module.exports=[24633,a=>{"use strict";a.s(["default",()=>E]);var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(210),f=a.i(41675),g=a.i(16201),h=a.i(41710),i=a.i(24569),j=a.i(52495),k=a.i(83497),l=a.i(24987),m=a.i(67900),n=a.i(46842),o=a.i(4720),p=a.i(73570),q=a.i(10227),r=a.i(62722),s=a.i(99570),t=a.i(91119),u=a.i(86304),v=a.i(5084),w=a.i(66718),x=a.i(70430),y=a.i(29246),z=a.i(80701),A=a.i(86192),B=a.i(96221),C=a.i(95669),D=a.i(47507);function E({params:a}){let E=(0,d.useRouter)(),{id:F}=(0,c.use)(a),{canManageInventory:G}=(0,D.usePermissions)(),[H,I]=(0,c.useState)(!1),[J,K]=(0,c.useState)({status:"",actual_delivery_date:"",notes:""}),{data:L,isLoading:M,error:N}=(0,C.useMaterialOrder)(F),O=(0,C.useUpdateMaterialOrder)(),P=(0,C.useDeleteMaterialOrder)(),Q=a=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(a),R=a=>a?new Date(a).toLocaleDateString("de-DE"):"—",S=async()=>{if(L)try{await O.mutateAsync({id:L.id,data:{status:J.status,actual_delivery_date:J.actual_delivery_date||void 0,notes:J.notes||void 0}}),I(!1)}catch(a){console.error("Failed to update order:",a)}},T=async(a,b)=>{if(L)try{await O.mutateAsync({id:L.id,data:{status:a,actual_delivery_date:b||void 0,notes:L.notes||void 0}})}catch(a){console.error("Failed to update order:",a)}},U=async()=>{if(L)try{await P.mutateAsync(L.id),E.push("/dashboard/materials")}catch(a){console.error("Failed to delete order:",a)}};return M?(0,b.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,b.jsx)(B.Loader2,{className:"h-8 w-8 animate-spin"})}):N||!L?(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("div",{className:"flex items-center gap-4",children:(0,b.jsxs)(s.Button,{variant:"ghost",onClick:()=>E.back(),children:[(0,b.jsx)(e.ArrowLeft,{className:"mr-2 h-4 w-4"}),"Back"]})}),(0,b.jsx)(t.Card,{children:(0,b.jsx)(t.CardContent,{className:"py-8",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(p.AlertTriangle,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,b.jsx)("h3",{className:"mt-2 text-lg font-semibold",children:"Order not found"}),(0,b.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"The material order you're looking for doesn't exist or you don't have permission to view it."})]})})})]}):(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsxs)(s.Button,{variant:"ghost",onClick:()=>E.back(),children:[(0,b.jsx)(e.ArrowLeft,{className:"mr-2 h-4 w-4"}),"Back"]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("h1",{className:"text-3xl font-bold tracking-tight",children:["Order #",L.id.slice(0,8)]}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Material order details and management"})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(a=>{let c={pending:{variant:"outline",icon:h.Clock,color:"text-yellow-600"},ordered:{variant:"secondary",icon:q.Truck,color:"text-blue-600"},delivered:{variant:"default",icon:g.CheckCircle,color:"text-green-600"},cancelled:{variant:"destructive",icon:r.XCircle,color:"text-red-600"},draft:{variant:"outline",icon:o.FileText,color:"text-gray-600"}},d=c[a]||c.pending,e=d.icon;return(0,b.jsxs)(u.Badge,{variant:d.variant,children:[(0,b.jsx)(e,{className:`mr-1 h-3 w-3 ${d.color}`}),a.charAt(0).toUpperCase()+a.slice(1)]})})(L.status),G&&!H&&(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(s.Button,{variant:"outline",onClick:()=>{L&&(K({status:L.status,actual_delivery_date:L.actual_delivery_date||"",notes:L.notes||""}),I(!0))},children:[(0,b.jsx)(i.Edit,{className:"mr-2 h-4 w-4"}),"Edit"]}),("draft"===L.status||"pending"===L.status)&&(0,b.jsxs)(A.AlertDialog,{children:[(0,b.jsx)(A.AlertDialogTrigger,{asChild:!0,children:(0,b.jsxs)(s.Button,{variant:"destructive",children:[(0,b.jsx)(r.XCircle,{className:"mr-2 h-4 w-4"}),"Delete"]})}),(0,b.jsxs)(A.AlertDialogContent,{children:[(0,b.jsxs)(A.AlertDialogHeader,{children:[(0,b.jsx)(A.AlertDialogTitle,{children:"Delete Material Order"}),(0,b.jsx)(A.AlertDialogDescription,{children:"Are you sure you want to delete this material order? This action cannot be undone. Only draft and pending orders can be deleted."})]}),(0,b.jsxs)(A.AlertDialogFooter,{children:[(0,b.jsx)(A.AlertDialogCancel,{children:"Cancel"}),(0,b.jsx)(A.AlertDialogAction,{onClick:U,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete Order"})]})]})]})]})]})]}),(0,b.jsxs)("div",{className:"grid gap-6 lg:grid-cols-3",children:[(0,b.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,b.jsxs)(t.Card,{children:[(0,b.jsx)(t.CardHeader,{children:(0,b.jsxs)(t.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(k.Package,{className:"h-5 w-5"}),"Order Information"]})}),(0,b.jsxs)(t.CardContent,{className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-medium mb-3",children:"Material"}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Material Type:"}),(0,b.jsx)("span",{className:"font-medium",children:L.material_type||"—"})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"SKU:"}),(0,b.jsx)("span",{className:"font-mono text-sm",children:L.material_sku||"—"})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Unit:"}),(0,b.jsx)("span",{children:L.material_unit||"—"})]})]})]}),(0,b.jsx)(v.Separator,{}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(x.Label,{className:"text-sm text-muted-foreground",children:"Quantity"}),(0,b.jsxs)("p",{className:"font-medium",children:[L.quantity," ",L.material_unit||"units"]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(x.Label,{className:"text-sm text-muted-foreground",children:"Unit Price"}),(0,b.jsx)("p",{className:"font-medium",children:Q(L.unit_price_eur)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(x.Label,{className:"text-sm text-muted-foreground",children:"Delivery Cost"}),(0,b.jsx)("p",{className:"font-medium",children:Q(L.delivery_cost_eur||0)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(x.Label,{className:"text-sm text-muted-foreground",children:"Total Cost"}),(0,b.jsx)("p",{className:"text-lg font-bold",children:Q(L.total_cost_eur)})]})]}),(0,b.jsx)(v.Separator,{}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(x.Label,{className:"text-sm text-muted-foreground",children:"Order Date"}),(0,b.jsxs)("p",{className:"flex items-center gap-2",children:[(0,b.jsx)(f.Calendar,{className:"h-4 w-4"}),R(L.order_date)]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(x.Label,{className:"text-sm text-muted-foreground",children:"Expected Delivery"}),(0,b.jsxs)("p",{className:"flex items-center gap-2",children:[(0,b.jsx)(f.Calendar,{className:"h-4 w-4"}),R(L.expected_delivery_date)]})]}),L.actual_delivery_date&&(0,b.jsxs)("div",{className:"col-span-2",children:[(0,b.jsx)(x.Label,{className:"text-sm text-muted-foreground",children:"Actual Delivery"}),(0,b.jsxs)("p",{className:"flex items-center gap-2",children:[(0,b.jsx)(g.CheckCircle,{className:"h-4 w-4 text-green-600"}),R(L.actual_delivery_date)]})]})]}),L.notes&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(v.Separator,{}),(0,b.jsxs)("div",{children:[(0,b.jsx)(x.Label,{className:"text-sm text-muted-foreground",children:"Notes"}),(0,b.jsx)("p",{className:"mt-1 p-3 bg-muted rounded-md text-sm",children:L.notes})]})]})]})]}),H&&(0,b.jsxs)(t.Card,{children:[(0,b.jsxs)(t.CardHeader,{children:[(0,b.jsx)(t.CardTitle,{children:"Edit Order"}),(0,b.jsx)(t.CardDescription,{children:"Update order status, delivery date, and notes"})]}),(0,b.jsxs)(t.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(x.Label,{htmlFor:"status",children:"Status"}),(0,b.jsxs)(z.Select,{value:J.status,onValueChange:a=>K({...J,status:a}),children:[(0,b.jsx)(z.SelectTrigger,{children:(0,b.jsx)(z.SelectValue,{placeholder:"Select status"})}),(0,b.jsxs)(z.SelectContent,{children:[(0,b.jsx)(z.SelectItem,{value:"draft",children:"Draft"}),(0,b.jsx)(z.SelectItem,{value:"pending",children:"Pending"}),(0,b.jsx)(z.SelectItem,{value:"ordered",children:"Ordered"}),(0,b.jsx)(z.SelectItem,{value:"delivered",children:"Delivered"}),(0,b.jsx)(z.SelectItem,{value:"cancelled",children:"Cancelled"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(x.Label,{htmlFor:"actual_delivery_date",children:"Actual Delivery Date"}),(0,b.jsx)(w.Input,{id:"actual_delivery_date",type:"date",value:J.actual_delivery_date,onChange:a=>K({...J,actual_delivery_date:a.target.value})})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(x.Label,{htmlFor:"notes",children:"Notes"}),(0,b.jsx)(y.Textarea,{id:"notes",value:J.notes,onChange:a=>K({...J,notes:a.target.value}),placeholder:"Add any additional notes about this order...",rows:3})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)(s.Button,{variant:"outline",onClick:()=>I(!1),children:"Cancel"}),(0,b.jsx)(s.Button,{onClick:S,disabled:O.isPending,children:O.isPending?"Saving...":"Save Changes"})]})]})]})]}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)(t.Card,{children:[(0,b.jsx)(t.CardHeader,{children:(0,b.jsxs)(t.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(m.Building2,{className:"h-5 w-5"}),"Supplier"]})}),(0,b.jsxs)(t.CardContent,{className:"space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:L.supplier_name||"—"}),L.supplier_contact&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:L.supplier_contact})]}),L.supplier_phone&&(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Phone:"}),(0,b.jsx)("span",{children:L.supplier_phone})]}),L.supplier_email&&(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Email:"}),(0,b.jsx)("span",{children:L.supplier_email})]})]})]}),L.project_name&&(0,b.jsxs)(t.Card,{children:[(0,b.jsx)(t.CardHeader,{children:(0,b.jsxs)(t.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(l.MapPin,{className:"h-5 w-5"}),"Project"]})}),(0,b.jsx)(t.CardContent,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("p",{className:"font-medium",children:L.project_name}),L.project_id&&(0,b.jsx)(s.Button,{variant:"outline",size:"sm",onClick:()=>E.push(`/dashboard/projects/${L.project_id}`),children:(0,b.jsx)(j.ExternalLink,{className:"h-4 w-4"})})]})})]}),(0,b.jsxs)(t.Card,{children:[(0,b.jsx)(t.CardHeader,{children:(0,b.jsxs)(t.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(n.User,{className:"h-5 w-5"}),"Order Details"]})}),(0,b.jsxs)(t.CardContent,{className:"space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Created by"}),(0,b.jsx)("p",{className:"font-medium",children:L.created_by_name||"—"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Order ID"}),(0,b.jsx)("p",{className:"font-mono text-sm",children:L.id})]}),L.created_at&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Created"}),(0,b.jsx)("p",{className:"text-sm",children:R(L.created_at)})]})]})]}),G&&!H&&(0,b.jsxs)(t.Card,{children:[(0,b.jsx)(t.CardHeader,{children:(0,b.jsx)(t.CardTitle,{children:"Quick Actions"})}),(0,b.jsxs)(t.CardContent,{className:"space-y-2",children:["pending"===L.status&&(0,b.jsxs)(s.Button,{variant:"outline",className:"w-full justify-start",onClick:()=>T("ordered"),disabled:O.isPending,children:[(0,b.jsx)(q.Truck,{className:"mr-2 h-4 w-4"}),O.isPending?"Updating...":"Mark as Ordered"]}),("pending"===L.status||"ordered"===L.status)&&(0,b.jsxs)(s.Button,{variant:"outline",className:"w-full justify-start",onClick:()=>T("delivered",new Date().toISOString().split("T")[0]),disabled:O.isPending,children:[(0,b.jsx)(g.CheckCircle,{className:"mr-2 h-4 w-4"}),O.isPending?"Updating...":"Mark as Delivered"]})]})]})]})]})]})}}];

//# sourceMappingURL=src_app_%28dashboard%29_dashboard_materials_orders_%5Bid%5D_page_tsx_9a28f99d._.js.map