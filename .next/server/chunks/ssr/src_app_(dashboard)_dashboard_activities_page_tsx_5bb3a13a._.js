module.exports=[84088,a=>{"use strict";a.s(["default",()=>C],84088);var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(91119),f=a.i(99570),g=a.i(86304),h=a.i(66718),i=a.i(80701),j=a.i(6015),k=a.i(33140),l=a.i(75083),m=a.i(87532),n=a.i(69012),o=a.i(46842),p=a.i(90669),q=a.i(39761),r=a.i(41710),s=a.i(60246),t=a.i(84505),u=a.i(69520),v=a.i(24669),w=a.i(77156),x=a.i(33217);a.i(70025),a.i(37927);let y={all:["activities"],lists:()=>[...y.all,"list"],list:a=>[...y.lists(),a],stats:a=>[...y.all,"stats",a]},z=["login","logout","project_created","project_updated","project_deleted","work_entry_created","work_entry_updated","work_entry_approved","work_entry_deleted","crew_created","crew_updated","crew_deleted","user_created","user_updated","user_deleted","equipment_created","equipment_updated","equipment_deleted","equipment_assigned","material_allocated","material_used","expense_created","expense_approved","document_uploaded","document_deleted","report_generated","settings_updated"];function A(a){return({login:"User Login",logout:"User Logout",project_created:"Project Created",project_updated:"Project Updated",project_deleted:"Project Deleted",work_entry_created:"Work Entry Created",work_entry_updated:"Work Entry Updated",work_entry_approved:"Work Entry Approved",work_entry_deleted:"Work Entry Deleted",crew_created:"Team Created",crew_updated:"Team Updated",crew_deleted:"Team Deleted",user_created:"User Created",user_updated:"User Updated",user_deleted:"User Deleted",equipment_created:"Equipment Added",equipment_updated:"Equipment Updated",equipment_deleted:"Equipment Deleted",equipment_assigned:"Equipment Assigned",material_allocated:"Material Allocated",material_used:"Material Used",expense_created:"Expense Created",expense_approved:"Expense Approved",document_uploaded:"Document Uploaded",document_deleted:"Document Deleted",report_generated:"Report Generated",settings_updated:"Settings Updated"})[a]||a.replace(/_/g," ").replace(/\b\w/g,a=>a.toUpperCase())}function B(a){return({login:"bg-green-100 text-green-800",logout:"bg-gray-100 text-gray-800",project_created:"bg-blue-100 text-blue-800",project_updated:"bg-yellow-100 text-yellow-800",project_deleted:"bg-red-100 text-red-800",work_entry_created:"bg-purple-100 text-purple-800",work_entry_updated:"bg-purple-100 text-purple-800",work_entry_approved:"bg-green-100 text-green-800",work_entry_deleted:"bg-red-100 text-red-800",crew_created:"bg-indigo-100 text-indigo-800",crew_updated:"bg-indigo-100 text-indigo-800",crew_deleted:"bg-red-100 text-red-800",user_created:"bg-emerald-100 text-emerald-800",user_updated:"bg-emerald-100 text-emerald-800",user_deleted:"bg-red-100 text-red-800",equipment_created:"bg-orange-100 text-orange-800",equipment_updated:"bg-orange-100 text-orange-800",equipment_deleted:"bg-red-100 text-red-800",equipment_assigned:"bg-cyan-100 text-cyan-800",material_allocated:"bg-teal-100 text-teal-800",material_used:"bg-teal-100 text-teal-800",expense_created:"bg-rose-100 text-rose-800",expense_approved:"bg-green-100 text-green-800",document_uploaded:"bg-violet-100 text-violet-800",document_deleted:"bg-red-100 text-red-800",report_generated:"bg-sky-100 text-sky-800",settings_updated:"bg-slate-100 text-slate-800"})[a]||"bg-gray-100 text-gray-800"}function C(){(0,d.useRouter)();let[a,C]=(0,c.useState)({page:1,per_page:50}),{data:D,isLoading:E,error:F,refetch:G}=function(a={}){let b=new URLSearchParams;return Object.entries(a).forEach(([a,c])=>{null!=c&&""!==c&&b.append(a,c.toString())}),(0,x.useQuery)({queryKey:y.list(a),queryFn:async()=>{let a=await fetch(`/api/activities?${b.toString()}`);if(!a.ok)throw Error("Failed to fetch activities");return a.json()}})}(a),{data:H,isLoading:I}=function(a={}){let b=new URLSearchParams;return Object.entries(a).forEach(([a,c])=>{null!=c&&""!==c&&b.append(a,c.toString())}),(0,x.useQuery)({queryKey:y.stats(a),queryFn:async()=>{let a=await fetch(`/api/activities/stats?${b.toString()}`);if(!a.ok)throw Error("Failed to fetch activity statistics");return a.json()}})}({user_id:a.user_id,project_id:a.project_id,activity_type:a.activity_type,date_from:a.date_from,date_to:a.date_to}),J=(a,b)=>{let c="all"===b?void 0:b;C(b=>({...b,[a]:c,page:1}))};return F?(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("div",{className:"flex items-center justify-between",children:(0,b.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Activity Log"})}),(0,b.jsx)(e.Card,{children:(0,b.jsx)(e.CardContent,{className:"py-8",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(p.Activity,{className:"mx-auto h-12 w-12 text-red-500"}),(0,b.jsx)("h3",{className:"mt-2 text-sm font-semibold",children:"Error Loading Activities"}),(0,b.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"Failed to load activity log. Please try again."}),(0,b.jsxs)(f.Button,{onClick:()=>G(),className:"mt-4",children:[(0,b.jsx)(u.RefreshCw,{className:"mr-2 h-4 w-4"}),"Retry"]})]})})})]}):(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Activity Log"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Complete audit trail of system activities and user actions"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)(f.Button,{variant:"outline",onClick:()=>G(),disabled:E,children:[(0,b.jsx)(u.RefreshCw,{className:`mr-2 h-4 w-4 ${E?"animate-spin":""}`}),"Refresh"]}),(0,b.jsxs)(f.Button,{variant:"outline",children:[(0,b.jsx)(t.Download,{className:"mr-2 h-4 w-4"}),"Export"]})]})]}),(0,b.jsxs)(l.Tabs,{defaultValue:"activities",className:"space-y-4",children:[(0,b.jsxs)(l.TabsList,{children:[(0,b.jsxs)(l.TabsTrigger,{value:"activities",children:["Activity Log (",D?.total||0,")"]}),(0,b.jsxs)(l.TabsTrigger,{value:"analytics",children:[(0,b.jsx)(q.BarChart3,{className:"mr-2 h-4 w-4"}),"Analytics"]})]}),(0,b.jsxs)(l.TabsContent,{value:"activities",className:"space-y-6",children:[H&&(0,b.jsxs)("div",{className:"grid gap-6 md:grid-cols-4",children:[(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(e.CardTitle,{className:"text-sm font-medium",children:"Total Activities"}),(0,b.jsx)(p.Activity,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:H.overview.total_activities}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"All logged activities"})]})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(e.CardTitle,{className:"text-sm font-medium",children:"Active Users"}),(0,b.jsx)(s.Users,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:H.overview.unique_users}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Users with activity"})]})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(e.CardTitle,{className:"text-sm font-medium",children:"Activity Types"}),(0,b.jsx)(q.BarChart3,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:H.overview.activity_types_count}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Different action types"})]})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(e.CardTitle,{className:"text-sm font-medium",children:"Active Projects"}),(0,b.jsx)(v.TrendingUp,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:H.overview.active_projects}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Projects with activity"})]})]})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsxs)(e.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(n.Filter,{className:"w-5 h-5"}),"Filter Activities"]})}),(0,b.jsx)(e.CardContent,{children:(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(m.Search,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(h.Input,{placeholder:"Search activities...",className:"pl-9",value:a.search||"",onChange:a=>J("search",a.target.value)})]}),(0,b.jsxs)(i.Select,{onValueChange:a=>J("activity_type",a),children:[(0,b.jsx)(i.SelectTrigger,{children:(0,b.jsx)(i.SelectValue,{placeholder:"Activity type"})}),(0,b.jsxs)(i.SelectContent,{children:[(0,b.jsx)(i.SelectItem,{value:"all",children:"All Types"}),z.map(a=>(0,b.jsx)(i.SelectItem,{value:a,children:A(a)},a))]})]}),(0,b.jsxs)(i.Select,{onValueChange:a=>{let b,c=new Date;switch(a){case"today":b=new Date(c.getFullYear(),c.getMonth(),c.getDate()).toISOString();break;case"week":b=new Date(c.getTime()-6048e5).toISOString();break;case"month":b=new Date(c.getTime()-2592e6).toISOString();break;default:b=void 0}C(a=>({...a,date_from:b,page:1}))},children:[(0,b.jsx)(i.SelectTrigger,{children:(0,b.jsx)(i.SelectValue,{placeholder:"Time range"})}),(0,b.jsxs)(i.SelectContent,{children:[(0,b.jsx)(i.SelectItem,{value:"all",children:"All Time"}),(0,b.jsx)(i.SelectItem,{value:"today",children:"Today"}),(0,b.jsx)(i.SelectItem,{value:"week",children:"Last 7 Days"}),(0,b.jsx)(i.SelectItem,{value:"month",children:"Last 30 Days"})]})]}),(0,b.jsx)(h.Input,{type:"datetime-local",placeholder:"From date",value:a.date_from?new Date(a.date_from).toISOString().slice(0,16):"",onChange:a=>J("date_from",a.target.value?new Date(a.target.value).toISOString():"")}),(0,b.jsx)(h.Input,{type:"datetime-local",placeholder:"To date",value:a.date_to?new Date(a.date_to).toISOString().slice(0,16):"",onChange:a=>J("date_to",a.target.value?new Date(a.target.value).toISOString():"")}),(0,b.jsxs)(i.Select,{onValueChange:a=>J("per_page",parseInt(a)),children:[(0,b.jsx)(i.SelectTrigger,{children:(0,b.jsx)(i.SelectValue,{placeholder:"Page size"})}),(0,b.jsxs)(i.SelectContent,{children:[(0,b.jsx)(i.SelectItem,{value:"25",children:"25 per page"}),(0,b.jsx)(i.SelectItem,{value:"50",children:"50 per page"}),(0,b.jsx)(i.SelectItem,{value:"100",children:"100 per page"}),(0,b.jsx)(i.SelectItem,{value:"200",children:"200 per page"})]})]})]})})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsx)(e.CardTitle,{children:"Activity Log"}),(0,b.jsxs)(e.CardDescription,{children:[D?.total||0," activities found"]})]}),(0,b.jsx)(e.CardContent,{children:E?(0,b.jsx)("div",{className:"space-y-4",children:[...Array(10)].map((a,c)=>(0,b.jsxs)("div",{className:"flex space-x-4",children:[(0,b.jsx)(k.Skeleton,{className:"h-4 w-[100px]"}),(0,b.jsx)(k.Skeleton,{className:"h-4 w-[150px]"}),(0,b.jsx)(k.Skeleton,{className:"h-4 w-[200px]"}),(0,b.jsx)(k.Skeleton,{className:"h-4 w-[100px]"}),(0,b.jsx)(k.Skeleton,{className:"h-4 w-[80px]"})]},c))}):D?.activities&&0!==D.activities.length?(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(j.Table,{children:[(0,b.jsx)(j.TableHeader,{children:(0,b.jsxs)(j.TableRow,{children:[(0,b.jsx)(j.TableHead,{children:"Timestamp"}),(0,b.jsx)(j.TableHead,{children:"User"}),(0,b.jsx)(j.TableHead,{children:"Activity"}),(0,b.jsx)(j.TableHead,{children:"Description"}),(0,b.jsx)(j.TableHead,{children:"Project"}),(0,b.jsx)(j.TableHead,{children:"Actions"})]})}),(0,b.jsx)(j.TableBody,{children:D.activities.map(a=>(0,b.jsxs)(j.TableRow,{children:[(0,b.jsx)(j.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(r.Clock,{className:"w-4 h-4 text-gray-400"}),(0,b.jsx)("span",{className:"text-sm",children:new Date(a.timestamp).toLocaleString("en-GB",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})}),(0,b.jsx)(j.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(o.User,{className:"w-4 h-4 text-gray-400"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium text-sm",children:a.user?.name||"Unknown User"}),a.user?.role&&(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:a.user.role})]})]})}),(0,b.jsx)(j.TableCell,{children:(0,b.jsx)(g.Badge,{className:B(a.activity_type),children:A(a.activity_type)})}),(0,b.jsx)(j.TableCell,{children:(0,b.jsx)("span",{className:"text-sm max-w-xs truncate block",children:a.description})}),(0,b.jsx)(j.TableCell,{children:a.project?(0,b.jsx)("span",{className:"text-sm font-medium",children:a.project.name}):(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"â€”"})}),(0,b.jsx)(j.TableCell,{children:(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",onClick:()=>{console.log("View activity details:",a)},children:(0,b.jsx)(w.Eye,{className:"w-4 h-4"})})})]},a.id))})]})}):(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)(p.Activity,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-medium mb-2",children:"No Activities Found"}),(0,b.jsx)("p",{className:"text-gray-600 mb-4",children:"No activities match the current filters."}),(0,b.jsx)(f.Button,{variant:"outline",onClick:()=>C({page:1,per_page:50}),children:"Clear Filters"})]})})]}),D&&D.total_pages>1&&(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Showing ",(D.page-1)*D.per_page+1," to"," ",Math.min(D.page*D.per_page,D.total)," of"," ",D.total," activities"]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(f.Button,{variant:"outline",size:"sm",onClick:()=>J("page",Math.max(1,(a.page||1)-1)),disabled:D.page<=1,children:"Previous"}),(0,b.jsx)(f.Button,{variant:"outline",size:"sm",onClick:()=>J("page",(a.page||1)+1),disabled:D.page>=D.total_pages,children:"Next"})]})]})]}),(0,b.jsx)(l.TabsContent,{value:"analytics",className:"space-y-6",children:I?(0,b.jsx)("div",{className:"grid gap-6 md:grid-cols-2",children:[void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsx)(e.Card,{children:(0,b.jsx)(e.CardContent,{className:"p-6",children:(0,b.jsx)(k.Skeleton,{className:"h-48 w-full"})})},c))}):H?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsx)(e.CardTitle,{children:"Activity Types"}),(0,b.jsx)(e.CardDescription,{children:"Distribution of activity types"})]}),(0,b.jsx)(e.CardContent,{children:(0,b.jsx)("div",{className:"space-y-4",children:H.activity_types.slice(0,10).map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("div",{className:"flex items-center gap-3",children:(0,b.jsx)(g.Badge,{className:B(a.activity_type),children:A(a.activity_type)})}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-sm font-medium",children:a.count}),(0,b.jsxs)("span",{className:"text-sm text-muted-foreground",children:["(",a.percentage.toFixed(1),"%)"]})]})]},a.activity_type))})})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsx)(e.CardTitle,{children:"Most Active Users"}),(0,b.jsx)(e.CardDescription,{children:"Users with the highest activity"})]}),(0,b.jsx)(e.CardContent,{children:(0,b.jsx)("div",{className:"space-y-4",children:H.most_active_users.slice(0,10).map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-6 h-6 rounded-full bg-primary text-primary-foreground text-xs flex items-center justify-center",children:c+1}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium",children:a.user_name}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:a.role})]})]}),(0,b.jsxs)("div",{className:"text-sm font-medium",children:[a.activity_count," activities"]})]},a.user_id))})})]}),H.project_activity.length>0&&(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsx)(e.CardTitle,{children:"Project Activity"}),(0,b.jsx)(e.CardDescription,{children:"Most active projects"})]}),(0,b.jsx)(e.CardContent,{children:(0,b.jsx)("div",{className:"space-y-4",children:H.project_activity.slice(0,10).map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-6 h-6 rounded-full bg-secondary text-secondary-foreground text-xs flex items-center justify-center",children:c+1}),(0,b.jsx)("div",{className:"font-medium",children:a.project_name})]}),(0,b.jsxs)("div",{className:"text-sm font-medium",children:[a.activity_count," activities"]})]},a.project_id))})})]})]}):(0,b.jsx)(e.Card,{children:(0,b.jsx)(e.CardContent,{className:"py-8",children:(0,b.jsx)("div",{className:"text-center text-muted-foreground",children:"No analytics data available"})})})})]})]})}}];

//# sourceMappingURL=src_app_%28dashboard%29_dashboard_activities_page_tsx_5bb3a13a._.js.map