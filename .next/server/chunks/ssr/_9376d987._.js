module.exports=[86456,a=>{"use strict";a.s(["useCreateProject",()=>j,"useDeleteProject",()=>l,"useProject",()=>i,"useProjectStats",()=>m,"useProjects",()=>h,"useUpdateProject",()=>k]);var b=a.i(33217),c=a.i(70025),d=a.i(37927),e=a.i(23292),f=a.i(91938);let g={all:["projects"],lists:()=>[...g.all,"list"],list:a=>[...g.lists(),a],details:()=>[...g.all,"detail"],detail:a=>[...g.details(),a]};function h(a){return(0,b.useQuery)({queryKey:g.list(a||{}),queryFn:()=>f.projectsApi.getProjects(a),staleTime:3e5})}function i(a){return(0,b.useQuery)({queryKey:g.detail(a),queryFn:()=>f.projectsApi.getProject(a),enabled:!!a,staleTime:3e5})}function j(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:a=>f.projectsApi.createProject(a),onSuccess:b=>{a.invalidateQueries({queryKey:g.lists()}),a.setQueryData(g.detail(b.id),b),e.toast.success("Project created successfully")},onError:a=>{e.toast.error(`Failed to create project: ${a.message}`)}})}function k(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:({id:a,data:b})=>f.projectsApi.updateProject(a,b),onMutate:async({id:b,data:c})=>{await a.cancelQueries({queryKey:g.detail(b)});let d=a.getQueryData(g.detail(b));return a.setQueryData(g.detail(b),a=>a?{...a,...c}:a),{previousProject:d}},onError:(b,{id:c},d)=>{d?.previousProject&&a.setQueryData(g.detail(c),d.previousProject),e.toast.error(`Failed to update project: ${b.message}`)},onSuccess:b=>{a.invalidateQueries({queryKey:g.lists()}),e.toast.success("Project updated successfully")},onSettled:(b,c,{id:d})=>{a.invalidateQueries({queryKey:g.detail(d)})}})}function l(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:a=>f.projectsApi.deleteProject(a),onSuccess:(b,c)=>{a.removeQueries({queryKey:g.detail(c)}),a.invalidateQueries({queryKey:g.lists()}),e.toast.success("Project deleted successfully")},onError:a=>{e.toast.error(`Failed to delete project: ${a.message}`)}})}function m(a){return(0,b.useQuery)({queryKey:[...g.detail(a),"stats"],queryFn:async()=>{let b=await fetch(`/api/projects/${a}/stats`);if(!b.ok)throw Error("Failed to fetch project statistics");return b.json()},staleTime:12e4,enabled:!!a})}},210,a=>{"use strict";a.s(["ArrowLeft",()=>b],210);let b=(0,a.i(70106).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},14548,a=>{"use strict";a.s(["Save",()=>b],14548);let b=(0,a.i(70106).default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},10778,a=>{"use strict";a.s(["useDeleteUser",()=>j,"useProjectManagers",()=>k,"useUpdateUser",()=>i,"useUsers",()=>h]);var b=a.i(33217),c=a.i(70025),d=a.i(37927),e=a.i(23292),f=a.i(91938);let g={all:["users"],lists:()=>[...g.all,"list"],list:a=>[...g.lists(),a],details:()=>[...g.all,"detail"],detail:a=>[...g.details(),a]};function h(a){return(0,b.useQuery)({queryKey:g.list(a||{}),queryFn:()=>f.usersApi.getUsers(a),staleTime:3e5})}function i(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:({id:a,data:b})=>f.usersApi.updateUser(a,b),onMutate:async({id:b,data:c})=>{await a.cancelQueries({queryKey:g.detail(b)});let d=a.getQueryData(g.detail(b));return a.setQueryData(g.detail(b),a=>a?{...a,...c}:a),{previousUser:d}},onError:(b,{id:c},d)=>{d?.previousUser&&a.setQueryData(g.detail(c),d.previousUser),e.toast.error(`Failed to update user: ${b.message}`)},onSuccess:()=>{a.invalidateQueries({queryKey:g.lists()}),e.toast.success("User updated successfully")},onSettled:(b,c,{id:d})=>{a.invalidateQueries({queryKey:g.detail(d)})}})}function j(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:a=>f.usersApi.deleteUser(a),onSuccess:(b,c)=>{a.removeQueries({queryKey:g.detail(c)}),a.invalidateQueries({queryKey:g.lists()}),e.toast.success("User deleted successfully")},onError:a=>{e.toast.error(`Failed to delete user: ${a.message}`)}})}function k(){return h({role:"pm",page:1,per_page:50})}},30769,a=>{"use strict";a.s(["CalendarIcon",()=>b.default]);var b=a.i(67937)},63672,a=>{"use strict";a.s(["requireAuth",()=>c]);var b=a.i(50944);function c(){(0,b.redirect)("/login")}a.i(47507)},22497,a=>{"use strict";a.s(["default",()=>t]);var b=a.i(87924),c=a.i(50944),d=a.i(95245),e=a.i(59501),f=a.i(56757),g=a.i(30769),h=a.i(210),i=a.i(14548),j=a.i(67900),k=a.i(99570),l=a.i(91119),m=a.i(41921),n=a.i(66718),o=a.i(80701),p=a.i(86456),q=a.i(10778),r=a.i(63672);let s=f.z.object({name:f.z.string().min(1,"Project name is required").max(255,"Project name too long"),customer:f.z.string().optional(),city:f.z.string().optional(),address:f.z.string().optional(),contact_24h:f.z.string().optional(),start_date:f.z.string().optional(),end_date_plan:f.z.string().optional(),total_length_m:f.z.coerce.number().min(0,"Length must be positive"),base_rate_per_m:f.z.coerce.number().min(0,"Rate must be positive"),language_default:f.z.enum(["ru","en","de","uz","tr"]),pm_user_id:f.z.string().optional()});function t(){(0,r.requireAuth)();let a=(0,c.useRouter)(),f=(0,p.useCreateProject)(),{data:t,isLoading:u}=(0,q.useProjectManagers)(),v=(0,d.useForm)({resolver:(0,e.zodResolver)(s),defaultValues:{name:"",customer:"",city:"",address:"",contact_24h:"",start_date:"",end_date_plan:"",total_length_m:0,base_rate_per_m:15.5,language_default:"de",pm_user_id:"none"}}),w=async b=>{try{let c={...b,start_date:b.start_date||void 0,end_date_plan:b.end_date_plan||void 0,pm_user_id:"none"!==b.pm_user_id&&b.pm_user_id?b.pm_user_id:void 0},d=await f.mutateAsync(c);a.push(`/dashboard/projects/${d.id}`)}catch(a){console.error("Failed to create project:",a)}},x=[{value:"de",label:"German (Deutsch)"},{value:"en",label:"English"},{value:"ru",label:"Russian (Русский)"},{value:"uz",label:"Uzbek (Oʻzbek)"},{value:"tr",label:"Turkish (Türkçe)"}];return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("div",{className:"flex items-center justify-between",children:(0,b.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,b.jsxs)(k.Button,{variant:"ghost",size:"sm",onClick:()=>a.back(),className:"flex items-center space-x-2",children:[(0,b.jsx)(h.ArrowLeft,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"Back"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Create New Project"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Set up a new fiber optic construction project"})]})]})}),(0,b.jsx)("div",{className:"max-w-2xl",children:(0,b.jsx)(m.Form,{...v,children:(0,b.jsxs)("form",{onSubmit:v.handleSubmit(w),className:"space-y-6",children:[(0,b.jsxs)(l.Card,{children:[(0,b.jsxs)(l.CardHeader,{children:[(0,b.jsxs)(l.CardTitle,{className:"flex items-center space-x-2",children:[(0,b.jsx)(j.Building2,{className:"h-5 w-5"}),(0,b.jsx)("span",{children:"Basic Information"})]}),(0,b.jsx)(l.CardDescription,{children:"Enter the fundamental details about the project"})]}),(0,b.jsxs)(l.CardContent,{className:"space-y-6",children:[(0,b.jsx)(m.FormField,{control:v.control,name:"name",render:({field:a})=>(0,b.jsxs)(m.FormItem,{children:[(0,b.jsx)(m.FormLabel,{children:"Project Name *"}),(0,b.jsx)(m.FormControl,{children:(0,b.jsx)(n.Input,{placeholder:"e.g., Fiber Installation Berlin District 1",...a})}),(0,b.jsx)(m.FormDescription,{children:"A clear, descriptive name for the project"}),(0,b.jsx)(m.FormMessage,{})]})}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsx)(m.FormField,{control:v.control,name:"customer",render:({field:a})=>(0,b.jsxs)(m.FormItem,{children:[(0,b.jsx)(m.FormLabel,{children:"Customer"}),(0,b.jsx)(m.FormControl,{children:(0,b.jsx)(n.Input,{placeholder:"e.g., Deutsche Telekom",...a})}),(0,b.jsx)(m.FormMessage,{})]})}),(0,b.jsx)(m.FormField,{control:v.control,name:"city",render:({field:a})=>(0,b.jsxs)(m.FormItem,{children:[(0,b.jsx)(m.FormLabel,{children:"City"}),(0,b.jsx)(m.FormControl,{children:(0,b.jsx)(n.Input,{placeholder:"e.g., Berlin",...a})}),(0,b.jsx)(m.FormMessage,{})]})})]}),(0,b.jsx)(m.FormField,{control:v.control,name:"address",render:({field:a})=>(0,b.jsxs)(m.FormItem,{children:[(0,b.jsx)(m.FormLabel,{children:"Project Address"}),(0,b.jsx)(m.FormControl,{children:(0,b.jsx)(n.Input,{placeholder:"e.g., Hauptstraße 123, 10115 Berlin",...a})}),(0,b.jsx)(m.FormDescription,{children:"Primary address or area where the work will be performed"}),(0,b.jsx)(m.FormMessage,{})]})}),(0,b.jsx)(m.FormField,{control:v.control,name:"contact_24h",render:({field:a})=>(0,b.jsxs)(m.FormItem,{children:[(0,b.jsx)(m.FormLabel,{children:"24h Emergency Contact"}),(0,b.jsx)(m.FormControl,{children:(0,b.jsx)(n.Input,{placeholder:"e.g., +49 30 12345678",...a})}),(0,b.jsx)(m.FormDescription,{children:"Contact number for emergencies during the project"}),(0,b.jsx)(m.FormMessage,{})]})}),(0,b.jsx)(m.FormField,{control:v.control,name:"language_default",render:({field:a})=>(0,b.jsxs)(m.FormItem,{children:[(0,b.jsx)(m.FormLabel,{children:"Default Language"}),(0,b.jsxs)(o.Select,{onValueChange:a.onChange,defaultValue:a.value,children:[(0,b.jsx)(m.FormControl,{children:(0,b.jsx)(o.SelectTrigger,{children:(0,b.jsx)(o.SelectValue,{placeholder:"Select project language"})})}),(0,b.jsx)(o.SelectContent,{children:x.map(a=>(0,b.jsx)(o.SelectItem,{value:a.value,children:a.label},a.value))})]}),(0,b.jsx)(m.FormDescription,{children:"Primary language used for project documentation and interface"}),(0,b.jsx)(m.FormMessage,{})]})}),(0,b.jsx)(m.FormField,{control:v.control,name:"pm_user_id",render:({field:a})=>(0,b.jsxs)(m.FormItem,{children:[(0,b.jsx)(m.FormLabel,{children:"Project Manager"}),(0,b.jsxs)(o.Select,{onValueChange:a.onChange,value:a.value,children:[(0,b.jsx)(m.FormControl,{children:(0,b.jsx)(o.SelectTrigger,{children:(0,b.jsx)(o.SelectValue,{placeholder:"Select project manager (optional)"})})}),(0,b.jsxs)(o.SelectContent,{children:[(0,b.jsx)(o.SelectItem,{value:"none",children:"No project manager assigned"}),u?(0,b.jsx)(o.SelectItem,{value:"loading",disabled:!0,children:"Loading project managers..."}):t?.items?.map(a=>(0,b.jsxs)(o.SelectItem,{value:a.id,children:[a.first_name," ",a.last_name," (",a.email,")"]},a.id))]})]}),(0,b.jsx)(m.FormDescription,{children:"Choose a project manager to oversee this project"}),(0,b.jsx)(m.FormMessage,{})]})})]})]}),(0,b.jsxs)(l.Card,{children:[(0,b.jsxs)(l.CardHeader,{children:[(0,b.jsx)(l.CardTitle,{children:"Project Scope"}),(0,b.jsx)(l.CardDescription,{children:"Define the scope and financial parameters of the project"})]}),(0,b.jsxs)(l.CardContent,{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsx)(m.FormField,{control:v.control,name:"total_length_m",render:({field:a})=>(0,b.jsxs)(m.FormItem,{children:[(0,b.jsx)(m.FormLabel,{children:"Total Length (meters) *"}),(0,b.jsx)(m.FormControl,{children:(0,b.jsx)(n.Input,{type:"number",step:"0.01",min:"0",placeholder:"e.g., 1500",...a})}),(0,b.jsx)(m.FormDescription,{children:"Total length of fiber cable to be installed"}),(0,b.jsx)(m.FormMessage,{})]})}),(0,b.jsx)(m.FormField,{control:v.control,name:"base_rate_per_m",render:({field:a})=>(0,b.jsxs)(m.FormItem,{children:[(0,b.jsx)(m.FormLabel,{children:"Rate per Meter (€) *"}),(0,b.jsx)(m.FormControl,{children:(0,b.jsx)(n.Input,{type:"number",step:"0.01",min:"0",placeholder:"e.g., 15.50",...a})}),(0,b.jsx)(m.FormDescription,{children:"Base rate charged per meter of installation"}),(0,b.jsx)(m.FormMessage,{})]})})]}),(0,b.jsxs)("div",{className:"rounded-md bg-muted p-4",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:"font-medium",children:"Estimated Project Value:"}),(0,b.jsxs)("span",{className:"text-lg font-bold",children:["€",(v.watch("total_length_m")*v.watch("base_rate_per_m")).toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground mt-1",children:[v.watch("total_length_m")," meters × €",v.watch("base_rate_per_m")," per meter"]})]})]})]}),(0,b.jsxs)(l.Card,{children:[(0,b.jsxs)(l.CardHeader,{children:[(0,b.jsxs)(l.CardTitle,{className:"flex items-center space-x-2",children:[(0,b.jsx)(g.CalendarIcon,{className:"h-5 w-5"}),(0,b.jsx)("span",{children:"Project Timeline"})]}),(0,b.jsx)(l.CardDescription,{children:"Set the planned start and end dates (optional)"})]}),(0,b.jsx)(l.CardContent,{className:"space-y-6",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsx)(m.FormField,{control:v.control,name:"start_date",render:({field:a})=>(0,b.jsxs)(m.FormItem,{children:[(0,b.jsx)(m.FormLabel,{children:"Planned Start Date"}),(0,b.jsx)(m.FormControl,{children:(0,b.jsx)(n.Input,{type:"date",...a})}),(0,b.jsx)(m.FormMessage,{})]})}),(0,b.jsx)(m.FormField,{control:v.control,name:"end_date_plan",render:({field:a})=>(0,b.jsxs)(m.FormItem,{children:[(0,b.jsx)(m.FormLabel,{children:"Planned End Date"}),(0,b.jsx)(m.FormControl,{children:(0,b.jsx)(n.Input,{type:"date",...a})}),(0,b.jsx)(m.FormMessage,{})]})})]})})]}),(0,b.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,b.jsx)(k.Button,{type:"button",variant:"outline",onClick:()=>a.back(),children:"Cancel"}),(0,b.jsxs)(k.Button,{type:"submit",disabled:f.isPending,className:"flex items-center space-x-2",children:[f.isPending?(0,b.jsx)("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-background border-t-transparent"}):(0,b.jsx)(i.Save,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"Create Project"})]})]})]})})})]})}}];

//# sourceMappingURL=_9376d987._.js.map