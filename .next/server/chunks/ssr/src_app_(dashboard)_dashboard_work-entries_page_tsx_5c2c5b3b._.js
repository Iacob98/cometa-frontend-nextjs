module.exports=[60600,a=>{"use strict";a.s(["default",()=>z]);var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(15618),f=a.i(87532),g=a.i(69012),h=a.i(24987),i=a.i(46842),j=a.i(77156),k=a.i(16201),l=a.i(41710),m=a.i(67900),n=a.i(13513),o=a.i(3544),p=a.i(99570),q=a.i(66718),r=a.i(91119),s=a.i(86304),t=a.i(6015),u=a.i(35732),v=a.i(80701),w=a.i(75083),x=a.i(49294),y=a.i(47507);function z(){let a=(0,d.useRouter)(),{user:z}=(0,y.useAuth)(),{canApproveWork:A,canManageWork:B}=(0,y.usePermissions)(),C=(0,x.useApproveWorkEntry)(),[D,E]=(0,c.useState)(""),[F,G]=(0,c.useState)("all"),[H,I]=(0,c.useState)("all"),{data:J,isLoading:K,error:L}=(0,x.useWorkEntries)({stage_code:"all"===F?void 0:F,approved:"all"===H?void 0:"approved"===H,page:1,per_page:20}),{data:M}=(0,x.usePendingApprovals)(),N=J?.items||[],O=M?.items||[],P=async a=>{try{await C.mutateAsync(a)}catch(a){console.error("Failed to approve work entry:",a)}},Q=a=>({stage_1_marking:"Marking",stage_2_excavation:"Excavation",stage_3_conduit:"Conduit Installation",stage_4_cable_pulling:"Cable Pulling",stage_5_closure:"Closure",stage_6_testing:"Testing",stage_7_backfill:"Backfilling",stage_8_restoration:"Surface Restoration",stage_9_documentation:"Documentation",stage_10_quality_check:"Quality Check"})[a]||a;return L?(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("div",{className:"flex items-center justify-between",children:(0,b.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Work Entries"})}),(0,b.jsx)(r.Card,{children:(0,b.jsx)(r.CardContent,{className:"py-8",children:(0,b.jsx)("div",{className:"text-center text-muted-foreground",children:"Failed to load work entries. Please try again later."})})})]}):(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Work Entries"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Track and manage field work progress across all projects"})]}),(0,b.jsxs)(p.Button,{onClick:()=>a.push("/dashboard/work-entries/new"),children:[(0,b.jsx)(e.Plus,{className:"mr-2 h-4 w-4"}),"New Work Entry"]})]}),(0,b.jsxs)(w.Tabs,{defaultValue:"all",className:"space-y-4",children:[(0,b.jsxs)(w.TabsList,{children:[(0,b.jsx)(w.TabsTrigger,{value:"all",children:"All Work Entries"}),A&&(0,b.jsxs)(w.TabsTrigger,{value:"pending",children:["Pending Approval (",O.length,")"]}),(0,b.jsx)(w.TabsTrigger,{value:"my-work",children:"My Work"})]}),(0,b.jsxs)(w.TabsContent,{value:"all",className:"space-y-6",children:[(0,b.jsxs)(r.Card,{children:[(0,b.jsxs)(r.CardHeader,{children:[(0,b.jsx)(r.CardTitle,{children:"Filter Work Entries"}),(0,b.jsx)(r.CardDescription,{children:"Search and filter work entries by various criteria"})]}),(0,b.jsx)(r.CardContent,{children:(0,b.jsxs)("div",{className:"flex flex-col space-y-4 md:flex-row md:space-y-0 md:space-x-4",children:[(0,b.jsx)("div",{className:"flex-1",children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(f.Search,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(q.Input,{placeholder:"Search by project, notes, or worker...",value:D,onChange:a=>E(a.target.value),className:"pl-8"})]})}),(0,b.jsxs)(v.Select,{value:F,onValueChange:a=>G(a),children:[(0,b.jsx)(v.SelectTrigger,{className:"w-48",children:(0,b.jsx)(v.SelectValue,{placeholder:"Filter by stage"})}),(0,b.jsxs)(v.SelectContent,{children:[(0,b.jsx)(v.SelectItem,{value:"all",children:"All Stages"}),(0,b.jsx)(v.SelectItem,{value:"stage_1_marking",children:"Marking"}),(0,b.jsx)(v.SelectItem,{value:"stage_2_excavation",children:"Excavation"}),(0,b.jsx)(v.SelectItem,{value:"stage_3_conduit",children:"Conduit Installation"}),(0,b.jsx)(v.SelectItem,{value:"stage_4_cable_pulling",children:"Cable Pulling"}),(0,b.jsx)(v.SelectItem,{value:"stage_5_closure",children:"Closure"}),(0,b.jsx)(v.SelectItem,{value:"stage_6_testing",children:"Testing"}),(0,b.jsx)(v.SelectItem,{value:"stage_7_backfill",children:"Backfilling"}),(0,b.jsx)(v.SelectItem,{value:"stage_8_restoration",children:"Surface Restoration"}),(0,b.jsx)(v.SelectItem,{value:"stage_9_documentation",children:"Documentation"}),(0,b.jsx)(v.SelectItem,{value:"stage_10_quality_check",children:"Quality Check"})]})]}),(0,b.jsxs)(v.Select,{value:H,onValueChange:a=>I(a),children:[(0,b.jsx)(v.SelectTrigger,{className:"w-48",children:(0,b.jsx)(v.SelectValue,{placeholder:"Filter by approval"})}),(0,b.jsxs)(v.SelectContent,{children:[(0,b.jsx)(v.SelectItem,{value:"all",children:"All Status"}),(0,b.jsx)(v.SelectItem,{value:"approved",children:"Approved"}),(0,b.jsx)(v.SelectItem,{value:"pending",children:"Pending Approval"})]})]})]})})]}),(0,b.jsxs)(r.Card,{children:[(0,b.jsx)(r.CardHeader,{children:(0,b.jsxs)(r.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(m.Building2,{className:"h-5 w-5"}),"Work Entries (",J?.total||0,")"]})}),(0,b.jsx)(r.CardContent,{children:K?(0,b.jsx)("div",{className:"space-y-4",children:[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsxs)("div",{className:"flex space-x-4",children:[(0,b.jsx)("div",{className:"h-4 bg-muted animate-pulse rounded flex-1"}),(0,b.jsx)("div",{className:"h-4 bg-muted animate-pulse rounded w-20"}),(0,b.jsx)("div",{className:"h-4 bg-muted animate-pulse rounded w-16"})]},c))}):0===N.length?(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)(m.Building2,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,b.jsx)("h3",{className:"mt-2 text-sm font-semibold",children:"No work entries found"}),(0,b.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:D||"all"!==F||"all"!==H?"No work entries match your current filters.":"Get started by creating your first work entry."}),(0,b.jsxs)(p.Button,{className:"mt-4",onClick:()=>a.push("/dashboard/work-entries/new"),children:[(0,b.jsx)(e.Plus,{className:"mr-2 h-4 w-4"}),"Create Work Entry"]})]}):(0,b.jsxs)(t.Table,{children:[(0,b.jsx)(t.TableHeader,{children:(0,b.jsxs)(t.TableRow,{children:[(0,b.jsx)(t.TableHead,{children:"Date & Worker"}),(0,b.jsx)(t.TableHead,{children:"Stage & Progress"}),(0,b.jsx)(t.TableHead,{children:"Project"}),(0,b.jsx)(t.TableHead,{children:"Location"}),(0,b.jsx)(t.TableHead,{children:"Status"}),(0,b.jsx)(t.TableHead,{children:"Photos"}),(0,b.jsx)(t.TableHead,{className:"w-[100px]",children:"Actions"})]})}),(0,b.jsx)(t.TableBody,{children:N.map(c=>{var d;return(0,b.jsxs)(t.TableRow,{children:[(0,b.jsx)(t.TableCell,{children:(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium",children:new Date(c.date).toLocaleDateString()}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground flex items-center space-x-1",children:[(0,b.jsx)(i.User,{className:"h-3 w-3"}),(0,b.jsx)("span",{children:c.user?.full_name||"Unknown"})]})]})}),(0,b.jsx)(t.TableCell,{children:(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)(s.Badge,{variant:!(d=c.stage_code)||d.includes("marking")||d.includes("excavation")?"secondary":d.includes("cable")||d.includes("conduit")?"default":d.includes("testing")||d.includes("quality")?"outline":"secondary",children:Q(c.stage_code)}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground flex items-center space-x-1",children:[(0,b.jsx)(o.Ruler,{className:"h-3 w-3"}),(0,b.jsxs)("span",{children:[c.meters_done_m,"m"]})]})]})}),(0,b.jsx)(t.TableCell,{children:(0,b.jsxs)("div",{className:"text-sm",children:["Project ",c.project_id]})}),(0,b.jsx)(t.TableCell,{children:(0,b.jsxs)("div",{className:"text-sm flex items-center space-x-1",children:[(0,b.jsx)(h.MapPin,{className:"h-3 w-3 text-muted-foreground"}),(0,b.jsx)("span",{children:c.cut_id?`Cut ${c.cut_id}`:c.cabinet_id?`Cabinet ${c.cabinet_id}`:"â€”"})]})}),(0,b.jsx)(t.TableCell,{children:c.approved_at?(0,b.jsxs)("div",{className:"flex items-center space-x-1 text-green-600",children:[(0,b.jsx)(k.CheckCircle,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"text-sm",children:"Approved"})]}):(0,b.jsxs)("div",{className:"flex items-center space-x-1 text-amber-600",children:[(0,b.jsx)(l.Clock,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"text-sm",children:"Pending"})]})}),(0,b.jsx)(t.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,b.jsx)(n.Camera,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsx)("span",{className:"text-sm",children:c.photos?.length||0})]})}),(0,b.jsx)(t.TableCell,{children:(0,b.jsxs)(u.DropdownMenu,{children:[(0,b.jsx)(u.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)(p.Button,{variant:"ghost",className:"h-8 w-8 p-0",children:[(0,b.jsx)("span",{className:"sr-only",children:"Open menu"}),(0,b.jsx)(g.Filter,{className:"h-4 w-4"})]})}),(0,b.jsxs)(u.DropdownMenuContent,{align:"end",children:[(0,b.jsx)(u.DropdownMenuLabel,{children:"Actions"}),(0,b.jsxs)(u.DropdownMenuItem,{onClick:()=>a.push(`/dashboard/work-entries/${c.id}`),children:[(0,b.jsx)(j.Eye,{className:"mr-2 h-4 w-4"}),"View Details"]}),A&&!c.approved_at&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(u.DropdownMenuSeparator,{}),(0,b.jsxs)(u.DropdownMenuItem,{onClick:()=>P(c.id),disabled:C.isPending,children:[(0,b.jsx)(k.CheckCircle,{className:"mr-2 h-4 w-4"}),"Approve Entry"]})]})]})]})})]},c.id)})})]})})]})]}),A&&(0,b.jsx)(w.TabsContent,{value:"pending",className:"space-y-6",children:(0,b.jsxs)(r.Card,{children:[(0,b.jsxs)(r.CardHeader,{children:[(0,b.jsxs)(r.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(l.Clock,{className:"h-5 w-5"}),"Pending Approvals (",O.length,")"]}),(0,b.jsx)(r.CardDescription,{children:"Work entries waiting for your approval"})]}),(0,b.jsx)(r.CardContent,{children:0===O.length?(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)(k.CheckCircle,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,b.jsx)("h3",{className:"mt-2 text-sm font-semibold",children:"No pending approvals"}),(0,b.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"All work entries have been approved."})]}):(0,b.jsx)("div",{className:"space-y-4",children:O.map(c=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsxs)("div",{className:"font-medium",children:[Q(c.stage_code)," - ",c.meters_done_m,"m"]}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:[c.user?.full_name," â€¢ ",new Date(c.date).toLocaleDateString()]})]}),(0,b.jsxs)("div",{className:"flex space-x-2",children:[(0,b.jsxs)(p.Button,{variant:"outline",size:"sm",onClick:()=>a.push(`/dashboard/work-entries/${c.id}`),children:[(0,b.jsx)(j.Eye,{className:"mr-2 h-4 w-4"}),"View"]}),(0,b.jsxs)(p.Button,{size:"sm",onClick:()=>P(c.id),disabled:C.isPending,children:[(0,b.jsx)(k.CheckCircle,{className:"mr-2 h-4 w-4"}),"Approve"]})]})]},c.id))})})]})}),(0,b.jsx)(w.TabsContent,{value:"my-work",className:"space-y-6",children:(0,b.jsxs)(r.Card,{children:[(0,b.jsxs)(r.CardHeader,{children:[(0,b.jsx)(r.CardTitle,{children:"My Work Entries"}),(0,b.jsx)(r.CardDescription,{children:"Work entries you have created"})]}),(0,b.jsx)(r.CardContent,{children:(0,b.jsx)("div",{className:"text-center py-8 text-muted-foreground",children:"My work entries view will be implemented based on current user context."})})]})})]})]})}}];

//# sourceMappingURL=src_app_%28dashboard%29_dashboard_work-entries_page_tsx_5c2c5b3b._.js.map