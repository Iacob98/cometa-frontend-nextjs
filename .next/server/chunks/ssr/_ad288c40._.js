module.exports=[210,a=>{"use strict";a.s(["ArrowLeft",()=>b],210);let b=(0,a.i(70106).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},86456,a=>{"use strict";a.s(["useCreateProject",()=>j,"useDeleteProject",()=>l,"useProject",()=>i,"useProjectStats",()=>m,"useProjects",()=>h,"useUpdateProject",()=>k]);var b=a.i(33217),c=a.i(70025),d=a.i(37927),e=a.i(23292),f=a.i(91938);let g={all:["projects"],lists:()=>[...g.all,"list"],list:a=>[...g.lists(),a],details:()=>[...g.all,"detail"],detail:a=>[...g.details(),a]};function h(a){return(0,b.useQuery)({queryKey:g.list(a||{}),queryFn:()=>f.projectsApi.getProjects(a),staleTime:3e5})}function i(a){return(0,b.useQuery)({queryKey:g.detail(a),queryFn:()=>f.projectsApi.getProject(a),enabled:!!a,staleTime:3e5})}function j(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:a=>f.projectsApi.createProject(a),onSuccess:b=>{a.invalidateQueries({queryKey:g.lists()}),a.setQueryData(g.detail(b.id),b),e.toast.success("Project created successfully")},onError:a=>{e.toast.error(`Failed to create project: ${a.message}`)}})}function k(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:({id:a,data:b})=>f.projectsApi.updateProject(a,b),onMutate:async({id:b,data:c})=>{await a.cancelQueries({queryKey:g.detail(b)});let d=a.getQueryData(g.detail(b));return a.setQueryData(g.detail(b),a=>a?{...a,...c}:a),{previousProject:d}},onError:(b,{id:c},d)=>{d?.previousProject&&a.setQueryData(g.detail(c),d.previousProject),e.toast.error(`Failed to update project: ${b.message}`)},onSuccess:b=>{a.invalidateQueries({queryKey:g.lists()}),e.toast.success("Project updated successfully")},onSettled:(b,c,{id:d})=>{a.invalidateQueries({queryKey:g.detail(d)})}})}function l(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:a=>f.projectsApi.deleteProject(a),onSuccess:(b,c)=>{a.removeQueries({queryKey:g.detail(c)}),a.invalidateQueries({queryKey:g.lists()}),e.toast.success("Project deleted successfully")},onError:a=>{e.toast.error(`Failed to delete project: ${a.message}`)}})}function m(a){return(0,b.useQuery)({queryKey:[...g.detail(a),"stats"],queryFn:async()=>{let b=await fetch(`/api/projects/${a}/stats`);if(!b.ok)throw Error("Failed to fetch project statistics");return b.json()},staleTime:12e4,enabled:!!a})}},29246,a=>{"use strict";a.s(["Textarea",()=>e]);var b=a.i(87924),c=a.i(72131),d=a.i(68114);let e=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("textarea",{className:(0,d.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:e,...c}));e.displayName="Textarea"},24669,a=>{"use strict";a.s(["TrendingUp",()=>b],24669);let b=(0,a.i(70106).default)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]])},41710,a=>{"use strict";a.s(["Clock",()=>b],41710);let b=(0,a.i(70106).default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},24987,a=>{"use strict";a.s(["MapPin",()=>b],24987);let b=(0,a.i(70106).default)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},7671,a=>{"use strict";a.s(["invalidateAllMaterialQueries",()=>k,"useAdjustStock",()=>t,"useAssignMaterialToProject",()=>w,"useCreateMaterial",()=>q,"useDeleteMaterial",()=>s,"useDeleteMaterialAssignment",()=>y,"useLowStockMaterials",()=>n,"useMaterial",()=>m,"useMaterials",()=>l,"useOrders",()=>v,"useSuppliers",()=>u,"useUnifiedProjectMaterials",()=>p,"useUnifiedWarehouseMaterials",()=>o,"useUpdateMaterial",()=>r,"useUpdateMaterialAssignment",()=>x]);var b=a.i(33217),c=a.i(70025),d=a.i(37927),e=a.i(23292),f=a.i(91938);let g={all:["materials"],lists:()=>[...g.all,"list"],list:a=>[...g.lists(),a],details:()=>[...g.all,"detail"],detail:a=>[...g.details(),a],lowStock:()=>[...g.all,"low-stock"]},h={all:["suppliers"],lists:()=>[...h.all,"list"],details:()=>[...h.all,"detail"],detail:a=>[...h.details(),a]},i={all:["allocations"],lists:()=>[...i.all,"list"],list:a=>[...i.lists(),a],details:()=>[...i.all,"detail"],detail:a=>[...i.details(),a]},j={all:["orders"],lists:()=>[...j.all,"list"],list:a=>[...j.lists(),a],details:()=>[...j.all,"detail"],detail:a=>[...j.details(),a]};function k(a){a.invalidateQueries({queryKey:g.all}),a.invalidateQueries({queryKey:i.all}),a.invalidateQueries({queryKey:j.all}),a.invalidateQueries({queryKey:[...g.all,"unified-warehouse"]}),a.invalidateQueries({queryKey:[...g.all,"allocation-targets"]}),a.refetchQueries({queryKey:[...g.all,"unified-warehouse"],type:"active"})}function l(a){return(0,b.useQuery)({queryKey:g.list(a||{}),queryFn:()=>f.materialsApi.getMaterials(a),staleTime:12e4})}function m(a){return(0,b.useQuery)({queryKey:g.detail(a),queryFn:()=>f.materialsApi.getMaterial(a),enabled:!!a,staleTime:3e5})}function n(){return(0,b.useQuery)({queryKey:g.lowStock(),queryFn:async()=>{let a=await fetch("/api/materials/low-stock");if(!a.ok)throw Error("Failed to fetch low stock materials");return(await a.json()).materials||[]},staleTime:12e4})}function o(){return(0,b.useQuery)({queryKey:[...g.all,"unified-warehouse"],queryFn:async()=>{let a=await fetch("/api/materials/unified?view=warehouse");if(!a.ok)throw Error("Failed to fetch warehouse materials");return(await a.json()).materials||[]},staleTime:3e4,gcTime:3e5,refetchOnWindowFocus:!0,refetchInterval:6e4})}function p(a){return(0,b.useQuery)({queryKey:[...i.all,"project",a,"unified"],queryFn:async()=>{let b=await fetch(`/api/materials/unified?view=project_allocations&project_id=${a}`);if(!b.ok)throw Error("Failed to fetch project materials");let c=await b.json();return{materials:c.materials||[],summary:c.allocation_summary}},enabled:!!a,staleTime:6e4,gcTime:3e5})}function q(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:a=>f.materialsApi.createMaterial(a),onSuccess:b=>{a.invalidateQueries({queryKey:g.lists()}),a.setQueryData(g.detail(b.id),b),e.toast.success("Material created successfully")},onError:a=>{e.toast.error(`Failed to create material: ${a.message}`)}})}function r(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:({id:a,data:b})=>f.materialsApi.updateMaterial(a,b),onMutate:async({id:b,data:c})=>{await a.cancelQueries({queryKey:g.detail(b)});let d=a.getQueryData(g.detail(b));return a.setQueryData(g.detail(b),a=>a?{...a,...c}:a),{previousMaterial:d}},onError:(b,{id:c},d)=>{d?.previousMaterial&&a.setQueryData(g.detail(c),d.previousMaterial),e.toast.error(`Failed to update material: ${b.message}`)},onSuccess:()=>{a.invalidateQueries({queryKey:g.lists()}),a.invalidateQueries({queryKey:g.lowStock()}),e.toast.success("Material updated successfully")},onSettled:(b,c,{id:d})=>{a.invalidateQueries({queryKey:g.detail(d)})}})}function s(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:a=>f.materialsApi.deleteMaterial(a),onSuccess:(b,c)=>{a.removeQueries({queryKey:g.detail(c)}),a.invalidateQueries({queryKey:g.lists()}),a.invalidateQueries({queryKey:g.lowStock()}),e.toast.success("Material deleted successfully")},onError:a=>{e.toast.error(`Failed to delete material: ${a.message}`)}})}function t(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:({id:a,adjustment:b})=>f.materialsApi.adjustStock(a,b),onSuccess:b=>{a.setQueryData(g.detail(b.id),b),a.invalidateQueries({queryKey:g.lists()}),a.invalidateQueries({queryKey:g.lowStock()}),a.invalidateQueries({queryKey:[...g.all,"unified-warehouse"]}),a.invalidateQueries({queryKey:[...g.all,"allocation-targets"]}),e.toast.success("Stock adjusted successfully")},onError:a=>{e.toast.error(`Failed to adjust stock: ${a.message}`)}})}function u(){return(0,b.useQuery)({queryKey:h.lists(),queryFn:()=>f.suppliersApi.getSuppliers(),staleTime:6e5})}function v(a){return(0,b.useQuery)({queryKey:j.list(a||{}),queryFn:()=>f.materialOrdersApi.getOrders(a),staleTime:18e4})}function w(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:async a=>{let b=await fetch("/api/materials/assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!b.ok)throw Error((await b.json()).message||"Failed to assign material");return b.json()},onSuccess:(b,c)=>{a.invalidateQueries({queryKey:[...g.all,"project",c.project_id]}),a.invalidateQueries({queryKey:[...i.all,"project",c.project_id,"unified"]}),a.invalidateQueries({queryKey:[...g.all,"warehouse"]}),a.invalidateQueries({queryKey:[...g.all,"unified-warehouse"]}),a.invalidateQueries({queryKey:[...g.all,"allocation-targets"]}),a.refetchQueries({queryKey:[...i.all,"project",c.project_id,"unified"]}),a.refetchQueries({queryKey:[...g.all,"unified-warehouse"]}),e.toast.success("Material assigned successfully")},onError:a=>{e.toast.error(`Failed to assign material: ${a.message}`)}})}function x(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:async a=>{let{assignment_id:b,...c}=a,d=await fetch(`/api/materials/assignments/${b}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!d.ok)throw Error((await d.json()).message||"Failed to update material assignment");return d.json()},onSuccess:(b,c)=>{a.invalidateQueries({predicate:a=>"materials"===a.queryKey[0]&&"project"===a.queryKey[1]}),a.invalidateQueries({predicate:a=>a.queryKey.includes("unified")}),a.invalidateQueries({queryKey:[...g.all,"warehouse"]}),a.invalidateQueries({queryKey:[...g.all,"unified-warehouse"]}),a.invalidateQueries({queryKey:[...g.all,"allocation-targets"]}),e.toast.success("Material assignment updated successfully")},onError:a=>{e.toast.error(`Failed to update material assignment: ${a.message}`)}})}function y(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:async a=>{let b=await fetch(`/api/materials/assignments/${a}`,{method:"DELETE"});if(!b.ok)throw Error((await b.json()).message||"Failed to delete material assignment");return b.json()},onSuccess:(b,c)=>{a.invalidateQueries({predicate:a=>"materials"===a.queryKey[0]&&"project"===a.queryKey[1]}),a.invalidateQueries({predicate:a=>a.queryKey.includes("unified")}),a.invalidateQueries({queryKey:[...g.all,"warehouse"]}),a.invalidateQueries({queryKey:[...g.all,"unified-warehouse"]}),a.invalidateQueries({queryKey:[...g.all,"allocation-targets"]}),e.toast.success("Material assignment deleted successfully")},onError:a=>{e.toast.error(`Failed to delete material assignment: ${a.message}`)}})}},33140,a=>{"use strict";a.s(["Skeleton",()=>d]);var b=a.i(87924),c=a.i(68114);function d({className:a,...d}){return(0,b.jsx)("div",{className:(0,c.cn)("animate-pulse rounded-md bg-muted",a),...d})}},15618,a=>{"use strict";a.s(["Plus",()=>b],15618);let b=(0,a.i(70106).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},6015,a=>{"use strict";a.s(["Table",()=>e,"TableBody",()=>g,"TableCell",()=>j,"TableHead",()=>i,"TableHeader",()=>f,"TableRow",()=>h]);var b=a.i(87924),c=a.i(72131),d=a.i(68114);let e=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("div",{className:"relative w-full overflow-auto",children:(0,b.jsx)("table",{ref:e,className:(0,d.cn)("w-full caption-bottom text-sm",a),...c})}));e.displayName="Table";let f=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("thead",{ref:e,className:(0,d.cn)("[&_tr]:border-b",a),...c}));f.displayName="TableHeader";let g=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("tbody",{ref:e,className:(0,d.cn)("[&_tr:last-child]:border-0",a),...c}));g.displayName="TableBody",c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("tfoot",{ref:e,className:(0,d.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...c})).displayName="TableFooter";let h=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("tr",{ref:e,className:(0,d.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...c}));h.displayName="TableRow";let i=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("th",{ref:e,className:(0,d.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",a),...c}));i.displayName="TableHead";let j=c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("td",{ref:e,className:(0,d.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...c}));j.displayName="TableCell",c.forwardRef(({className:a,...c},e)=>(0,b.jsx)("caption",{ref:e,className:(0,d.cn)("mt-4 text-sm text-muted-foreground",a),...c})).displayName="TableCaption"},24569,a=>{"use strict";a.s(["Edit",()=>b],24569);let b=(0,a.i(70106).default)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},81560,a=>{"use strict";a.s(["Trash2",()=>b],81560);let b=(0,a.i(70106).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])},77156,a=>{"use strict";a.s(["Eye",()=>b],77156);let b=(0,a.i(70106).default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},95669,87653,a=>{"use strict";a.s(["useCreateMaterialOrderWithBudget",()=>p,"useDeleteMaterialOrder",()=>r,"useMaterialOrder",()=>o,"useMaterialOrders",()=>n,"useUpdateMaterialOrder",()=>q],95669);var b=a.i(33217),c=a.i(70025),d=a.i(37927),e=a.i(23292);function f(a){return(0,b.useQuery)({queryKey:["material-order-budget",a],queryFn:async()=>{let b=await fetch(`/api/materials/orders/${a}/budget`);if(!b.ok)throw Error("Failed to fetch budget impact");return b.json()},enabled:!!a})}function g(){let a=function(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:async({orderId:a,data:b})=>{let c=await fetch(`/api/materials/orders/${a}/budget`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)});if(!c.ok)throw Error((await c.json()).error||"Failed to create budget transaction");return c.json()},onSuccess:(b,c)=>{a.invalidateQueries({queryKey:["material-order-budget",c.orderId]}),a.invalidateQueries({queryKey:["material-orders"]}),a.invalidateQueries({queryKey:["financial-summary"]}),a.invalidateQueries({queryKey:["project",b.project_id]}),e.toast.success(`Budget transaction created: €${b.amount_deducted.toFixed(2)} deducted`)},onError:a=>{e.toast.error(a.message||"Failed to create budget transaction")}})}();return{deductFromBudget:async(b,c=!0)=>{if(!c)return null;try{return await a.mutateAsync({orderId:b,data:{deduct_from_budget:!0}})}catch(a){return console.error("Auto budget deduction failed:",a),null}},isLoading:a.isPending,error:a.error}}a.s(["useAutoBudgetDeduction",()=>g,"useMaterialOrderBudgetImpact",()=>f],87653);let h={all:["material-orders"],lists:()=>[...h.all,"list"],list:a=>[...h.lists(),a],details:()=>[...h.all,"detail"],detail:a=>[...h.details(),a]};async function i(a){let b=new URLSearchParams;a?.project_id&&b.set("project_id",a.project_id),a?.supplier_id&&b.set("supplier_id",a.supplier_id),a?.status&&b.set("status",a.status),a?.page&&b.set("page",a.page.toString()),a?.per_page&&b.set("per_page",a.per_page.toString());let c=await fetch(`/api/materials/orders?${b.toString()}`);if(!c.ok)throw Error("Failed to fetch material orders");return c.json()}async function j(a){let b=await fetch(`/api/materials/orders/${a}`);if(!b.ok)throw Error("Failed to fetch material order");return b.json()}async function k(a){let b=await fetch("/api/materials/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!b.ok)throw Error((await b.json()).error||"Failed to create material order");return b.json()}async function l(a,b){let c=await fetch(`/api/materials/orders/${a}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)});if(!c.ok)throw Error((await c.json()).error||"Failed to update material order");return c.json()}async function m(a){let b=await fetch(`/api/materials/orders/${a}`,{method:"DELETE"});if(!b.ok)throw Error((await b.json()).error||"Failed to delete material order")}function n(a){return(0,b.useQuery)({queryKey:h.list(a||{}),queryFn:()=>i(a),staleTime:3e5})}function o(a){return(0,b.useQuery)({queryKey:h.detail(a),queryFn:()=>j(a),enabled:!!a,staleTime:3e5})}function p(){let a=function(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:k,onSuccess:b=>{a.invalidateQueries({queryKey:h.lists()}),a.setQueryData(h.detail(b.id),b),e.toast.success("Material order created successfully")},onError:a=>{e.toast.error(`Failed to create order: ${a.message}`)}})}(),{deductFromBudget:b}=g();return(0,c.useMutation)({mutationFn:async c=>{let{deduct_from_budget:d=!0,...f}=c,g=await a.mutateAsync(f);if(d&&g.project_id)try{await b(g.id,!0)}catch(a){console.warn("Budget deduction failed, but order was created:",a),e.toast.warning("Order created but budget deduction failed. Please manage manually.")}return g},onSuccess:a=>{e.toast.success(`Order created and €${a.total_cost_eur.toFixed(2)} deducted from project budget`)},onError:a=>{e.toast.error(`Failed to create order: ${a.message}`)}})}function q(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:({id:a,data:b})=>l(a,b),onSuccess:b=>{a.setQueryData(h.detail(b.id),b),a.invalidateQueries({queryKey:h.lists()}),e.toast.success("Order updated successfully")},onError:a=>{e.toast.error(`Failed to update order: ${a.message}`)}})}function r(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:m,onSuccess:(b,c)=>{a.removeQueries({queryKey:h.detail(c)}),a.invalidateQueries({queryKey:h.lists()}),e.toast.success("Order deleted successfully")},onError:a=>{e.toast.error(`Failed to delete order: ${a.message}`)}})}},44494,a=>{"use strict";a.s(["Globe",()=>b],44494);let b=(0,a.i(70106).default)("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]])},17755,a=>{"use strict";a.s(["MoreHorizontal",()=>b],17755);let b=(0,a.i(70106).default)("ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]])},3544,a=>{"use strict";a.s(["Ruler",()=>b],3544);let b=(0,a.i(70106).default)("ruler",[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]])},13513,a=>{"use strict";a.s(["Camera",()=>b],13513);let b=(0,a.i(70106).default)("camera",[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]])},44750,a=>{"use strict";a.s(["useCreateCrew",()=>j,"useCreateTeam",()=>o,"useCrew",()=>i,"useDeleteCrew",()=>l,"useForemenUsers",()=>n,"useGlobalTeams",()=>m,"useProjectTeams",()=>p,"useTeams",()=>h,"useUpdateCrew",()=>k,"useUpdateTeam",()=>q]);var b=a.i(33217),c=a.i(70025),d=a.i(37927),e=a.i(23292),f=a.i(91938);let g={all:["teams"],crews:()=>[...g.all,"crews"],crew:a=>[...g.all,"crew",a]};function h(){return(0,b.useQuery)({queryKey:g.crews(),queryFn:async()=>{let a=await fetch("/api/crews");if(!a.ok)throw Error("Failed to fetch crews");return(await a.json()).crews||[]},staleTime:3e4})}function i(a){return(0,b.useQuery)({queryKey:g.crew(a),queryFn:()=>f.teamsApi.getCrew(a),enabled:!!a,staleTime:3e5})}function j(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:a=>f.teamsApi.createCrew(a),onSuccess:b=>{a.invalidateQueries({queryKey:g.crews()}),a.setQueryData(g.crew(b.id),b),e.toast.success("Team created successfully")},onError:a=>{e.toast.error(`Failed to create team: ${a.message}`)}})}function k(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:({id:a,data:b})=>f.teamsApi.updateCrew(a,b),onMutate:async({id:b,data:c})=>{await a.cancelQueries({queryKey:g.crew(b)});let d=a.getQueryData(g.crew(b));return a.setQueryData(g.crew(b),a=>a?{...a,...c}:a),{previousCrew:d}},onError:(b,{id:c},d)=>{d?.previousCrew&&a.setQueryData(g.crew(c),d.previousCrew),e.toast.error(`Failed to update team: ${b.message}`)},onSuccess:()=>{a.invalidateQueries({queryKey:g.crews()}),e.toast.success("Team updated successfully")},onSettled:(b,c,{id:d})=>{a.invalidateQueries({queryKey:g.crew(d)})}})}function l(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:a=>f.teamsApi.deleteCrew(a),onSuccess:(b,c)=>{a.removeQueries({queryKey:g.crew(c)}),a.invalidateQueries({queryKey:g.crews()}),e.toast.success("Team deleted successfully")},onError:a=>{e.toast.error(`Failed to delete team: ${a.message}`)}})}function m(){return(0,b.useQuery)({queryKey:["global-teams"],queryFn:async()=>{let a=await fetch("/api/crews");if(!a.ok)throw Error("Failed to fetch global teams");let b=(await a.json()).crews||[],c={};return b.forEach(a=>{a.project_id&&(c[a.name]=(c[a.name]||0)+1)}),b.map(a=>({id:a.id,name:a.name,foreman_name:a.foreman?.full_name||a.foreman_name,is_active:"active"===a.status,project_count:c[a.name]||0,specialization:"mixed"}))}})}function n(){return(0,b.useQuery)({queryKey:["foremen-users"],queryFn:async()=>{let a=await fetch("/api/users?role=foreman&is_active=true");if(!a.ok){let a=await fetch("/api/users?role=pm&is_active=true");if(!a.ok)throw Error("Failed to fetch users");return(await a.json()).items||[]}let b=await a.json();if(0===b.items.length){let a=await fetch("/api/users?is_active=true");if(!a.ok)throw Error("Failed to fetch users");return((await a.json()).items||[]).filter(a=>"foreman"===a.role||"pm"===a.role)}return b.items||[]}})}function o(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:async a=>{let b=await fetch("/api/crews",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!b.ok)throw Error((await b.json()).error||"Failed to create team");return b.json()},onSuccess:(b,c)=>{c.project_id&&(a.invalidateQueries({queryKey:["project-teams",c.project_id]}),a.invalidateQueries({queryKey:["project-preparation",c.project_id]})),a.invalidateQueries({queryKey:["global-teams"]}),a.invalidateQueries({queryKey:g.crews()}),e.toast.success(b.message||"Team created successfully")},onError:a=>{e.toast.error(a.message)}})}function p(a){return(0,b.useQuery)({queryKey:["project-teams",a],queryFn:async()=>{let b=await fetch(`/api/crews?project_id=${a}`);if(!b.ok)throw Error("Failed to fetch project teams");return(await b.json()).crews||[]},enabled:!!a})}function q(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:async({id:a,data:b})=>{let c=await fetch(`/api/crews/${a}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)});if(!c.ok)throw Error((await c.json()).error||"Failed to update team");return c.json()},onSuccess:(b,c)=>{a.invalidateQueries({queryKey:["project-teams"]}),a.invalidateQueries({queryKey:["global-teams"]}),a.invalidateQueries({queryKey:g.crews()}),a.invalidateQueries({queryKey:["project-preparation"]}),e.toast.success(b.message||"Team updated successfully")},onError:a=>{e.toast.error(a.message)}})}},63519,a=>{"use strict";a.s(["Phone",()=>b],63519);let b=(0,a.i(70106).default)("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]])},92258,a=>{"use strict";a.s(["Mail",()=>b],92258);let b=(0,a.i(70106).default)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]])},84505,a=>{"use strict";a.s(["Download",()=>b],84505);let b=(0,a.i(70106).default)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]])},73320,a=>{"use strict";a.s(["Upload",()=>b],73320);let b=(0,a.i(70106).default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]])},73390,a=>{"use strict";a.s(["Progress",()=>t],73390);var b=a.i(87924),c=a.i(72131),d=a.i(50104),e=a.i(30553),f="Progress",[g,h]=(0,d.createContextScope)(f),[i,j]=g(f),k=c.forwardRef((a,c)=>{var d,f;let{__scopeProgress:g,value:h=null,max:j,getValueLabel:k=n,...l}=a;(j||0===j)&&!q(j)&&console.error((d=`${j}`,`Invalid prop \`max\` of value \`${d}\` supplied to \`Progress\`. Only numbers greater than 0 are valid max values. Defaulting to \`100\`.`));let m=q(j)?j:100;null===h||r(h,m)||console.error((f=`${h}`,`Invalid prop \`value\` of value \`${f}\` supplied to \`Progress\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or 100 if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`));let s=r(h,m)?h:null,t=p(s)?k(s,m):void 0;return(0,b.jsx)(i,{scope:g,value:s,max:m,children:(0,b.jsx)(e.Primitive.div,{"aria-valuemax":m,"aria-valuemin":0,"aria-valuenow":p(s)?s:void 0,"aria-valuetext":t,role:"progressbar","data-state":o(s,m),"data-value":s??void 0,"data-max":m,...l,ref:c})})});k.displayName=f;var l="ProgressIndicator",m=c.forwardRef((a,c)=>{let{__scopeProgress:d,...f}=a,g=j(l,d);return(0,b.jsx)(e.Primitive.div,{"data-state":o(g.value,g.max),"data-value":g.value??void 0,"data-max":g.max,...f,ref:c})});function n(a,b){return`${Math.round(a/b*100)}%`}function o(a,b){return null==a?"indeterminate":a===b?"complete":"loading"}function p(a){return"number"==typeof a}function q(a){return p(a)&&!isNaN(a)&&a>0}function r(a,b){return p(a)&&!isNaN(a)&&a<=b&&a>=0}m.displayName=l;var s=a.i(68114);let t=c.forwardRef(({className:a,value:c,...d},e)=>(0,b.jsx)(k,{ref:e,className:(0,s.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",a),...d,children:(0,b.jsx)(m,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(c||0)}%)`}})}));t.displayName=k.displayName},3314,a=>{"use strict";a.s(["Shield",()=>b],3314);let b=(0,a.i(70106).default)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},38784,a=>{"use strict";a.s(["ShoppingCart",()=>b],38784);let b=(0,a.i(70106).default)("shopping-cart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]])},52495,a=>{"use strict";a.s(["ExternalLink",()=>b],52495);let b=(0,a.i(70106).default)("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]])},51252,a=>{"use strict";a.s(["useCompletedConnections",()=>s,"useCreateHouse",()=>k,"useDeleteHouse",()=>m,"useHouses",()=>i,"useInProgressConnections",()=>r,"usePendingConnections",()=>p,"useProjectHouses",()=>j,"useScheduleAppointment",()=>o,"useScheduledAppointments",()=>q,"useTodaysAppointments",()=>t,"useUpdateHouse",()=>l]);var b=a.i(33217),c=a.i(70025),d=a.i(37927),e=a.i(23292),f=a.i(91938);let g={all:["houses"],lists:()=>[...g.all,"list"],list:a=>[...g.lists(),a],details:()=>[...g.all,"detail"],detail:a=>[...g.details(),a],project:a=>[...g.all,"project",a],team:a=>[...g.all,"team",a]},h={all:["appointments"],lists:()=>[...h.all,"list"],list:a=>[...h.lists(),a],details:()=>[...h.all,"detail"],detail:a=>[...h.details(),a]};function i(a){return(0,b.useQuery)({queryKey:g.list(a||{}),queryFn:()=>f.housesApi.getHouses(a),staleTime:18e4})}function j(a){return(0,b.useQuery)({queryKey:g.project(a),queryFn:()=>f.housesApi.getProjectHouses(a),enabled:!!a,staleTime:18e4})}function k(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:a=>f.housesApi.createHouse(a),onSuccess:b=>{a.invalidateQueries({queryKey:g.lists()}),a.invalidateQueries({queryKey:g.project(b.project_id)}),a.setQueryData(g.detail(b.id),b),e.toast.success("House created successfully")},onError:a=>{e.toast.error(`Failed to create house: ${a.message}`)}})}function l(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:({id:a,data:b})=>f.housesApi.updateHouse(a,b),onMutate:async({id:b,data:c})=>{await a.cancelQueries({queryKey:g.detail(b)});let d=a.getQueryData(g.detail(b));return a.setQueryData(g.detail(b),a=>a?{...a,...c}:a),{previousHouse:d}},onError:(b,{id:c},d)=>{d?.previousHouse&&a.setQueryData(g.detail(c),d.previousHouse),e.toast.error(`Failed to update house: ${b.message}`)},onSuccess:b=>{a.invalidateQueries({queryKey:g.lists()}),a.invalidateQueries({queryKey:g.project(b.project_id)}),b.assigned_team_id&&a.invalidateQueries({queryKey:g.team(b.assigned_team_id)}),e.toast.success("House updated successfully")},onSettled:(b,c,{id:d})=>{a.invalidateQueries({queryKey:g.detail(d)})}})}function m(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:a=>f.housesApi.deleteHouse(a),onSuccess:(b,c)=>{a.removeQueries({queryKey:g.detail(c)}),a.invalidateQueries({queryKey:g.lists()}),a.invalidateQueries({queryKey:g.all}),e.toast.success("House deleted successfully")},onError:a=>{e.toast.error(`Failed to delete house: ${a.message}`)}})}function n(a){return(0,b.useQuery)({queryKey:h.list(a||{}),queryFn:()=>f.appointmentsApi.getAppointments(a),staleTime:12e4})}function o(){let a=(0,d.useQueryClient)();return(0,c.useMutation)({mutationFn:a=>f.housesApi.scheduleAppointment(a),onSuccess:b=>{a.invalidateQueries({queryKey:h.lists()}),a.invalidateQueries({queryKey:g.detail(b.house_id)}),a.setQueryData(h.detail(b.id),b),e.toast.success("Appointment scheduled successfully")},onError:a=>{e.toast.error(`Failed to schedule appointment: ${a.message}`)}})}function p(){return i({status:"not_assigned",page:1,per_page:50})}function q(){return n({status:"scheduled",page:1,per_page:20})}function r(){return i({status:"in_progress",page:1,per_page:20})}function s(){return i({status:"connected",page:1,per_page:20})}function t(){let a=new Date().toISOString().split("T")[0];return n({scheduled_date_from:a,scheduled_date_to:a,page:1,per_page:50})}}];

//# sourceMappingURL=_ad288c40._.js.map