module.exports=[25354,a=>{"use strict";a.s(["default",()=>D],25354);var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(56711),f=a.i(83497),g=a.i(53277),h=a.i(73570),i=a.i(69012),j=a.i(84505),k=a.i(69520);let l=(0,a.i(70106).default)("warehouse",[["path",{d:"M18 21V10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1v11",key:"pb2vm6"}],["path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 1.132-1.803l7.95-3.974a2 2 0 0 1 1.837 0l7.948 3.974A2 2 0 0 1 22 8z",key:"doq5xv"}],["path",{d:"M6 13h12",key:"yf64js"}],["path",{d:"M6 17h12",key:"1jwigz"}]]);var m=a.i(39761),n=a.i(41710),o=a.i(99570),p=a.i(91119),q=a.i(66718),r=a.i(86304),s=a.i(6015),t=a.i(80701),u=a.i(33140),v=a.i(14574),w=a.i(41921),x=a.i(29246),y=a.i(95245),z=a.i(59501),A=a.i(56757),B=a.i(7671);let C=A.z.object({quantity:A.z.coerce.number().refine(a=>0!==a,{message:"Adjustment quantity cannot be zero"}),reason:A.z.string().min(1,"Reason is required")});function D(){let a;(0,d.useRouter)();let[A,D]=(0,c.useState)({category:"",status:"",search:""}),[E,F]=(0,c.useState)(null),[G,H]=(0,c.useState)(!1),{data:I,isLoading:J}=(0,B.useMaterials)({search:A.search,category:A.category,per_page:1e3}),K=async({id:a,data:b})=>{let c=await fetch(`/api/materials/${a}/adjust`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)});if(!c.ok)throw Error((await c.json()).error||"Failed to adjust stock");return c.json()},L=(0,y.useForm)({resolver:(0,z.zodResolver)(C),defaultValues:{quantity:0,reason:""}}),M=I?.items||[],N=(a=M,"low"===A.status?a=M.filter(a=>a.current_stock_qty-a.reserved_qty<=a.min_stock_level&&a.min_stock_level>0):"out"===A.status?a=M.filter(a=>a.current_stock_qty-a.reserved_qty<=0):"normal"===A.status&&(a=M.filter(a=>a.current_stock_qty-a.reserved_qty>a.min_stock_level||0===a.min_stock_level)),a),O=M.reduce((a,b)=>{let c=b.current_stock_qty-b.reserved_qty,d=b.current_stock_qty*b.default_price_eur;return a.totalValue+=d,a.totalItems+=1,c<=0?a.outOfStock+=1:c<=b.min_stock_level&&b.min_stock_level>0?a.lowStock+=1:a.inStock+=1,a},{totalValue:0,totalItems:0,inStock:0,lowStock:0,outOfStock:0}),P=async a=>{if(E)try{await K({id:E.id,data:{quantity:a.quantity,reason:a.reason}}),H(!1),F(null),L.reset()}catch(a){console.error("Failed to adjust stock:",a)}};return J?(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(u.Skeleton,{className:"h-8 w-64 mb-2"}),(0,b.jsx)(u.Skeleton,{className:"h-4 w-96"})]}),(0,b.jsx)(u.Skeleton,{className:"h-10 w-32"})]}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:Array.from({length:4}).map((a,c)=>(0,b.jsx)(p.Card,{children:(0,b.jsxs)(p.CardContent,{className:"p-6",children:[(0,b.jsx)(u.Skeleton,{className:"h-4 w-20 mb-2"}),(0,b.jsx)(u.Skeleton,{className:"h-8 w-16 mb-1"}),(0,b.jsx)(u.Skeleton,{className:"h-3 w-24"})]})},c))}),(0,b.jsx)(p.Card,{children:(0,b.jsx)(p.CardContent,{className:"p-6",children:(0,b.jsx)(u.Skeleton,{className:"h-64 w-full"})})})]}):(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Inventory Management"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Monitor stock levels, manage inventory, and track material movements"})]}),(0,b.jsxs)("div",{className:"flex space-x-2",children:[(0,b.jsxs)(o.Button,{variant:"outline",children:[(0,b.jsx)(j.Download,{className:"mr-2 h-4 w-4"}),"Export"]}),(0,b.jsxs)(o.Button,{variant:"outline",children:[(0,b.jsx)(k.RefreshCw,{className:"mr-2 h-4 w-4"}),"Refresh"]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,b.jsx)(p.Card,{children:(0,b.jsx)(p.CardContent,{className:"p-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Inventory Value"}),(0,b.jsxs)("p",{className:"text-2xl font-bold",children:["€",O.totalValue.toLocaleString()]}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[O.totalItems," materials"]})]}),(0,b.jsx)(m.BarChart3,{className:"h-8 w-8 text-blue-600"})]})})}),(0,b.jsx)(p.Card,{children:(0,b.jsx)(p.CardContent,{className:"p-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"In Stock"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-green-600",children:O.inStock}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Normal levels"})]}),(0,b.jsx)(f.Package,{className:"h-8 w-8 text-green-600"})]})})}),(0,b.jsx)(p.Card,{children:(0,b.jsx)(p.CardContent,{className:"p-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Low Stock"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-yellow-600",children:O.lowStock}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Needs attention"})]}),(0,b.jsx)(g.TrendingDown,{className:"h-8 w-8 text-yellow-600"})]})})}),(0,b.jsx)(p.Card,{children:(0,b.jsx)(p.CardContent,{className:"p-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Out of Stock"}),(0,b.jsx)("p",{className:"text-2xl font-bold text-red-600",children:O.outOfStock}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Immediate action needed"})]}),(0,b.jsx)(h.AlertTriangle,{className:"h-8 w-8 text-red-600"})]})})})]}),(0,b.jsxs)(p.Card,{children:[(0,b.jsx)(p.CardHeader,{children:(0,b.jsxs)(p.CardTitle,{className:"flex items-center space-x-2",children:[(0,b.jsx)(i.Filter,{className:"h-5 w-5"}),(0,b.jsx)("span",{children:"Filters"})]})}),(0,b.jsx)(p.CardContent,{children:(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Search"}),(0,b.jsx)(q.Input,{placeholder:"Search materials...",value:A.search,onChange:a=>D({...A,search:a.target.value})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Category"}),(0,b.jsxs)(t.Select,{value:A.category,onValueChange:a=>D({...A,category:"all"===a?"":a}),children:[(0,b.jsx)(t.SelectTrigger,{children:(0,b.jsx)(t.SelectValue,{placeholder:"All categories"})}),(0,b.jsxs)(t.SelectContent,{children:[(0,b.jsx)(t.SelectItem,{value:"all",children:"All categories"}),(0,b.jsx)(t.SelectItem,{value:"Cables",children:"Cables"}),(0,b.jsx)(t.SelectItem,{value:"Connectors",children:"Connectors"}),(0,b.jsx)(t.SelectItem,{value:"Tools",children:"Tools"}),(0,b.jsx)(t.SelectItem,{value:"Conduits",children:"Conduits"}),(0,b.jsx)(t.SelectItem,{value:"Equipment",children:"Equipment"}),(0,b.jsx)(t.SelectItem,{value:"Other",children:"Other"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Stock Status"}),(0,b.jsxs)(t.Select,{value:A.status,onValueChange:a=>D({...A,status:"all"===a?"":a}),children:[(0,b.jsx)(t.SelectTrigger,{children:(0,b.jsx)(t.SelectValue,{placeholder:"All status"})}),(0,b.jsxs)(t.SelectContent,{children:[(0,b.jsx)(t.SelectItem,{value:"all",children:"All status"}),(0,b.jsx)(t.SelectItem,{value:"normal",children:"In Stock"}),(0,b.jsx)(t.SelectItem,{value:"low",children:"Low Stock"}),(0,b.jsx)(t.SelectItem,{value:"out",children:"Out of Stock"})]})]})]}),(0,b.jsx)("div",{className:"flex items-end",children:(0,b.jsx)(o.Button,{variant:"outline",onClick:()=>D({category:"",status:"",search:""}),className:"w-full",children:"Clear Filters"})})]})})]}),(0,b.jsxs)(p.Card,{children:[(0,b.jsxs)(p.CardHeader,{children:[(0,b.jsx)(p.CardTitle,{children:"Inventory Overview"}),(0,b.jsxs)(p.CardDescription,{children:[N.length," material",1!==N.length?"s":""," found"]})]}),(0,b.jsx)(p.CardContent,{children:N.length>0?(0,b.jsx)("div",{className:"rounded-md border",children:(0,b.jsxs)(s.Table,{children:[(0,b.jsx)(s.TableHeader,{children:(0,b.jsxs)(s.TableRow,{children:[(0,b.jsx)(s.TableHead,{children:"Material"}),(0,b.jsx)(s.TableHead,{children:"Category"}),(0,b.jsx)(s.TableHead,{children:"Current Stock"}),(0,b.jsx)(s.TableHead,{children:"Reserved"}),(0,b.jsx)(s.TableHead,{children:"Available"}),(0,b.jsx)(s.TableHead,{children:"Min Level"}),(0,b.jsx)(s.TableHead,{children:"Status"}),(0,b.jsx)(s.TableHead,{children:"Unit Value"}),(0,b.jsx)(s.TableHead,{children:"Total Value"}),(0,b.jsx)(s.TableHead,{children:"Last Updated"}),(0,b.jsx)(s.TableHead,{className:"w-[100px]",children:"Actions"})]})}),(0,b.jsx)(s.TableBody,{children:N.map(a=>{let c=a.current_stock_qty-a.reserved_qty,d=(a=>{let b=a.current_stock_qty-a.reserved_qty;return b<=0?{status:"out",label:"Out of Stock",color:"bg-red-100 text-red-800 border-red-200"}:b<=a.min_stock_level&&a.min_stock_level>0?{status:"low",label:"Low Stock",color:"bg-yellow-100 text-yellow-800 border-yellow-200"}:{status:"normal",label:"In Stock",color:"bg-green-100 text-green-800 border-green-200"}})(a),f=a.current_stock_qty*a.default_price_eur;return(0,b.jsxs)(s.TableRow,{className:"hover:bg-muted/50",children:[(0,b.jsx)(s.TableCell,{children:(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:a.name}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.sku||"No SKU"})]})}),(0,b.jsx)(s.TableCell,{children:(0,b.jsx)(r.Badge,{variant:"outline",children:a.category})}),(0,b.jsx)(s.TableCell,{children:(0,b.jsxs)("span",{className:"font-medium",children:[a.current_stock_qty.toLocaleString()," ",a.unit]})}),(0,b.jsx)(s.TableCell,{children:(0,b.jsxs)("span",{className:"text-orange-600",children:[a.reserved_qty.toLocaleString()," ",a.unit]})}),(0,b.jsx)(s.TableCell,{children:(0,b.jsxs)("span",{className:c<=0?"text-red-600 font-medium":"text-green-600 font-medium",children:[c.toLocaleString()," ",a.unit]})}),(0,b.jsx)(s.TableCell,{children:a.min_stock_level>0?(0,b.jsxs)("span",{children:[a.min_stock_level.toLocaleString()," ",a.unit]}):(0,b.jsx)("span",{className:"text-muted-foreground",children:"Not set"})}),(0,b.jsx)(s.TableCell,{children:(0,b.jsx)(r.Badge,{className:d.color,children:d.label})}),(0,b.jsx)(s.TableCell,{children:(0,b.jsxs)("span",{children:["€",a.default_price_eur.toFixed(2)]})}),(0,b.jsx)(s.TableCell,{children:(0,b.jsxs)("span",{className:"font-medium",children:["€",f.toLocaleString()]})}),(0,b.jsx)(s.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(n.Clock,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:a.last_updated?(0,e.format)(new Date(a.last_updated),"MMM dd"):"Never"})]})}),(0,b.jsx)(s.TableCell,{children:(0,b.jsxs)(v.Dialog,{open:G&&E?.id===a.id,onOpenChange:H,children:[(0,b.jsx)(v.DialogTrigger,{asChild:!0,children:(0,b.jsx)(o.Button,{variant:"ghost",size:"sm",onClick:()=>F(a),children:"Adjust"})}),(0,b.jsxs)(v.DialogContent,{children:[(0,b.jsxs)(v.DialogHeader,{children:[(0,b.jsx)(v.DialogTitle,{children:"Adjust Stock Level"}),(0,b.jsxs)(v.DialogDescription,{children:["Adjust the stock level for ",a.name]})]}),(0,b.jsx)(w.Form,{...L,children:(0,b.jsxs)("form",{onSubmit:L.handleSubmit(P),className:"space-y-4",children:[(0,b.jsxs)("div",{className:"rounded-lg border p-4 bg-muted/50",children:[(0,b.jsx)("h4",{className:"font-medium mb-2",children:"Current Stock Information"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Total Stock:"}),(0,b.jsxs)("span",{className:"ml-2 font-medium",children:[a.current_stock_qty," ",a.unit]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Reserved:"}),(0,b.jsxs)("span",{className:"ml-2 font-medium",children:[a.reserved_qty," ",a.unit]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Available:"}),(0,b.jsxs)("span",{className:"ml-2 font-medium",children:[c," ",a.unit]})]})]})]}),(0,b.jsx)(w.FormField,{control:L.control,name:"quantity",render:({field:a})=>(0,b.jsxs)(w.FormItem,{children:[(0,b.jsx)(w.FormLabel,{children:"Adjustment Quantity"}),(0,b.jsx)(w.FormControl,{children:(0,b.jsx)(q.Input,{type:"number",step:"0.001",placeholder:"Enter positive or negative value",...a})}),(0,b.jsx)(w.FormMessage,{})]})}),(0,b.jsx)(w.FormField,{control:L.control,name:"reason",render:({field:a})=>(0,b.jsxs)(w.FormItem,{children:[(0,b.jsx)(w.FormLabel,{children:"Reason"}),(0,b.jsx)(w.FormControl,{children:(0,b.jsx)(x.Textarea,{placeholder:"Reason for stock adjustment...",rows:3,...a})}),(0,b.jsx)(w.FormMessage,{})]})}),(0,b.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,b.jsx)(o.Button,{type:"button",variant:"outline",onClick:()=>{H(!1),F(null),L.reset()},children:"Cancel"}),(0,b.jsxs)(o.Button,{type:"submit",disabled:!1,children:[null,"Adjust Stock"]})]})]})})]})]})})]},a.id)})})]})}):(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)(l,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,b.jsx)("h3",{className:"mt-4 text-lg font-semibold",children:"No materials found"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"No materials match your current filters."}),(0,b.jsx)(o.Button,{className:"mt-4",onClick:()=>D({category:"",status:"",search:""}),children:"Clear Filters"})]})})]})]})}}];

//# sourceMappingURL=src_app_%28dashboard%29_dashboard_materials_inventory_page_tsx_6a71fcb3._.js.map