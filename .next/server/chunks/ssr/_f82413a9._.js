module.exports=[210,a=>{"use strict";a.s(["ArrowLeft",()=>b],210);let b=(0,a.i(70106).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},5084,a=>{"use strict";a.s(["Separator",()=>i],5084);var b=a.i(87924),c=a.i(72131),d=a.i(30553),e="horizontal",f=["horizontal","vertical"],g=c.forwardRef((a,c)=>{var g;let{decorative:h,orientation:i=e,...j}=a,k=(g=i,f.includes(g))?i:e;return(0,b.jsx)(d.Primitive.div,{"data-orientation":k,...h?{role:"none"}:{"aria-orientation":"vertical"===k?k:void 0,role:"separator"},...j,ref:c})});g.displayName="Separator";var h=a.i(68114);let i=c.forwardRef(({className:a,orientation:c="horizontal",decorative:d=!0,...e},f)=>(0,b.jsx)(g,{ref:f,decorative:d,orientation:c,className:(0,h.cn)("shrink-0 bg-border","horizontal"===c?"h-[1px] w-full":"h-full w-[1px]",a),...e}));i.displayName=g.displayName},47349,(a,b,c)=>{"use strict";var d=a.r(72131);"function"==typeof Object.is&&Object.is,d.useState,d.useEffect,d.useLayoutEffect,d.useDebugValue,c.useSyncExternalStore=void 0!==d.useSyncExternalStore?d.useSyncExternalStore:function(a,b){return b()}},87610,(a,b,c)=>{"use strict";b.exports=a.r(47349)},72233,a=>{"use strict";a.s(["Avatar",()=>v,"AvatarFallback",()=>x,"AvatarImage",()=>w],72233);var b=a.i(87924),c=a.i(72131),d=a.i(50104),e=a.i(46872),f=a.i(72752),g=a.i(30553),h=a.i(87610);function i(){return()=>{}}var j="Avatar",[k,l]=(0,d.createContextScope)(j),[m,n]=k(j),o=c.forwardRef((a,d)=>{let{__scopeAvatar:e,...f}=a,[h,i]=c.useState("idle");return(0,b.jsx)(m,{scope:e,imageLoadingStatus:h,onImageLoadingStatusChange:i,children:(0,b.jsx)(g.Primitive.span,{...f,ref:d})})});o.displayName=j;var p="AvatarImage",q=c.forwardRef((a,d)=>{let{__scopeAvatar:j,src:k,onLoadingStatusChange:l=()=>{},...m}=a,o=n(p,j),q=function(a,{referrerPolicy:b,crossOrigin:d}){let e=(0,h.useSyncExternalStore)(i,()=>!0,()=>!1),g=c.useRef(null),j=e?(g.current||(g.current=new window.Image),g.current):null,[k,l]=c.useState(()=>t(j,a));return(0,f.useLayoutEffect)(()=>{l(t(j,a))},[j,a]),(0,f.useLayoutEffect)(()=>{let a=a=>()=>{l(a)};if(!j)return;let c=a("loaded"),e=a("error");return j.addEventListener("load",c),j.addEventListener("error",e),b&&(j.referrerPolicy=b),"string"==typeof d&&(j.crossOrigin=d),()=>{j.removeEventListener("load",c),j.removeEventListener("error",e)}},[j,d,b]),k}(k,m),r=(0,e.useCallbackRef)(a=>{l(a),o.onImageLoadingStatusChange(a)});return(0,f.useLayoutEffect)(()=>{"idle"!==q&&r(q)},[q,r]),"loaded"===q?(0,b.jsx)(g.Primitive.img,{...m,ref:d,src:k}):null});q.displayName=p;var r="AvatarFallback",s=c.forwardRef((a,d)=>{let{__scopeAvatar:e,delayMs:f,...h}=a,i=n(r,e),[j,k]=c.useState(void 0===f);return c.useEffect(()=>{if(void 0!==f){let a=window.setTimeout(()=>k(!0),f);return()=>window.clearTimeout(a)}},[f]),j&&"loaded"!==i.imageLoadingStatus?(0,b.jsx)(g.Primitive.span,{...h,ref:d}):null});function t(a,b){return a?b?(a.src!==b&&(a.src=b),a.complete&&a.naturalWidth>0?"loaded":"loading"):"error":"idle"}s.displayName=r;var u=a.i(68114);let v=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)(o,{ref:d,className:(0,u.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...c}));v.displayName=o.displayName;let w=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)(q,{ref:d,className:(0,u.cn)("aspect-square h-full w-full",a),...c}));w.displayName=q.displayName;let x=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)(s,{ref:d,className:(0,u.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...c}));x.displayName=s.displayName},17371,a=>{"use strict";a.s(["UserPlus",()=>b],17371);let b=(0,a.i(70106).default)("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]])},54614,a=>{"use strict";a.s(["useToast",()=>c]);var b=a.i(23292);function c(){return{toast:({title:a,description:c,variant:d="default",duration:e=5e3})=>{"destructive"===d?b.toast.error(a||"Error",{description:c,duration:e}):b.toast.success(a||"Success",{description:c,duration:e})}}}},18940,a=>{"use strict";a.s(["default",()=>x],18940);var b=a.i(87924),c=a.i(50944),d=a.i(72131),e=a.i(33217),f=a.i(70025),g=a.i(37927),h=a.i(210),i=a.i(60246),j=a.i(17371);let k=(0,a.i(70106).default)("user-x",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);var l=a.i(87532),m=a.i(99570),n=a.i(66718),o=a.i(91119),p=a.i(86304),q=a.i(72233),r=a.i(5084),s=a.i(54614);async function t(a){let b=await fetch(`/api/crews?team_id=${a}`);if(!b.ok)throw Error("Failed to fetch team");return((await b.json()).crews||[])[0]||null}async function u(){let a=await fetch("/api/users?page=1&per_page=100");if(!a.ok)throw Error("Failed to fetch users");return(await a.json()).items||[]}async function v(a,b,c="crew"){let d=await fetch(`/api/crews/${a}/members`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:b,role_in_crew:c})});if(!d.ok)throw Error("Failed to add member to team");return d.json()}async function w(a,b){let c=await fetch(`/api/crews/${a}/members/${b}`,{method:"DELETE"});if(!c.ok)throw Error("Failed to remove member from team");return c.json()}function x(){let a=(0,c.useRouter)(),x=(0,c.useParams)().id,{toast:y}=(0,s.useToast)(),z=(0,g.useQueryClient)(),[A,B]=(0,d.useState)(""),{data:C,isLoading:D}=(0,e.useQuery)({queryKey:["team",x],queryFn:()=>t(x),enabled:!!x}),{data:E=[],isLoading:F}=(0,e.useQuery)({queryKey:["users"],queryFn:u}),G=(0,f.useMutation)({mutationFn:({userId:a,role:b})=>v(x,a,b),onSuccess:()=>{z.invalidateQueries({queryKey:["team",x]}),z.invalidateQueries({queryKey:["teams"]}),y({title:"Member Added",description:"Member successfully added to team"})},onError:a=>{y({title:"Error",description:"Failed to add member to team",variant:"destructive"}),console.error("Add member error:",a)}}),H=(0,f.useMutation)({mutationFn:a=>w(x,a),onSuccess:()=>{z.invalidateQueries({queryKey:["team",x]}),z.invalidateQueries({queryKey:["teams"]}),y({title:"Member Removed",description:"Member removed from team"})},onError:a=>{y({title:"Error",description:"Failed to remove member from team",variant:"destructive"}),console.error("Remove member error:",a)}});if(D)return(0,b.jsx)("div",{className:"space-y-6",children:(0,b.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,b.jsx)("div",{className:"h-8 w-8 animate-pulse bg-muted rounded"}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("div",{className:"h-8 w-48 animate-pulse bg-muted rounded"}),(0,b.jsx)("div",{className:"h-4 w-64 animate-pulse bg-muted rounded"})]})]})});if(!C)return(0,b.jsx)("div",{className:"space-y-6",children:(0,b.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,b.jsxs)(m.Button,{variant:"ghost",size:"sm",onClick:()=>a.back(),children:[(0,b.jsx)(h.ArrowLeft,{className:"h-4 w-4 mr-2"}),"Назад"]}),(0,b.jsx)("div",{children:(0,b.jsx)("h1",{className:"text-3xl font-bold tracking-tight text-destructive",children:"Team Not Found"})})]})});let I=C.members.map(a=>a.user_id);C.foreman&&I.push(C.foreman.id);let J=E.filter(a=>!I.includes(a.id)).filter(a=>{if(!A)return!0;let b=A.toLowerCase();return a.full_name.toLowerCase().includes(b)||a.email?.toLowerCase().includes(b)||a.role.toLowerCase().includes(b)});return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,b.jsxs)(m.Button,{variant:"ghost",size:"sm",onClick:()=>a.push("/dashboard/teams"),className:"flex items-center space-x-2",children:[(0,b.jsx)(h.ArrowLeft,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"Back to Teams"})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("h1",{className:"text-3xl font-bold tracking-tight",children:["Team Members: ",C.name]}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Manage team members"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,b.jsxs)(o.Card,{children:[(0,b.jsxs)(o.CardHeader,{children:[(0,b.jsxs)(o.CardTitle,{className:"flex items-center space-x-2",children:[(0,b.jsx)(i.Users,{className:"h-5 w-5"}),(0,b.jsxs)("span",{children:["Current Members (",C.members.length+ +!!C.foreman,")"]})]}),(0,b.jsx)(o.CardDescription,{children:"Members of this team"})]}),(0,b.jsxs)(o.CardContent,{className:"space-y-4",children:[C.foreman&&(0,b.jsx)("div",{className:"flex items-center justify-between p-3 border rounded-lg bg-muted/50",children:(0,b.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,b.jsxs)(q.Avatar,{className:"h-10 w-10",children:[(0,b.jsx)(q.AvatarImage,{src:""}),(0,b.jsxs)(q.AvatarFallback,{children:[C.foreman.first_name?.[0],C.foreman.last_name?.[0]]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:C.foreman.full_name}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(p.Badge,{variant:"secondary",children:"Foreman"}),(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:C.foreman.email})]})]})]})}),C.members.length>0?C.members.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,b.jsxs)(q.Avatar,{className:"h-10 w-10",children:[(0,b.jsx)(q.AvatarImage,{src:""}),(0,b.jsxs)(q.AvatarFallback,{children:[a.first_name?.[0],a.last_name?.[0]]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:a.full_name}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(p.Badge,{variant:"outline",children:(a=>{if(!a)return"Member";switch(a){case"leader":case"foreman":return"Leader";case"member":case"worker":case"operator":return"Member";case"trainee":return"Trainee";default:return a.charAt(0).toUpperCase()+a.slice(1)}})(a.role_in_crew)}),(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:a.email})]})]})]}),(0,b.jsx)(m.Button,{variant:"outline",size:"sm",onClick:()=>{var b;return b=a.user_id,void H.mutate(b)},disabled:H.isPending,children:(0,b.jsx)(k,{className:"h-4 w-4"})})]},a.user_id)):(0,b.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,b.jsx)(i.Users,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),(0,b.jsx)("p",{children:"No team members"})]})]})]}),(0,b.jsxs)(o.Card,{children:[(0,b.jsxs)(o.CardHeader,{children:[(0,b.jsxs)(o.CardTitle,{className:"flex items-center space-x-2",children:[(0,b.jsx)(j.UserPlus,{className:"h-5 w-5"}),(0,b.jsx)("span",{children:"Add Members"})]}),(0,b.jsx)(o.CardDescription,{children:"Available users to add to the team"})]}),(0,b.jsxs)(o.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(l.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(n.Input,{placeholder:"Search users...",value:A,onChange:a=>B(a.target.value),className:"pl-10"})]}),(0,b.jsx)(r.Separator,{}),(0,b.jsx)("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:F?(0,b.jsxs)("div",{className:"text-center py-4",children:[(0,b.jsx)("div",{className:"animate-spin h-6 w-6 border-2 border-primary border-t-transparent rounded-full mx-auto"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:"Loading users..."})]}):J.length>0?J.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,b.jsxs)(q.Avatar,{className:"h-8 w-8",children:[(0,b.jsx)(q.AvatarImage,{src:""}),(0,b.jsxs)(q.AvatarFallback,{children:[a.first_name?.[0],a.last_name?.[0]]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:a.full_name}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(p.Badge,{variant:"outline",children:(a=>{switch(a){case"admin":return"Admin";case"pm":return"Project Manager";case"foreman":return"Foreman";case"crew":case"worker":return"Worker";case"viewer":return"Viewer";default:return a.charAt(0).toUpperCase()+a.slice(1)}})(a.role)}),(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:a.email})]})]})]}),(0,b.jsx)(m.Button,{variant:"outline",size:"sm",onClick:()=>((a,b="member")=>{G.mutate({userId:a,role:b})})(a.id,"member"),disabled:G.isPending,children:(0,b.jsx)(j.UserPlus,{className:"h-4 w-4"})})]},a.id)):(0,b.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,b.jsx)(l.Search,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),(0,b.jsx)("p",{children:A?"No users found":"All users are already in the team"})]})})]})]})]})]})}}];

//# sourceMappingURL=_f82413a9._.js.map