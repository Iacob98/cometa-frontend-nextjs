module.exports=[22568,a=>{"use strict";a.s(["default",()=>M]);var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(95245),f=a.i(59501),g=a.i(56757),h=a.i(210),i=a.i(60246),j=a.i(24569),k=a.i(14548),l=a.i(33508),m=a.i(24987),n=a.i(41675),o=a.i(92258),p=a.i(63519),q=a.i(17371),r=a.i(81560),s=a.i(21161),t=a.i(79808),u=a.i(10227),v=a.i(83497),w=a.i(99570),x=a.i(66718),y=a.i(91119),z=a.i(86304),A=a.i(70430),B=a.i(41921),C=a.i(80701),D=a.i(86192),E=a.i(44750),F=a.i(10778),G=a.i(86456),H=a.i(47507),I=a.i(25839),J=a.i(47671),K=a.i(35850);let L=g.z.object({name:g.z.string().min(1,"Team name is required"),foreman_user_id:g.z.string().optional(),project_id:g.z.string().optional()});function M(){let a=(0,d.useRouter)(),g=(0,d.useParams)(),{canManageTeams:M}=(0,H.usePermissions)(),[N,O]=(0,c.useState)(!1),P=g.id,{data:Q,isLoading:R,error:S}=(0,E.useCrew)(P),T=(0,E.useUpdateCrew)(),U=(0,E.useDeleteCrew)(),{data:V}=(0,F.useUsers)({page:1,per_page:100}),{data:W,isLoading:X}=(0,G.useProjects)({page:1,per_page:50}),{data:Y,isLoading:Z}=(0,I.useCrewEquipmentAssignments)(P),{data:$,isLoading:_}=(0,J.useCrewVehicleAssignments)(P),aa=V?.items||[],ab=W?.items||[],ac=aa.filter(a=>["foreman","pm","admin"].includes(a.role)),ad=(0,e.useForm)({resolver:(0,f.zodResolver)(L),defaultValues:{name:Q?.name||"",foreman_user_id:Q?.foreman_user_id||"",project_id:Q?.project_id||""}});(0,c.useEffect)(()=>{Q&&ad.reset({name:Q.name,foreman_user_id:Q.foreman_user_id||"",project_id:Q.project_id||""})},[Q,ad]);let ae=async a=>{if(Q)try{let b={name:a.name,foreman_user_id:"none"===a.foreman_user_id?void 0:a.foreman_user_id,project_id:"none"===a.project_id?void 0:a.project_id};await T.mutateAsync({id:Q.id,data:b}),O(!1)}catch(a){console.error("Failed to update team:",a)}},af=async()=>{if(Q)try{await U.mutateAsync(Q.id),a.push("/dashboard/teams")}catch(a){console.error("Failed to delete team:",a)}};return R?(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,b.jsx)("div",{className:"h-10 w-20 bg-muted animate-pulse rounded"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"h-8 w-64 bg-muted animate-pulse rounded"}),(0,b.jsx)("div",{className:"h-4 w-96 mt-2 bg-muted animate-pulse rounded"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,b.jsx)("div",{className:"h-96 bg-muted animate-pulse rounded"}),(0,b.jsx)("div",{className:"h-96 bg-muted animate-pulse rounded"})]})]}):S||!Q?(0,b.jsx)("div",{className:"space-y-6",children:(0,b.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,b.jsxs)(w.Button,{variant:"ghost",size:"sm",onClick:()=>a.back(),className:"flex items-center space-x-2",children:[(0,b.jsx)(h.ArrowLeft,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"Back"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold tracking-tight text-destructive",children:"Team Not Found"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"The team you're looking for doesn't exist or has been deleted."})]})]})}):(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,b.jsxs)(w.Button,{variant:"ghost",size:"sm",onClick:()=>a.back(),className:"flex items-center space-x-2",children:[(0,b.jsx)(h.ArrowLeft,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"Back"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:Q.name}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Team details and member management"})]})]}),M&&(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[N?(0,b.jsxs)(w.Button,{variant:"outline",onClick:()=>O(!1),className:"flex items-center space-x-2",children:[(0,b.jsx)(l.X,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"Cancel"})]}):(0,b.jsxs)(w.Button,{variant:"outline",onClick:()=>O(!0),className:"flex items-center space-x-2",children:[(0,b.jsx)(j.Edit,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"Edit Team"})]}),(0,b.jsxs)(D.AlertDialog,{children:[(0,b.jsx)(D.AlertDialogTrigger,{asChild:!0,children:(0,b.jsx)(w.Button,{variant:"destructive",size:"sm",children:(0,b.jsx)(r.Trash2,{className:"h-4 w-4"})})}),(0,b.jsxs)(D.AlertDialogContent,{children:[(0,b.jsxs)(D.AlertDialogHeader,{children:[(0,b.jsx)(D.AlertDialogTitle,{children:"Delete Team"}),(0,b.jsxs)(D.AlertDialogDescription,{children:['Are you sure you want to delete "',Q.name,'"? This action cannot be undone.']})]}),(0,b.jsxs)(D.AlertDialogFooter,{children:[(0,b.jsx)(D.AlertDialogCancel,{children:"Cancel"}),(0,b.jsx)(D.AlertDialogAction,{onClick:af,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,b.jsxs)(y.Card,{children:[(0,b.jsxs)(y.CardHeader,{children:[(0,b.jsxs)(y.CardTitle,{className:"flex items-center space-x-2",children:[(0,b.jsx)(s.Settings,{className:"h-5 w-5"}),(0,b.jsx)("span",{children:"Team Information"})]}),(0,b.jsx)(y.CardDescription,{children:"Basic team details and assignments"})]}),(0,b.jsx)(y.CardContent,{children:N?(0,b.jsx)(B.Form,{...ad,children:(0,b.jsxs)("form",{onSubmit:ad.handleSubmit(ae),className:"space-y-4",children:[(0,b.jsx)(B.FormField,{control:ad.control,name:"name",render:({field:a})=>(0,b.jsxs)(B.FormItem,{children:[(0,b.jsx)(B.FormLabel,{children:"Team Name *"}),(0,b.jsx)(B.FormControl,{children:(0,b.jsx)(x.Input,{placeholder:"e.g., Installation Team Alpha",...a})}),(0,b.jsx)(B.FormMessage,{})]})}),(0,b.jsx)(B.FormField,{control:ad.control,name:"foreman_user_id",render:({field:a})=>(0,b.jsxs)(B.FormItem,{children:[(0,b.jsx)(B.FormLabel,{children:"Team Leader / Foreman"}),(0,b.jsxs)(C.Select,{onValueChange:a.onChange,value:a.value,children:[(0,b.jsx)(B.FormControl,{children:(0,b.jsx)(C.SelectTrigger,{children:(0,b.jsx)(C.SelectValue,{placeholder:"Select team leader"})})}),(0,b.jsxs)(C.SelectContent,{children:[(0,b.jsx)(C.SelectItem,{value:"none",children:"No leader assigned"}),ac.map(a=>(0,b.jsxs)(C.SelectItem,{value:a.id,children:[a.full_name," (",a.role,")"]},a.id))]})]}),(0,b.jsx)(B.FormMessage,{})]})}),(0,b.jsx)(B.FormField,{control:ad.control,name:"project_id",render:({field:a})=>(0,b.jsxs)(B.FormItem,{children:[(0,b.jsx)(B.FormLabel,{children:"Assign to Project"}),(0,b.jsxs)(C.Select,{onValueChange:a.onChange,value:a.value,children:[(0,b.jsx)(B.FormControl,{children:(0,b.jsx)(C.SelectTrigger,{children:(0,b.jsx)(C.SelectValue,{placeholder:"Select project (optional)"})})}),(0,b.jsxs)(C.SelectContent,{children:[(0,b.jsx)(C.SelectItem,{value:"none",children:"No project assigned"}),X?(0,b.jsx)(C.SelectItem,{value:"loading",disabled:!0,children:"Loading projects..."}):ab.map(a=>(0,b.jsx)(C.SelectItem,{value:a.id,children:a.name},a.id))]})]}),(0,b.jsx)(B.FormMessage,{})]})}),(0,b.jsxs)("div",{className:"flex justify-end space-x-2 pt-4",children:[(0,b.jsxs)(w.Button,{type:"button",variant:"outline",onClick:()=>O(!1),children:[(0,b.jsx)(l.X,{className:"mr-2 h-4 w-4"}),"Cancel"]}),(0,b.jsxs)(w.Button,{type:"submit",disabled:T.isPending,children:[T.isPending?(0,b.jsx)("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-background border-t-transparent mr-2"}):(0,b.jsx)(k.Save,{className:"mr-2 h-4 w-4"}),"Save Changes"]})]})]})}):(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(A.Label,{className:"text-sm font-medium",children:"Team Name"}),(0,b.jsx)("p",{className:"text-lg",children:Q.name})]}),Q.foreman&&(0,b.jsxs)("div",{children:[(0,b.jsx)(A.Label,{className:"text-sm font-medium",children:"Team Leader / Foreman"}),(0,b.jsxs)("div",{className:"flex items-center space-x-2 mt-1",children:[(0,b.jsx)(z.Badge,{variant:"default",children:Q.foreman.role}),(0,b.jsx)("span",{className:"text-sm",children:Q.foreman.full_name})]}),Q.foreman.email&&(0,b.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-muted-foreground mt-1",children:[(0,b.jsx)(o.Mail,{className:"h-3 w-3"}),(0,b.jsx)("span",{children:Q.foreman.email})]}),Q.foreman.phone&&(0,b.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-muted-foreground",children:[(0,b.jsx)(p.Phone,{className:"h-3 w-3"}),(0,b.jsx)("span",{children:Q.foreman.phone})]})]}),Q.project_name&&(0,b.jsxs)("div",{children:[(0,b.jsx)(A.Label,{className:"text-sm font-medium",children:"Assigned Project"}),(0,b.jsxs)("div",{className:"flex items-center space-x-2 mt-1",children:[(0,b.jsx)(m.MapPin,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsx)("span",{children:Q.project_name})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(A.Label,{className:"text-sm font-medium",children:"Status"}),(0,b.jsx)("div",{className:"mt-1",children:(0,b.jsx)(z.Badge,{variant:"secondary",children:Q.status})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(A.Label,{className:"text-sm font-medium",children:"Created"}),(0,b.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-muted-foreground mt-1",children:[(0,b.jsx)(n.Calendar,{className:"h-3 w-3"}),(0,b.jsx)("span",{children:new Date(Q.created_at).toLocaleDateString()})]})]})]})})]}),(0,b.jsxs)(y.Card,{children:[(0,b.jsx)(y.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)(y.CardTitle,{className:"flex items-center space-x-2",children:[(0,b.jsx)(i.Users,{className:"h-5 w-5"}),(0,b.jsxs)("span",{children:["Team Members (",Q.members?.length||0,")"]})]}),(0,b.jsx)(y.CardDescription,{children:"Current team members and their roles"})]}),M&&(0,b.jsxs)(w.Button,{variant:"outline",onClick:()=>a.push(`/dashboard/teams/${P}/members`),className:"flex items-center space-x-2",children:[(0,b.jsx)(q.UserPlus,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"Manage Members"})]})]})}),(0,b.jsx)(y.CardContent,{children:(0,b.jsx)("div",{className:"space-y-3",children:Q.members?.length===0?(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)(q.UserPlus,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,b.jsx)("h3",{className:"mt-2 text-sm font-semibold",children:"No team members"}),(0,b.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"This team doesn't have any members assigned yet."}),M&&(0,b.jsxs)(w.Button,{variant:"outline",className:"mt-4",onClick:()=>a.push(`/dashboard/teams/${P}/members`),children:[(0,b.jsx)(q.UserPlus,{className:"mr-2 h-4 w-4"}),"Add Members"]})]}):Q.members?.map(a=>(0,b.jsxs)("div",{className:"flex items-center space-x-3 p-3 border rounded-lg",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("div",{className:"font-medium text-sm",children:a.user.full_name}),(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:a.user.email||a.user.phone||"No contact info"})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(z.Badge,{variant:(a=>{switch(a){case"foreman":return"default";case"crew":case"worker":return"secondary";default:return"outline"}})(a.user.role||""),children:a.user.role}),(0,b.jsx)(z.Badge,{variant:"outline",children:a.role_in_crew}),(0,b.jsx)(K.default,{userId:a.user.id,userName:a.user.full_name})]})]},a.id))})})]})]}),(0,b.jsxs)(y.Card,{children:[(0,b.jsx)(y.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)(y.CardTitle,{className:"flex items-center space-x-2",children:[(0,b.jsx)(v.Package,{className:"h-5 w-5"}),(0,b.jsx)("span",{children:"Assigned Resources"})]}),(0,b.jsx)(y.CardDescription,{children:"Equipment and vehicles assigned to this crew"})]}),M&&(0,b.jsxs)(w.Button,{variant:"outline",size:"sm",onClick:()=>a.push("/dashboard/equipment/assignments/new"),className:"flex items-center space-x-2",children:[(0,b.jsx)(v.Package,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"Assign Resource"})]})]})}),(0,b.jsx)(y.CardContent,{children:(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,b.jsx)(t.Wrench,{className:"h-5 w-5 text-muted-foreground"}),(0,b.jsxs)("span",{className:"text-lg font-semibold",children:["Equipment (",Y?.length||0,")"]})]}),Z?(0,b.jsx)("div",{className:"space-y-2",children:Array.from({length:2}).map((a,c)=>(0,b.jsx)("div",{className:"h-16 bg-muted animate-pulse rounded"},c))}):Y?.length?(0,b.jsx)("div",{className:"space-y-3",children:Y?.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/5 transition-colors",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,b.jsx)(t.Wrench,{className:"h-5 w-5 text-muted-foreground"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium",children:a.equipment?.name||"Unknown Equipment"}),a.equipment?.inventory_no&&(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:["#",a.equipment.inventory_no]})]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:a.is_permanent?"Permanent":"Temporary"}),a.project_name&&(0,b.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Project: ",a.project_name]})]})]},a.id))}):(0,b.jsxs)("div",{className:"text-center py-6 border rounded-lg bg-muted/10",children:[(0,b.jsx)(t.Wrench,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,b.jsx)("p",{className:"mt-2 text-sm text-muted-foreground",children:"No equipment assigned"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,b.jsx)(u.Truck,{className:"h-5 w-5 text-muted-foreground"}),(0,b.jsxs)("span",{className:"text-lg font-semibold",children:["Vehicles (",$?.length||0,")"]})]}),_?(0,b.jsx)("div",{className:"space-y-2",children:Array.from({length:2}).map((a,c)=>(0,b.jsx)("div",{className:"h-16 bg-muted animate-pulse rounded"},c))}):$?.length?(0,b.jsx)("div",{className:"space-y-3",children:$?.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/5 transition-colors",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,b.jsx)(u.Truck,{className:"h-5 w-5 text-muted-foreground"}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"font-medium",children:[a.vehicle?.brand," ",a.vehicle?.model]}),a.vehicle?.plate_number&&(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:["ðŸš— ",a.vehicle.plate_number]})]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("div",{className:"text-xs text-muted-foreground",children:a.is_permanent?"Permanent":"Temporary"}),a.project_name&&(0,b.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Project: ",a.project_name]})]})]},a.id))}):(0,b.jsxs)("div",{className:"text-center py-6 border rounded-lg bg-muted/10",children:[(0,b.jsx)(u.Truck,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,b.jsx)("p",{className:"mt-2 text-sm text-muted-foreground",children:"No vehicles assigned"})]})]})]})})]})]})}}];

//# sourceMappingURL=src_app_%28dashboard%29_dashboard_teams_%5Bid%5D_page_tsx_7af17c48._.js.map