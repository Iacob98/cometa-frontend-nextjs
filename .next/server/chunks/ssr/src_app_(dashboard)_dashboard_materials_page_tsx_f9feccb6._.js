module.exports=[41973,a=>{"use strict";a.s(["default",()=>V],41973);var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(15618),f=a.i(87532),g=a.i(83497),h=a.i(73570),i=a.i(10227),j=a.i(11300),k=a.i(94101),l=a.i(67900),m=a.i(77156),n=a.i(24569),o=a.i(81560),p=a.i(17755);let q=(0,a.i(70106).default)("arrow-up-down",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);var r=a.i(16201),s=a.i(41710),t=a.i(62722),u=a.i(69012),v=a.i(24669),w=a.i(24987),x=a.i(99570),y=a.i(66718),z=a.i(91119),A=a.i(86304),B=a.i(6015),C=a.i(35732),D=a.i(80701),E=a.i(75083),F=a.i(18155),G=a.i(23665),H=a.i(58042),I=a.i(94222),J=a.i(54419),K=a.i(59854),L=a.i(48662),M=a.i(64321),N=a.i(27165),O=a.i(67149),P=a.i(57431),Q=a.i(77924),R=a.i(7671),S=a.i(40533),T=a.i(95669),U=a.i(47507);function V(){let a=(0,d.useRouter)(),{canManageInventory:F}=(0,U.usePermissions)(),G=(0,R.useDeleteMaterial)();(0,R.useAdjustStock)();let[H,I]=(0,c.useState)(""),[J,K]=(0,c.useState)("all"),[L,M]=(0,c.useState)("all"),{data:N,isLoading:O,error:P}=(0,R.useMaterials)({search:H||void 0,category:"all"===J?void 0:J,low_stock:"low"===L||void 0,page:1,per_page:20}),{data:Q}=(0,R.useLowStockMaterials)(),{data:V}=(0,R.useSuppliers)(),{data:$}=(0,S.useAllocations)(),{data:_}=(0,T.useMaterialOrders)({page:1,per_page:10}),aa=N?.items||[],ab=_?.items||[],ac=async(a,b)=>{confirm(`Are you sure you want to delete "${b}"? This action cannot be undone.`)&&await G.mutateAsync(a)},ad=a=>new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}).format(a),ae=a=>({piece:"pcs",meter:"m",kg:"kg",ton:"t",liter:"L",m3:"m³",box:"box",pallet:"plt",roll:"roll"})[a]||a;return P?(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("div",{className:"flex items-center justify-between",children:(0,b.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Materials"})}),(0,b.jsx)(z.Card,{children:(0,b.jsx)(z.CardContent,{className:"py-8",children:(0,b.jsx)("div",{className:"text-center text-muted-foreground",children:"Failed to load materials. Please try again later."})})})]}):(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Materials & Inventory"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Manage materials, track inventory, and monitor stock levels"})]}),F&&(0,b.jsxs)("div",{className:"flex space-x-2",children:[(0,b.jsxs)(x.Button,{variant:"outline",onClick:()=>a.push("/dashboard/materials/suppliers"),children:[(0,b.jsx)(l.Building2,{className:"mr-2 h-4 w-4"}),"Suppliers"]}),(0,b.jsxs)(x.Button,{variant:"outline",onClick:()=>a.push("/dashboard/materials/new"),children:[(0,b.jsx)(e.Plus,{className:"mr-2 h-4 w-4"}),"Add Material"]}),(0,b.jsxs)(x.Button,{onClick:()=>a.push("/dashboard/materials/order"),children:[(0,b.jsx)(e.Plus,{className:"mr-2 h-4 w-4"}),"Order Materials"]})]})]}),(0,b.jsxs)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:[(0,b.jsxs)(z.Card,{children:[(0,b.jsxs)(z.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(z.CardTitle,{className:"text-sm font-medium",children:"Total Materials"}),(0,b.jsx)(g.Package,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(z.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:N?.total||0}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"In inventory system"})]})]}),(0,b.jsxs)(z.Card,{children:[(0,b.jsxs)(z.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(z.CardTitle,{className:"text-sm font-medium",children:"Low Stock Items"}),(0,b.jsx)(h.AlertTriangle,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(z.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-destructive",children:Q?.length||0}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Need reordering"})]})]}),(0,b.jsxs)(z.Card,{children:[(0,b.jsxs)(z.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(z.CardTitle,{className:"text-sm font-medium",children:"Active Orders"}),(0,b.jsx)(i.Truck,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(z.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:ab.filter(a=>["pending","ordered"].includes(a.status)).length}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Pending delivery"})]})]}),(0,b.jsxs)(z.Card,{children:[(0,b.jsxs)(z.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(z.CardTitle,{className:"text-sm font-medium",children:"Inventory Value"}),(0,b.jsx)(k.DollarSign,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(z.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:ad(aa.reduce((a,b)=>a+b.current_stock_qty*b.unit_cost,0))}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Total stock value"})]})]})]}),(0,b.jsxs)(E.Tabs,{defaultValue:"inventory",className:"space-y-4",children:[(0,b.jsxs)(E.TabsList,{children:[(0,b.jsxs)(E.TabsTrigger,{value:"inventory",children:["Inventory (",aa.length,")"]}),(0,b.jsxs)(E.TabsTrigger,{value:"low-stock",children:["Low Stock (",Q?.length||0,")"]}),(0,b.jsxs)(E.TabsTrigger,{value:"allocations",children:["Allocations (",$?.length||0,")"]}),(0,b.jsxs)(E.TabsTrigger,{value:"orders",children:["Orders (",ab.length,")"]})]}),(0,b.jsxs)(E.TabsContent,{value:"inventory",className:"space-y-6",children:[(0,b.jsxs)(z.Card,{children:[(0,b.jsxs)(z.CardHeader,{children:[(0,b.jsx)(z.CardTitle,{children:"Filter Materials"}),(0,b.jsx)(z.CardDescription,{children:"Search and filter materials by various criteria"})]}),(0,b.jsx)(z.CardContent,{children:(0,b.jsxs)("div",{className:"flex flex-col space-y-4 md:flex-row md:space-y-0 md:space-x-4",children:[(0,b.jsx)("div",{className:"flex-1",children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(f.Search,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(y.Input,{placeholder:"Search materials by name or description...",value:H,onChange:a=>I(a.target.value),className:"pl-8"})]})}),(0,b.jsxs)(D.Select,{value:J,onValueChange:K,children:[(0,b.jsx)(D.SelectTrigger,{className:"w-48",children:(0,b.jsx)(D.SelectValue,{placeholder:"Filter by category"})}),(0,b.jsxs)(D.SelectContent,{children:[(0,b.jsx)(D.SelectItem,{value:"all",children:"All Categories"}),(0,b.jsx)(D.SelectItem,{value:"cables",children:"Cables"}),(0,b.jsx)(D.SelectItem,{value:"conduits",children:"Conduits"}),(0,b.jsx)(D.SelectItem,{value:"tools",children:"Tools"}),(0,b.jsx)(D.SelectItem,{value:"equipment",children:"Equipment"}),(0,b.jsx)(D.SelectItem,{value:"consumables",children:"Consumables"})]})]}),(0,b.jsxs)(D.Select,{value:L,onValueChange:a=>M(a),children:[(0,b.jsx)(D.SelectTrigger,{className:"w-48",children:(0,b.jsx)(D.SelectValue,{placeholder:"Filter by stock"})}),(0,b.jsxs)(D.SelectContent,{children:[(0,b.jsx)(D.SelectItem,{value:"all",children:"All Stock Levels"}),(0,b.jsx)(D.SelectItem,{value:"low",children:"Low Stock"}),(0,b.jsx)(D.SelectItem,{value:"normal",children:"Normal Stock"})]})]})]})})]}),(0,b.jsxs)(z.Card,{children:[(0,b.jsx)(z.CardHeader,{children:(0,b.jsxs)(z.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(g.Package,{className:"h-5 w-5"}),"Materials Inventory"]})}),(0,b.jsx)(z.CardContent,{children:O?(0,b.jsx)("div",{className:"space-y-4",children:[void 0,void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsxs)("div",{className:"flex space-x-4",children:[(0,b.jsx)("div",{className:"h-4 bg-muted animate-pulse rounded flex-1"}),(0,b.jsx)("div",{className:"h-4 bg-muted animate-pulse rounded w-20"}),(0,b.jsx)("div",{className:"h-4 bg-muted animate-pulse rounded w-16"})]},c))}):0===aa.length?(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)(g.Package,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,b.jsx)("h3",{className:"mt-2 text-sm font-semibold",children:"No materials found"}),(0,b.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:H||"all"!==J||"all"!==L?"No materials match your current filters.":"Get started by adding your first material."}),F&&(0,b.jsxs)(x.Button,{className:"mt-4",onClick:()=>a.push("/dashboard/materials/new"),children:[(0,b.jsx)(e.Plus,{className:"mr-2 h-4 w-4"}),"Add Material"]})]}):(0,b.jsxs)(B.Table,{children:[(0,b.jsx)(B.TableHeader,{children:(0,b.jsxs)(B.TableRow,{children:[(0,b.jsx)(B.TableHead,{children:"Material"}),(0,b.jsx)(B.TableHead,{children:"Category"}),(0,b.jsx)(B.TableHead,{children:"Stock Level"}),(0,b.jsx)(B.TableHead,{children:"Unit Cost"}),(0,b.jsx)(B.TableHead,{children:"Total Value"}),(0,b.jsx)(B.TableHead,{children:"Supplier"}),(0,b.jsx)(B.TableHead,{children:"Status"}),(0,b.jsx)(B.TableHead,{className:"w-[70px]",children:"Actions"})]})}),(0,b.jsx)(B.TableBody,{children:aa.map(c=>(0,b.jsxs)(B.TableRow,{children:[(0,b.jsx)(B.TableCell,{children:(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium",children:c.name}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:c.description})]})}),(0,b.jsx)(B.TableCell,{children:(0,b.jsx)(A.Badge,{variant:"outline",children:c.category})}),(0,b.jsx)(B.TableCell,{children:(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"font-medium",children:[c.current_stock_qty," ",ae(c.unit)]}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Min: ",c.min_stock_level," ",ae(c.unit)]})]})}),(0,b.jsx)(B.TableCell,{children:(0,b.jsx)("div",{className:"font-mono",children:ad(c.unit_cost)})}),(0,b.jsx)(B.TableCell,{children:(0,b.jsx)("div",{className:"font-mono font-medium",children:ad(c.current_stock_qty*c.unit_cost)})}),(0,b.jsx)(B.TableCell,{children:(0,b.jsx)("div",{className:"text-sm",children:c.supplier?.name||"—"})}),(0,b.jsx)(B.TableCell,{children:(0,b.jsx)(A.Badge,{variant:c.current_stock_qty<=c.min_stock_level?"destructive":c.current_stock_qty<=1.2*c.min_stock_level?"outline":"secondary",children:c.current_stock_qty<=c.min_stock_level?"Low Stock":c.current_stock_qty<=1.2*c.min_stock_level?"Warning":"Normal"})}),(0,b.jsx)(B.TableCell,{children:(0,b.jsxs)(C.DropdownMenu,{children:[(0,b.jsx)(C.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)(x.Button,{variant:"ghost",className:"h-8 w-8 p-0",children:[(0,b.jsx)("span",{className:"sr-only",children:"Open menu"}),(0,b.jsx)(p.MoreHorizontal,{className:"h-4 w-4"})]})}),(0,b.jsxs)(C.DropdownMenuContent,{align:"end",children:[(0,b.jsx)(C.DropdownMenuLabel,{children:"Actions"}),(0,b.jsxs)(C.DropdownMenuItem,{onClick:()=>a.push(`/dashboard/materials/${c.id}`),children:[(0,b.jsx)(m.Eye,{className:"mr-2 h-4 w-4"}),"View Details"]}),F&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(C.DropdownMenuItem,{onClick:()=>a.push(`/dashboard/materials/${c.id}`),children:[(0,b.jsx)(n.Edit,{className:"mr-2 h-4 w-4"}),"Edit Material"]}),(0,b.jsxs)(C.DropdownMenuItem,{onClick:()=>a.push(`/dashboard/materials/${c.id}/adjust`),children:[(0,b.jsx)(q,{className:"mr-2 h-4 w-4"}),"Adjust Stock"]}),(0,b.jsx)(C.DropdownMenuSeparator,{}),(0,b.jsxs)(C.DropdownMenuItem,{className:"text-destructive",onClick:()=>ac(c.id,c.name),children:[(0,b.jsx)(o.Trash2,{className:"mr-2 h-4 w-4"}),"Delete Material"]})]})]})]})})]},c.id))})]})})]})]}),(0,b.jsx)(E.TabsContent,{value:"low-stock",className:"space-y-6",children:(0,b.jsxs)(z.Card,{children:[(0,b.jsxs)(z.CardHeader,{children:[(0,b.jsxs)(z.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(h.AlertTriangle,{className:"h-5 w-5 text-destructive"}),"Low Stock Alert"]}),(0,b.jsx)(z.CardDescription,{children:"Materials that need immediate attention"})]}),(0,b.jsx)(z.CardContent,{children:Q?.length===0?(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)(g.Package,{className:"mx-auto h-12 w-12 text-green-500"}),(0,b.jsx)("h3",{className:"mt-2 text-sm font-semibold",children:"All stock levels are healthy"}),(0,b.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"No materials are currently below minimum stock levels."})]}):(0,b.jsx)("div",{className:"space-y-4",children:Q?.map(c=>(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 border border-destructive/20 rounded-lg bg-destructive/5",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("div",{className:"font-medium",children:c.name}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Current: ",c.current_stock_qty," ",ae(c.unit)," / Min: ",c.min_stock_level," ",ae(c.unit)]})]}),(0,b.jsxs)("div",{className:"flex space-x-2",children:[(0,b.jsxs)(x.Button,{variant:"outline",size:"sm",onClick:()=>a.push(`/dashboard/materials/order?material=${c.id}`),children:[(0,b.jsx)(i.Truck,{className:"mr-2 h-4 w-4"}),"Order"]}),(0,b.jsxs)(x.Button,{variant:"outline",size:"sm",onClick:()=>a.push(`/dashboard/materials/${c.id}`),children:[(0,b.jsx)(m.Eye,{className:"mr-2 h-4 w-4"}),"View"]})]})]},c.id))})})]})}),(0,b.jsxs)(E.TabsContent,{value:"allocations",className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:[(0,b.jsxs)(z.Card,{children:[(0,b.jsxs)(z.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(z.CardTitle,{className:"text-sm font-medium",children:"Total Allocations"}),(0,b.jsx)(j.ClipboardList,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(z.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:$?.length||0}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Active material assignments"})]})]}),(0,b.jsxs)(z.Card,{children:[(0,b.jsxs)(z.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(z.CardTitle,{className:"text-sm font-medium",children:"Projects with Materials"}),(0,b.jsx)(w.MapPin,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(z.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:new Set($?.map(a=>a.project_id).filter(Boolean)).size||0}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Unique projects"})]})]}),(0,b.jsxs)(z.Card,{children:[(0,b.jsxs)(z.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(z.CardTitle,{className:"text-sm font-medium",children:"Total Allocated Value"}),(0,b.jsx)(k.DollarSign,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(z.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:ad($?.reduce((a,b)=>a+b.allocated_qty*(b.material?.default_price_eur||0),0)||0)}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Total allocation value"})]})]}),(0,b.jsxs)(z.Card,{children:[(0,b.jsxs)(z.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(z.CardTitle,{className:"text-sm font-medium",children:"Utilization Rate"}),(0,b.jsx)(v.TrendingUp,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(z.CardContent,{children:[(0,b.jsxs)("div",{className:"text-2xl font-bold",children:[$?.length>0?Math.round($.reduce((a,b)=>a+(b.used_qty||0),0)/$.reduce((a,b)=>a+b.allocated_qty,0)*100):0,"%"]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Materials actually used"})]})]})]}),(0,b.jsxs)("div",{className:"grid gap-6 lg:grid-cols-2",children:[(0,b.jsxs)(z.Card,{children:[(0,b.jsx)(z.CardHeader,{children:(0,b.jsx)(z.CardTitle,{children:"Allocation by Material Type"})}),(0,b.jsx)(z.CardContent,{children:(0,b.jsx)(W,{})})]}),(0,b.jsxs)(z.Card,{children:[(0,b.jsx)(z.CardHeader,{children:(0,b.jsx)(z.CardTitle,{children:"Project Allocation Distribution"})}),(0,b.jsx)(z.CardContent,{children:(0,b.jsx)(X,{})})]})]}),(0,b.jsxs)(z.Card,{children:[(0,b.jsxs)(z.CardHeader,{children:[(0,b.jsxs)(z.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(j.ClipboardList,{className:"h-5 w-5"}),"Material Allocations"]}),(0,b.jsx)(z.CardDescription,{children:"Track material assignments to projects and teams"})]}),(0,b.jsx)(z.CardContent,{children:$?.length?(0,b.jsxs)(B.Table,{children:[(0,b.jsx)(B.TableHeader,{children:(0,b.jsxs)(B.TableRow,{children:[(0,b.jsx)(B.TableHead,{children:"Material"}),(0,b.jsx)(B.TableHead,{children:"Project"}),(0,b.jsx)(B.TableHead,{children:"Allocated"}),(0,b.jsx)(B.TableHead,{children:"Used"}),(0,b.jsx)(B.TableHead,{children:"Remaining"}),(0,b.jsx)(B.TableHead,{children:"Value"}),(0,b.jsx)(B.TableHead,{children:"Status"}),(0,b.jsx)(B.TableHead,{className:"w-[70px]",children:"Actions"})]})}),(0,b.jsx)(B.TableBody,{children:$?.map(c=>{let d=c.allocated_qty-(c.used_qty||0),e=(c.used_qty||0)/c.allocated_qty*100;return(0,b.jsxs)(B.TableRow,{children:[(0,b.jsx)(B.TableCell,{children:(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium",children:c.material?.name}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:c.material?.category})]})}),(0,b.jsx)(B.TableCell,{children:(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium",children:c.project_name||"Unknown Project"}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:c.crew_name||"No Crew"})]})}),(0,b.jsx)(B.TableCell,{children:(0,b.jsxs)("div",{className:"font-medium",children:[c.allocated_qty," ",ae(c.material?.unit||"piece")]})}),(0,b.jsxs)(B.TableCell,{children:[(0,b.jsxs)("div",{className:"font-medium",children:[c.used_qty||0," ",ae(c.material?.unit||"piece")]}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:[Math.round(e),"% used"]})]}),(0,b.jsx)(B.TableCell,{children:(0,b.jsxs)("div",{className:"font-medium",children:[d," ",ae(c.material?.unit||"piece")]})}),(0,b.jsx)(B.TableCell,{children:(0,b.jsx)("div",{className:"font-mono",children:ad(c.allocated_qty*(c.material?.default_price_eur||0))})}),(0,b.jsx)(B.TableCell,{children:(0,b.jsx)(A.Badge,{variant:e>90?"default":e>50?"secondary":"outline",children:e>90?"High Usage":e>50?"In Use":"Available"})}),(0,b.jsx)(B.TableCell,{children:(0,b.jsxs)(C.DropdownMenu,{children:[(0,b.jsx)(C.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)(x.Button,{variant:"ghost",className:"h-8 w-8 p-0",children:[(0,b.jsx)("span",{className:"sr-only",children:"Open menu"}),(0,b.jsx)(p.MoreHorizontal,{className:"h-4 w-4"})]})}),(0,b.jsxs)(C.DropdownMenuContent,{align:"end",children:[(0,b.jsx)(C.DropdownMenuLabel,{children:"Actions"}),(0,b.jsxs)(C.DropdownMenuItem,{onClick:()=>a.push(`/dashboard/materials/allocations/${c.id}`),children:[(0,b.jsx)(m.Eye,{className:"mr-2 h-4 w-4"}),"View Details"]}),F&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(C.DropdownMenuItem,{onClick:()=>a.push(`/dashboard/materials/allocations/${c.id}/edit`),children:[(0,b.jsx)(n.Edit,{className:"mr-2 h-4 w-4"}),"Edit Allocation"]}),(0,b.jsxs)(C.DropdownMenuItem,{onClick:()=>a.push(`/dashboard/materials/allocations/${c.id}/usage`),children:[(0,b.jsx)(q,{className:"mr-2 h-4 w-4"}),"Update Usage"]})]})]})]})})]},c.id)})})]}):(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)(j.ClipboardList,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,b.jsx)("h3",{className:"mt-2 text-sm font-semibold",children:"No allocations found"}),(0,b.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"Start allocating materials to projects to track usage."}),F&&(0,b.jsxs)(x.Button,{className:"mt-4",onClick:()=>a.push("/dashboard/materials/allocate"),children:[(0,b.jsx)(e.Plus,{className:"mr-2 h-4 w-4"}),"New Allocation"]})]})})]})]}),(0,b.jsxs)(E.TabsContent,{value:"orders",className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:[(0,b.jsxs)(z.Card,{children:[(0,b.jsxs)(z.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(z.CardTitle,{className:"text-sm font-medium",children:"Total Orders"}),(0,b.jsx)(i.Truck,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(z.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:ab.length}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"All purchase orders"})]})]}),(0,b.jsxs)(z.Card,{children:[(0,b.jsxs)(z.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(z.CardTitle,{className:"text-sm font-medium",children:"Pending Orders"}),(0,b.jsx)(s.Clock,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(z.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-orange-600",children:ab.filter(a=>["pending","ordered"].includes(a.status)).length}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Awaiting delivery"})]})]}),(0,b.jsxs)(z.Card,{children:[(0,b.jsxs)(z.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(z.CardTitle,{className:"text-sm font-medium",children:"Delivered Orders"}),(0,b.jsx)(r.CheckCircle,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(z.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-green-600",children:ab.filter(a=>"delivered"===a.status).length}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Successfully received"})]})]}),(0,b.jsxs)(z.Card,{children:[(0,b.jsxs)(z.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(z.CardTitle,{className:"text-sm font-medium",children:"Total Order Value"}),(0,b.jsx)(k.DollarSign,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(z.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:ad(ab.reduce((a,b)=>a+b.quantity*(b.unit_price||0),0))}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Total purchasing value"})]})]})]}),(0,b.jsxs)("div",{className:"grid gap-6 lg:grid-cols-2",children:[(0,b.jsxs)(z.Card,{children:[(0,b.jsx)(z.CardHeader,{children:(0,b.jsx)(z.CardTitle,{children:"Order Status Distribution"})}),(0,b.jsx)(z.CardContent,{children:(0,b.jsx)(Y,{})})]}),(0,b.jsxs)(z.Card,{children:[(0,b.jsx)(z.CardHeader,{children:(0,b.jsx)(z.CardTitle,{children:"Monthly Order Trends"})}),(0,b.jsx)(z.CardContent,{children:(0,b.jsx)(Z,{})})]})]}),(0,b.jsxs)(z.Card,{children:[(0,b.jsxs)(z.CardHeader,{children:[(0,b.jsxs)(z.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(i.Truck,{className:"h-5 w-5"}),"Material Orders"]}),(0,b.jsx)(z.CardDescription,{children:"Manage purchase orders and deliveries from suppliers"})]}),(0,b.jsxs)(z.CardContent,{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(y.Input,{placeholder:"Search orders...",className:"w-64"}),(0,b.jsxs)(x.Button,{variant:"outline",size:"sm",children:[(0,b.jsx)(u.Filter,{className:"mr-2 h-4 w-4"}),"Filter"]})]}),F&&(0,b.jsxs)(x.Button,{onClick:()=>a.push("/dashboard/materials/order/new"),children:[(0,b.jsx)(e.Plus,{className:"mr-2 h-4 w-4"}),"New Order"]})]}),0===ab.length?(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)(i.Truck,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,b.jsx)("h3",{className:"mt-2 text-sm font-semibold",children:"No orders found"}),(0,b.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"Start by creating your first material order."}),F&&(0,b.jsxs)(x.Button,{className:"mt-4",onClick:()=>a.push("/dashboard/materials/order/new"),children:[(0,b.jsx)(e.Plus,{className:"mr-2 h-4 w-4"}),"Create Order"]})]}):(0,b.jsxs)(B.Table,{children:[(0,b.jsx)(B.TableHeader,{children:(0,b.jsxs)(B.TableRow,{children:[(0,b.jsx)(B.TableHead,{children:"Order ID"}),(0,b.jsx)(B.TableHead,{children:"Material"}),(0,b.jsx)(B.TableHead,{children:"Supplier"}),(0,b.jsx)(B.TableHead,{children:"Quantity"}),(0,b.jsx)(B.TableHead,{children:"Unit Price"}),(0,b.jsx)(B.TableHead,{children:"Total"}),(0,b.jsx)(B.TableHead,{children:"Expected Delivery"}),(0,b.jsx)(B.TableHead,{children:"Status"}),(0,b.jsx)(B.TableHead,{className:"w-[70px]",children:"Actions"})]})}),(0,b.jsx)(B.TableBody,{children:ab.map(c=>{let d=c.quantity*(c.unit_price||0),e=c.expected_delivery_date&&new Date(c.expected_delivery_date)<new Date&&"delivered"!==c.status;return(0,b.jsxs)(B.TableRow,{children:[(0,b.jsx)(B.TableCell,{children:(0,b.jsxs)("div",{className:"font-mono text-sm",children:["#",c.id.slice(0,8)]})}),(0,b.jsx)(B.TableCell,{children:(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium",children:c.material?.name}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:c.material?.category})]})}),(0,b.jsx)(B.TableCell,{children:(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium",children:c.supplier?.name}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground",children:c.supplier?.contact_person})]})}),(0,b.jsx)(B.TableCell,{children:(0,b.jsxs)("div",{className:"font-medium",children:[c.quantity," ",ae(c.material?.unit||"piece")]})}),(0,b.jsx)(B.TableCell,{children:(0,b.jsx)("div",{className:"font-mono",children:ad(c.unit_price||0)})}),(0,b.jsx)(B.TableCell,{children:(0,b.jsx)("div",{className:"font-mono font-medium",children:ad(d)})}),(0,b.jsx)(B.TableCell,{children:(0,b.jsxs)("div",{className:`text-sm ${e?"text-destructive font-medium":""}`,children:[c.expected_delivery_date?new Date(c.expected_delivery_date).toLocaleDateString():"—",e&&(0,b.jsx)("div",{className:"text-xs text-destructive",children:"Overdue"})]})}),(0,b.jsx)(B.TableCell,{children:(0,b.jsx)(A.Badge,{variant:"delivered"===c.status?"default":"ordered"===c.status?"secondary":"pending"===c.status?"outline":"destructive",children:"delivered"===c.status?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(r.CheckCircle,{className:"mr-1 h-3 w-3"}),"Delivered"]}):"ordered"===c.status?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(s.Clock,{className:"mr-1 h-3 w-3"}),"Ordered"]}):"pending"===c.status?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(s.Clock,{className:"mr-1 h-3 w-3"}),"Pending"]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(t.XCircle,{className:"mr-1 h-3 w-3"}),"Cancelled"]})})}),(0,b.jsx)(B.TableCell,{children:(0,b.jsxs)(C.DropdownMenu,{children:[(0,b.jsx)(C.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)(x.Button,{variant:"ghost",className:"h-8 w-8 p-0",children:[(0,b.jsx)("span",{className:"sr-only",children:"Open menu"}),(0,b.jsx)(p.MoreHorizontal,{className:"h-4 w-4"})]})}),(0,b.jsxs)(C.DropdownMenuContent,{align:"end",children:[(0,b.jsx)(C.DropdownMenuLabel,{children:"Actions"}),(0,b.jsxs)(C.DropdownMenuItem,{onClick:()=>a.push(`/dashboard/materials/orders/${c.id}`),children:[(0,b.jsx)(m.Eye,{className:"mr-2 h-4 w-4"}),"View Details"]}),F&&"delivered"!==c.status&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(C.DropdownMenuItem,{onClick:()=>a.push(`/dashboard/materials/orders/${c.id}/edit`),children:[(0,b.jsx)(n.Edit,{className:"mr-2 h-4 w-4"}),"Edit Order"]}),"pending"===c.status&&(0,b.jsxs)(C.DropdownMenuItem,{children:[(0,b.jsx)(r.CheckCircle,{className:"mr-2 h-4 w-4"}),"Mark as Ordered"]}),("pending"===c.status||"ordered"===c.status)&&(0,b.jsxs)(C.DropdownMenuItem,{children:[(0,b.jsx)(i.Truck,{className:"mr-2 h-4 w-4"}),"Mark as Delivered"]})]})]})]})})]},c.id)})})]})]})]})]})]})]})}let W=()=>{let{data:a}=(0,S.useAllocations)(),c=a?.reduce((a,b)=>{let c=b.material?.category||"Other",d=a.find(a=>a.category===c);return d?(d.value+=b.allocated_qty*(b.material?.default_price_eur||0),d.count+=1):a.push({category:c,value:b.allocated_qty*(b.material?.default_price_eur||0),count:1}),a},[])||[];return(0,b.jsx)(L.ResponsiveContainer,{width:"100%",height:300,children:(0,b.jsxs)(F.BarChart,{data:c,children:[(0,b.jsx)(J.CartesianGrid,{strokeDasharray:"3 3"}),(0,b.jsx)(H.XAxis,{dataKey:"category"}),(0,b.jsx)(I.YAxis,{}),(0,b.jsx)(K.Tooltip,{formatter:a=>[`€${a.toLocaleString()}`,"Allocated Value"]}),(0,b.jsx)(G.Bar,{dataKey:"value",fill:"#3b82f6",name:"Allocated Value"})]})})},X=()=>{let{data:a}=(0,S.useAllocations)(),c=a?.reduce((a,b)=>{let c=b.project_name||"Unassigned",d=a.find(a=>a.project===c);return d?d.value+=b.allocated_qty*(b.material?.default_price_eur||0):a.push({project:c.length>20?c.substring(0,20)+"...":c,value:b.allocated_qty*(b.material?.default_price_eur||0)}),a},[])||[],d=["#3b82f6","#ef4444","#22c55e","#f59e0b","#8b5cf6","#06b6d4"];return(0,b.jsx)(L.ResponsiveContainer,{width:"100%",height:300,children:(0,b.jsxs)(M.PieChart,{children:[(0,b.jsx)(N.Pie,{data:c,cx:"50%",cy:"50%",labelLine:!1,label:({project:a,percent:b})=>`${a} ${(100*b).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:c.map((a,c)=>(0,b.jsx)(O.Cell,{fill:d[c%d.length]},`cell-${c}`))}),(0,b.jsx)(K.Tooltip,{formatter:a=>[`€${a.toLocaleString()}`,"Allocated Value"]})]})})},Y=()=>{let{data:a}=(0,T.useMaterialOrders)({page:1,per_page:100}),c=(a?.items||[]).reduce((a,b)=>{let c=b.status||"pending",d=a.find(a=>a.status===c);return d?(d.count+=1,d.value+=b.quantity*(b.unit_price||0)):a.push({status:c.charAt(0).toUpperCase()+c.slice(1),count:1,value:b.quantity*(b.unit_price||0)}),a},[]),d={Pending:"#f59e0b",Ordered:"#3b82f6",Delivered:"#22c55e",Cancelled:"#ef4444"};return(0,b.jsx)(L.ResponsiveContainer,{width:"100%",height:300,children:(0,b.jsxs)(M.PieChart,{children:[(0,b.jsx)(N.Pie,{data:c,cx:"50%",cy:"50%",labelLine:!1,label:({status:a,count:b})=>`${a} (${b})`,outerRadius:80,fill:"#8884d8",dataKey:"count",children:c.map((a,c)=>(0,b.jsx)(O.Cell,{fill:d[a.status]||"#8b5cf6"},`cell-${c}`))}),(0,b.jsx)(K.Tooltip,{formatter:(a,b)=>[a,"Orders"]})]})})},Z=()=>{let{data:a}=(0,T.useMaterialOrders)({page:1,per_page:100}),c=a?.items||[],d=Array.from({length:6},(a,b)=>{let c=new Date;return c.setMonth(c.getMonth()-b),{month:c.toLocaleDateString("en-US",{month:"short",year:"2-digit"}),monthKey:`${c.getFullYear()}-${String(c.getMonth()+1).padStart(2,"0")}`,orders:0,value:0}}).reverse();return c.forEach(a=>{if(a.created_at){let b=new Date(a.created_at),c=`${b.getFullYear()}-${String(b.getMonth()+1).padStart(2,"0")}`,e=d.find(a=>a.monthKey===c);e&&(e.orders+=1,e.value+=a.quantity*(a.unit_price||0))}}),(0,b.jsx)(L.ResponsiveContainer,{width:"100%",height:300,children:(0,b.jsxs)(P.LineChart,{data:d,children:[(0,b.jsx)(J.CartesianGrid,{strokeDasharray:"3 3"}),(0,b.jsx)(H.XAxis,{dataKey:"month"}),(0,b.jsx)(I.YAxis,{}),(0,b.jsx)(K.Tooltip,{formatter:(a,b)=>["orders"===b?a:`€${a.toLocaleString()}`,"orders"===b?"Orders":"Value"]}),(0,b.jsx)(Q.Line,{type:"monotone",dataKey:"orders",stroke:"#3b82f6",strokeWidth:2,name:"orders"}),(0,b.jsx)(Q.Line,{type:"monotone",dataKey:"value",stroke:"#22c55e",strokeWidth:2,name:"value"})]})})}}];

//# sourceMappingURL=src_app_%28dashboard%29_dashboard_materials_page_tsx_f9feccb6._.js.map