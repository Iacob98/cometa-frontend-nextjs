{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/T7/cometa/cometa-separated-projects/cometa-frontend-nextjs/src/components/ui/alert-dialog.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAEA;AACA;AAEA;AACA;AANA;;;;;;AAQA,MAAM,cAAc,mLAAyB;AAE7C,MAAM,qBAAqB,sLAA4B;AAEvD,MAAM,oBAAoB,qLAA2B;AAErD,MAAM,mCAAqB,mNAAgB,CAGzC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,sLAA4B;QAC3B,WAAW,IAAA,yHAAE,EACX,2JACA;QAED,GAAG,KAAK;QACT,KAAK;;;;;;AAGT,mBAAmB,WAAW,GAAG,sLAA4B,CAAC,WAAW;AAEzE,MAAM,mCAAqB,mNAAgB,CAGzC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;;0BACC,8OAAC;;;;;0BACD,8OAAC,sLAA4B;gBAC3B,KAAK;gBACL,WAAW,IAAA,yHAAE,EACX,+fACA;gBAED,GAAG,KAAK;;;;;;;;;;;;AAIf,mBAAmB,WAAW,GAAG,sLAA4B,CAAC,WAAW;AAEzE,MAAM,oBAAoB,CAAC,EACzB,SAAS,EACT,GAAG,OACkC,iBACrC,8OAAC;QACC,WAAW,IAAA,yHAAE,EACX,oDACA;QAED,GAAG,KAAK;;;;;;AAGb,kBAAkB,WAAW,GAAG;AAEhC,MAAM,oBAAoB,CAAC,EACzB,SAAS,EACT,GAAG,OACkC,iBACrC,8OAAC;QACC,WAAW,IAAA,yHAAE,EACX,iEACA;QAED,GAAG,KAAK;;;;;;AAGb,kBAAkB,WAAW,GAAG;AAEhC,MAAM,iCAAmB,mNAAgB,CAGvC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,oLAA0B;QACzB,KAAK;QACL,WAAW,IAAA,yHAAE,EAAC,yBAAyB;QACtC,GAAG,KAAK;;;;;;AAGb,iBAAiB,WAAW,GAAG,oLAA0B,CAAC,WAAW;AAErE,MAAM,uCAAyB,mNAAgB,CAG7C,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,0LAAgC;QAC/B,KAAK;QACL,WAAW,IAAA,yHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,uBAAuB,WAAW,GAChC,0LAAgC,CAAC,WAAW;AAE9C,MAAM,kCAAoB,mNAAgB,CAGxC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,qLAA2B;QAC1B,KAAK;QACL,WAAW,IAAA,yHAAE,EAAC,IAAA,oJAAc,KAAI;QAC/B,GAAG,KAAK;;;;;;AAGb,kBAAkB,WAAW,GAAG,qLAA2B,CAAC,WAAW;AAEvE,MAAM,kCAAoB,mNAAgB,CAGxC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,qLAA2B;QAC1B,KAAK;QACL,WAAW,IAAA,yHAAE,EACX,IAAA,oJAAc,EAAC;YAAE,SAAS;QAAU,IACpC,gBACA;QAED,GAAG,KAAK;;;;;;AAGb,kBAAkB,WAAW,GAAG,qLAA2B,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 140, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/T7/cometa/cometa-separated-projects/cometa-frontend-nextjs/src/hooks/use-teams.ts"],"sourcesContent":["import { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { toast } from \"sonner\";\nimport {\n  teamsApi,\n  type Crew,\n  type PaginatedResponse,\n} from \"@/lib/api-client\";\n\n// Query keys\nexport const teamKeys = {\n  all: [\"teams\"] as const,\n  crews: () => [...teamKeys.all, \"crews\"] as const,\n  crew: (id: string) => [...teamKeys.all, \"crew\", id] as const,\n};\n\n// Hooks\nexport function useTeams() {\n  return useQuery({\n    queryKey: teamKeys.crews(),\n    queryFn: async () => {\n      const response = await fetch('/api/crews');\n      if (!response.ok) {\n        throw new Error('Failed to fetch crews');\n      }\n      const data = await response.json();\n      return data.crews || [];\n    },\n    staleTime: 30 * 1000, // 30 seconds - frequent updates for team changes\n  });\n}\n\nexport function useCrew(id: string) {\n  return useQuery({\n    queryKey: teamKeys.crew(id),\n    queryFn: () => teamsApi.getCrew(id),\n    enabled: !!id,\n    staleTime: 5 * 60 * 1000,\n  });\n}\n\nexport function useCreateCrew() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: (data: Partial<Crew>) => teamsApi.createCrew(data),\n    onSuccess: (newCrew) => {\n      // Invalidate and refetch crews list\n      queryClient.invalidateQueries({ queryKey: teamKeys.crews() });\n\n      // Add the new crew to the cache\n      queryClient.setQueryData(teamKeys.crew(newCrew.id), newCrew);\n\n      toast.success(\"Team created successfully\");\n    },\n    onError: (error) => {\n      toast.error(`Failed to create team: ${error.message}`);\n    },\n  });\n}\n\nexport function useUpdateCrew() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: ({ id, data }: { id: string; data: Partial<Crew> }) =>\n      teamsApi.updateCrew(id, data),\n    onMutate: async ({ id, data }) => {\n      // Cancel any outgoing refetches\n      await queryClient.cancelQueries({ queryKey: teamKeys.crew(id) });\n\n      // Snapshot the previous value\n      const previousCrew = queryClient.getQueryData(teamKeys.crew(id));\n\n      // Optimistically update to the new value\n      queryClient.setQueryData(teamKeys.crew(id), (old: Crew | undefined) => {\n        if (!old) return old;\n        return { ...old, ...data };\n      });\n\n      // Return a context object with the snapshotted value\n      return { previousCrew };\n    },\n    onError: (error, { id }, context) => {\n      // If the mutation fails, use the context returned from onMutate to roll back\n      if (context?.previousCrew) {\n        queryClient.setQueryData(teamKeys.crew(id), context.previousCrew);\n      }\n      toast.error(`Failed to update team: ${error.message}`);\n    },\n    onSuccess: () => {\n      // Invalidate and refetch crews list\n      queryClient.invalidateQueries({ queryKey: teamKeys.crews() });\n      toast.success(\"Team updated successfully\");\n    },\n    onSettled: (data, error, { id }) => {\n      // Always refetch after error or success\n      queryClient.invalidateQueries({ queryKey: teamKeys.crew(id) });\n    },\n  });\n}\n\nexport function useDeleteCrew() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: (id: string) => teamsApi.deleteCrew(id),\n    onSuccess: (_, deletedId) => {\n      // Remove from cache\n      queryClient.removeQueries({ queryKey: teamKeys.crew(deletedId) });\n\n      // Invalidate crews list\n      queryClient.invalidateQueries({ queryKey: teamKeys.crews() });\n\n      toast.success(\"Team deleted successfully\");\n    },\n    onError: (error) => {\n      toast.error(`Failed to delete team: ${error.message}`);\n    },\n  });\n}\n\n// Additional interfaces for project preparation\nexport interface ProjectUser {\n  id: string;\n  name: string;\n  email: string;\n  role: string;\n  assigned_at: string;\n  assigned_by: string;\n}\n\nexport interface GlobalTeam {\n  id: string;\n  name: string;\n  foreman_name?: string;\n  is_active: boolean;\n  project_count?: number;\n  specialization?: string;\n}\n\n// Additional hooks for project preparation\nexport function useGlobalTeams() {\n  return useQuery({\n    queryKey: ['global-teams'],\n    queryFn: async (): Promise<GlobalTeam[]> => {\n      const response = await fetch('/api/crews');\n      if (!response.ok) {\n        throw new Error('Failed to fetch global teams');\n      }\n      const data = await response.json();\n      const crews = data.crews || [];\n\n      // Transform to GlobalTeam format and count projects per team\n      const projectCounts: Record<string, number> = {};\n      crews.forEach((crew: any) => {\n        if (crew.project_id) {\n          projectCounts[crew.name] = (projectCounts[crew.name] || 0) + 1;\n        }\n      });\n\n      return crews.map((crew: any) => ({\n        id: crew.id,\n        name: crew.name,\n        foreman_name: crew.foreman?.full_name || crew.foreman_name,\n        is_active: crew.status === 'active',\n        project_count: projectCounts[crew.name] || 0,\n        specialization: 'mixed'\n      }));\n    },\n  });\n}\n\nexport function useProjectUsers(projectId: string) {\n  return useQuery({\n    queryKey: ['project-users', projectId],\n    queryFn: async (): Promise<ProjectUser[]> => {\n      try {\n        const response = await fetch(`/api/projects/${projectId}/users`);\n        if (!response.ok) {\n          if (response.status === 404) {\n            return []; // No users assigned yet\n          }\n          throw new Error('Failed to fetch project users');\n        }\n        const data = await response.json();\n        return data.users || [];\n      } catch (error) {\n        console.warn('Project users not available:', error);\n        return []; // Return empty array instead of mock data\n      }\n    },\n    enabled: !!projectId,\n  });\n}\n\nexport function useForemenUsers() {\n  return useQuery({\n    queryKey: ['foremen-users'],\n    queryFn: async () => {\n      const response = await fetch('/api/users?role=foreman&is_active=true');\n      if (!response.ok) {\n        // Try to get PM users as well if no foremen\n        const pmResponse = await fetch('/api/users?role=pm&is_active=true');\n        if (!pmResponse.ok) {\n          throw new Error('Failed to fetch users');\n        }\n        const pmData = await pmResponse.json();\n        return pmData.items || [];\n      }\n      const data = await response.json();\n\n      // If no foremen, get both foremen and PMs\n      if (data.items.length === 0) {\n        const allResponse = await fetch('/api/users?is_active=true');\n        if (!allResponse.ok) {\n          throw new Error('Failed to fetch users');\n        }\n        const allData = await allResponse.json();\n        return (allData.items || []).filter((user: any) =>\n          user.role === 'foreman' || user.role === 'pm'\n        );\n      }\n\n      return data.items || [];\n    },\n  });\n}\n\nexport function useCreateTeam() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async (data: any) => {\n      const response = await fetch('/api/crews', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(data),\n      });\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'Failed to create team');\n      }\n\n      return response.json();\n    },\n    onSuccess: (data, variables) => {\n      if (variables.project_id) {\n        queryClient.invalidateQueries({ queryKey: ['project-teams', variables.project_id] });\n        queryClient.invalidateQueries({ queryKey: ['project-preparation', variables.project_id] });\n      }\n      queryClient.invalidateQueries({ queryKey: ['global-teams'] });\n      queryClient.invalidateQueries({ queryKey: teamKeys.crews() });\n      toast.success(data.message || 'Team created successfully');\n    },\n    onError: (error: Error) => {\n      toast.error(error.message);\n    },\n  });\n}\n\n// Specialized hooks\nexport function useProjectTeams(projectId: string) {\n  return useQuery({\n    queryKey: ['project-teams', projectId],\n    queryFn: async () => {\n      const response = await fetch(`/api/crews?project_id=${projectId}`);\n      if (!response.ok) {\n        throw new Error('Failed to fetch project teams');\n      }\n      const data = await response.json();\n      return data.crews || [];\n    },\n    enabled: !!projectId,\n  });\n}\n\nexport function useAvailableTeams() {\n  const { data: crews, ...rest } = useTeams();\n\n  return {\n    ...rest,\n    data: crews?.filter(crew => !crew.project_id) || [],\n  };\n}\n\nexport function useUpdateTeam() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async ({ id, data }: { id: string; data: any }) => {\n      const response = await fetch(`/api/crews/${id}`, {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(data),\n      });\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'Failed to update team');\n      }\n\n      return response.json();\n    },\n    onSuccess: (data, variables) => {\n      queryClient.invalidateQueries({ queryKey: ['project-teams'] });\n      queryClient.invalidateQueries({ queryKey: ['global-teams'] });\n      queryClient.invalidateQueries({ queryKey: teamKeys.crews() });\n      queryClient.invalidateQueries({ queryKey: ['project-preparation'] });\n      toast.success(data.message || 'Team updated successfully');\n    },\n    onError: (error: Error) => {\n      toast.error(error.message);\n    },\n  });\n}\n\nexport function useDeleteTeam() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async (id: string) => {\n      const response = await fetch(`/api/crews/${id}`, {\n        method: 'DELETE',\n      });\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'Failed to delete team');\n      }\n\n      return response.json();\n    },\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: ['project-teams'] });\n      queryClient.invalidateQueries({ queryKey: ['global-teams'] });\n      queryClient.invalidateQueries({ queryKey: teamKeys.crews() });\n      queryClient.invalidateQueries({ queryKey: ['project-preparation'] });\n      toast.success(data.message || 'Team deleted successfully');\n    },\n    onError: (error: Error) => {\n      toast.error(error.message);\n    },\n  });\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 540, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/T7/cometa/cometa-separated-projects/cometa-frontend-nextjs/src/hooks/use-users.ts"],"sourcesContent":["import { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { toast } from \"sonner\";\nimport {\n  usersApi,\n  type User,\n  type PaginatedResponse,\n} from \"@/lib/api-client\";\n\n// Query keys\nexport const userKeys = {\n  all: [\"users\"] as const,\n  lists: () => [...userKeys.all, \"list\"] as const,\n  list: (filters: any) => [...userKeys.lists(), filters] as const,\n  details: () => [...userKeys.all, \"detail\"] as const,\n  detail: (id: string) => [...userKeys.details(), id] as const,\n};\n\n// Hooks\nexport function useUsers(filters?: { role?: string; page?: number; per_page?: number }) {\n  return useQuery({\n    queryKey: userKeys.list(filters || {}),\n    queryFn: () => usersApi.getUsers(filters),\n    staleTime: 5 * 60 * 1000, // 5 minutes\n  });\n}\n\nexport function useUser(id: string) {\n  return useQuery({\n    queryKey: userKeys.detail(id),\n    queryFn: () => usersApi.getUser(id),\n    enabled: !!id,\n    staleTime: 5 * 60 * 1000,\n  });\n}\n\nexport function useCreateUser() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: (data: Partial<User>) => usersApi.createUser(data),\n    onSuccess: (newUser) => {\n      // Invalidate and refetch users list\n      queryClient.invalidateQueries({ queryKey: userKeys.lists() });\n\n      // Add the new user to the cache\n      queryClient.setQueryData(userKeys.detail(newUser.id), newUser);\n\n      toast.success(\"User created successfully\");\n    },\n    onError: (error) => {\n      toast.error(`Failed to create user: ${error.message}`);\n    },\n  });\n}\n\nexport function useUpdateUser() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: ({ id, data }: { id: string; data: Partial<User> }) =>\n      usersApi.updateUser(id, data),\n    onMutate: async ({ id, data }) => {\n      // Cancel any outgoing refetches\n      await queryClient.cancelQueries({ queryKey: userKeys.detail(id) });\n\n      // Snapshot the previous value\n      const previousUser = queryClient.getQueryData(userKeys.detail(id));\n\n      // Optimistically update to the new value\n      queryClient.setQueryData(userKeys.detail(id), (old: User | undefined) => {\n        if (!old) return old;\n        return { ...old, ...data };\n      });\n\n      // Return a context object with the snapshotted value\n      return { previousUser };\n    },\n    onError: (error, { id }, context) => {\n      // If the mutation fails, use the context returned from onMutate to roll back\n      if (context?.previousUser) {\n        queryClient.setQueryData(userKeys.detail(id), context.previousUser);\n      }\n      toast.error(`Failed to update user: ${error.message}`);\n    },\n    onSuccess: () => {\n      // Invalidate and refetch users list\n      queryClient.invalidateQueries({ queryKey: userKeys.lists() });\n      toast.success(\"User updated successfully\");\n    },\n    onSettled: (data, error, { id }) => {\n      // Always refetch after error or success\n      queryClient.invalidateQueries({ queryKey: userKeys.detail(id) });\n    },\n  });\n}\n\nexport function useDeleteUser() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: (id: string) => usersApi.deleteUser(id),\n    onSuccess: (_, deletedId) => {\n      // Remove from cache\n      queryClient.removeQueries({ queryKey: userKeys.detail(deletedId) });\n\n      // Invalidate users list\n      queryClient.invalidateQueries({ queryKey: userKeys.lists() });\n\n      toast.success(\"User deleted successfully\");\n    },\n    onError: (error) => {\n      toast.error(`Failed to delete user: ${error.message}`);\n    },\n  });\n}\n\n// Specialized hooks for common use cases\nexport function useWorkers() {\n  return useUsers({\n    role: \"crew,worker,foreman\",\n    page: 1,\n    per_page: 100,\n  });\n}\n\nexport function useForemen() {\n  return useUsers({\n    role: \"foreman\",\n    page: 1,\n    per_page: 50,\n  });\n}\n\nexport function useProjectManagers() {\n  return useUsers({\n    role: \"pm\",\n    page: 1,\n    per_page: 50,\n  });\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 713, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/T7/cometa/cometa-separated-projects/cometa-frontend-nextjs/src/hooks/use-projects.ts"],"sourcesContent":["import { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { toast } from \"sonner\";\nimport {\n  projectsApi,\n  type Project,\n  type ProjectFilters,\n  type CreateProjectRequest,\n  type UpdateProjectRequest,\n  type PaginatedResponse,\n} from \"@/lib/api-client\";\n\n// Query keys\nexport const projectKeys = {\n  all: [\"projects\"] as const,\n  lists: () => [...projectKeys.all, \"list\"] as const,\n  list: (filters: ProjectFilters) => [...projectKeys.lists(), filters] as const,\n  details: () => [...projectKeys.all, \"detail\"] as const,\n  detail: (id: string) => [...projectKeys.details(), id] as const,\n};\n\n// Hooks\nexport function useProjects(filters?: ProjectFilters) {\n  return useQuery({\n    queryKey: projectKeys.list(filters || {}),\n    queryFn: () => projectsApi.getProjects(filters),\n    staleTime: 5 * 60 * 1000, // 5 minutes\n  });\n}\n\nexport function useProject(id: string) {\n  return useQuery({\n    queryKey: projectKeys.detail(id),\n    queryFn: () => projectsApi.getProject(id),\n    enabled: !!id,\n    staleTime: 5 * 60 * 1000, // 5 minutes\n  });\n}\n\nexport function useCreateProject() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: (data: CreateProjectRequest) => projectsApi.createProject(data),\n    onSuccess: (newProject) => {\n      // Invalidate and refetch projects list\n      queryClient.invalidateQueries({ queryKey: projectKeys.lists() });\n\n      // Add the new project to the cache\n      queryClient.setQueryData(projectKeys.detail(newProject.id), newProject);\n\n      toast.success(\"Project created successfully\");\n    },\n    onError: (error) => {\n      toast.error(`Failed to create project: ${error.message}`);\n    },\n  });\n}\n\nexport function useUpdateProject() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: ({ id, data }: { id: string; data: UpdateProjectRequest }) =>\n      projectsApi.updateProject(id, data),\n    onMutate: async ({ id, data }) => {\n      // Cancel any outgoing refetches\n      await queryClient.cancelQueries({ queryKey: projectKeys.detail(id) });\n\n      // Snapshot the previous value\n      const previousProject = queryClient.getQueryData(projectKeys.detail(id));\n\n      // Optimistically update to the new value\n      queryClient.setQueryData(projectKeys.detail(id), (old: Project | undefined) => {\n        if (!old) return old;\n        return { ...old, ...data };\n      });\n\n      // Return a context object with the snapshotted value\n      return { previousProject };\n    },\n    onError: (error, { id }, context) => {\n      // If the mutation fails, use the context returned from onMutate to roll back\n      if (context?.previousProject) {\n        queryClient.setQueryData(projectKeys.detail(id), context.previousProject);\n      }\n      toast.error(`Failed to update project: ${error.message}`);\n    },\n    onSuccess: (updatedProject) => {\n      // Invalidate and refetch projects list\n      queryClient.invalidateQueries({ queryKey: projectKeys.lists() });\n      toast.success(\"Project updated successfully\");\n    },\n    onSettled: (data, error, { id }) => {\n      // Always refetch after error or success\n      queryClient.invalidateQueries({ queryKey: projectKeys.detail(id) });\n    },\n  });\n}\n\nexport function useDeleteProject() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: (id: string) => projectsApi.deleteProject(id),\n    onSuccess: (_, deletedId) => {\n      // Remove from cache\n      queryClient.removeQueries({ queryKey: projectKeys.detail(deletedId) });\n\n      // Invalidate projects list\n      queryClient.invalidateQueries({ queryKey: projectKeys.lists() });\n\n      toast.success(\"Project deleted successfully\");\n    },\n    onError: (error) => {\n      toast.error(`Failed to delete project: ${error.message}`);\n    },\n  });\n}\n\n// Optimistic mutations for better UX\nexport function useOptimisticProjectUpdate() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: ({ id, data }: { id: string; data: Partial<Project> }) =>\n      projectsApi.updateProject(id, data),\n    onMutate: async ({ id, data }) => {\n      await queryClient.cancelQueries({ queryKey: projectKeys.detail(id) });\n\n      const previousProject = queryClient.getQueryData(projectKeys.detail(id));\n\n      queryClient.setQueryData(projectKeys.detail(id), (old: Project | undefined) => {\n        if (!old) return old;\n        return { ...old, ...data };\n      });\n\n      // Also update in lists if present\n      queryClient.setQueriesData(\n        { queryKey: projectKeys.lists() },\n        (old: PaginatedResponse<Project> | undefined) => {\n          if (!old) return old;\n\n          return {\n            ...old,\n            items: old.items.map((project) =>\n              project.id === id ? { ...project, ...data } : project\n            ),\n          };\n        }\n      );\n\n      return { previousProject };\n    },\n    onError: (error, { id }, context) => {\n      if (context?.previousProject) {\n        queryClient.setQueryData(projectKeys.detail(id), context.previousProject);\n      }\n      // Invalidate lists to revert optimistic updates\n      queryClient.invalidateQueries({ queryKey: projectKeys.lists() });\n      toast.error(`Failed to update project: ${error.message}`);\n    },\n    onSuccess: () => {\n      toast.success(\"Project updated successfully\");\n    },\n  });\n}\n\n// Project statistics hook\nexport interface ProjectStats {\n  progress: {\n    totalLength: number;\n    completedLength: number;\n    progressPercentage: number;\n    workEntries: number;\n    pendingApprovals: number;\n    teamMembers: number;\n    materialsCount: number;\n  };\n  phase: {\n    currentPhase: number;\n    totalPhases: number;\n    phaseName: string;\n    phaseProgress: number;\n  };\n  financial: {\n    projectBudget: number;\n    totalSpent: number;\n    spentPercentage: number;\n    remainingBudget: number;\n  };\n}\n\nexport function useProjectStats(projectId: string) {\n  return useQuery({\n    queryKey: [...projectKeys.detail(projectId), \"stats\"],\n    queryFn: async (): Promise<ProjectStats> => {\n      const response = await fetch(`/api/projects/${projectId}/stats`);\n      if (!response.ok) {\n        throw new Error('Failed to fetch project statistics');\n      }\n      return response.json();\n    },\n    staleTime: 2 * 60 * 1000, // 2 minutes - stats change more frequently\n    enabled: !!projectId,\n  });\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 928, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/T7/cometa/cometa-separated-projects/cometa-frontend-nextjs/src/hooks/use-equipment.ts"],"sourcesContent":["import { useMutation, useQuery, useQueryClient } from '@tanstack/react-query';\nimport { toast } from 'sonner';\n\nexport interface Equipment {\n  id: string;\n  type: 'machine' | 'tool' | 'measuring_device';\n  name: string;\n  inventory_no?: string;\n  owned: boolean;\n  status: 'available' | 'in_use' | 'maintenance' | 'broken';\n  purchase_price_eur: number;\n  rental_price_per_day_eur: number;\n  rental_price_per_hour_eur: number;\n  current_location?: string;\n  quantity?: number; // Available quantity in inventory\n}\n\nexport interface EquipmentAssignment {\n  id: string;\n  equipment_id: string;\n  resource_id?: string; // For unified assignments\n  project_id?: string; // Now optional - crew-based logic\n  cabinet_id?: string;\n  crew_id: string; // Now required - crew-based logic\n  from_ts: string;\n  to_ts?: string;\n  is_permanent: boolean;\n  rental_cost_per_day: number;\n  equipment: {\n    name: string;\n    type: string;\n    inventory_no?: string;\n  };\n  project_name?: string;\n  crew_name?: string;\n  is_active: boolean;\n  assignment_type?: 'equipment' | 'vehicle'; // For unified assignments\n  resource_type?: 'equipment' | 'vehicle'; // For UI distinction\n}\n\nexport interface CreateEquipmentData {\n  type: string;\n  name: string;\n  inventory_no?: string;\n  owned?: boolean;\n  status?: string;\n  purchase_price_eur?: number;\n  rental_price_per_day_eur?: number;\n  rental_price_per_hour_eur?: number;\n  current_location?: string;\n}\n\nexport interface CreateAssignmentData {\n  equipment_id: string;\n  project_id?: string; // Now optional - crew-based logic\n  cabinet_id?: string;\n  crew_id: string; // Now required - crew-based logic\n  from_ts: string;\n  to_ts?: string;\n  is_permanent?: boolean;\n  rental_cost_per_day?: number;\n}\n\nexport interface EquipmentAnalytics {\n  overview: {\n    totalHours: number;\n    efficiencyScore: number;\n    downtimeRate: number;\n    revenueGenerated: number;\n  };\n  statusDistribution: {\n    name: string;\n    value: number;\n    color: string;\n  }[];\n  utilization: {\n    name: string;\n    hours: number;\n    revenue: number;\n    assignments: number;\n  }[];\n  assignments: {\n    total: number;\n    active: number;\n    averageDailyCost: number;\n    totalDailyRevenue: number;\n    averageDuration: number;\n  };\n  equipment: {\n    totalCount: number;\n    byType: Record<string, { count: number; value: number }>;\n    byStatus: Record<string, number>;\n  };\n}\n\ninterface EquipmentFilters {\n  type?: string;\n  status?: string;\n  owned?: string;\n  search?: string;\n  page?: number;\n  per_page?: number;\n}\n\ninterface AssignmentFilters {\n  equipment_id?: string;\n  project_id?: string;\n  crew_id?: string;\n  active_only?: boolean;\n}\n\nconst api = {\n  getEquipment: async (filters?: EquipmentFilters): Promise<{ items: Equipment[]; total: number; page: number; per_page: number; total_pages: number }> => {\n    const params = new URLSearchParams();\n    if (filters?.type) params.append('type', filters.type);\n    if (filters?.status) params.append('status', filters.status);\n    if (filters?.owned) params.append('owned', filters.owned);\n    if (filters?.search) params.append('search', filters.search);\n    if (filters?.page) params.append('page', filters.page.toString());\n    if (filters?.per_page) params.append('per_page', filters.per_page.toString());\n\n    const url = `/api/equipment${params.toString() ? `?${params.toString()}` : ''}`;\n    const response = await fetch(url);\n\n    if (!response.ok) {\n      throw new Error('Failed to fetch equipment');\n    }\n\n    return response.json();\n  },\n\n  getEquipmentItem: async (id: string): Promise<Equipment> => {\n    const response = await fetch(`/api/equipment/${id}`);\n\n    if (!response.ok) {\n      throw new Error('Failed to fetch equipment');\n    }\n\n    return response.json();\n  },\n\n  createEquipment: async (data: CreateEquipmentData): Promise<Equipment> => {\n    const response = await fetch('/api/equipment', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(data),\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.error || 'Failed to create equipment');\n    }\n\n    return response.json();\n  },\n\n  updateEquipment: async (id: string, data: Partial<Equipment>): Promise<{ success: boolean }> => {\n    const response = await fetch(`/api/equipment/${id}`, {\n      method: 'PUT',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(data),\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.error || 'Failed to update equipment');\n    }\n\n    return response.json();\n  },\n\n  deleteEquipment: async (id: string): Promise<{ success: boolean }> => {\n    const response = await fetch(`/api/equipment/${id}`, {\n      method: 'DELETE',\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.error || 'Failed to delete equipment');\n    }\n\n    return response.json();\n  },\n\n  getAssignments: async (filters?: AssignmentFilters): Promise<EquipmentAssignment[]> => {\n    const params = new URLSearchParams();\n    if (filters?.equipment_id) params.append('equipment_id', filters.equipment_id);\n    if (filters?.project_id) params.append('project_id', filters.project_id);\n    if (filters?.crew_id) params.append('crew_id', filters.crew_id);\n    if (filters?.active_only) params.append('active_only', filters.active_only.toString());\n\n    // Use our new equipment assignments API\n    const url = `/api/equipment/assignments${params.toString() ? `?${params.toString()}` : ''}`;\n    const response = await fetch(url);\n\n    if (!response.ok) {\n      throw new Error('Failed to fetch equipment assignments');\n    }\n\n    const data = await response.json();\n\n    // Transform our API response to match expected format\n    const assignments = data.items || data;\n\n    // For now, use basic transformation. TODO: Enhance with actual equipment/crew names\n    return assignments.map((assignment: any) => ({\n      id: assignment.id,\n      equipment_id: assignment.equipment_id || assignment.resource_id,\n      project_id: assignment.project_id,\n      crew_id: assignment.crew_id,\n      from_ts: assignment.assigned_at,\n      to_ts: assignment.returned_at,\n      is_permanent: !assignment.returned_at, // If no return date, consider permanent\n      rental_cost_per_day: assignment.daily_rental_cost || 0,\n      equipment: {\n        name: assignment.equipment_name || `Equipment ${assignment.equipment_id?.slice(-8) || 'Unknown'}`,\n        type: assignment.resource_type || 'equipment',\n        inventory_no: assignment.equipment_id\n      },\n      project_name: assignment.project_name || (assignment.project_id ? `Project ${assignment.project_id.slice(-8)}` : undefined),\n      crew_name: assignment.crew_name || (assignment.crew_id ? `Crew ${assignment.crew_id.slice(-8)}` : undefined),\n      is_active: !assignment.returned_at,\n      assignment_type: assignment.resource_type,\n      resource_type: assignment.resource_type,\n      notes: assignment.notes\n    }));\n  },\n\n  createAssignment: async (data: CreateAssignmentData): Promise<{ success: boolean; assignment_id: string; message: string }> => {\n    const response = await fetch('/api/resources/equipment-assignments', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(data),\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.error || 'Failed to create assignment');\n    }\n\n    return response.json();\n  },\n\n  updateAssignment: async (id: string, data: Partial<EquipmentAssignment>): Promise<{ success: boolean; message: string }> => {\n    const response = await fetch(`/api/resources/equipment-assignments/${id}`, {\n      method: 'PUT',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(data),\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.error || 'Failed to update assignment');\n    }\n\n    return response.json();\n  },\n\n  deleteAssignment: async (id: string): Promise<{ success: boolean; message: string }> => {\n    const response = await fetch(`/api/resources/equipment-assignments/${id}`, {\n      method: 'DELETE',\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.error || 'Failed to delete assignment');\n    }\n\n    return response.json();\n  },\n\n  getAnalytics: async (): Promise<EquipmentAnalytics> => {\n    const response = await fetch('/api/equipment/analytics');\n\n    if (!response.ok) {\n      throw new Error('Failed to fetch equipment analytics');\n    }\n\n    return response.json();\n  },\n};\n\nexport function useEquipment(filters?: EquipmentFilters) {\n  return useQuery({\n    queryKey: ['equipment', filters],\n    queryFn: () => api.getEquipment(filters),\n  });\n}\n\nexport function useEquipmentItem(id: string) {\n  return useQuery({\n    queryKey: ['equipment', id],\n    queryFn: () => api.getEquipmentItem(id),\n    enabled: !!id,\n  });\n}\n\nexport function useCreateEquipment() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: api.createEquipment,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['equipment'] });\n      toast.success('Equipment created successfully');\n    },\n    onError: (error: Error) => {\n      toast.error(error.message);\n    },\n  });\n}\n\nexport function useUpdateEquipment() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: ({ id, data }: { id: string; data: Partial<Equipment> }) =>\n      api.updateEquipment(id, data),\n    onSuccess: (_, { id }) => {\n      queryClient.invalidateQueries({ queryKey: ['equipment'] });\n      queryClient.invalidateQueries({ queryKey: ['equipment', id] });\n      toast.success('Equipment updated successfully');\n    },\n    onError: (error: Error) => {\n      toast.error(error.message);\n    },\n  });\n}\n\nexport function useDeleteEquipment() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: api.deleteEquipment,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['equipment'] });\n      toast.success('Equipment deleted successfully');\n    },\n    onError: (error: Error) => {\n      toast.error(error.message);\n    },\n  });\n}\n\nexport function useEquipmentAssignments(filters?: AssignmentFilters) {\n  return useQuery({\n    queryKey: ['equipment-assignments', filters],\n    queryFn: () => api.getAssignments(filters),\n    staleTime: 30 * 1000, // 30 seconds - crew assignments change frequently\n  });\n}\n\nexport function useCreateAssignment() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: api.createAssignment,\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: ['equipment-assignments'] });\n      queryClient.invalidateQueries({ queryKey: ['equipment'] });\n      queryClient.invalidateQueries({ queryKey: ['crews'] }); // Also invalidate crew queries\n      toast.success(data.message || 'Assignment created successfully');\n    },\n    onError: (error: Error) => {\n      // Enhanced error handling for crew validation\n      if (error.message.includes('Crew not found') || error.message.includes('CREW_NOT_FOUND')) {\n        toast.error('Selected crew is not found or inactive. Please select a valid crew.');\n      } else if (error.message.includes('crew_id') || error.message.includes('Crew ID')) {\n        toast.error('Crew selection is required. Please select a crew for this assignment.');\n      } else {\n        toast.error(error.message);\n      }\n    },\n  });\n}\n\nexport function useUpdateAssignment() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: ({ id, data }: { id: string; data: Partial<EquipmentAssignment> }) =>\n      api.updateAssignment(id, data),\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: ['equipment-assignments'] });\n      queryClient.invalidateQueries({ queryKey: ['equipment'] });\n      toast.success(data.message || 'Assignment updated successfully');\n    },\n    onError: (error: Error) => {\n      toast.error(error.message);\n    },\n  });\n}\n\nexport function useDeleteAssignment() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: api.deleteAssignment,\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: ['equipment-assignments'] });\n      queryClient.invalidateQueries({ queryKey: ['equipment'] });\n      toast.success(data.message || 'Assignment deleted successfully');\n    },\n    onError: (error: Error) => {\n      toast.error(error.message);\n    },\n  });\n}\n\nexport function useEquipmentAnalytics() {\n  return useQuery({\n    queryKey: ['equipment-analytics'],\n    queryFn: () => api.getAnalytics(),\n    staleTime: 5 * 60 * 1000, // 5 minutes\n  });\n}\n\n// New hook for crew-based equipment assignments (only equipment)\nexport function useCrewEquipmentAssignments(crew_id?: string) {\n  return useQuery({\n    queryKey: ['equipment-assignments', 'crew', crew_id],\n    queryFn: async () => {\n      const response = await fetch(`/api/resources/equipment-assignments?crew_id=${crew_id}&active_only=true`);\n      if (!response.ok) {\n        throw new Error('Failed to fetch equipment assignments');\n      }\n      return response.json();\n    },\n    enabled: !!crew_id,\n    staleTime: 30 * 1000, // 30 seconds - crew assignments change frequently\n  });\n}\n\n// Hook for getting equipment assignments by project (filtered through crew assignments)\nexport function useProjectEquipmentAssignments(project_id?: string) {\n  return useQuery({\n    queryKey: ['equipment-assignments', 'project', project_id],\n    queryFn: () => api.getAssignments({ project_id }),\n    enabled: !!project_id,\n    staleTime: 60 * 1000, // 1 minute - project assignments are more stable\n  });\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1314, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/T7/cometa/cometa-separated-projects/cometa-frontend-nextjs/src/hooks/use-vehicles.ts"],"sourcesContent":["import { useMutation, useQuery, useQueryClient } from '@tanstack/react-query';\nimport { toast } from 'sonner';\n\nexport interface Vehicle {\n  id: string;\n  brand: string;\n  model: string;\n  plate_number: string;\n  type: 'van' | 'truck' | 'trailer' | 'excavator' | 'other' | 'car';\n  status: 'available' | 'in_use' | 'maintenance' | 'broken';\n  rental_cost_per_day: number;\n  fuel_type?: string;\n  year_manufactured?: number;\n  description?: string;\n  is_active: boolean;\n  full_name?: string;\n  age?: number;\n  current_assignment?: any;\n  assignments_count?: number;\n  created_at?: string;\n  updated_at?: string;\n}\n\nexport interface VehicleAssignment {\n  id: string;\n  vehicle_id: string;\n  project_id?: string; // Now optional - crew-based logic\n  crew_id: string; // Now required - crew-based logic\n  from_ts: string;\n  to_ts?: string;\n  is_permanent: boolean;\n  rental_cost_per_day: number;\n  vehicle: {\n    brand: string;\n    model: string;\n    plate_number: string;\n    type: string;\n  };\n  project_name?: string;\n  crew_name?: string;\n  is_active: boolean;\n}\n\nexport interface CreateVehicleData {\n  brand: string;\n  model: string;\n  plate_number: string;\n  type: string;\n  status?: string;\n  rental_cost_per_day?: number;\n  fuel_type?: string;\n  year_manufactured?: number;\n  description?: string;\n}\n\nexport interface CreateVehicleAssignmentData {\n  vehicle_id: string;\n  project_id?: string; // Now optional - crew-based logic\n  crew_id: string; // Now required - crew-based logic\n  from_ts: string;\n  to_ts?: string;\n  is_permanent?: boolean;\n  rental_cost_per_day?: number;\n}\n\nexport interface VehicleAnalytics {\n  overview: {\n    totalHours: number;\n    efficiencyScore: number;\n    downtimeRate: number;\n    revenueGenerated: number;\n  };\n  statusDistribution: {\n    name: string;\n    value: number;\n    color: string;\n  }[];\n  utilization: {\n    name: string;\n    hours: number;\n    revenue: number;\n    assignments: number;\n  }[];\n  assignments: {\n    total: number;\n    active: number;\n    averageDailyCost: number;\n    totalDailyRevenue: number;\n    averageDuration: number;\n  };\n  vehicles: {\n    totalCount: number;\n    byType: Record<string, { count: number; value: number }>;\n    byStatus: Record<string, number>;\n  };\n}\n\ninterface VehicleFilters {\n  type?: string;\n  status?: string;\n  owned?: string;\n  search?: string;\n  page?: number;\n  per_page?: number;\n}\n\ninterface VehicleAssignmentFilters {\n  vehicle_id?: string;\n  project_id?: string;\n  crew_id?: string;\n  active_only?: boolean;\n}\n\nconst api = {\n  getVehicles: async (filters?: VehicleFilters): Promise<{ items: Vehicle[]; total: number; page: number; per_page: number; total_pages: number }> => {\n    const params = new URLSearchParams();\n    if (filters?.type) params.append('type', filters.type);\n    if (filters?.status) params.append('status', filters.status);\n    if (filters?.owned) params.append('owned', filters.owned);\n    if (filters?.search) params.append('search', filters.search);\n    if (filters?.page) params.append('page', filters.page.toString());\n    if (filters?.per_page) params.append('per_page', filters.per_page.toString());\n\n    const url = `/api/vehicles${params.toString() ? `?${params.toString()}` : ''}`;\n    const response = await fetch(url);\n\n    if (!response.ok) {\n      throw new Error('Failed to fetch vehicles');\n    }\n\n    const data = await response.json();\n\n    // Transform the API response to match expected format\n    return {\n      items: data.vehicles || [],\n      total: data.pagination?.total || 0,\n      page: data.pagination?.page || 1,\n      per_page: data.pagination?.per_page || 20,\n      total_pages: data.pagination?.total_pages || 1\n    };\n  },\n\n  getVehicle: async (id: string): Promise<Vehicle> => {\n    const response = await fetch(`/api/vehicles/${id}`);\n\n    if (!response.ok) {\n      throw new Error('Failed to fetch vehicle');\n    }\n\n    return response.json();\n  },\n\n  createVehicle: async (data: CreateVehicleData): Promise<Vehicle> => {\n    const response = await fetch('/api/vehicles', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(data),\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.error || 'Failed to create vehicle');\n    }\n\n    const result = await response.json();\n    return result.vehicle || result;\n  },\n\n  updateVehicle: async (id: string, data: Partial<Vehicle>): Promise<{ success: boolean }> => {\n    const response = await fetch(`/api/vehicles/${id}`, {\n      method: 'PUT',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(data),\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.error || 'Failed to update vehicle');\n    }\n\n    return response.json();\n  },\n\n  deleteVehicle: async (id: string): Promise<{ success: boolean }> => {\n    const response = await fetch(`/api/vehicles/${id}`, {\n      method: 'DELETE',\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.error || 'Failed to delete vehicle');\n    }\n\n    return response.json();\n  },\n\n  getVehicleAssignments: async (filters?: VehicleAssignmentFilters): Promise<VehicleAssignment[]> => {\n    const params = new URLSearchParams();\n    if (filters?.vehicle_id) params.append('vehicle_id', filters.vehicle_id);\n    if (filters?.project_id) params.append('project_id', filters.project_id);\n    if (filters?.crew_id) params.append('crew_id', filters.crew_id);\n    if (filters?.active_only) params.append('active_only', filters.active_only.toString());\n\n    // Use new vehicles/assignments endpoint for crew-based logic\n    const url = `/api/resources/vehicle-assignments${params.toString() ? `?${params.toString()}` : ''}`;\n    const response = await fetch(url);\n\n    if (!response.ok) {\n      throw new Error('Failed to fetch vehicle assignments');\n    }\n\n    return response.json();\n  },\n\n  createVehicleAssignment: async (data: CreateVehicleAssignmentData): Promise<{ success: boolean; assignment_id: string; message: string }> => {\n    // Use new vehicles/assignments endpoint with crew-based logic\n    const response = await fetch('/api/resources/vehicle-assignments', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        vehicle_id: data.vehicle_id,\n        crew_id: data.crew_id, // Now required\n        project_id: data.project_id, // Now optional\n        from_ts: data.from_ts,\n        to_ts: data.to_ts,\n        is_permanent: data.is_permanent || false,\n        rental_cost_per_day: data.rental_cost_per_day\n      }),\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.error || 'Failed to create vehicle assignment');\n    }\n\n    return response.json();\n  },\n\n  updateVehicleAssignment: async (id: string, data: Partial<VehicleAssignment>): Promise<{ success: boolean; message: string }> => {\n    // Use new vehicles/assignments endpoint\n    const response = await fetch(`/api/resources/vehicle-assignments/${id}`, {\n      method: 'PUT',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(data),\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.error || 'Failed to update vehicle assignment');\n    }\n\n    return response.json();\n  },\n\n  deleteVehicleAssignment: async (id: string): Promise<{ success: boolean; message: string }> => {\n    // Use new vehicles/assignments endpoint\n    const response = await fetch(`/api/resources/vehicle-assignments/${id}`, {\n      method: 'DELETE',\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.error || 'Failed to delete vehicle assignment');\n    }\n\n    return response.json();\n  },\n\n  getAvailableVehicles: async (): Promise<Vehicle[]> => {\n    const response = await fetch('/api/resources/vehicles/available');\n\n    if (!response.ok) {\n      throw new Error('Failed to fetch available vehicles');\n    }\n\n    return response.json();\n  },\n\n  getVehicleAnalytics: async (): Promise<VehicleAnalytics> => {\n    const response = await fetch('/api/vehicles/analytics');\n\n    if (!response.ok) {\n      throw new Error('Failed to fetch vehicle analytics');\n    }\n\n    return response.json();\n  },\n};\n\nexport function useVehicles(filters?: VehicleFilters) {\n  return useQuery({\n    queryKey: ['vehicles', filters],\n    queryFn: () => api.getVehicles(filters),\n  });\n}\n\nexport function useVehicle(id: string) {\n  return useQuery({\n    queryKey: ['vehicles', id],\n    queryFn: () => api.getVehicle(id),\n    enabled: !!id,\n  });\n}\n\nexport function useCreateVehicle() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: api.createVehicle,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['vehicles'] });\n      toast.success('Vehicle created successfully');\n    },\n    onError: (error: Error) => {\n      toast.error(error.message);\n    },\n  });\n}\n\nexport function useUpdateVehicle() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: ({ id, data }: { id: string; data: Partial<Vehicle> }) =>\n      api.updateVehicle(id, data),\n    onSuccess: (_, { id }) => {\n      queryClient.invalidateQueries({ queryKey: ['vehicles'] });\n      queryClient.invalidateQueries({ queryKey: ['vehicles', id] });\n      toast.success('Vehicle updated successfully');\n    },\n    onError: (error: Error) => {\n      toast.error(error.message);\n    },\n  });\n}\n\nexport function useDeleteVehicle() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: api.deleteVehicle,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['vehicles'] });\n      toast.success('Vehicle deleted successfully');\n    },\n    onError: (error: Error) => {\n      toast.error(error.message);\n    },\n  });\n}\n\nexport function useVehicleAssignments(filters?: VehicleAssignmentFilters) {\n  return useQuery({\n    queryKey: ['vehicle-assignments', filters],\n    queryFn: () => api.getVehicleAssignments(filters),\n    staleTime: 30 * 1000, // 30 seconds - crew assignments change frequently\n  });\n}\n\nexport function useCreateVehicleAssignment() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: api.createVehicleAssignment,\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: ['vehicle-assignments'] });\n      queryClient.invalidateQueries({ queryKey: ['vehicles'] });\n      queryClient.invalidateQueries({ queryKey: ['crews'] }); // Also invalidate crew queries\n      toast.success(data.message || 'Vehicle assignment created successfully');\n    },\n    onError: (error: Error) => {\n      // Enhanced error handling for crew validation\n      if (error.message.includes('Crew not found') || error.message.includes('CREW_NOT_FOUND')) {\n        toast.error('Selected crew is not found or inactive. Please select a valid crew.');\n      } else if (error.message.includes('crew_id') || error.message.includes('Crew ID')) {\n        toast.error('Crew selection is required. Please select a crew for this assignment.');\n      } else {\n        toast.error(error.message);\n      }\n    },\n  });\n}\n\nexport function useUpdateVehicleAssignment() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: ({ id, data }: { id: string; data: Partial<VehicleAssignment> }) =>\n      api.updateVehicleAssignment(id, data),\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: ['vehicle-assignments'] });\n      queryClient.invalidateQueries({ queryKey: ['vehicles'] });\n      toast.success(data.message || 'Vehicle assignment updated successfully');\n    },\n    onError: (error: Error) => {\n      toast.error(error.message);\n    },\n  });\n}\n\nexport function useDeleteVehicleAssignment() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: api.deleteVehicleAssignment,\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: ['vehicle-assignments'] });\n      queryClient.invalidateQueries({ queryKey: ['vehicles'] });\n      toast.success(data.message || 'Vehicle assignment deleted successfully');\n    },\n    onError: (error: Error) => {\n      toast.error(error.message);\n    },\n  });\n}\n\nexport function useAvailableVehicles() {\n  return useQuery({\n    queryKey: ['vehicles', 'available'],\n    queryFn: () => api.getAvailableVehicles(),\n    staleTime: 30 * 1000, // 30 seconds\n  });\n}\n\nexport function useVehicleAnalytics() {\n  return useQuery({\n    queryKey: ['vehicle-analytics'],\n    queryFn: () => api.getVehicleAnalytics(),\n    staleTime: 5 * 60 * 1000, // 5 minutes\n  });\n}\n\n// New hook for crew-based vehicle assignments (only vehicles)\nexport function useCrewVehicleAssignments(crew_id?: string) {\n  return useQuery({\n    queryKey: ['vehicle-assignments', 'crew', crew_id],\n    queryFn: async () => {\n      const response = await fetch(`/api/resources/vehicle-assignments?crew_id=${crew_id}&active_only=true`);\n      if (!response.ok) {\n        throw new Error('Failed to fetch vehicle assignments');\n      }\n      return response.json();\n    },\n    enabled: !!crew_id,\n    staleTime: 30 * 1000, // 30 seconds - crew assignments change frequently\n  });\n}\n\n// Hook for getting vehicle assignments by project (filtered through crew assignments)\nexport function useProjectVehicleAssignments(project_id?: string) {\n  return useQuery({\n    queryKey: ['vehicle-assignments', 'project', project_id],\n    queryFn: () => api.getVehicleAssignments({ project_id }),\n    enabled: !!project_id,\n    staleTime: 60 * 1000, // 1 minute - project assignments are more stable\n  });\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1715, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/T7/cometa/cometa-separated-projects/cometa-frontend-nextjs/src/components/ui/textarea.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n"],"names":[],"mappings":";;;;;AAAA;AAEA;;;;AAEA,MAAM,yBAAW,mNAAgB,CAG/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE;IAC1B,qBACE,8OAAC;QACC,WAAW,IAAA,yHAAE,EACX,qTACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;AACA,SAAS,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 1742, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/T7/cometa/cometa-separated-projects/cometa-frontend-nextjs/src/components/ui/progress.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAEA;AALA;;;;;AAOA,MAAM,yBAAW,mNAAgB,CAG/B,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,GAAG,OAAO,EAAE,oBACjC,8OAAC,4KAAsB;QACrB,KAAK;QACL,WAAW,IAAA,yHAAE,EACX,iEACA;QAED,GAAG,KAAK;kBAET,cAAA,8OAAC,iLAA2B;YAC1B,WAAU;YACV,OAAO;gBAAE,WAAW,CAAC,YAAY,EAAE,MAAM,CAAC,SAAS,CAAC,EAAE,EAAE,CAAC;YAAC;;;;;;;;;;;AAIhE,SAAS,WAAW,GAAG,4KAAsB,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 1780, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/T7/cometa/cometa-separated-projects/cometa-frontend-nextjs/src/hooks/use-documents.ts"],"sourcesContent":["'use client';\n\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { toast } from 'sonner';\nimport type {\n  WorkerDocument,\n  DocumentCategory,\n  DocumentsResponse,\n  DocumentStatus,\n  DocumentCategoryCode\n} from '@/types';\n\nexport interface DocumentFilters {\n  user_id?: string;\n  category_code?: DocumentCategoryCode;\n  status?: DocumentStatus;\n  search?: string;\n  page?: number;\n  per_page?: number;\n}\n\nexport interface CreateDocumentRequest {\n  user_id: string;\n  category_id: string;\n  document_number?: string;\n  issuing_authority?: string;\n  issue_date?: string;\n  expiry_date?: string;\n  valid_until?: string;\n  file_url: string;\n  file_name: string;\n  file_size?: number;\n  file_type: string;\n  notes?: string;\n}\n\nexport interface VerifyDocumentRequest {\n  document_id: string;\n  verified: boolean;\n  notes?: string;\n}\n\n// Query keys\nexport const documentKeys = {\n  all: ['documents'] as const,\n  lists: () => [...documentKeys.all, 'list'] as const,\n  list: (filters: DocumentFilters) => [...documentKeys.lists(), filters] as const,\n  categories: () => [...documentKeys.all, 'categories'] as const,\n  stats: () => [...documentKeys.all, 'stats'] as const,\n};\n\n// Fetch documents with filters\nexport function useDocuments(filters: DocumentFilters = {}) {\n  const searchParams = new URLSearchParams();\n\n  Object.entries(filters).forEach(([key, value]) => {\n    if (value !== undefined && value !== null && value !== '') {\n      searchParams.append(key, value.toString());\n    }\n  });\n\n  return useQuery({\n    queryKey: documentKeys.list(filters),\n    queryFn: async (): Promise<DocumentsResponse> => {\n      const response = await fetch(`/api/documents?${searchParams.toString()}`);\n      if (!response.ok) {\n        throw new Error('Failed to fetch documents');\n      }\n      return response.json();\n    },\n  });\n}\n\n// Upload new document\nexport function useUploadDocument() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async (data: CreateDocumentRequest) => {\n      const response = await fetch('/api/documents', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(data),\n      });\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'Failed to upload document');\n      }\n\n      return response.json();\n    },\n    onSuccess: () => {\n      // Invalidate all document queries to refresh data\n      queryClient.invalidateQueries({ queryKey: documentKeys.all });\n      toast.success('Document uploaded successfully');\n    },\n    onError: (error: Error) => {\n      console.error('Failed to upload document:', error);\n      toast.error(error.message || 'Failed to upload document');\n    },\n  });\n}\n\n// Verify document\nexport function useVerifyDocument() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async (data: VerifyDocumentRequest) => {\n      const response = await fetch(`/api/documents/${data.document_id}/verify`, {\n        method: 'PATCH',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          verified: data.verified,\n          notes: data.notes,\n        }),\n      });\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'Failed to verify document');\n      }\n\n      return response.json();\n    },\n    onSuccess: (_, variables) => {\n      // Invalidate document queries to refresh data\n      queryClient.invalidateQueries({ queryKey: documentKeys.all });\n      toast.success(variables.verified ? 'Document verified successfully' : 'Document verification removed');\n    },\n    onError: (error: Error) => {\n      console.error('Failed to verify document:', error);\n      toast.error(error.message || 'Failed to verify document');\n    },\n  });\n}\n\n// Delete document\nexport function useDeleteDocument() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async (documentId: string) => {\n      const response = await fetch(`/api/documents/${documentId}`, {\n        method: 'DELETE',\n      });\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'Failed to delete document');\n      }\n\n      return response.json();\n    },\n    onSuccess: () => {\n      // Invalidate document queries to refresh data\n      queryClient.invalidateQueries({ queryKey: documentKeys.all });\n      toast.success('Document deleted successfully');\n    },\n    onError: (error: Error) => {\n      console.error('Failed to delete document:', error);\n      toast.error(error.message || 'Failed to delete document');\n    },\n  });\n}\n\n// Specialized hooks for common use cases\nexport function useUserDocuments(userId?: string) {\n  return useDocuments({\n    user_id: userId,\n    page: 1,\n    per_page: 50,\n  });\n}\n\nexport function useDocumentsByCategory(categoryCode?: DocumentCategoryCode) {\n  return useDocuments({\n    category_code: categoryCode,\n    page: 1,\n    per_page: 50,\n  });\n}\n\nexport function useExpiredDocuments() {\n  return useDocuments({\n    status: 'expired',\n    page: 1,\n    per_page: 50,\n  });\n}\n\nexport function useExpiringDocuments() {\n  return useDocuments({\n    status: 'expiring_soon',\n    page: 1,\n    per_page: 50,\n  });\n}\n\nexport function usePendingVerifications() {\n  return useDocuments({\n    status: 'pending',\n    page: 1,\n    per_page: 50,\n  });\n}\n\n// Document categories and status constants\nexport const DOCUMENT_CATEGORIES: DocumentCategoryCode[] = [\n  'WORK_PERMIT',\n  'INSURANCE',\n  'ID_DOCUMENT',\n  'VISA',\n  'MEDICAL',\n  'SAFETY_TRAINING',\n  'PASSPORT',\n  'DRIVING_LICENSE',\n];\n\nexport const DOCUMENT_STATUSES: DocumentStatus[] = [\n  'active',\n  'expired',\n  'expiring_soon',\n  'pending',\n  'inactive',\n];\n\n// Helper function to get status label\nexport function getStatusLabel(status: DocumentStatus): string {\n  const labels: Record<DocumentStatus, string> = {\n    active: 'Active',\n    expired: 'Expired',\n    expiring_soon: 'Expiring Soon',\n    pending: 'Pending Verification',\n    inactive: 'Inactive',\n  };\n\n  return labels[status] || status;\n}\n\n// Helper function to get status color\nexport function getStatusColor(status: DocumentStatus): string {\n  const colors: Record<DocumentStatus, string> = {\n    active: 'bg-green-100 text-green-800',\n    expired: 'bg-red-100 text-red-800',\n    expiring_soon: 'bg-yellow-100 text-yellow-800',\n    pending: 'bg-blue-100 text-blue-800',\n    inactive: 'bg-gray-100 text-gray-800',\n  };\n\n  return colors[status] || 'bg-gray-100 text-gray-800';\n}\n\n// Helper function to get category label\nexport function getCategoryLabel(categoryCode: DocumentCategoryCode): string {\n  const labels: Record<DocumentCategoryCode, string> = {\n    WORK_PERMIT: 'Work Permit',\n    INSURANCE: 'Insurance',\n    ID_DOCUMENT: 'ID Document',\n    VISA: 'Visa',\n    MEDICAL: 'Medical Certificate',\n    SAFETY_TRAINING: 'Safety Training',\n    PASSPORT: 'Passport',\n    DRIVING_LICENSE: 'Driving License',\n  };\n\n  return labels[categoryCode] || categoryCode.replace(/_/g, ' ');\n}\n\n// Helper function to check if document is expiring soon\nexport function isExpiringSign(document: WorkerDocument): boolean {\n  if (!document.expiry_date) return false;\n\n  const expiry = new Date(document.expiry_date);\n  const now = new Date();\n  const daysUntilExpiry = Math.ceil((expiry.getTime() - now.getTime()) / (1000 * 60 * 60 * 24));\n\n  return daysUntilExpiry >= 0 && daysUntilExpiry <= 30;\n}\n\n// Helper function to check if document is expired\nexport function isExpired(document: WorkerDocument): boolean {\n  if (!document.expiry_date) return false;\n\n  const expiry = new Date(document.expiry_date);\n  const now = new Date();\n\n  return expiry < now;\n}\n\n// Helper function to get days until expiry\nexport function getDaysUntilExpiry(document: WorkerDocument): number | null {\n  if (!document.expiry_date) return null;\n\n  const expiry = new Date(document.expiry_date);\n  const now = new Date();\n\n  return Math.ceil((expiry.getTime() - now.getTime()) / (1000 * 60 * 60 * 24));\n}\n\n// Helper function to format file size\nexport function formatFileSize(bytes: number): string {\n  if (bytes === 0) return '0 Bytes';\n\n  const k = 1024;\n  const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\n\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\n}\n\n// Helper function to get file type icon\nexport function getFileTypeIcon(fileType: string): string {\n  if (fileType.includes('pdf')) return '📄';\n  if (fileType.includes('image')) return '🖼️';\n  if (fileType.includes('word') || fileType.includes('document')) return '📝';\n  if (fileType.includes('excel') || fileType.includes('spreadsheet')) return '📊';\n  if (fileType.includes('powerpoint') || fileType.includes('presentation')) return '📺';\n  return '📎';\n}\n\n// Document categories hook - get all available categories\nexport function useDocumentCategories() {\n  return useQuery({\n    queryKey: documentKeys.categories(),\n    queryFn: async (): Promise<DocumentCategory[]> => {\n      const response = await fetch('/api/documents');\n      if (!response.ok) {\n        throw new Error('Failed to fetch document categories');\n      }\n      const data = await response.json();\n      return data.categories || [];\n    },\n    staleTime: 5 * 60 * 1000, // 5 minutes\n  });\n}\n\n// Document search hook - search across document content\nexport function useSearchDocuments() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async (searchRequest: {\n      query: string;\n      include_content?: boolean;\n      highlight?: boolean;\n      fuzzy?: boolean;\n    }) => {\n      const searchParams = new URLSearchParams();\n      searchParams.append('search', searchRequest.query);\n      if (searchRequest.include_content) searchParams.append('include_content', 'true');\n      if (searchRequest.highlight) searchParams.append('highlight', 'true');\n      if (searchRequest.fuzzy) searchParams.append('fuzzy', 'true');\n\n      const response = await fetch(`/api/documents/search?${searchParams.toString()}`);\n      if (!response.ok) {\n        throw new Error('Failed to search documents');\n      }\n      return response.json();\n    },\n    onSuccess: (data) => {\n      // Cache search results temporarily\n      queryClient.setQueryData(['documents', 'search', data.query], data);\n    },\n    onError: (error: Error) => {\n      toast.error(`Search failed: ${error.message}`);\n    },\n  });\n}\n\n// Document actions hook - for action menus and operations\nexport function useDocumentActions() {\n  const queryClient = useQueryClient();\n\n  const shareDocument = useMutation({\n    mutationFn: async ({ documentId, accessLevel }: { documentId: string; accessLevel: 'public' | 'private' | 'team' }) => {\n      const response = await fetch(`/api/documents/${documentId}/share`, {\n        method: 'PATCH',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ access_level: accessLevel }),\n      });\n      if (!response.ok) throw new Error('Failed to share document');\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: documentKeys.all });\n      toast.success('Document sharing updated');\n    },\n    onError: (error: Error) => toast.error(error.message),\n  });\n\n  const downloadDocument = useMutation({\n    mutationFn: async (documentId: string) => {\n      const response = await fetch(`/api/documents/${documentId}/download`);\n      if (!response.ok) throw new Error('Failed to download document');\n      const blob = await response.blob();\n      return { blob, response };\n    },\n    onError: (error: Error) => toast.error(error.message),\n  });\n\n  const duplicateDocument = useMutation({\n    mutationFn: async (documentId: string) => {\n      const response = await fetch(`/api/documents/${documentId}/duplicate`, {\n        method: 'POST',\n      });\n      if (!response.ok) throw new Error('Failed to duplicate document');\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: documentKeys.all });\n      toast.success('Document duplicated');\n    },\n    onError: (error: Error) => toast.error(error.message),\n  });\n\n  return {\n    shareDocument,\n    downloadDocument,\n    duplicateDocument,\n  };\n}\n\n// Document classification hook - for auto-categorizing documents\nexport function useClassifyDocument() {\n  return useMutation({\n    mutationFn: async (file: File) => {\n      // Simple classification based on file extension and name\n      const fileName = file.name.toLowerCase();\n      const fileType = file.type.toLowerCase();\n\n      // Classify based on file name patterns\n      if (fileName.includes('passport') || fileName.includes('паспорт')) {\n        return { category_code: 'PASSPORT', confidence: 0.9 };\n      }\n      if (fileName.includes('visa') || fileName.includes('виза')) {\n        return { category_code: 'VISA', confidence: 0.85 };\n      }\n      if (fileName.includes('permit') || fileName.includes('разрешение')) {\n        return { category_code: 'WORK_PERMIT', confidence: 0.8 };\n      }\n      if (fileName.includes('insurance') || fileName.includes('страхов')) {\n        return { category_code: 'INSURANCE', confidence: 0.8 };\n      }\n      if (fileName.includes('medical') || fileName.includes('медицин')) {\n        return { category_code: 'MEDICAL', confidence: 0.75 };\n      }\n      if (fileName.includes('safety') || fileName.includes('безопасн')) {\n        return { category_code: 'SAFETY_TRAINING', confidence: 0.75 };\n      }\n      if (fileName.includes('license') || fileName.includes('лицензи')) {\n        return { category_code: 'DRIVING_LICENSE', confidence: 0.7 };\n      }\n\n      // Default to ID document for images\n      if (fileType.includes('image')) {\n        return { category_code: 'ID_DOCUMENT', confidence: 0.5 };\n      }\n\n      // Default classification\n      return { category_code: 'ID_DOCUMENT', confidence: 0.3 };\n    },\n    onError: (error: Error) => {\n      console.warn('Document classification failed:', error);\n    },\n  });\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2260, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/T7/cometa/cometa-separated-projects/cometa-frontend-nextjs/src/components/documents/document-upload.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useState, useCallback } from \"react\";\nimport { useDropzone } from \"react-dropzone\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { Upload, X, FileText, Image, FileIcon, AlertCircle } from \"lucide-react\";\nimport { toast } from \"sonner\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Progress } from \"@/components/ui/progress\";\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardHeader,\n  CardTitle,\n} from \"@/components/ui/card\";\nimport {\n  useUploadDocument,\n  useDocumentCategories,\n  useClassifyDocument,\n} from \"@/hooks/use-documents\";\nimport { cn } from \"@/lib/utils\";\nimport type {\n  CreateDocumentRequest,\n  DocumentCategoryCode,\n  DocumentAccessLevel,\n} from \"@/types\";\n\ninterface DocumentUploadProps {\n  projectId?: string;\n  houseId?: string;\n  workEntryId?: string;\n  teamId?: string;\n  userId?: string;\n  onUploadComplete?: (document: any) => void;\n  maxFiles?: number;\n  acceptedFileTypes?: string[];\n  maxFileSize?: number; // in bytes\n}\n\ninterface FileWithPreview {\n  file: File; // Original File object\n  preview?: string;\n  category?: DocumentCategoryCode;\n  tags?: string[];\n  description?: string;\n  accessLevel?: DocumentAccessLevel;\n  documentNumber?: string;\n  issuingAuthority?: string;\n  issueDate?: string;\n  expiryDate?: string;\n  // File properties for compatibility\n  name: string;\n  size: number;\n  type: string;\n}\n\nconst getFileIcon = (fileType: string | undefined) => {\n  if (!fileType) return FileIcon;\n  if (fileType.startsWith(\"image/\")) return Image;\n  if (fileType.includes(\"pdf\") || fileType.includes(\"document\")) return FileText;\n  return FileIcon;\n};\n\nconst formatFileSize = (bytes: number): string => {\n  if (bytes === 0) return \"0 Bytes\";\n  const k = 1024;\n  const sizes = [\"Bytes\", \"KB\", \"MB\", \"GB\"];\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + \" \" + sizes[i];\n};\n\nexport function DocumentUpload({\n  projectId,\n  houseId,\n  workEntryId,\n  teamId,\n  userId,\n  onUploadComplete,\n  maxFiles = 10,\n  acceptedFileTypes = [\n    \"image/*\",\n    \"application/pdf\",\n    \"application/msword\", // .doc files\n    \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\", // .docx files\n    \"application/vnd.ms-excel\", // .xls files\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\", // .xlsx files\n    \".doc\",\n    \".docx\",\n    \".xls\",\n    \".xlsx\"\n  ],\n  maxFileSize = 50 * 1024 * 1024, // 50MB\n}: DocumentUploadProps) {\n  const [files, setFiles] = useState<FileWithPreview[]>([]);\n  const [uploading, setUploading] = useState(false);\n  const [uploadProgress, setUploadProgress] = useState<Record<string, number>>({});\n\n  const uploadDocument = useUploadDocument();\n\n  // Custom upload function for user documents\n  const uploadUserDocument = async (file: FileWithPreview, userId: string) => {\n    console.log('Starting upload for:', file.name, 'to user:', userId, 'category:', file.category);\n\n    if (!file.category) {\n      throw new Error('Please select a document category before uploading');\n    }\n\n    // Use the original file object from our wrapper\n    const formData = new FormData();\n    formData.append('file', file.file); // Use the original File object\n    formData.append('category_id', file.category || '');\n    formData.append('document_number', file.documentNumber || '');\n    formData.append('issuing_authority', file.issuingAuthority || '');\n    formData.append('issue_date', file.issueDate || '');\n    formData.append('expiry_date', file.expiryDate || '');\n    formData.append('notes', file.description || '');\n\n    console.log('FormData prepared:', {\n      fileName: file.name,\n      fileSize: file.size,\n      fileType: file.type,\n      categoryId: file.category,\n      notes: file.description || ''\n    });\n\n    console.log('FormData entries:');\n    for (const [key, value] of formData.entries()) {\n      if (value instanceof File) {\n        console.log(`  ${key}: File(name=\"${value.name}\", size=${value.size}, type=\"${value.type}\")`);\n      } else {\n        console.log(`  ${key}: \"${value}\"`);\n      }\n    }\n\n    const response = await fetch(`/api/users/${userId}/documents`, {\n      method: 'POST',\n      body: formData,\n    });\n\n    console.log('Response status:', response.status, response.statusText);\n\n    if (!response.ok) {\n      let errorMessage = 'Failed to upload document';\n      try {\n        const errorText = await response.text();\n        console.log('Error response text:', errorText);\n        if (errorText && errorText.trim()) {\n          try {\n            const error = JSON.parse(errorText);\n            errorMessage = error.error || error.message || errorMessage;\n          } catch (parseError) {\n            // If JSON parsing fails, use the raw text as error message\n            errorMessage = errorText;\n          }\n        }\n      } catch (e) {\n        errorMessage = `HTTP ${response.status}: ${response.statusText}`;\n      }\n      console.error('Upload error:', errorMessage);\n      throw new Error(errorMessage);\n    }\n\n    const result = await response.json();\n    console.log('Upload successful:', result);\n    return result;\n  };\n  // Custom hook to fetch document categories\n  const { data: userDocumentsData } = useQuery({\n    queryKey: ['user-documents-categories', userId],\n    queryFn: async () => {\n      if (!userId) return { categories: [] };\n      const response = await fetch(`/api/users/${userId}/documents`);\n      if (!response.ok) throw new Error('Failed to fetch categories');\n      return response.json();\n    },\n    enabled: !!userId,\n  });\n\n  const categories = userDocumentsData?.categories || [];\n  const classifyDocument = useClassifyDocument();\n\n  const onDrop = useCallback(\n    async (acceptedFiles: File[]) => {\n      console.log('📁 Файлы выбраны:', acceptedFiles.map(f => ({\n        name: f.name,\n        size: f.size,\n        type: f.type\n      })));\n\n      if (files.length + acceptedFiles.length > maxFiles) {\n        toast.error(`Maximum ${maxFiles} files allowed`);\n        return;\n      }\n\n      const newFiles: FileWithPreview[] = acceptedFiles.map((file) => {\n        console.log('🔧 Обрабатываю файл:', {\n          name: file.name,\n          size: file.size,\n          type: file.type,\n          constructor: file.constructor.name\n        });\n\n        // Create preview for images\n        const preview = file.type.startsWith(\"image/\")\n          ? URL.createObjectURL(file)\n          : undefined;\n\n        // Create a wrapper object that preserves the original File object\n        const enhancedFile: FileWithPreview = {\n          file, // Store the original File object\n          preview,\n          category: undefined,\n          tags: [],\n          description: \"\",\n          accessLevel: \"project\",\n          documentNumber: \"\",\n          issuingAuthority: \"\",\n          issueDate: \"\",\n          expiryDate: \"\",\n          // Copy File properties for compatibility\n          name: file.name,\n          size: file.size,\n          type: file.type\n        };\n\n        console.log('✅ Файл обработан:', {\n          name: enhancedFile.name,\n          size: enhancedFile.size,\n          type: enhancedFile.type,\n          hasPreview: !!enhancedFile.preview,\n          originalFile: enhancedFile.file,\n          hasArrayBuffer: typeof enhancedFile.file.arrayBuffer === 'function',\n          hasStream: typeof enhancedFile.file.stream === 'function'\n        });\n\n        return enhancedFile;\n      });\n\n      console.log('📋 Добавляю файлы в состояние:', newFiles.length);\n      setFiles((prev) => [...prev, ...newFiles]);\n\n      // Auto-classify documents\n      for (const file of newFiles) {\n        try {\n          const result = await classifyDocument.mutateAsync(file.file);\n\n          setFiles((prev) =>\n            prev.map((f) =>\n              f.name === file.name && f.size === file.size\n                ? {\n                    ...f,\n                    category: result.category_code as DocumentCategoryCode,\n                    tags: [], // No tags returned from this hook\n                  }\n                : f\n            )\n          );\n        } catch (error) {\n          console.error(\"Classification failed for\", file.name, error);\n        }\n      }\n    },\n    [files.length, maxFiles, classifyDocument]\n  );\n\n  const { getRootProps, getInputProps, isDragActive } = useDropzone({\n    onDrop,\n    accept: {\n      'image/*': ['.png', '.jpg', '.jpeg', '.gif', '.bmp', '.webp'],\n      'application/pdf': ['.pdf'],\n      'application/msword': ['.doc'],\n      'application/vnd.openxmlformats-officedocument.wordprocessingml.document': ['.docx'],\n      'application/vnd.ms-excel': ['.xls'],\n      'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet': ['.xlsx'],\n    },\n    maxSize: maxFileSize,\n    multiple: true,\n  });\n\n  const removeFile = (index: number) => {\n    setFiles((prev) => {\n      const file = prev[index];\n      if (file.preview) {\n        URL.revokeObjectURL(file.preview);\n      }\n      return prev.filter((_, i) => i !== index);\n    });\n  };\n\n  const updateFileMetadata = (\n    index: number,\n    field: keyof FileWithPreview,\n    value: any\n  ) => {\n    setFiles((prev) =>\n      prev.map((file, i) =>\n        i === index ? { ...file, [field]: value } : file\n      )\n    );\n  };\n\n  const handleUpload = async () => {\n    if (files.length === 0) {\n      toast.error(\"Пожалуйста, выберите файл для загрузки\");\n      return;\n    }\n    if (!userId) {\n      toast.error(\"User ID is required for uploading documents\");\n      return;\n    }\n\n    // Check if all files have categories\n    const filesWithoutCategory = files.filter(file => !file.category);\n    if (filesWithoutCategory.length > 0) {\n      toast.error(\"Пожалуйста, выберите категорию для всех файлов\");\n      return;\n    }\n\n    console.log('📤 Начинаем загрузку файлов:', files.map((f, i) => ({\n      name: f.name || `file-${i}`,\n      size: f.size,\n      type: f.type,\n      category: f.category\n    })));\n\n    setUploading(true);\n\n    for (const [index, file] of files.entries()) {\n      // Store original filename before it gets corrupted\n      const originalFileName = file.name || `file-${index}`;\n\n      try {\n        setUploadProgress((prev) => ({ ...prev, [originalFileName]: 0 }));\n\n        // Simulate progress (in real implementation, this would come from upload progress)\n        const progressInterval = setInterval(() => {\n          setUploadProgress((prev) => ({\n            ...prev,\n            [originalFileName]: Math.min(prev[originalFileName] + 10, 90),\n          }));\n        }, 100);\n\n        const document = await uploadUserDocument(file, userId);\n\n        clearInterval(progressInterval);\n        setUploadProgress((prev) => ({ ...prev, [originalFileName]: 100 }));\n\n        onUploadComplete?.(document);\n      } catch (error) {\n        console.error(\"Upload failed for\", originalFileName, error);\n        setUploadProgress((prev) => ({ ...prev, [originalFileName]: -1 }));\n      }\n    }\n\n    setUploading(false);\n    setFiles([]);\n    setUploadProgress({});\n  };\n\n  return (\n    <Card className=\"w-full\">\n      <CardHeader>\n        <CardTitle>Upload Documents</CardTitle>\n        <CardDescription>\n          Drag and drop files or click to select. Maximum {maxFiles} files,{\" \"}\n          {formatFileSize(maxFileSize)} each.\n        </CardDescription>\n      </CardHeader>\n      <CardContent className=\"space-y-4\">\n        {/* Drop Zone */}\n        <div\n          {...getRootProps()}\n          className={cn(\n            \"border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors\",\n            isDragActive\n              ? \"border-primary bg-primary/10\"\n              : \"border-muted-foreground/25 hover:border-primary/50\"\n          )}\n        >\n          <input {...getInputProps()} />\n          <Upload className=\"mx-auto h-12 w-12 text-muted-foreground mb-4\" />\n          {isDragActive ? (\n            <p className=\"text-primary\">Drop the files here...</p>\n          ) : (\n            <div>\n              <p className=\"text-muted-foreground mb-2\">\n                Drag and drop files here, or click to select files\n              </p>\n              <p className=\"text-sm text-muted-foreground\">\n                Supported: {acceptedFileTypes.join(\", \")}\n              </p>\n            </div>\n          )}\n        </div>\n\n        {/* File List */}\n        {files.length > 0 && (\n          <div className=\"space-y-4\">\n            <h4 className=\"font-medium\">Files to Upload ({files.length})</h4>\n            {files.map((file, index) => {\n              const FileIconComponent = getFileIcon(file.type);\n              const progress = uploadProgress[file.name] || 0;\n              const isError = progress === -1;\n\n              return (\n                <Card key={`${file.name}-${file.size}`} className=\"p-4\">\n                  <div className=\"flex items-start gap-4\">\n                    {/* File Icon/Preview */}\n                    <div className=\"flex-shrink-0\">\n                      {file.preview ? (\n                        <img\n                          src={file.preview}\n                          alt={file.name}\n                          className=\"w-16 h-16 object-cover rounded\"\n                          onLoad={() => URL.revokeObjectURL(file.preview!)}\n                        />\n                      ) : (\n                        <div className=\"w-16 h-16 bg-muted rounded flex items-center justify-center\">\n                          <FileIconComponent className=\"w-8 h-8 text-muted-foreground\" />\n                        </div>\n                      )}\n                    </div>\n\n                    {/* File Details */}\n                    <div className=\"flex-1 space-y-3\">\n                      <div className=\"flex items-start justify-between\">\n                        <div>\n                          <p className=\"font-medium truncate max-w-xs\">\n                            {file.name}\n                          </p>\n                          <p className=\"text-sm text-muted-foreground\">\n                            {formatFileSize(file.size)}\n                          </p>\n                        </div>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => removeFile(index)}\n                          disabled={uploading}\n                        >\n                          <X className=\"w-4 h-4\" />\n                        </Button>\n                      </div>\n\n                      {/* Metadata Form */}\n                      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\n                        <div>\n                          <Label htmlFor={`category-${index}`}>Category</Label>\n                          <Select\n                            value={file.category || \"\"}\n                            onValueChange={(value) =>\n                              updateFileMetadata(index, \"category\", value)\n                            }\n                            disabled={uploading}\n                          >\n                            <SelectTrigger>\n                              <SelectValue placeholder=\"Select category\" />\n                            </SelectTrigger>\n                            <SelectContent>\n                              {categories?.map((category: any) => (\n                                <SelectItem key={category.id} value={category.id}>\n                                  {category.name_en || category.name_ru || category.code}\n                                </SelectItem>\n                              ))}\n                            </SelectContent>\n                          </Select>\n                        </div>\n\n                        <div>\n                          <Label htmlFor={`access-${index}`}>Access Level</Label>\n                          <Select\n                            value={file.accessLevel || \"project\"}\n                            onValueChange={(value) =>\n                              updateFileMetadata(index, \"accessLevel\", value)\n                            }\n                            disabled={uploading}\n                          >\n                            <SelectTrigger>\n                              <SelectValue />\n                            </SelectTrigger>\n                            <SelectContent>\n                              <SelectItem value=\"public\">Public</SelectItem>\n                              <SelectItem value=\"project\">Project</SelectItem>\n                              <SelectItem value=\"team\">Team</SelectItem>\n                              <SelectItem value=\"private\">Private</SelectItem>\n                              <SelectItem value=\"admin\">Admin Only</SelectItem>\n                            </SelectContent>\n                          </Select>\n                        </div>\n\n                        <div>\n                          <Label htmlFor={`document-number-${index}`}>Document Number</Label>\n                          <Input\n                            id={`document-number-${index}`}\n                            placeholder=\"Document number...\"\n                            value={file.documentNumber || \"\"}\n                            onChange={(e) =>\n                              updateFileMetadata(index, \"documentNumber\", e.target.value)\n                            }\n                            disabled={uploading}\n                          />\n                        </div>\n\n                        <div>\n                          <Label htmlFor={`issuing-authority-${index}`}>Issuing Authority</Label>\n                          <Input\n                            id={`issuing-authority-${index}`}\n                            placeholder=\"Issuing authority...\"\n                            value={file.issuingAuthority || \"\"}\n                            onChange={(e) =>\n                              updateFileMetadata(index, \"issuingAuthority\", e.target.value)\n                            }\n                            disabled={uploading}\n                          />\n                        </div>\n\n                        <div>\n                          <Label htmlFor={`issue-date-${index}`}>Issue Date</Label>\n                          <Input\n                            id={`issue-date-${index}`}\n                            type=\"date\"\n                            value={file.issueDate || \"\"}\n                            onChange={(e) =>\n                              updateFileMetadata(index, \"issueDate\", e.target.value)\n                            }\n                            disabled={uploading}\n                          />\n                        </div>\n\n                        <div>\n                          <Label htmlFor={`expiry-date-${index}`}>Expiry Date</Label>\n                          <Input\n                            id={`expiry-date-${index}`}\n                            type=\"date\"\n                            value={file.expiryDate || \"\"}\n                            onChange={(e) =>\n                              updateFileMetadata(index, \"expiryDate\", e.target.value)\n                            }\n                            disabled={uploading}\n                          />\n                        </div>\n                      </div>\n\n                      <div>\n                        <Label htmlFor={`description-${index}`}>Description</Label>\n                        <Textarea\n                          id={`description-${index}`}\n                          placeholder=\"Optional description...\"\n                          value={file.description || \"\"}\n                          onChange={(e) =>\n                            updateFileMetadata(index, \"description\", e.target.value)\n                          }\n                          disabled={uploading}\n                          rows={2}\n                        />\n                      </div>\n\n                      {/* Tags */}\n                      {file.tags && file.tags.length > 0 && (\n                        <div>\n                          <Label>Suggested Tags</Label>\n                          <div className=\"flex flex-wrap gap-1 mt-1\">\n                            {file.tags.map((tag, tagIndex) => (\n                              <Badge key={tagIndex} variant=\"secondary\">\n                                {tag}\n                              </Badge>\n                            ))}\n                          </div>\n                        </div>\n                      )}\n\n                      {/* Upload Progress */}\n                      {uploading && progress >= 0 && (\n                        <div className=\"space-y-1\">\n                          <div className=\"flex items-center justify-between text-sm\">\n                            <span>Uploading...</span>\n                            <span>{progress}%</span>\n                          </div>\n                          <Progress value={progress} className=\"h-2\" />\n                        </div>\n                      )}\n\n                      {/* Error State */}\n                      {isError && (\n                        <div className=\"flex items-center gap-2 text-destructive text-sm\">\n                          <AlertCircle className=\"w-4 h-4\" />\n                          <span>Upload failed</span>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                </Card>\n              );\n            })}\n\n            {/* Upload Button */}\n            <div className=\"flex justify-end\">\n              <Button\n                onClick={handleUpload}\n                disabled={uploading || files.length === 0}\n                className=\"min-w-32\"\n              >\n                {uploading ? \"Uploading...\" : `Upload ${files.length} Files`}\n              </Button>\n            </div>\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3223, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/T7/cometa/cometa-separated-projects/cometa-frontend-nextjs/src/components/documents/worker-documents-dialog.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport { useQuery, useQueryClient } from \"@tanstack/react-query\";\nimport {\n  FileText,\n  Shield,\n  Calendar,\n  AlertTriangle,\n  CheckCircle,\n  Clock,\n  Download,\n  Eye,\n  X,\n  Plus\n} from \"lucide-react\";\n\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { DocumentUpload } from \"./document-upload\";\n\nimport type { DocumentsResponse, WorkerDocument, DocumentStatus } from \"@/types\";\n\ninterface WorkerDocumentsDialogProps {\n  userId: string;\n  userName: string;\n  trigger?: React.ReactNode;\n}\n\nasync function fetchWorkerDocuments(userId: string): Promise<DocumentsResponse> {\n  const response = await fetch(`/api/users/${userId}/documents`);\n  if (!response.ok) {\n    throw new Error('Failed to fetch documents');\n  }\n  return response.json();\n}\n\nfunction getStatusColor(status: DocumentStatus): string {\n  switch (status) {\n    case 'active':\n      return 'bg-green-500';\n    case 'expired':\n      return 'bg-red-500';\n    case 'expiring_soon':\n      return 'bg-yellow-500';\n    case 'pending':\n      return 'bg-blue-500';\n    case 'inactive':\n      return 'bg-gray-500';\n    default:\n      return 'bg-gray-500';\n  }\n}\n\nfunction getStatusIcon(status: DocumentStatus) {\n  switch (status) {\n    case 'active':\n      return <CheckCircle className=\"h-4 w-4\" />;\n    case 'expired':\n      return <AlertTriangle className=\"h-4 w-4\" />;\n    case 'expiring_soon':\n      return <Clock className=\"h-4 w-4\" />;\n    case 'pending':\n      return <Clock className=\"h-4 w-4\" />;\n    case 'inactive':\n      return <X className=\"h-4 w-4\" />;\n    default:\n      return <FileText className=\"h-4 w-4\" />;\n  }\n}\n\nfunction getStatusText(status: DocumentStatus): string {\n  switch (status) {\n    case 'active':\n      return 'Действителен';\n    case 'expired':\n      return 'Истёк';\n    case 'expiring_soon':\n      return 'Истекает скоро';\n    case 'pending':\n      return 'В ожидании';\n    case 'inactive':\n      return 'Неактивен';\n    default:\n      return 'Неизвестен';\n  }\n}\n\nfunction formatFileSize(bytes: number): string {\n  if (bytes === 0) return '0 Bytes';\n  const k = 1024;\n  const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\n}\n\nfunction DocumentCard({ document }: { document: WorkerDocument }) {\n  const statusColor = getStatusColor(document.status);\n  const statusIcon = getStatusIcon(document.status);\n  const statusText = getStatusText(document.status);\n  const queryClient = useQueryClient();\n\n  const handleView = () => {\n    // Open document in new tab for viewing (not downloading)\n    const viewUrl = `/api/users/${document.user_id}/documents/${document.id}/view`;\n    console.log(`👁️ Открываю документ \"${document.file_name}\" для просмотра`);\n    window.open(viewUrl, '_blank');\n  };\n\n  const handleDownload = async () => {\n    try {\n      console.log(`💾 Скачиваю документ \"${document.file_name}\" для работника ID: ${document.user_id}`);\n      // Download the document using the API endpoint\n      const downloadUrl = `/api/users/${document.user_id}/documents/${document.id}/download`;\n\n      const response = await fetch(downloadUrl);\n      if (!response.ok) {\n        throw new Error('Failed to download document');\n      }\n\n      // Create blob from response\n      const blob = await response.blob();\n\n      // Create download link\n      const url = window.URL.createObjectURL(blob);\n      const link = window.document.createElement('a');\n      link.href = url;\n      link.download = document.file_name;\n      window.document.body.appendChild(link);\n      link.click();\n\n      // Cleanup\n      window.URL.revokeObjectURL(url);\n      window.document.body.removeChild(link);\n    } catch (error) {\n      console.error('Download failed:', error);\n      alert('Ошибка при скачивании документа');\n    }\n  };\n\n  const handleDelete = async () => {\n    const confirmDelete = window.confirm(`Вы уверены, что хотите удалить документ \"${document.file_name}\"?`);\n    if (!confirmDelete) return;\n\n    try {\n      console.log(`🗑️ Удаляю документ \"${document.file_name}\" для работника ID: ${document.user_id}`);\n\n      const response = await fetch(`/api/users/${document.user_id}/documents/${document.id}`, {\n        method: 'DELETE',\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to delete document');\n      }\n\n      console.log(`✅ Документ \"${document.file_name}\" успешно удален`);\n\n      // Refresh the documents list\n      queryClient.invalidateQueries({\n        queryKey: ['worker-documents', document.user_id]\n      });\n\n      alert('Документ успешно удален');\n\n    } catch (error) {\n      console.error('Delete failed:', error);\n      alert('Ошибка при удалении документа');\n    }\n  };\n\n  return (\n    <Card className=\"mb-4\">\n      <CardHeader className=\"pb-3\">\n        <div className=\"flex items-center justify-between\">\n          <CardTitle className=\"text-lg flex items-center gap-2\">\n            <div\n              className=\"w-3 h-3 rounded-full\"\n              style={{ backgroundColor: document.category.color }}\n            />\n            {document.category.name_ru || document.category.name_en}\n          </CardTitle>\n          <Badge\n            variant=\"secondary\"\n            className={`${statusColor} text-white flex items-center gap-1`}\n          >\n            {statusIcon}\n            {statusText}\n          </Badge>\n        </div>\n      </CardHeader>\n      <CardContent className=\"space-y-3\">\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm\">\n          {document.document_number && (\n            <div>\n              <span className=\"font-medium text-muted-foreground\">Номер документа:</span>\n              <p>{document.document_number}</p>\n            </div>\n          )}\n\n          {document.issuing_authority && (\n            <div>\n              <span className=\"font-medium text-muted-foreground\">Выдавший орган:</span>\n              <p>{document.issuing_authority}</p>\n            </div>\n          )}\n\n          {document.issue_date && (\n            <div>\n              <span className=\"font-medium text-muted-foreground\">Дата выдачи:</span>\n              <p>{new Date(document.issue_date).toLocaleDateString('ru-RU')}</p>\n            </div>\n          )}\n\n          {document.expiry_date && (\n            <div>\n              <span className=\"font-medium text-muted-foreground\">Дата истечения:</span>\n              <p className={document.status === 'expired' ? 'text-red-600 font-medium' : document.status === 'expiring_soon' ? 'text-yellow-600 font-medium' : ''}>\n                {new Date(document.expiry_date).toLocaleDateString('ru-RU')}\n              </p>\n            </div>\n          )}\n        </div>\n\n        {document.notes && (\n          <div>\n            <span className=\"font-medium text-muted-foreground\">Примечания:</span>\n            <p className=\"text-sm mt-1\">{document.notes}</p>\n          </div>\n        )}\n\n        <div className=\"flex items-center justify-between pt-2 border-t\">\n          <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n            <FileText className=\"h-4 w-4\" />\n            <span>{document.file_name}</span>\n            <span>({formatFileSize(document.file_size)})</span>\n            {document.is_verified && (\n              <Badge variant=\"outline\" className=\"text-green-600 border-green-600\">\n                <Shield className=\"h-3 w-3 mr-1\" />\n                Проверен\n              </Badge>\n            )}\n          </div>\n\n          <div className=\"flex gap-2\">\n            <Button variant=\"outline\" size=\"sm\" onClick={handleView}>\n              <Eye className=\"h-4 w-4 mr-1\" />\n              Просмотр\n            </Button>\n            <Button variant=\"outline\" size=\"sm\" onClick={handleDownload}>\n              <Download className=\"h-4 w-4 mr-1\" />\n              Скачать\n            </Button>\n            <Button variant=\"outline\" size=\"sm\" onClick={handleDelete} className=\"text-red-600 hover:text-red-700\">\n              <X className=\"h-4 w-4 mr-1\" />\n              Удалить\n            </Button>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n\nfunction DocumentsByCategory({ documents }: { documents: WorkerDocument[] }) {\n  // Group documents by category\n  const documentsByCategory = documents.reduce((acc, doc) => {\n    const categoryName = doc.category.name_ru || doc.category.name_en;\n    if (!acc[categoryName]) {\n      acc[categoryName] = [];\n    }\n    acc[categoryName].push(doc);\n    return acc;\n  }, {} as Record<string, WorkerDocument[]>);\n\n  return (\n    <div className=\"space-y-6\">\n      {Object.entries(documentsByCategory).map(([categoryName, categoryDocs]) => (\n        <div key={categoryName}>\n          <h3 className=\"font-semibold text-lg mb-3 flex items-center gap-2\">\n            <div\n              className=\"w-3 h-3 rounded-full\"\n              style={{ backgroundColor: categoryDocs[0].category.color }}\n            />\n            {categoryName}\n            <Badge variant=\"outline\">{categoryDocs.length}</Badge>\n          </h3>\n          {categoryDocs.map(doc => (\n            <DocumentCard key={doc.id} document={doc} />\n          ))}\n        </div>\n      ))}\n    </div>\n  );\n}\n\nexport default function WorkerDocumentsDialog({\n  userId,\n  userName,\n  trigger\n}: WorkerDocumentsDialogProps) {\n  const [open, setOpen] = useState(false);\n  const [showUpload, setShowUpload] = useState(false);\n  const queryClient = useQueryClient();\n\n  const { data, isLoading, error } = useQuery({\n    queryKey: ['worker-documents', userId],\n    queryFn: () => fetchWorkerDocuments(userId),\n    enabled: open, // Only fetch when dialog is open\n  });\n\n  const defaultTrigger = (\n    <Button variant=\"outline\" size=\"sm\">\n      <FileText className=\"h-4 w-4 mr-1\" />\n      Документы\n    </Button>\n  );\n\n  return (\n    <Dialog open={open} onOpenChange={setOpen}>\n      <DialogTrigger asChild>\n        {trigger || defaultTrigger}\n      </DialogTrigger>\n      <DialogContent className=\"max-w-4xl max-h-[80vh] overflow-y-auto\">\n        <DialogHeader>\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <DialogTitle className=\"flex items-center gap-2\">\n                <FileText className=\"h-5 w-5\" />\n                Документы работника: {userName}\n              </DialogTitle>\n              <DialogDescription>\n                Просмотр всех документов работника (страховка, разрешения, удостоверения)\n              </DialogDescription>\n            </div>\n            <Button\n              onClick={() => setShowUpload(true)}\n              className=\"flex items-center gap-2\"\n            >\n              <Plus className=\"h-4 w-4\" />\n              Добавить документ\n            </Button>\n          </div>\n        </DialogHeader>\n\n        {isLoading && (\n          <div className=\"flex justify-center py-8\">\n            <div className=\"h-6 w-6 animate-spin rounded-full border-2 border-primary border-t-transparent\" />\n          </div>\n        )}\n\n        {error && (\n          <div className=\"text-center py-8\">\n            <p className=\"text-destructive\">Ошибка загрузки документов</p>\n          </div>\n        )}\n\n        {data && (\n          <div className=\"space-y-6\">\n            {/* Stats */}\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n              <Card>\n                <CardContent className=\"p-4 text-center\">\n                  <div className=\"text-2xl font-bold\">{data.stats.total}</div>\n                  <div className=\"text-sm text-muted-foreground\">Всего</div>\n                </CardContent>\n              </Card>\n              <Card>\n                <CardContent className=\"p-4 text-center\">\n                  <div className=\"text-2xl font-bold text-green-600\">{data.stats.active}</div>\n                  <div className=\"text-sm text-muted-foreground\">Действительных</div>\n                </CardContent>\n              </Card>\n              <Card>\n                <CardContent className=\"p-4 text-center\">\n                  <div className=\"text-2xl font-bold text-yellow-600\">{data.stats.expiring_soon}</div>\n                  <div className=\"text-sm text-muted-foreground\">Истекают скоро</div>\n                </CardContent>\n              </Card>\n              <Card>\n                <CardContent className=\"p-4 text-center\">\n                  <div className=\"text-2xl font-bold text-red-600\">{data.stats.expired}</div>\n                  <div className=\"text-sm text-muted-foreground\">Истёкших</div>\n                </CardContent>\n              </Card>\n            </div>\n\n            {/* Documents */}\n            {data.documents.length === 0 ? (\n              <div className=\"text-center py-8\">\n                <FileText className=\"mx-auto h-12 w-12 text-muted-foreground\" />\n                <h3 className=\"mt-2 text-sm font-semibold\">Нет документов</h3>\n                <p className=\"mt-1 text-sm text-muted-foreground\">\n                  У этого работника пока нет загруженных документов.\n                </p>\n              </div>\n            ) : (\n              <Tabs defaultValue=\"all\" className=\"w-full\">\n                <TabsList className=\"grid w-full grid-cols-4\">\n                  <TabsTrigger value=\"all\">Все ({data.stats.total})</TabsTrigger>\n                  <TabsTrigger value=\"active\">Действительные ({data.stats.active})</TabsTrigger>\n                  <TabsTrigger value=\"expiring\">Истекают ({data.stats.expiring_soon})</TabsTrigger>\n                  <TabsTrigger value=\"expired\">Истёкшие ({data.stats.expired})</TabsTrigger>\n                </TabsList>\n\n                <TabsContent value=\"all\" className=\"mt-6\">\n                  <DocumentsByCategory documents={data.documents} />\n                </TabsContent>\n\n                <TabsContent value=\"active\" className=\"mt-6\">\n                  <DocumentsByCategory\n                    documents={data.documents.filter(doc => doc.status === 'active')}\n                  />\n                </TabsContent>\n\n                <TabsContent value=\"expiring\" className=\"mt-6\">\n                  <DocumentsByCategory\n                    documents={data.documents.filter(doc => doc.status === 'expiring_soon')}\n                  />\n                </TabsContent>\n\n                <TabsContent value=\"expired\" className=\"mt-6\">\n                  <DocumentsByCategory\n                    documents={data.documents.filter(doc => doc.status === 'expired')}\n                  />\n                </TabsContent>\n              </Tabs>\n            )}\n          </div>\n        )}\n      </DialogContent>\n\n      {/* Upload Document Dialog */}\n      <Dialog open={showUpload} onOpenChange={setShowUpload}>\n        <DialogContent className=\"max-w-2xl\">\n          <DialogHeader>\n            <DialogTitle>Загрузить документ для {userName}</DialogTitle>\n            <DialogDescription>\n              Загрузите новый документ (паспорт, разрешение на работу, страховка и т.д.)\n            </DialogDescription>\n          </DialogHeader>\n          <DocumentUpload\n            userId={userId}\n            onUploadComplete={(document) => {\n              console.log(`✅ Документ \"${document.file_name}\" успешно добавлен для работника: ${userName} (ID: ${userId})`);\n              setShowUpload(false);\n              // Refresh the documents data\n              queryClient.invalidateQueries({\n                queryKey: ['worker-documents', userId]\n              });\n              // Also invalidate categories data since it might be fetched from the same endpoint\n              queryClient.invalidateQueries({\n                queryKey: ['user-documents-categories', userId]\n              });\n            }}\n          />\n        </DialogContent>\n      </Dialog>\n    </Dialog>\n  );\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 4328, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/T7/cometa/cometa-separated-projects/cometa-frontend-nextjs/src/app/%28dashboard%29/dashboard/teams/%5Bid%5D/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport { useRouter, useParams } from \"next/navigation\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport {\n  ArrowLeft,\n  Users,\n  Edit,\n  Save,\n  X,\n  MapPin,\n  Calendar,\n  Mail,\n  Phone,\n  UserPlus,\n  Trash2,\n  Settings,\n  Wrench,\n  Truck,\n  Package\n} from \"lucide-react\";\n\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Label } from \"@/components/ui/label\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n  AlertDialogTrigger,\n} from \"@/components/ui/alert-dialog\";\n\nimport { useCrew, useUpdateCrew, useDeleteCrew } from \"@/hooks/use-teams\";\nimport { useUsers } from \"@/hooks/use-users\";\nimport { useProjects } from \"@/hooks/use-projects\";\nimport { usePermissions } from \"@/hooks/use-auth\";\nimport { useCrewEquipmentAssignments } from \"@/hooks/use-equipment\";\nimport { useCrewVehicleAssignments } from \"@/hooks/use-vehicles\";\nimport WorkerDocumentsDialog from \"@/components/documents/worker-documents-dialog\";\n\n// Validation schema for editing teams\nconst editTeamSchema = z.object({\n  name: z.string().min(1, \"Team name is required\"),\n  foreman_user_id: z.string().optional(),\n  project_id: z.string().optional(),\n});\n\ntype EditTeamFormData = z.infer<typeof editTeamSchema>;\n\nexport default function TeamDetailsPage() {\n  const router = useRouter();\n  const params = useParams();\n  const { canManageTeams } = usePermissions();\n\n  const [isEditing, setIsEditing] = useState(false);\n  const teamId = params.id as string;\n  const { data: crew, isLoading: crewLoading, error } = useCrew(teamId);\n  const updateCrew = useUpdateCrew();\n  const deleteCrew = useDeleteCrew();\n\n  const { data: usersResponse } = useUsers({\n    page: 1,\n    per_page: 100\n  });\n  const { data: projectsResponse, isLoading: projectsLoading } = useProjects({\n    page: 1,\n    per_page: 50\n  });\n\n  // Fetch crew assignments\n  const { data: equipmentAssignments, isLoading: equipmentLoading } = useCrewEquipmentAssignments(teamId);\n  const { data: vehicleAssignments, isLoading: vehicleLoading } = useCrewVehicleAssignments(teamId);\n\n  const users = usersResponse?.items || [];\n  const projects = projectsResponse?.items || [];\n  const foremen = users.filter(user => [\"foreman\", \"pm\", \"admin\"].includes(user.role));\n\n  const editTeamForm = useForm<EditTeamFormData>({\n    resolver: zodResolver(editTeamSchema),\n    defaultValues: {\n      name: crew?.name || \"\",\n      foreman_user_id: crew?.foreman_user_id || \"\",\n      project_id: crew?.project_id || \"\",\n    },\n  });\n\n  // Update form when crew data loads\n  useEffect(() => {\n    if (crew) {\n      editTeamForm.reset({\n        name: crew.name,\n        foreman_user_id: crew.foreman_user_id || \"\",\n        project_id: crew.project_id || \"\",\n      });\n    }\n  }, [crew, editTeamForm]);\n\n  const handleUpdateTeam = async (data: EditTeamFormData) => {\n    if (!crew) return;\n\n    try {\n      const teamData = {\n        name: data.name,\n        foreman_user_id: data.foreman_user_id === \"none\" ? undefined : data.foreman_user_id,\n        project_id: data.project_id === \"none\" ? undefined : data.project_id,\n      };\n\n      await updateCrew.mutateAsync({ id: crew.id, data: teamData });\n      setIsEditing(false);\n    } catch (error) {\n      console.error(\"Failed to update team:\", error);\n    }\n  };\n\n  const handleDeleteTeam = async () => {\n    if (!crew) return;\n\n    try {\n      await deleteCrew.mutateAsync(crew.id);\n      router.push(\"/dashboard/teams\");\n    } catch (error) {\n      console.error(\"Failed to delete team:\", error);\n    }\n  };\n\n\n  const getRoleColor = (role: string) => {\n    switch (role) {\n      case \"foreman\":\n        return \"default\";\n      case \"crew\":\n      case \"worker\":\n        return \"secondary\";\n      default:\n        return \"outline\";\n    }\n  };\n\n  if (crewLoading) {\n    return (\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center space-x-4\">\n          <div className=\"h-10 w-20 bg-muted animate-pulse rounded\" />\n          <div>\n            <div className=\"h-8 w-64 bg-muted animate-pulse rounded\" />\n            <div className=\"h-4 w-96 mt-2 bg-muted animate-pulse rounded\" />\n          </div>\n        </div>\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n          <div className=\"h-96 bg-muted animate-pulse rounded\" />\n          <div className=\"h-96 bg-muted animate-pulse rounded\" />\n        </div>\n      </div>\n    );\n  }\n\n  if (error || !crew) {\n    return (\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center space-x-4\">\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            onClick={() => router.back()}\n            className=\"flex items-center space-x-2\"\n          >\n            <ArrowLeft className=\"h-4 w-4\" />\n            <span>Back</span>\n          </Button>\n          <div>\n            <h1 className=\"text-3xl font-bold tracking-tight text-destructive\">Team Not Found</h1>\n            <p className=\"text-muted-foreground\">\n              The team you're looking for doesn't exist or has been deleted.\n            </p>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex items-center space-x-4\">\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            onClick={() => router.back()}\n            className=\"flex items-center space-x-2\"\n          >\n            <ArrowLeft className=\"h-4 w-4\" />\n            <span>Back</span>\n          </Button>\n          <div>\n            <h1 className=\"text-3xl font-bold tracking-tight\">{crew.name}</h1>\n            <p className=\"text-muted-foreground\">\n              Team details and member management\n            </p>\n          </div>\n        </div>\n        {canManageTeams && (\n          <div className=\"flex items-center space-x-2\">\n            {!isEditing ? (\n              <Button\n                variant=\"outline\"\n                onClick={() => setIsEditing(true)}\n                className=\"flex items-center space-x-2\"\n              >\n                <Edit className=\"h-4 w-4\" />\n                <span>Edit Team</span>\n              </Button>\n            ) : (\n              <Button\n                variant=\"outline\"\n                onClick={() => setIsEditing(false)}\n                className=\"flex items-center space-x-2\"\n              >\n                <X className=\"h-4 w-4\" />\n                <span>Cancel</span>\n              </Button>\n            )}\n            <AlertDialog>\n              <AlertDialogTrigger asChild>\n                <Button variant=\"destructive\" size=\"sm\">\n                  <Trash2 className=\"h-4 w-4\" />\n                </Button>\n              </AlertDialogTrigger>\n              <AlertDialogContent>\n                <AlertDialogHeader>\n                  <AlertDialogTitle>Delete Team</AlertDialogTitle>\n                  <AlertDialogDescription>\n                    Are you sure you want to delete \"{crew.name}\"? This action cannot be undone.\n                  </AlertDialogDescription>\n                </AlertDialogHeader>\n                <AlertDialogFooter>\n                  <AlertDialogCancel>Cancel</AlertDialogCancel>\n                  <AlertDialogAction\n                    onClick={handleDeleteTeam}\n                    className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n                  >\n                    Delete\n                  </AlertDialogAction>\n                </AlertDialogFooter>\n              </AlertDialogContent>\n            </AlertDialog>\n          </div>\n        )}\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n        {/* Team Information */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center space-x-2\">\n              <Settings className=\"h-5 w-5\" />\n              <span>Team Information</span>\n            </CardTitle>\n            <CardDescription>\n              Basic team details and assignments\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            {!isEditing ? (\n              <div className=\"space-y-4\">\n                <div>\n                  <Label className=\"text-sm font-medium\">Team Name</Label>\n                  <p className=\"text-lg\">{crew.name}</p>\n                </div>\n\n                {crew.foreman && (\n                  <div>\n                    <Label className=\"text-sm font-medium\">Team Leader / Foreman</Label>\n                    <div className=\"flex items-center space-x-2 mt-1\">\n                      <Badge variant=\"default\">{crew.foreman.role}</Badge>\n                      <span className=\"text-sm\">{crew.foreman.full_name}</span>\n                    </div>\n                    {crew.foreman.email && (\n                      <div className=\"flex items-center space-x-2 text-sm text-muted-foreground mt-1\">\n                        <Mail className=\"h-3 w-3\" />\n                        <span>{crew.foreman.email}</span>\n                      </div>\n                    )}\n                    {crew.foreman.phone && (\n                      <div className=\"flex items-center space-x-2 text-sm text-muted-foreground\">\n                        <Phone className=\"h-3 w-3\" />\n                        <span>{crew.foreman.phone}</span>\n                      </div>\n                    )}\n                  </div>\n                )}\n\n                {crew.project_name && (\n                  <div>\n                    <Label className=\"text-sm font-medium\">Assigned Project</Label>\n                    <div className=\"flex items-center space-x-2 mt-1\">\n                      <MapPin className=\"h-4 w-4 text-muted-foreground\" />\n                      <span>{crew.project_name}</span>\n                    </div>\n                  </div>\n                )}\n\n                <div>\n                  <Label className=\"text-sm font-medium\">Status</Label>\n                  <div className=\"mt-1\">\n                    <Badge variant=\"secondary\">{crew.status}</Badge>\n                  </div>\n                </div>\n\n                <div>\n                  <Label className=\"text-sm font-medium\">Created</Label>\n                  <div className=\"flex items-center space-x-2 text-sm text-muted-foreground mt-1\">\n                    <Calendar className=\"h-3 w-3\" />\n                    <span>{new Date(crew.created_at).toLocaleDateString()}</span>\n                  </div>\n                </div>\n              </div>\n            ) : (\n              <Form {...editTeamForm}>\n                <form onSubmit={editTeamForm.handleSubmit(handleUpdateTeam)} className=\"space-y-4\">\n                  <FormField\n                    control={editTeamForm.control}\n                    name=\"name\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Team Name *</FormLabel>\n                        <FormControl>\n                          <Input\n                            placeholder=\"e.g., Installation Team Alpha\"\n                            {...field}\n                          />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={editTeamForm.control}\n                    name=\"foreman_user_id\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Team Leader / Foreman</FormLabel>\n                        <Select onValueChange={field.onChange} value={field.value}>\n                          <FormControl>\n                            <SelectTrigger>\n                              <SelectValue placeholder=\"Select team leader\" />\n                            </SelectTrigger>\n                          </FormControl>\n                          <SelectContent>\n                            <SelectItem value=\"none\">No leader assigned</SelectItem>\n                            {foremen.map((user) => (\n                              <SelectItem key={user.id} value={user.id}>\n                                {user.full_name} ({user.role})\n                              </SelectItem>\n                            ))}\n                          </SelectContent>\n                        </Select>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={editTeamForm.control}\n                    name=\"project_id\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Assign to Project</FormLabel>\n                        <Select onValueChange={field.onChange} value={field.value}>\n                          <FormControl>\n                            <SelectTrigger>\n                              <SelectValue placeholder=\"Select project (optional)\" />\n                            </SelectTrigger>\n                          </FormControl>\n                          <SelectContent>\n                            <SelectItem value=\"none\">No project assigned</SelectItem>\n                            {projectsLoading ? (\n                              <SelectItem value=\"loading\" disabled>Loading projects...</SelectItem>\n                            ) : (\n                              projects.map((project) => (\n                                <SelectItem key={project.id} value={project.id}>\n                                  {project.name}\n                                </SelectItem>\n                              ))\n                            )}\n                          </SelectContent>\n                        </Select>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <div className=\"flex justify-end space-x-2 pt-4\">\n                    <Button\n                      type=\"button\"\n                      variant=\"outline\"\n                      onClick={() => setIsEditing(false)}\n                    >\n                      <X className=\"mr-2 h-4 w-4\" />\n                      Cancel\n                    </Button>\n                    <Button type=\"submit\" disabled={updateCrew.isPending}>\n                      {updateCrew.isPending ? (\n                        <div className=\"h-4 w-4 animate-spin rounded-full border-2 border-background border-t-transparent mr-2\" />\n                      ) : (\n                        <Save className=\"mr-2 h-4 w-4\" />\n                      )}\n                      Save Changes\n                    </Button>\n                  </div>\n                </form>\n              </Form>\n            )}\n          </CardContent>\n        </Card>\n\n        {/* Team Members */}\n        <Card>\n          <CardHeader>\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <CardTitle className=\"flex items-center space-x-2\">\n                  <Users className=\"h-5 w-5\" />\n                  <span>Team Members ({crew.members?.length || 0})</span>\n                </CardTitle>\n                <CardDescription>\n                  Current team members and their roles\n                </CardDescription>\n              </div>\n              {canManageTeams && (\n                <Button\n                  variant=\"outline\"\n                  onClick={() => router.push(`/dashboard/teams/${teamId}/members`)}\n                  className=\"flex items-center space-x-2\"\n                >\n                  <UserPlus className=\"h-4 w-4\" />\n                  <span>Manage Members</span>\n                </Button>\n              )}\n            </div>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-3\">\n              {crew.members?.length === 0 ? (\n                <div className=\"text-center py-8\">\n                  <UserPlus className=\"mx-auto h-12 w-12 text-muted-foreground\" />\n                  <h3 className=\"mt-2 text-sm font-semibold\">No team members</h3>\n                  <p className=\"mt-1 text-sm text-muted-foreground\">\n                    This team doesn't have any members assigned yet.\n                  </p>\n                  {canManageTeams && (\n                    <Button\n                      variant=\"outline\"\n                      className=\"mt-4\"\n                      onClick={() => router.push(`/dashboard/teams/${teamId}/members`)}\n                    >\n                      <UserPlus className=\"mr-2 h-4 w-4\" />\n                      Add Members\n                    </Button>\n                  )}\n                </div>\n              ) : (\n                crew.members?.map((member) => (\n                  <div\n                    key={member.id}\n                    className=\"flex items-center space-x-3 p-3 border rounded-lg\"\n                  >\n                    <div className=\"flex-1\">\n                      <div className=\"font-medium text-sm\">{member.user.full_name}</div>\n                      <div className=\"text-xs text-muted-foreground\">\n                        {member.user.email || member.user.phone || \"No contact info\"}\n                      </div>\n                    </div>\n                    <div className=\"flex items-center space-x-2\">\n                      <Badge variant={getRoleColor(member.user.role || \"\")}>\n                        {member.user.role}\n                      </Badge>\n                      <Badge variant=\"outline\">\n                        {member.role_in_crew}\n                      </Badge>\n                      <WorkerDocumentsDialog\n                        userId={member.user.id}\n                        userName={member.user.full_name}\n                      />\n                    </div>\n                  </div>\n                ))\n              )}\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Assigned Resources - Full Width Section */}\n      <Card>\n          <CardHeader>\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <CardTitle className=\"flex items-center space-x-2\">\n                  <Package className=\"h-5 w-5\" />\n                  <span>Assigned Resources</span>\n                </CardTitle>\n                <CardDescription>\n                  Equipment and vehicles assigned to this crew\n                </CardDescription>\n              </div>\n              {canManageTeams && (\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={() => router.push('/dashboard/equipment/assignments/new')}\n                  className=\"flex items-center space-x-2\"\n                >\n                  <Package className=\"h-4 w-4\" />\n                  <span>Assign Resource</span>\n                </Button>\n              )}\n            </div>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n              {/* Equipment Section */}\n              <div>\n                <div className=\"flex items-center space-x-2 mb-3\">\n                  <Wrench className=\"h-5 w-5 text-muted-foreground\" />\n                  <span className=\"text-lg font-semibold\">Equipment ({equipmentAssignments?.length || 0})</span>\n                </div>\n                {equipmentLoading ? (\n                  <div className=\"space-y-2\">\n                    {Array.from({ length: 2 }).map((_, i) => (\n                      <div key={i} className=\"h-16 bg-muted animate-pulse rounded\" />\n                    ))}\n                  </div>\n                ) : !equipmentAssignments?.length ? (\n                  <div className=\"text-center py-6 border rounded-lg bg-muted/10\">\n                    <Wrench className=\"mx-auto h-12 w-12 text-muted-foreground\" />\n                    <p className=\"mt-2 text-sm text-muted-foreground\">No equipment assigned</p>\n                  </div>\n                ) : (\n                  <div className=\"space-y-3\">\n                    {equipmentAssignments?.map((assignment) => (\n                      <div\n                        key={assignment.id}\n                        className=\"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/5 transition-colors\"\n                      >\n                        <div className=\"flex items-center space-x-3\">\n                          <Wrench className=\"h-5 w-5 text-muted-foreground\" />\n                          <div>\n                            <div className=\"font-medium\">\n                              {assignment.equipment?.name || 'Unknown Equipment'}\n                            </div>\n                            {assignment.equipment?.inventory_no && (\n                              <div className=\"text-sm text-muted-foreground\">\n                                #{assignment.equipment.inventory_no}\n                              </div>\n                            )}\n                          </div>\n                        </div>\n                        <div className=\"text-right\">\n                          <div className=\"text-xs text-muted-foreground\">\n                            {assignment.is_permanent ? 'Permanent' : 'Temporary'}\n                          </div>\n                          {assignment.project_name && (\n                            <div className=\"text-xs text-muted-foreground\">\n                              Project: {assignment.project_name}\n                            </div>\n                          )}\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </div>\n\n              {/* Vehicle Section */}\n              <div>\n                <div className=\"flex items-center space-x-2 mb-3\">\n                  <Truck className=\"h-5 w-5 text-muted-foreground\" />\n                  <span className=\"text-lg font-semibold\">Vehicles ({vehicleAssignments?.length || 0})</span>\n                </div>\n                {vehicleLoading ? (\n                  <div className=\"space-y-2\">\n                    {Array.from({ length: 2 }).map((_, i) => (\n                      <div key={i} className=\"h-16 bg-muted animate-pulse rounded\" />\n                    ))}\n                  </div>\n                ) : !vehicleAssignments?.length ? (\n                  <div className=\"text-center py-6 border rounded-lg bg-muted/10\">\n                    <Truck className=\"mx-auto h-12 w-12 text-muted-foreground\" />\n                    <p className=\"mt-2 text-sm text-muted-foreground\">No vehicles assigned</p>\n                  </div>\n                ) : (\n                  <div className=\"space-y-3\">\n                    {vehicleAssignments?.map((assignment) => (\n                      <div\n                        key={assignment.id}\n                        className=\"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/5 transition-colors\"\n                      >\n                        <div className=\"flex items-center space-x-3\">\n                          <Truck className=\"h-5 w-5 text-muted-foreground\" />\n                          <div>\n                            <div className=\"font-medium\">\n                              {assignment.vehicle?.brand} {assignment.vehicle?.model}\n                            </div>\n                            {assignment.vehicle?.plate_number && (\n                              <div className=\"text-sm text-muted-foreground\">\n                                🚗 {assignment.vehicle.plate_number}\n                              </div>\n                            )}\n                          </div>\n                        </div>\n                        <div className=\"text-right\">\n                          <div className=\"text-xs text-muted-foreground\">\n                            {assignment.is_permanent ? 'Permanent' : 'Temporary'}\n                          </div>\n                          {assignment.project_name && (\n                            <div className=\"text-xs text-muted-foreground\">\n                              Project: {assignment.project_name}\n                            </div>\n                          )}\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n    </div>\n  );\n}"],"names":[],"mappings":"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","debugId":null}}]
}