module.exports=[36338,a=>{"use strict";a.s(["default",()=>z],36338);var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(56711),f=a.i(15618),g=a.i(69012),h=a.i(210),i=a.i(41675),j=a.i(83497);let k=(0,a.i(70106).default)("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);var l=a.i(46842),m=a.i(24669),n=a.i(53277),o=a.i(99570),p=a.i(91119),q=a.i(86304),r=a.i(6015),s=a.i(80701),t=a.i(33140),u=a.i(40533),v=a.i(86456),w=a.i(38408);let x={allocated:"bg-blue-100 text-blue-800 border-blue-200",partially_used:"bg-yellow-100 text-yellow-800 border-yellow-200",fully_used:"bg-green-100 text-green-800 border-green-200",returned:"bg-gray-100 text-gray-800 border-gray-200"},y={allocated:"Allocated",partially_used:"Partially Used",fully_used:"Fully Used",returned:"Returned"};function z(){let a=(0,d.useRouter)(),[z,A]=(0,c.useState)({status:"",project_id:"",crew_id:"",material_id:""}),{data:B,isLoading:C}=(0,u.useAllocations)(z),{data:D}=(0,v.useProjects)({status:"active"}),{data:E}=(0,w.useCrews)(),F=(a,b)=>{A(c=>({...c,[a]:"all"===b?"":b}))},G=B?.reduce((a,b)=>(a.totalValue+=b.total_value,a.totalAllocated+=b.allocated_qty,a.totalUsed+=b.used_qty,"allocated"===b.status&&a.activeAllocations++,a),{totalValue:0,totalAllocated:0,totalUsed:0,activeAllocations:0})||{totalValue:0,totalAllocated:0,totalUsed:0,activeAllocations:0},H=G.totalAllocated>0?Math.round(G.totalUsed/G.totalAllocated*100):0;return C?(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(t.Skeleton,{className:"h-8 w-64 mb-2"}),(0,b.jsx)(t.Skeleton,{className:"h-4 w-96"})]}),(0,b.jsx)(t.Skeleton,{className:"h-10 w-32"})]}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:Array.from({length:4}).map((a,c)=>(0,b.jsx)(p.Card,{children:(0,b.jsxs)(p.CardContent,{className:"p-6",children:[(0,b.jsx)(t.Skeleton,{className:"h-4 w-20 mb-2"}),(0,b.jsx)(t.Skeleton,{className:"h-8 w-16 mb-1"}),(0,b.jsx)(t.Skeleton,{className:"h-3 w-24"})]})},c))}),(0,b.jsx)(p.Card,{children:(0,b.jsx)(p.CardContent,{className:"p-6",children:(0,b.jsx)(t.Skeleton,{className:"h-64 w-full"})})})]}):(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,b.jsxs)(o.Button,{variant:"ghost",size:"sm",onClick:()=>a.back(),className:"flex items-center space-x-2",children:[(0,b.jsx)(h.ArrowLeft,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"Back"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Material Allocations"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Track and manage material allocations to projects and crews"})]})]}),(0,b.jsxs)(o.Button,{onClick:()=>a.push("/dashboard/materials/allocations/new"),children:[(0,b.jsx)(f.Plus,{className:"mr-2 h-4 w-4"}),"New Allocation"]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,b.jsx)(p.Card,{children:(0,b.jsx)(p.CardContent,{className:"p-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Value"}),(0,b.jsxs)("p",{className:"text-2xl font-bold",children:["€",G.totalValue.toLocaleString()]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"All allocations"})]}),(0,b.jsx)(m.TrendingUp,{className:"h-8 w-8 text-green-600"})]})})}),(0,b.jsx)(p.Card,{children:(0,b.jsx)(p.CardContent,{className:"p-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Active Allocations"}),(0,b.jsx)("p",{className:"text-2xl font-bold",children:G.activeAllocations}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Currently allocated"})]}),(0,b.jsx)(j.Package,{className:"h-8 w-8 text-blue-600"})]})})}),(0,b.jsx)(p.Card,{children:(0,b.jsx)(p.CardContent,{className:"p-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Utilization Rate"}),(0,b.jsxs)("p",{className:"text-2xl font-bold",children:[H,"%"]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Materials used vs allocated"})]}),(0,b.jsx)(n.TrendingDown,{className:"h-8 w-8 text-orange-600"})]})})}),(0,b.jsx)(p.Card,{children:(0,b.jsx)(p.CardContent,{className:"p-6",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Allocations"}),(0,b.jsx)("p",{className:"text-2xl font-bold",children:B?.length||0}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"All time"})]}),(0,b.jsx)(k,{className:"h-8 w-8 text-purple-600"})]})})})]}),(0,b.jsxs)(p.Card,{children:[(0,b.jsx)(p.CardHeader,{children:(0,b.jsxs)(p.CardTitle,{className:"flex items-center space-x-2",children:[(0,b.jsx)(g.Filter,{className:"h-5 w-5"}),(0,b.jsx)("span",{children:"Filters"})]})}),(0,b.jsx)(p.CardContent,{children:(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Status"}),(0,b.jsxs)(s.Select,{value:z.status||"all",onValueChange:a=>F("status",a),children:[(0,b.jsx)(s.SelectTrigger,{children:(0,b.jsx)(s.SelectValue,{placeholder:"All statuses"})}),(0,b.jsxs)(s.SelectContent,{children:[(0,b.jsx)(s.SelectItem,{value:"all",children:"All statuses"}),(0,b.jsx)(s.SelectItem,{value:"allocated",children:"Allocated"}),(0,b.jsx)(s.SelectItem,{value:"partially_used",children:"Partially Used"}),(0,b.jsx)(s.SelectItem,{value:"fully_used",children:"Fully Used"}),(0,b.jsx)(s.SelectItem,{value:"returned",children:"Returned"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Project"}),(0,b.jsxs)(s.Select,{value:z.project_id||"all",onValueChange:a=>F("project_id",a),children:[(0,b.jsx)(s.SelectTrigger,{children:(0,b.jsx)(s.SelectValue,{placeholder:"All projects"})}),(0,b.jsxs)(s.SelectContent,{children:[(0,b.jsx)(s.SelectItem,{value:"all",children:"All projects"}),D?.items?.map(a=>(0,b.jsx)(s.SelectItem,{value:a.id,children:a.name},a.id))]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Crew"}),(0,b.jsxs)(s.Select,{value:z.crew_id||"all",onValueChange:a=>F("crew_id",a),children:[(0,b.jsx)(s.SelectTrigger,{children:(0,b.jsx)(s.SelectValue,{placeholder:"All crews"})}),(0,b.jsxs)(s.SelectContent,{children:[(0,b.jsx)(s.SelectItem,{value:"all",children:"All crews"}),E?.map(a=>(0,b.jsx)(s.SelectItem,{value:a.id,children:a.name},a.id))]})]})]}),(0,b.jsx)("div",{className:"flex items-end",children:(0,b.jsx)(o.Button,{variant:"outline",onClick:()=>A({status:"",project_id:"",crew_id:"",material_id:""}),className:"w-full",children:"Clear Filters"})})]})})]}),(0,b.jsxs)(p.Card,{children:[(0,b.jsxs)(p.CardHeader,{children:[(0,b.jsx)(p.CardTitle,{children:"Allocations"}),(0,b.jsxs)(p.CardDescription,{children:[B?.length||0," allocation",B?.length!==1?"s":""," found"]})]}),(0,b.jsx)(p.CardContent,{children:B&&B.length>0?(0,b.jsx)("div",{className:"rounded-md border",children:(0,b.jsxs)(r.Table,{children:[(0,b.jsx)(r.TableHeader,{children:(0,b.jsxs)(r.TableRow,{children:[(0,b.jsx)(r.TableHead,{children:"Date"}),(0,b.jsx)(r.TableHead,{children:"Material"}),(0,b.jsx)(r.TableHead,{children:"Quantity"}),(0,b.jsx)(r.TableHead,{children:"Target"}),(0,b.jsx)(r.TableHead,{children:"Status"}),(0,b.jsx)(r.TableHead,{children:"Progress"}),(0,b.jsx)(r.TableHead,{children:"Value"}),(0,b.jsx)(r.TableHead,{children:"Allocated By"}),(0,b.jsx)(r.TableHead,{className:"w-[100px]",children:"Actions"})]})}),(0,b.jsx)(r.TableBody,{children:B.map(c=>(0,b.jsxs)(r.TableRow,{className:"cursor-pointer hover:bg-muted/50",children:[(0,b.jsx)(r.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(i.Calendar,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsx)("span",{children:(0,e.format)(new Date(c.allocation_date),"MMM dd, yyyy")})]})}),(0,b.jsx)(r.TableCell,{children:(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:c.material.name}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["€",c.material.default_price_eur.toFixed(2),"/",c.material.unit]})]})}),(0,b.jsx)(r.TableCell,{children:(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{className:"font-medium",children:[c.allocated_qty.toLocaleString()," ",c.material.unit]}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Used: ",c.used_qty.toLocaleString()," ",c.material.unit]})]})}),(0,b.jsx)(r.TableCell,{children:(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:c.project_name||c.crew_name}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:c.project_name?"Project":"Crew"})]})}),(0,b.jsx)(r.TableCell,{children:(0,b.jsx)(q.Badge,{className:x[c.status],children:y[c.status]})}),(0,b.jsxs)(r.TableCell,{children:[(0,b.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,b.jsx)("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${Math.min(100,c.used_qty/c.allocated_qty*100)}%`}})}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[c.allocated_qty>0?Math.round(c.used_qty/c.allocated_qty*100):0,"% used"]})]}),(0,b.jsx)(r.TableCell,{children:(0,b.jsxs)("p",{className:"font-medium",children:["€",c.total_value.toLocaleString()]})}),(0,b.jsx)(r.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(l.User,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsx)("span",{className:"text-sm",children:c.allocated_by_name})]})}),(0,b.jsx)(r.TableCell,{children:(0,b.jsx)(o.Button,{variant:"ghost",size:"sm",onClick:()=>a.push(`/dashboard/materials/allocations/${c.id}`),children:"View"})})]},c.id))})]})}):(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)(j.Package,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,b.jsx)("h3",{className:"mt-4 text-lg font-semibold",children:"No allocations found"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"No material allocations match your current filters."}),(0,b.jsxs)(o.Button,{className:"mt-4",onClick:()=>a.push("/dashboard/materials/allocations/new"),children:[(0,b.jsx)(f.Plus,{className:"mr-2 h-4 w-4"}),"Create First Allocation"]})]})})]})]})}}];

//# sourceMappingURL=src_app_%28dashboard%29_dashboard_materials_allocations_page_tsx_558210e6._.js.map