{"version":3,"sources":["turbopack:///[project]/node_modules/next/src/server/route-modules/app-page/module.compiled.js","turbopack:///[project]/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-jsx-runtime.ts","turbopack:///[project]/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react.ts","turbopack:///[project]/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-dom.ts","turbopack:///[project]/src/hooks/use-auth.ts","turbopack:///[project]/src/lib/websocket-provider.tsx"],"sourcesContent":["if (process.env.NEXT_RUNTIME === 'edge') {\n  module.exports = require('next/dist/server/route-modules/app-page/module.js')\n} else {\n  if (process.env.__NEXT_EXPERIMENTAL_REACT) {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.prod.js')\n      }\n    }\n  } else {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.prod.js')\n      }\n    }\n  }\n}\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactJsxRuntime\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.React\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactDOM\n","import { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { toast } from \"sonner\";\nimport {\n  authApi,\n  setAuthTokenForAllClients,\n  clearAuthTokenForAllClients,\n  type LoginRequest,\n  type TokenResponse,\n  type AuthUser,\n} from \"@/lib/api-client\";\n\n// Query keys\nexport const authKeys = {\n  all: [\"auth\"] as const,\n  user: () => [...authKeys.all, \"user\"] as const,\n  token: () => [...authKeys.all, \"token\"] as const,\n};\n\n// Storage utilities\nconst TOKEN_STORAGE_KEY = \"cometa_auth_token\";\nconst REFRESH_TOKEN_STORAGE_KEY = \"cometa_refresh_token\";\nconst USER_STORAGE_KEY = \"cometa_user\";\n\nexport function getStoredToken(): string | null {\n  if (typeof window === \"undefined\") return null;\n  return localStorage.getItem(TOKEN_STORAGE_KEY);\n}\n\nexport function getStoredRefreshToken(): string | null {\n  if (typeof window === \"undefined\") return null;\n  return localStorage.getItem(REFRESH_TOKEN_STORAGE_KEY);\n}\n\nexport function getStoredUser(): AuthUser | null {\n  if (typeof window === \"undefined\") return null;\n  try {\n    const stored = localStorage.getItem(USER_STORAGE_KEY);\n    return stored ? JSON.parse(stored) : null;\n  } catch {\n    return null;\n  }\n}\n\nfunction storeAuthData(tokenResponse: TokenResponse) {\n  localStorage.setItem(TOKEN_STORAGE_KEY, tokenResponse.access_token);\n  localStorage.setItem(REFRESH_TOKEN_STORAGE_KEY, tokenResponse.refresh_token);\n  localStorage.setItem(\n    USER_STORAGE_KEY,\n    JSON.stringify({\n      ...tokenResponse.user,\n      permissions: tokenResponse.permissions,\n    })\n  );\n\n  // Set cookie for middleware\n  const expiryDate = new Date();\n  expiryDate.setTime(expiryDate.getTime() + (tokenResponse.expires_in * 1000));\n\n  // Only use secure flag in production\n  const isSecure = window.location.protocol === 'https:';\n  const secureFlag = isSecure ? '; secure' : '';\n\n  document.cookie = `cometa_auth_token=${tokenResponse.access_token}; expires=${expiryDate.toUTCString()}; path=/; samesite=strict${secureFlag}`;\n\n  // Set token for API clients\n  setAuthTokenForAllClients(tokenResponse.access_token);\n}\n\nfunction clearAuthData() {\n  localStorage.removeItem(TOKEN_STORAGE_KEY);\n  localStorage.removeItem(REFRESH_TOKEN_STORAGE_KEY);\n  localStorage.removeItem(USER_STORAGE_KEY);\n\n  // Clear cookie\n  document.cookie = \"cometa_auth_token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;\";\n\n  // Clear tokens from API clients\n  clearAuthTokenForAllClients();\n}\n\n// Initialize auth state on app start\nexport function initializeAuth() {\n  const token = getStoredToken();\n  if (token) {\n    setAuthTokenForAllClients(token);\n  }\n}\n\n// Hooks\nexport function useAuth() {\n  return useQuery({\n    queryKey: authKeys.user(),\n    queryFn: () => {\n      const user = getStoredUser();\n      if (!user) throw new Error(\"Not authenticated\");\n      return user;\n    },\n    staleTime: Infinity,\n    retry: false,\n  });\n}\n\nexport function useLogin() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: (credentials: LoginRequest) => authApi.login(credentials),\n    onSuccess: (tokenResponse) => {\n      // Store auth data\n      storeAuthData(tokenResponse);\n\n      // Update auth query cache\n      const authUser: AuthUser = {\n        ...tokenResponse.user,\n        permissions: tokenResponse.permissions,\n      };\n\n      queryClient.setQueryData(authKeys.user(), authUser);\n\n      toast.success(`Welcome back, ${tokenResponse.user.first_name}!`);\n\n      // Redirect to dashboard after successful login\n      if (typeof window !== \"undefined\") {\n        window.location.href = \"/dashboard\";\n      }\n    },\n    onError: (error) => {\n      toast.error(`Login failed: ${error.message}`);\n    },\n  });\n}\n\nexport function useLogout() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: () => authApi.logout(),\n    onSuccess: () => {\n      // Clear auth data\n      clearAuthData();\n\n      // Clear all auth-related queries\n      queryClient.removeQueries({ queryKey: authKeys.all });\n\n      // Clear all cached data to prevent data leaks\n      queryClient.clear();\n\n      toast.success(\"Logged out successfully\");\n    },\n    onError: (_error) => {\n      // Even if logout fails on server, clear local data\n      clearAuthData();\n      queryClient.removeQueries({ queryKey: authKeys.all });\n      queryClient.clear();\n\n      toast.error(\"Logout failed\");\n    },\n    onSettled: () => {\n      // Redirect to login page\n      if (typeof window !== \"undefined\") {\n        window.location.href = \"/login\";\n      }\n    },\n  });\n}\n\nexport function useRefreshToken() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: () => {\n      const refreshToken = getStoredRefreshToken();\n      if (!refreshToken) throw new Error(\"No refresh token available\");\n      return authApi.refreshToken(refreshToken);\n    },\n    onSuccess: (tokenResponse) => {\n      storeAuthData(tokenResponse);\n\n      const authUser: AuthUser = {\n        ...tokenResponse.user,\n        permissions: tokenResponse.permissions,\n      };\n\n      queryClient.setQueryData(authKeys.user(), authUser);\n    },\n    onError: (error) => {\n      // If refresh fails, logout user\n      clearAuthData();\n      queryClient.removeQueries({ queryKey: authKeys.all });\n\n      toast.error(\"Session expired. Please login again.\");\n\n      if (typeof window !== \"undefined\") {\n        window.location.href = \"/login\";\n      }\n    },\n  });\n}\n\n// Utility hook for checking permissions\nexport function usePermissions() {\n  const { data: user } = useAuth();\n\n  const hasPermission = (permission: string): boolean => {\n    return user?.permissions?.includes(permission) ?? false;\n  };\n\n  const hasRole = (role: string): boolean => {\n    return user?.role === role;\n  };\n\n  const hasAnyRole = (roles: string[]): boolean => {\n    return user?.role ? roles.includes(user.role) : false;\n  };\n\n  return {\n    user,\n    hasPermission,\n    hasRole,\n    hasAnyRole,\n    isAdmin: hasRole(\"admin\"),\n    isProjectManager: hasRole(\"pm\"),\n    isForeman: hasRole(\"foreman\"),\n    isWorker: hasAnyRole([\"crew\", \"worker\"]),\n    isViewer: hasRole(\"viewer\"),\n    canManageTeams: hasAnyRole([\"admin\", \"pm\", \"foreman\"]),\n    canApproveWork: hasAnyRole([\"admin\", \"pm\", \"foreman\"]),\n    canManageWork: hasAnyRole([\"admin\", \"pm\", \"foreman\", \"crew\", \"worker\"]),\n    canViewFinances: hasAnyRole([\"admin\", \"pm\", \"foreman\"]),\n    canManageFinances: hasAnyRole([\"admin\", \"pm\"]),\n    canManageInventory: hasAnyRole([\"admin\", \"pm\", \"foreman\"]),\n  };\n}\n\n// Hook for protecting routes\nexport function useRequireAuth() {\n  const { data: user, isLoading, error } = useAuth();\n\n  const isAuthenticated = !!user && !error;\n\n  return {\n    user,\n    isLoading,\n    isAuthenticated,\n    error,\n  };\n}","\"use client\";\n\nimport React, { createContext, useContext, useEffect, useRef } from \"react\";\nimport { useQueryClient } from \"@tanstack/react-query\";\nimport { toast } from \"sonner\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { wsApi } from \"@/lib/api-client\";\nimport type { WebSocketMessage, RealtimeEvent, Notification } from \"@/types\";\n\ninterface WebSocketContextType {\n  isConnected: boolean;\n  send: (type: string, data: any) => void;\n  subscribe: (messageType: string, handler: (data: any) => void) => void;\n  unsubscribe: (messageType: string, handler: (data: any) => void) => void;\n}\n\nconst WebSocketContext = createContext<WebSocketContextType | null>(null);\n\ninterface WebSocketProviderProps {\n  children: React.ReactNode;\n}\n\nexport function WebSocketProvider({ children }: WebSocketProviderProps) {\n  const { user, token } = useAuth();\n  const queryClient = useQueryClient();\n  const isConnectedRef = useRef(false);\n  const connectionAttempts = useRef(0);\n  const maxConnectionAttempts = 5;\n\n  const handleNotification = React.useCallback((notification: Notification) => {\n    // Update notification-related queries\n    queryClient.invalidateQueries({ queryKey: [\"notifications\"] });\n\n    if (user?.id) {\n      queryClient.invalidateQueries({ queryKey: [\"notifications\", \"unread-count\", user.id] });\n    }\n\n    // Add notification to cache\n    queryClient.setQueryData([\"notifications\", \"detail\", notification.id], notification);\n\n    // Show toast for important notifications\n    if (notification.priority === \"high\" || notification.priority === \"urgent\") {\n      toast.info(notification.title, {\n        description: notification.body,\n        action: notification.priority === \"urgent\" ? {\n          label: \"View\",\n          onClick: () => {\n            // Could implement navigation to specific pages based on notification data\n            console.log(\"Navigate to notification:\", notification.id);\n          }\n        } : undefined,\n      });\n    }\n  }, [queryClient, user?.id]);\n\n  const handleRealtimeUpdate = React.useCallback((event: RealtimeEvent) => {\n    console.log(\"Realtime update received:\", event);\n\n    // Invalidate queries based on entity type\n    switch (event.entity_type) {\n      case \"project\":\n        queryClient.invalidateQueries({ queryKey: [\"projects\"] });\n        if (event.entity_id) {\n          queryClient.invalidateQueries({ queryKey: [\"projects\", \"detail\", event.entity_id] });\n        }\n        break;\n\n      case \"work_entry\":\n        queryClient.invalidateQueries({ queryKey: [\"work-entries\"] });\n        if (event.entity_id) {\n          queryClient.invalidateQueries({ queryKey: [\"work-entries\", \"detail\", event.entity_id] });\n        }\n        break;\n\n      case \"material\":\n        queryClient.invalidateQueries({ queryKey: [\"materials\"] });\n        if (event.entity_id) {\n          queryClient.invalidateQueries({ queryKey: [\"materials\", \"detail\", event.entity_id] });\n        }\n        break;\n\n      case \"material_allocation\":\n        queryClient.invalidateQueries({ queryKey: [\"material-allocations\"] });\n        break;\n\n      case \"house\":\n        queryClient.invalidateQueries({ queryKey: [\"houses\"] });\n        if (event.entity_id) {\n          queryClient.invalidateQueries({ queryKey: [\"houses\", \"detail\", event.entity_id] });\n        }\n        break;\n\n      case \"appointment\":\n        queryClient.invalidateQueries({ queryKey: [\"appointments\"] });\n        if (event.entity_id) {\n          queryClient.invalidateQueries({ queryKey: [\"appointments\", \"detail\", event.entity_id] });\n        }\n        break;\n\n      case \"crew\":\n        queryClient.invalidateQueries({ queryKey: [\"crews\"] });\n        if (event.entity_id) {\n          queryClient.invalidateQueries({ queryKey: [\"crews\", \"detail\", event.entity_id] });\n        }\n        break;\n\n      default:\n        // Generic cache invalidation for unknown entity types\n        console.log(\"Unknown entity type for realtime update:\", event.entity_type);\n        break;\n    }\n\n    // Show toast for critical status changes\n    if (event.type === \"status_changed\" && event.data?.status) {\n      const entityName = event.entity_type.replace(\"_\", \" \");\n      toast.info(`${entityName} status updated`, {\n        description: `Status changed to: ${event.data.status}`,\n      });\n    }\n\n    // Show toast for assignment changes\n    if (event.type === \"assignment_changed\" && user?.id && event.data?.assigned_to === user.id) {\n      const entityName = event.entity_type.replace(\"_\", \" \");\n      toast.info(`New ${entityName} assigned`, {\n        description: `You have been assigned to a ${entityName}`,\n      });\n    }\n  }, [queryClient, user?.id]);\n\n  const handleUserStatus = React.useCallback((data: any) => {\n    console.log(\"User status update:\", data);\n    // Could implement user presence indicators here\n  }, []);\n\n  const handleTypingIndicator = React.useCallback((data: any) => {\n    console.log(\"Typing indicator:\", data);\n    // Could implement typing indicators for chat/comments\n  }, []);\n\n  const connectWebSocket = React.useCallback(async () => {\n    if (!user?.id || !token) {\n      return;\n    }\n\n    try {\n      // Set auth token for WebSocket\n      wsApi.setAuthToken(token);\n\n      // Connect to WebSocket\n      await wsApi.connect(user.id);\n\n      isConnectedRef.current = true;\n      connectionAttempts.current = 0;\n\n      console.log(\"WebSocket connected successfully\");\n\n      // Subscribe to all message types\n      wsApi.subscribe(\"notification\", handleNotification);\n      wsApi.subscribe(\"realtime_update\", handleRealtimeUpdate);\n      wsApi.subscribe(\"user_status\", handleUserStatus);\n      wsApi.subscribe(\"typing_indicator\", handleTypingIndicator);\n\n      // Send initial presence update\n      wsApi.send(\"user_status\", {\n        status: \"online\",\n        timestamp: new Date().toISOString(),\n      });\n\n    } catch (error) {\n      console.error(\"WebSocket connection failed:\", error);\n      isConnectedRef.current = false;\n\n      // Implement exponential backoff for reconnection\n      if (connectionAttempts.current < maxConnectionAttempts) {\n        connectionAttempts.current++;\n        const delay = Math.pow(2, connectionAttempts.current) * 1000; // 2s, 4s, 8s, 16s, 32s\n\n        console.log(`Retrying WebSocket connection in ${delay}ms (attempt ${connectionAttempts.current}/${maxConnectionAttempts})`);\n\n        setTimeout(() => {\n          connectWebSocket();\n        }, delay);\n      } else {\n        console.error(\"Max WebSocket connection attempts reached\");\n        toast.error(\"Failed to establish real-time connection\", {\n          description: \"Some features may not work properly. Please refresh the page.\",\n        });\n      }\n    }\n  }, [user?.id, token, handleNotification, handleRealtimeUpdate, handleUserStatus, handleTypingIndicator]);\n\n  const disconnectWebSocket = React.useCallback(() => {\n    if (isConnectedRef.current) {\n      // Send offline status before disconnecting\n      wsApi.send(\"user_status\", {\n        status: \"offline\",\n        timestamp: new Date().toISOString(),\n      });\n\n      // Unsubscribe from all message types\n      wsApi.unsubscribe(\"notification\", handleNotification);\n      wsApi.unsubscribe(\"realtime_update\", handleRealtimeUpdate);\n      wsApi.unsubscribe(\"user_status\", handleUserStatus);\n      wsApi.unsubscribe(\"typing_indicator\", handleTypingIndicator);\n\n      // Disconnect\n      wsApi.disconnect();\n      isConnectedRef.current = false;\n      connectionAttempts.current = 0;\n\n      console.log(\"WebSocket disconnected\");\n    }\n  }, [handleNotification, handleRealtimeUpdate, handleUserStatus, handleTypingIndicator]);\n\n  // Connect when user and token are available\n  useEffect(() => {\n    if (user?.id && token) {\n      connectWebSocket();\n    } else {\n      disconnectWebSocket();\n    }\n\n    // Cleanup on unmount\n    return () => {\n      disconnectWebSocket();\n    };\n  }, [user?.id, token, connectWebSocket, disconnectWebSocket]);\n\n  // Handle page visibility changes\n  useEffect(() => {\n    const handleVisibilityChange = () => {\n      if (document.hidden) {\n        // Page is hidden, send away status\n        if (isConnectedRef.current) {\n          wsApi.send(\"user_status\", {\n            status: \"away\",\n            timestamp: new Date().toISOString(),\n          });\n        }\n      } else {\n        // Page is visible, send online status and reconnect if needed\n        if (user?.id && token) {\n          if (!isConnectedRef.current) {\n            connectWebSocket();\n          } else {\n            wsApi.send(\"user_status\", {\n              status: \"online\",\n              timestamp: new Date().toISOString(),\n            });\n          }\n        }\n      }\n    };\n\n    document.addEventListener(\"visibilitychange\", handleVisibilityChange);\n\n    return () => {\n      document.removeEventListener(\"visibilitychange\", handleVisibilityChange);\n    };\n  }, [user?.id, token, connectWebSocket]);\n\n  // Handle beforeunload to send offline status\n  useEffect(() => {\n    const handleBeforeUnload = () => {\n      if (isConnectedRef.current) {\n        wsApi.send(\"user_status\", {\n          status: \"offline\",\n          timestamp: new Date().toISOString(),\n        });\n      }\n    };\n\n    window.addEventListener(\"beforeunload\", handleBeforeUnload);\n\n    return () => {\n      window.removeEventListener(\"beforeunload\", handleBeforeUnload);\n    };\n  }, []);\n\n  const contextValue: WebSocketContextType = {\n    isConnected: isConnectedRef.current,\n    send: (type: string, data: any) => {\n      if (isConnectedRef.current) {\n        wsApi.send(type, data);\n      } else {\n        console.warn(\"WebSocket not connected, cannot send message:\", { type, data });\n      }\n    },\n    subscribe: (messageType: string, handler: (data: any) => void) => {\n      wsApi.subscribe(messageType, handler);\n    },\n    unsubscribe: (messageType: string, handler: (data: any) => void) => {\n      wsApi.unsubscribe(messageType, handler);\n    },\n  };\n\n  return (\n    <WebSocketContext.Provider value={contextValue}>\n      {children}\n    </WebSocketContext.Provider>\n  );\n}\n\nexport function useWebSocket() {\n  const context = useContext(WebSocketContext);\n  if (!context) {\n    throw new Error(\"useWebSocket must be used within a WebSocketProvider\");\n  }\n  return context;\n}\n\n// Hook for sending specific message types\nexport function useWebSocketSend() {\n  const { send, isConnected } = useWebSocket();\n\n  const sendNotification = (notification: Partial<Notification>) => {\n    send(\"create_notification\", notification);\n  };\n\n  const sendRealtimeEvent = (event: Partial<RealtimeEvent>) => {\n    send(\"realtime_event\", event);\n  };\n\n  const sendUserStatus = (status: \"online\" | \"away\" | \"offline\") => {\n    send(\"user_status\", {\n      status,\n      timestamp: new Date().toISOString(),\n    });\n  };\n\n  const sendTypingIndicator = (isTyping: boolean, context?: string) => {\n    send(\"typing_indicator\", {\n      typing: isTyping,\n      context,\n      timestamp: new Date().toISOString(),\n    });\n  };\n\n  return {\n    sendNotification,\n    sendRealtimeEvent,\n    sendUserStatus,\n    sendTypingIndicator,\n    isConnected,\n  };\n}"],"names":["process","env","NEXT_RUNTIME","module","exports","require","__NEXT_EXPERIMENTAL_REACT","NODE_ENV","TURBOPACK","vendored","ReactJsxRuntime","React","ReactDOM"],"mappings":"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","ignoreList":[0,1,2,3]}