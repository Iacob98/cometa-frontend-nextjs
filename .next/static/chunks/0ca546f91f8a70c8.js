(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,71689,e=>{"use strict";e.s(["ArrowLeft",()=>t],71689);let t=(0,e.i(75254).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},32661,e=>{"use strict";e.s(["useCreateProject",()=>n,"useDeleteProject",()=>d,"useProject",()=>o,"useProjectStats",()=>y,"useProjects",()=>l,"useUpdateProject",()=>c]);var t=e.i(66027),a=e.i(54616),r=e.i(12598),s=e.i(46696),i=e.i(41931);let u={all:["projects"],lists:()=>[...u.all,"list"],list:e=>[...u.lists(),e],details:()=>[...u.all,"detail"],detail:e=>[...u.details(),e]};function l(e){return(0,t.useQuery)({queryKey:u.list(e||{}),queryFn:()=>i.projectsApi.getProjects(e),staleTime:3e5})}function o(e){return(0,t.useQuery)({queryKey:u.detail(e),queryFn:()=>i.projectsApi.getProject(e),enabled:!!e,staleTime:3e5})}function n(){let e=(0,r.useQueryClient)();return(0,a.useMutation)({mutationFn:e=>i.projectsApi.createProject(e),onSuccess:t=>{e.invalidateQueries({queryKey:u.lists()}),e.setQueryData(u.detail(t.id),t),s.toast.success("Project created successfully")},onError:e=>{s.toast.error("Failed to create project: ".concat(e.message))}})}function c(){let e=(0,r.useQueryClient)();return(0,a.useMutation)({mutationFn:e=>{let{id:t,data:a}=e;return i.projectsApi.updateProject(t,a)},onMutate:async t=>{let{id:a,data:r}=t;await e.cancelQueries({queryKey:u.detail(a)});let s=e.getQueryData(u.detail(a));return e.setQueryData(u.detail(a),e=>e?{...e,...r}:e),{previousProject:s}},onError:(t,a,r)=>{let{id:i}=a;(null==r?void 0:r.previousProject)&&e.setQueryData(u.detail(i),r.previousProject),s.toast.error("Failed to update project: ".concat(t.message))},onSuccess:t=>{e.invalidateQueries({queryKey:u.lists()}),s.toast.success("Project updated successfully")},onSettled:(t,a,r)=>{let{id:s}=r;e.invalidateQueries({queryKey:u.detail(s)})}})}function d(){let e=(0,r.useQueryClient)();return(0,a.useMutation)({mutationFn:e=>i.projectsApi.deleteProject(e),onSuccess:(t,a)=>{e.removeQueries({queryKey:u.detail(a)}),e.invalidateQueries({queryKey:u.lists()}),s.toast.success("Project deleted successfully")},onError:e=>{s.toast.error("Failed to delete project: ".concat(e.message))}})}function y(e){return(0,t.useQuery)({queryKey:[...u.detail(e),"stats"],queryFn:async()=>{let t=await fetch("/api/projects/".concat(e,"/stats"));if(!t.ok)throw Error("Failed to fetch project statistics");return t.json()},staleTime:12e4,enabled:!!e})}},24687,e=>{"use strict";e.s(["Textarea",()=>s]);var t=e.i(43476),a=e.i(71645),r=e.i(75157);let s=a.forwardRef((e,a)=>{let{className:s,...i}=e;return(0,t.jsx)("textarea",{className:(0,r.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:a,...i})});s.displayName="Textarea"},25652,e=>{"use strict";e.s(["TrendingUp",()=>t],25652);let t=(0,e.i(75254).default)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]])},46897,e=>{"use strict";e.s(["MapPin",()=>t],46897);let t=(0,e.i(75254).default)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},3116,e=>{"use strict";e.s(["Clock",()=>t],3116);let t=(0,e.i(75254).default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},4382,e=>{"use strict";e.s(["invalidateAllMaterialQueries",()=>c,"useAdjustStock",()=>w,"useAssignMaterialToProject",()=>q,"useCreateMaterial",()=>h,"useDeleteMaterial",()=>v,"useDeleteMaterialAssignment",()=>b,"useLowStockMaterials",()=>p,"useMaterial",()=>y,"useMaterials",()=>d,"useOrders",()=>j,"useSuppliers",()=>Q,"useUnifiedProjectMaterials",()=>f,"useUnifiedWarehouseMaterials",()=>m,"useUpdateMaterial",()=>g,"useUpdateMaterialAssignment",()=>K]);var t=e.i(66027),a=e.i(54616),r=e.i(12598),s=e.i(46696),i=e.i(41931);let u={all:["materials"],lists:()=>[...u.all,"list"],list:e=>[...u.lists(),e],details:()=>[...u.all,"detail"],detail:e=>[...u.details(),e],lowStock:()=>[...u.all,"low-stock"]},l={all:["suppliers"],lists:()=>[...l.all,"list"],details:()=>[...l.all,"detail"],detail:e=>[...l.details(),e]},o={all:["allocations"],lists:()=>[...o.all,"list"],list:e=>[...o.lists(),e],details:()=>[...o.all,"detail"],detail:e=>[...o.details(),e]},n={all:["orders"],lists:()=>[...n.all,"list"],list:e=>[...n.lists(),e],details:()=>[...n.all,"detail"],detail:e=>[...n.details(),e]};function c(e){e.invalidateQueries({queryKey:u.all}),e.invalidateQueries({queryKey:o.all}),e.invalidateQueries({queryKey:n.all}),e.invalidateQueries({queryKey:[...u.all,"unified-warehouse"]}),e.invalidateQueries({queryKey:[...u.all,"allocation-targets"]}),e.refetchQueries({queryKey:[...u.all,"unified-warehouse"],type:"active"})}function d(e){return(0,t.useQuery)({queryKey:u.list(e||{}),queryFn:()=>i.materialsApi.getMaterials(e),staleTime:12e4})}function y(e){return(0,t.useQuery)({queryKey:u.detail(e),queryFn:()=>i.materialsApi.getMaterial(e),enabled:!!e,staleTime:3e5})}function p(){return(0,t.useQuery)({queryKey:u.lowStock(),queryFn:async()=>{let e=await fetch("/api/materials/low-stock");if(!e.ok)throw Error("Failed to fetch low stock materials");return(await e.json()).materials||[]},staleTime:12e4})}function m(){return(0,t.useQuery)({queryKey:[...u.all,"unified-warehouse"],queryFn:async()=>{let e=await fetch("/api/materials/unified?view=warehouse");if(!e.ok)throw Error("Failed to fetch warehouse materials");return(await e.json()).materials||[]},staleTime:3e4,gcTime:3e5,refetchOnWindowFocus:!0,refetchInterval:6e4})}function f(e){return(0,t.useQuery)({queryKey:[...o.all,"project",e,"unified"],queryFn:async()=>{let t=await fetch("/api/materials/unified?view=project_allocations&project_id=".concat(e));if(!t.ok)throw Error("Failed to fetch project materials");let a=await t.json();return{materials:a.materials||[],summary:a.allocation_summary}},enabled:!!e,staleTime:6e4,gcTime:3e5})}function h(){let e=(0,r.useQueryClient)();return(0,a.useMutation)({mutationFn:e=>i.materialsApi.createMaterial(e),onSuccess:t=>{e.invalidateQueries({queryKey:u.lists()}),e.setQueryData(u.detail(t.id),t),s.toast.success("Material created successfully")},onError:e=>{s.toast.error("Failed to create material: ".concat(e.message))}})}function g(){let e=(0,r.useQueryClient)();return(0,a.useMutation)({mutationFn:e=>{let{id:t,data:a}=e;return i.materialsApi.updateMaterial(t,a)},onMutate:async t=>{let{id:a,data:r}=t;await e.cancelQueries({queryKey:u.detail(a)});let s=e.getQueryData(u.detail(a));return e.setQueryData(u.detail(a),e=>e?{...e,...r}:e),{previousMaterial:s}},onError:(t,a,r)=>{let{id:i}=a;(null==r?void 0:r.previousMaterial)&&e.setQueryData(u.detail(i),r.previousMaterial),s.toast.error("Failed to update material: ".concat(t.message))},onSuccess:()=>{e.invalidateQueries({queryKey:u.lists()}),e.invalidateQueries({queryKey:u.lowStock()}),s.toast.success("Material updated successfully")},onSettled:(t,a,r)=>{let{id:s}=r;e.invalidateQueries({queryKey:u.detail(s)})}})}function v(){let e=(0,r.useQueryClient)();return(0,a.useMutation)({mutationFn:e=>i.materialsApi.deleteMaterial(e),onSuccess:(t,a)=>{e.removeQueries({queryKey:u.detail(a)}),e.invalidateQueries({queryKey:u.lists()}),e.invalidateQueries({queryKey:u.lowStock()}),s.toast.success("Material deleted successfully")},onError:e=>{s.toast.error("Failed to delete material: ".concat(e.message))}})}function w(){let e=(0,r.useQueryClient)();return(0,a.useMutation)({mutationFn:e=>{let{id:t,adjustment:a}=e;return i.materialsApi.adjustStock(t,a)},onSuccess:t=>{e.setQueryData(u.detail(t.id),t),e.invalidateQueries({queryKey:u.lists()}),e.invalidateQueries({queryKey:u.lowStock()}),e.invalidateQueries({queryKey:[...u.all,"unified-warehouse"]}),e.invalidateQueries({queryKey:[...u.all,"allocation-targets"]}),s.toast.success("Stock adjusted successfully")},onError:e=>{s.toast.error("Failed to adjust stock: ".concat(e.message))}})}function Q(){return(0,t.useQuery)({queryKey:l.lists(),queryFn:()=>i.suppliersApi.getSuppliers(),staleTime:6e5})}function j(e){return(0,t.useQuery)({queryKey:n.list(e||{}),queryFn:()=>i.materialOrdersApi.getOrders(e),staleTime:18e4})}function q(){let e=(0,r.useQueryClient)();return(0,a.useMutation)({mutationFn:async e=>{let t=await fetch("/api/materials/assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error((await t.json()).message||"Failed to assign material");return t.json()},onSuccess:(t,a)=>{e.invalidateQueries({queryKey:[...u.all,"project",a.project_id]}),e.invalidateQueries({queryKey:[...o.all,"project",a.project_id,"unified"]}),e.invalidateQueries({queryKey:[...u.all,"warehouse"]}),e.invalidateQueries({queryKey:[...u.all,"unified-warehouse"]}),e.invalidateQueries({queryKey:[...u.all,"allocation-targets"]}),e.refetchQueries({queryKey:[...o.all,"project",a.project_id,"unified"]}),e.refetchQueries({queryKey:[...u.all,"unified-warehouse"]}),s.toast.success("Material assigned successfully")},onError:e=>{s.toast.error("Failed to assign material: ".concat(e.message))}})}function K(){let e=(0,r.useQueryClient)();return(0,a.useMutation)({mutationFn:async e=>{let{assignment_id:t,...a}=e,r=await fetch("/api/materials/assignments/".concat(t),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!r.ok)throw Error((await r.json()).message||"Failed to update material assignment");return r.json()},onSuccess:(t,a)=>{e.invalidateQueries({predicate:e=>"materials"===e.queryKey[0]&&"project"===e.queryKey[1]}),e.invalidateQueries({predicate:e=>e.queryKey.includes("unified")}),e.invalidateQueries({queryKey:[...u.all,"warehouse"]}),e.invalidateQueries({queryKey:[...u.all,"unified-warehouse"]}),e.invalidateQueries({queryKey:[...u.all,"allocation-targets"]}),s.toast.success("Material assignment updated successfully")},onError:e=>{s.toast.error("Failed to update material assignment: ".concat(e.message))}})}function b(){let e=(0,r.useQueryClient)();return(0,a.useMutation)({mutationFn:async e=>{let t=await fetch("/api/materials/assignments/".concat(e),{method:"DELETE"});if(!t.ok)throw Error((await t.json()).message||"Failed to delete material assignment");return t.json()},onSuccess:(t,a)=>{e.invalidateQueries({predicate:e=>"materials"===e.queryKey[0]&&"project"===e.queryKey[1]}),e.invalidateQueries({predicate:e=>e.queryKey.includes("unified")}),e.invalidateQueries({queryKey:[...u.all,"warehouse"]}),e.invalidateQueries({queryKey:[...u.all,"unified-warehouse"]}),e.invalidateQueries({queryKey:[...u.all,"allocation-targets"]}),s.toast.success("Material assignment deleted successfully")},onError:e=>{s.toast.error("Failed to delete material assignment: ".concat(e.message))}})}},2747,e=>{"use strict";e.s(["Skeleton",()=>r]);var t=e.i(43476),a=e.i(75157);function r(e){let{className:r,...s}=e;return(0,t.jsx)("div",{className:(0,a.cn)("animate-pulse rounded-md bg-muted",r),...s})}},7233,e=>{"use strict";e.s(["Plus",()=>t],7233);let t=(0,e.i(75254).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},84774,e=>{"use strict";e.s(["Table",()=>s,"TableBody",()=>u,"TableCell",()=>n,"TableHead",()=>o,"TableHeader",()=>i,"TableRow",()=>l]);var t=e.i(43476),a=e.i(71645),r=e.i(75157);let s=a.forwardRef((e,a)=>{let{className:s,...i}=e;return(0,t.jsx)("div",{className:"relative w-full overflow-auto",children:(0,t.jsx)("table",{ref:a,className:(0,r.cn)("w-full caption-bottom text-sm",s),...i})})});s.displayName="Table";let i=a.forwardRef((e,a)=>{let{className:s,...i}=e;return(0,t.jsx)("thead",{ref:a,className:(0,r.cn)("[&_tr]:border-b",s),...i})});i.displayName="TableHeader";let u=a.forwardRef((e,a)=>{let{className:s,...i}=e;return(0,t.jsx)("tbody",{ref:a,className:(0,r.cn)("[&_tr:last-child]:border-0",s),...i})});u.displayName="TableBody",a.forwardRef((e,a)=>{let{className:s,...i}=e;return(0,t.jsx)("tfoot",{ref:a,className:(0,r.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...i})}).displayName="TableFooter";let l=a.forwardRef((e,a)=>{let{className:s,...i}=e;return(0,t.jsx)("tr",{ref:a,className:(0,r.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...i})});l.displayName="TableRow";let o=a.forwardRef((e,a)=>{let{className:s,...i}=e;return(0,t.jsx)("th",{ref:a,className:(0,r.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...i})});o.displayName="TableHead";let n=a.forwardRef((e,a)=>{let{className:s,...i}=e;return(0,t.jsx)("td",{ref:a,className:(0,r.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...i})});n.displayName="TableCell",a.forwardRef((e,a)=>{let{className:s,...i}=e;return(0,t.jsx)("caption",{ref:a,className:(0,r.cn)("mt-4 text-sm text-muted-foreground",s),...i})}).displayName="TableCaption"},27612,e=>{"use strict";e.s(["Trash2",()=>t],27612);let t=(0,e.i(75254).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])},88511,e=>{"use strict";e.s(["Edit",()=>t],88511);let t=(0,e.i(75254).default)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},86536,e=>{"use strict";e.s(["Eye",()=>t],86536);let t=(0,e.i(75254).default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},64483,49933,e=>{"use strict";e.s(["useCreateMaterialOrderWithBudget",()=>f,"useDeleteMaterialOrder",()=>g,"useMaterialOrder",()=>m,"useMaterialOrders",()=>p,"useUpdateMaterialOrder",()=>h],64483);var t=e.i(66027),a=e.i(54616),r=e.i(12598),s=e.i(46696);function i(e){return(0,t.useQuery)({queryKey:["material-order-budget",e],queryFn:async()=>{let t=await fetch("/api/materials/orders/".concat(e,"/budget"));if(!t.ok)throw Error("Failed to fetch budget impact");return t.json()},enabled:!!e})}function u(){let e=function(){let e=(0,r.useQueryClient)();return(0,a.useMutation)({mutationFn:async e=>{let{orderId:t,data:a}=e,r=await fetch("/api/materials/orders/".concat(t,"/budget"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!r.ok)throw Error((await r.json()).error||"Failed to create budget transaction");return r.json()},onSuccess:(t,a)=>{e.invalidateQueries({queryKey:["material-order-budget",a.orderId]}),e.invalidateQueries({queryKey:["material-orders"]}),e.invalidateQueries({queryKey:["financial-summary"]}),e.invalidateQueries({queryKey:["project",t.project_id]}),s.toast.success("Budget transaction created: €".concat(t.amount_deducted.toFixed(2)," deducted"))},onError:e=>{s.toast.error(e.message||"Failed to create budget transaction")}})}();return{deductFromBudget:async function(t){let a=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(!a)return null;try{return await e.mutateAsync({orderId:t,data:{deduct_from_budget:!0}})}catch(e){return console.error("Auto budget deduction failed:",e),null}},isLoading:e.isPending,error:e.error}}e.s(["useAutoBudgetDeduction",()=>u,"useMaterialOrderBudgetImpact",()=>i],49933);let l={all:["material-orders"],lists:()=>[...l.all,"list"],list:e=>[...l.lists(),e],details:()=>[...l.all,"detail"],detail:e=>[...l.details(),e]};async function o(e){let t=new URLSearchParams;(null==e?void 0:e.project_id)&&t.set("project_id",e.project_id),(null==e?void 0:e.supplier_id)&&t.set("supplier_id",e.supplier_id),(null==e?void 0:e.status)&&t.set("status",e.status),(null==e?void 0:e.page)&&t.set("page",e.page.toString()),(null==e?void 0:e.per_page)&&t.set("per_page",e.per_page.toString());let a=await fetch("/api/materials/orders?".concat(t.toString()));if(!a.ok)throw Error("Failed to fetch material orders");return a.json()}async function n(e){let t=await fetch("/api/materials/orders/".concat(e));if(!t.ok)throw Error("Failed to fetch material order");return t.json()}async function c(e){let t=await fetch("/api/materials/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error((await t.json()).error||"Failed to create material order");return t.json()}async function d(e,t){let a=await fetch("/api/materials/orders/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!a.ok)throw Error((await a.json()).error||"Failed to update material order");return a.json()}async function y(e){let t=await fetch("/api/materials/orders/".concat(e),{method:"DELETE"});if(!t.ok)throw Error((await t.json()).error||"Failed to delete material order")}function p(e){return(0,t.useQuery)({queryKey:l.list(e||{}),queryFn:()=>o(e),staleTime:3e5})}function m(e){return(0,t.useQuery)({queryKey:l.detail(e),queryFn:()=>n(e),enabled:!!e,staleTime:3e5})}function f(){let e=function(){let e=(0,r.useQueryClient)();return(0,a.useMutation)({mutationFn:c,onSuccess:t=>{e.invalidateQueries({queryKey:l.lists()}),e.setQueryData(l.detail(t.id),t),s.toast.success("Material order created successfully")},onError:e=>{s.toast.error("Failed to create order: ".concat(e.message))}})}(),{deductFromBudget:t}=u();return(0,a.useMutation)({mutationFn:async a=>{let{deduct_from_budget:r=!0,...i}=a,u=await e.mutateAsync(i);if(r&&u.project_id)try{await t(u.id,!0)}catch(e){console.warn("Budget deduction failed, but order was created:",e),s.toast.warning("Order created but budget deduction failed. Please manage manually.")}return u},onSuccess:e=>{s.toast.success("Order created and €".concat(e.total_cost_eur.toFixed(2)," deducted from project budget"))},onError:e=>{s.toast.error("Failed to create order: ".concat(e.message))}})}function h(){let e=(0,r.useQueryClient)();return(0,a.useMutation)({mutationFn:e=>{let{id:t,data:a}=e;return d(t,a)},onSuccess:t=>{e.setQueryData(l.detail(t.id),t),e.invalidateQueries({queryKey:l.lists()}),s.toast.success("Order updated successfully")},onError:e=>{s.toast.error("Failed to update order: ".concat(e.message))}})}function g(){let e=(0,r.useQueryClient)();return(0,a.useMutation)({mutationFn:y,onSuccess:(t,a)=>{e.removeQueries({queryKey:l.detail(a)}),e.invalidateQueries({queryKey:l.lists()}),s.toast.success("Order deleted successfully")},onError:e=>{s.toast.error("Failed to delete order: ".concat(e.message))}})}},41071,e=>{"use strict";e.s(["MoreHorizontal",()=>t],41071);let t=(0,e.i(75254).default)("ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]])},48256,e=>{"use strict";e.s(["Globe",()=>t],48256);let t=(0,e.i(75254).default)("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]])},59386,e=>{"use strict";e.s(["Ruler",()=>t],59386);let t=(0,e.i(75254).default)("ruler",[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]])},68553,e=>{"use strict";e.s(["Camera",()=>t],68553);let t=(0,e.i(75254).default)("camera",[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]])},20306,e=>{"use strict";e.s(["useCreateCrew",()=>n,"useCreateTeam",()=>m,"useCrew",()=>o,"useDeleteCrew",()=>d,"useForemenUsers",()=>p,"useGlobalTeams",()=>y,"useProjectTeams",()=>f,"useTeams",()=>l,"useUpdateCrew",()=>c,"useUpdateTeam",()=>h]);var t=e.i(66027),a=e.i(54616),r=e.i(12598),s=e.i(46696),i=e.i(41931);let u={all:["teams"],crews:()=>[...u.all,"crews"],crew:e=>[...u.all,"crew",e]};function l(){return(0,t.useQuery)({queryKey:u.crews(),queryFn:async()=>{let e=await fetch("/api/crews");if(!e.ok)throw Error("Failed to fetch crews");return(await e.json()).crews||[]},staleTime:3e4})}function o(e){return(0,t.useQuery)({queryKey:u.crew(e),queryFn:()=>i.teamsApi.getCrew(e),enabled:!!e,staleTime:3e5})}function n(){let e=(0,r.useQueryClient)();return(0,a.useMutation)({mutationFn:e=>i.teamsApi.createCrew(e),onSuccess:t=>{e.invalidateQueries({queryKey:u.crews()}),e.setQueryData(u.crew(t.id),t),s.toast.success("Team created successfully")},onError:e=>{s.toast.error("Failed to create team: ".concat(e.message))}})}function c(){let e=(0,r.useQueryClient)();return(0,a.useMutation)({mutationFn:e=>{let{id:t,data:a}=e;return i.teamsApi.updateCrew(t,a)},onMutate:async t=>{let{id:a,data:r}=t;await e.cancelQueries({queryKey:u.crew(a)});let s=e.getQueryData(u.crew(a));return e.setQueryData(u.crew(a),e=>e?{...e,...r}:e),{previousCrew:s}},onError:(t,a,r)=>{let{id:i}=a;(null==r?void 0:r.previousCrew)&&e.setQueryData(u.crew(i),r.previousCrew),s.toast.error("Failed to update team: ".concat(t.message))},onSuccess:()=>{e.invalidateQueries({queryKey:u.crews()}),s.toast.success("Team updated successfully")},onSettled:(t,a,r)=>{let{id:s}=r;e.invalidateQueries({queryKey:u.crew(s)})}})}function d(){let e=(0,r.useQueryClient)();return(0,a.useMutation)({mutationFn:e=>i.teamsApi.deleteCrew(e),onSuccess:(t,a)=>{e.removeQueries({queryKey:u.crew(a)}),e.invalidateQueries({queryKey:u.crews()}),s.toast.success("Team deleted successfully")},onError:e=>{s.toast.error("Failed to delete team: ".concat(e.message))}})}function y(){return(0,t.useQuery)({queryKey:["global-teams"],queryFn:async()=>{let e=await fetch("/api/crews");if(!e.ok)throw Error("Failed to fetch global teams");let t=(await e.json()).crews||[],a={};return t.forEach(e=>{e.project_id&&(a[e.name]=(a[e.name]||0)+1)}),t.map(e=>{var t;return{id:e.id,name:e.name,foreman_name:(null==(t=e.foreman)?void 0:t.full_name)||e.foreman_name,is_active:"active"===e.status,project_count:a[e.name]||0,specialization:"mixed"}})}})}function p(){return(0,t.useQuery)({queryKey:["foremen-users"],queryFn:async()=>{let e=await fetch("/api/users?role=foreman&is_active=true");if(!e.ok){let e=await fetch("/api/users?role=pm&is_active=true");if(!e.ok)throw Error("Failed to fetch users");return(await e.json()).items||[]}let t=await e.json();if(0===t.items.length){let e=await fetch("/api/users?is_active=true");if(!e.ok)throw Error("Failed to fetch users");return((await e.json()).items||[]).filter(e=>"foreman"===e.role||"pm"===e.role)}return t.items||[]}})}function m(){let e=(0,r.useQueryClient)();return(0,a.useMutation)({mutationFn:async e=>{let t=await fetch("/api/crews",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error((await t.json()).error||"Failed to create team");return t.json()},onSuccess:(t,a)=>{a.project_id&&(e.invalidateQueries({queryKey:["project-teams",a.project_id]}),e.invalidateQueries({queryKey:["project-preparation",a.project_id]})),e.invalidateQueries({queryKey:["global-teams"]}),e.invalidateQueries({queryKey:u.crews()}),s.toast.success(t.message||"Team created successfully")},onError:e=>{s.toast.error(e.message)}})}function f(e){return(0,t.useQuery)({queryKey:["project-teams",e],queryFn:async()=>{let t=await fetch("/api/crews?project_id=".concat(e));if(!t.ok)throw Error("Failed to fetch project teams");return(await t.json()).crews||[]},enabled:!!e})}function h(){let e=(0,r.useQueryClient)();return(0,a.useMutation)({mutationFn:async e=>{let{id:t,data:a}=e,r=await fetch("/api/crews/".concat(t),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!r.ok)throw Error((await r.json()).error||"Failed to update team");return r.json()},onSuccess:(t,a)=>{e.invalidateQueries({queryKey:["project-teams"]}),e.invalidateQueries({queryKey:["global-teams"]}),e.invalidateQueries({queryKey:u.crews()}),e.invalidateQueries({queryKey:["project-preparation"]}),s.toast.success(t.message||"Team updated successfully")},onError:e=>{s.toast.error(e.message)}})}},43432,e=>{"use strict";e.s(["Phone",()=>t],43432);let t=(0,e.i(75254).default)("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]])},63488,e=>{"use strict";e.s(["Mail",()=>t],63488);let t=(0,e.i(75254).default)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]])},40160,e=>{"use strict";e.s(["Download",()=>t],40160);let t=(0,e.i(75254).default)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]])},69074,e=>{"use strict";e.s(["Upload",()=>t],69074);let t=(0,e.i(75254).default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]])},68148,e=>{"use strict";e.s(["Progress",()=>w],68148);var t=e.i(43476),a=e.i(71645),r=e.i(30030),s=e.i(48425),i="Progress",[u,l]=(0,r.createContextScope)(i),[o,n]=u(i),c=a.forwardRef((e,a)=>{var r,i,u,l;let{__scopeProgress:n,value:c=null,max:d,getValueLabel:y=p,...v}=e;(d||0===d)&&!h(d)&&console.error((r="".concat(d),i="Progress","Invalid prop `max` of value `".concat(r,"` supplied to `").concat(i,"`. Only numbers greater than 0 are valid max values. Defaulting to `").concat(100,"`.")));let w=h(d)?d:100;null===c||g(c,w)||console.error((u="".concat(c),l="Progress","Invalid prop `value` of value `".concat(u,"` supplied to `").concat(l,"`. The `value` prop must be:\n  - a positive number\n  - less than the value passed to `max` (or ").concat(100," if no `max` prop is set)\n  - `null` or `undefined` if the progress is indeterminate.\n\nDefaulting to `null`.")));let Q=g(c,w)?c:null,j=f(Q)?y(Q,w):void 0;return(0,t.jsx)(o,{scope:n,value:Q,max:w,children:(0,t.jsx)(s.Primitive.div,{"aria-valuemax":w,"aria-valuemin":0,"aria-valuenow":f(Q)?Q:void 0,"aria-valuetext":j,role:"progressbar","data-state":m(Q,w),"data-value":null!=Q?Q:void 0,"data-max":w,...v,ref:a})})});c.displayName=i;var d="ProgressIndicator",y=a.forwardRef((e,a)=>{var r;let{__scopeProgress:i,...u}=e,l=n(d,i);return(0,t.jsx)(s.Primitive.div,{"data-state":m(l.value,l.max),"data-value":null!=(r=l.value)?r:void 0,"data-max":l.max,...u,ref:a})});function p(e,t){return"".concat(Math.round(e/t*100),"%")}function m(e,t){return null==e?"indeterminate":e===t?"complete":"loading"}function f(e){return"number"==typeof e}function h(e){return f(e)&&!isNaN(e)&&e>0}function g(e,t){return f(e)&&!isNaN(e)&&e<=t&&e>=0}y.displayName=d;var v=e.i(75157);let w=a.forwardRef((e,a)=>{let{className:r,value:s,...i}=e;return(0,t.jsx)(c,{ref:a,className:(0,v.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",r),...i,children:(0,t.jsx)(y,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(s||0),"%)")}})})});w.displayName=c.displayName},98919,e=>{"use strict";e.s(["Shield",()=>t],98919);let t=(0,e.i(75254).default)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},1928,e=>{"use strict";e.s(["ShoppingCart",()=>t],1928);let t=(0,e.i(75254).default)("shopping-cart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]])},78917,e=>{"use strict";e.s(["ExternalLink",()=>t],78917);let t=(0,e.i(75254).default)("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]])},67757,e=>{"use strict";e.s(["useCompletedConnections",()=>v,"useCreateHouse",()=>c,"useDeleteHouse",()=>y,"useHouses",()=>o,"useInProgressConnections",()=>g,"usePendingConnections",()=>f,"useProjectHouses",()=>n,"useScheduleAppointment",()=>m,"useScheduledAppointments",()=>h,"useTodaysAppointments",()=>w,"useUpdateHouse",()=>d]);var t=e.i(66027),a=e.i(54616),r=e.i(12598),s=e.i(46696),i=e.i(41931);let u={all:["houses"],lists:()=>[...u.all,"list"],list:e=>[...u.lists(),e],details:()=>[...u.all,"detail"],detail:e=>[...u.details(),e],project:e=>[...u.all,"project",e],team:e=>[...u.all,"team",e]},l={all:["appointments"],lists:()=>[...l.all,"list"],list:e=>[...l.lists(),e],details:()=>[...l.all,"detail"],detail:e=>[...l.details(),e]};function o(e){return(0,t.useQuery)({queryKey:u.list(e||{}),queryFn:()=>i.housesApi.getHouses(e),staleTime:18e4})}function n(e){return(0,t.useQuery)({queryKey:u.project(e),queryFn:()=>i.housesApi.getProjectHouses(e),enabled:!!e,staleTime:18e4})}function c(){let e=(0,r.useQueryClient)();return(0,a.useMutation)({mutationFn:e=>i.housesApi.createHouse(e),onSuccess:t=>{e.invalidateQueries({queryKey:u.lists()}),e.invalidateQueries({queryKey:u.project(t.project_id)}),e.setQueryData(u.detail(t.id),t),s.toast.success("House created successfully")},onError:e=>{s.toast.error("Failed to create house: ".concat(e.message))}})}function d(){let e=(0,r.useQueryClient)();return(0,a.useMutation)({mutationFn:e=>{let{id:t,data:a}=e;return i.housesApi.updateHouse(t,a)},onMutate:async t=>{let{id:a,data:r}=t;await e.cancelQueries({queryKey:u.detail(a)});let s=e.getQueryData(u.detail(a));return e.setQueryData(u.detail(a),e=>e?{...e,...r}:e),{previousHouse:s}},onError:(t,a,r)=>{let{id:i}=a;(null==r?void 0:r.previousHouse)&&e.setQueryData(u.detail(i),r.previousHouse),s.toast.error("Failed to update house: ".concat(t.message))},onSuccess:t=>{e.invalidateQueries({queryKey:u.lists()}),e.invalidateQueries({queryKey:u.project(t.project_id)}),t.assigned_team_id&&e.invalidateQueries({queryKey:u.team(t.assigned_team_id)}),s.toast.success("House updated successfully")},onSettled:(t,a,r)=>{let{id:s}=r;e.invalidateQueries({queryKey:u.detail(s)})}})}function y(){let e=(0,r.useQueryClient)();return(0,a.useMutation)({mutationFn:e=>i.housesApi.deleteHouse(e),onSuccess:(t,a)=>{e.removeQueries({queryKey:u.detail(a)}),e.invalidateQueries({queryKey:u.lists()}),e.invalidateQueries({queryKey:u.all}),s.toast.success("House deleted successfully")},onError:e=>{s.toast.error("Failed to delete house: ".concat(e.message))}})}function p(e){return(0,t.useQuery)({queryKey:l.list(e||{}),queryFn:()=>i.appointmentsApi.getAppointments(e),staleTime:12e4})}function m(){let e=(0,r.useQueryClient)();return(0,a.useMutation)({mutationFn:e=>i.housesApi.scheduleAppointment(e),onSuccess:t=>{e.invalidateQueries({queryKey:l.lists()}),e.invalidateQueries({queryKey:u.detail(t.house_id)}),e.setQueryData(l.detail(t.id),t),s.toast.success("Appointment scheduled successfully")},onError:e=>{s.toast.error("Failed to schedule appointment: ".concat(e.message))}})}function f(){return o({status:"not_assigned",page:1,per_page:50})}function h(){return p({status:"scheduled",page:1,per_page:20})}function g(){return o({status:"in_progress",page:1,per_page:20})}function v(){return o({status:"connected",page:1,per_page:20})}function w(){let e=new Date().toISOString().split("T")[0];return p({scheduled_date_from:e,scheduled_date_to:e,page:1,per_page:50})}}]);