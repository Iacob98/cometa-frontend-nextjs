(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,32661,e=>{"use strict";e.s(["useCreateProject",()=>o,"useDeleteProject",()=>u,"useProject",()=>c,"useProjectStats",()=>m,"useProjects",()=>l,"useUpdateProject",()=>d]);var t=e.i(66027),s=e.i(54616),a=e.i(12598),r=e.i(46696),i=e.i(41931);let n={all:["projects"],lists:()=>[...n.all,"list"],list:e=>[...n.lists(),e],details:()=>[...n.all,"detail"],detail:e=>[...n.details(),e]};function l(e){return(0,t.useQuery)({queryKey:n.list(e||{}),queryFn:()=>i.projectsApi.getProjects(e),staleTime:3e5})}function c(e){return(0,t.useQuery)({queryKey:n.detail(e),queryFn:()=>i.projectsApi.getProject(e),enabled:!!e,staleTime:3e5})}function o(){let e=(0,a.useQueryClient)();return(0,s.useMutation)({mutationFn:e=>i.projectsApi.createProject(e),onSuccess:t=>{e.invalidateQueries({queryKey:n.lists()}),e.setQueryData(n.detail(t.id),t),r.toast.success("Project created successfully")},onError:e=>{r.toast.error("Failed to create project: ".concat(e.message))}})}function d(){let e=(0,a.useQueryClient)();return(0,s.useMutation)({mutationFn:e=>{let{id:t,data:s}=e;return i.projectsApi.updateProject(t,s)},onMutate:async t=>{let{id:s,data:a}=t;await e.cancelQueries({queryKey:n.detail(s)});let r=e.getQueryData(n.detail(s));return e.setQueryData(n.detail(s),e=>e?{...e,...a}:e),{previousProject:r}},onError:(t,s,a)=>{let{id:i}=s;(null==a?void 0:a.previousProject)&&e.setQueryData(n.detail(i),a.previousProject),r.toast.error("Failed to update project: ".concat(t.message))},onSuccess:t=>{e.invalidateQueries({queryKey:n.lists()}),r.toast.success("Project updated successfully")},onSettled:(t,s,a)=>{let{id:r}=a;e.invalidateQueries({queryKey:n.detail(r)})}})}function u(){let e=(0,a.useQueryClient)();return(0,s.useMutation)({mutationFn:e=>i.projectsApi.deleteProject(e),onSuccess:(t,s)=>{e.removeQueries({queryKey:n.detail(s)}),e.invalidateQueries({queryKey:n.lists()}),r.toast.success("Project deleted successfully")},onError:e=>{r.toast.error("Failed to delete project: ".concat(e.message))}})}function m(e){return(0,t.useQuery)({queryKey:[...n.detail(e),"stats"],queryFn:async()=>{let t=await fetch("/api/projects/".concat(e,"/stats"));if(!t.ok)throw Error("Failed to fetch project statistics");return t.json()},staleTime:12e4,enabled:!!e})}},24687,e=>{"use strict";e.s(["Textarea",()=>r]);var t=e.i(43476),s=e.i(71645),a=e.i(75157);let r=s.forwardRef((e,s)=>{let{className:r,...i}=e;return(0,t.jsx)("textarea",{className:(0,a.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:s,...i})});r.displayName="Textarea"},71689,e=>{"use strict";e.s(["ArrowLeft",()=>t],71689);let t=(0,e.i(75254).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},56909,e=>{"use strict";e.s(["Save",()=>t],56909);let t=(0,e.i(75254).default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},95116,e=>{"use strict";e.s(["Wrench",()=>t],95116);let t=(0,e.i(75254).default)("wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z",key:"1ngwbx"}]])},46835,e=>{"use strict";e.s(["useDeleteUser",()=>o,"useProjectManagers",()=>d,"useUpdateUser",()=>c,"useUsers",()=>l]);var t=e.i(66027),s=e.i(54616),a=e.i(12598),r=e.i(46696),i=e.i(41931);let n={all:["users"],lists:()=>[...n.all,"list"],list:e=>[...n.lists(),e],details:()=>[...n.all,"detail"],detail:e=>[...n.details(),e]};function l(e){return(0,t.useQuery)({queryKey:n.list(e||{}),queryFn:()=>i.usersApi.getUsers(e),staleTime:3e5})}function c(){let e=(0,a.useQueryClient)();return(0,s.useMutation)({mutationFn:e=>{let{id:t,data:s}=e;return i.usersApi.updateUser(t,s)},onMutate:async t=>{let{id:s,data:a}=t;await e.cancelQueries({queryKey:n.detail(s)});let r=e.getQueryData(n.detail(s));return e.setQueryData(n.detail(s),e=>e?{...e,...a}:e),{previousUser:r}},onError:(t,s,a)=>{let{id:i}=s;(null==a?void 0:a.previousUser)&&e.setQueryData(n.detail(i),a.previousUser),r.toast.error("Failed to update user: ".concat(t.message))},onSuccess:()=>{e.invalidateQueries({queryKey:n.lists()}),r.toast.success("User updated successfully")},onSettled:(t,s,a)=>{let{id:r}=a;e.invalidateQueries({queryKey:n.detail(r)})}})}function o(){let e=(0,a.useQueryClient)();return(0,s.useMutation)({mutationFn:e=>i.usersApi.deleteUser(e),onSuccess:(t,s)=>{e.removeQueries({queryKey:n.detail(s)}),e.invalidateQueries({queryKey:n.lists()}),r.toast.success("User deleted successfully")},onError:e=>{r.toast.error("Failed to delete user: ".concat(e.message))}})}function d(){return l({role:"pm",page:1,per_page:50})}},77126,e=>{"use strict";e.s(["useCrewEquipmentAssignments",()=>u,"useDeleteAssignment",()=>o,"useEquipment",()=>n,"useEquipmentAnalytics",()=>d,"useEquipmentAssignments",()=>l,"useUpdateAssignment",()=>c]);var t=e.i(54616),s=e.i(66027),a=e.i(12598),r=e.i(46696);let i={getEquipment:async e=>{let t=new URLSearchParams;(null==e?void 0:e.type)&&t.append("type",e.type),(null==e?void 0:e.status)&&t.append("status",e.status),(null==e?void 0:e.owned)&&t.append("owned",e.owned),(null==e?void 0:e.search)&&t.append("search",e.search),(null==e?void 0:e.page)&&t.append("page",e.page.toString()),(null==e?void 0:e.per_page)&&t.append("per_page",e.per_page.toString());let s="/api/equipment".concat(t.toString()?"?".concat(t.toString()):""),a=await fetch(s);if(!a.ok)throw Error("Failed to fetch equipment");return a.json()},getAssignments:async e=>{let t=new URLSearchParams;(null==e?void 0:e.equipment_id)&&t.append("equipment_id",e.equipment_id),(null==e?void 0:e.project_id)&&t.append("project_id",e.project_id),(null==e?void 0:e.crew_id)&&t.append("crew_id",e.crew_id),(null==e?void 0:e.active_only)&&t.append("active_only",e.active_only.toString());let s="/api/resources/unified-assignments".concat(t.toString()?"?".concat(t.toString()):""),a=await fetch(s);if(!a.ok)throw Error("Failed to fetch unified assignments");return a.json()},updateAssignment:async(e,t)=>{let s=await fetch("/api/resources/equipment-assignments/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!s.ok)throw Error((await s.json()).error||"Failed to update assignment");return s.json()},deleteAssignment:async e=>{let t=await fetch("/api/resources/equipment-assignments/".concat(e),{method:"DELETE"});if(!t.ok)throw Error((await t.json()).error||"Failed to delete assignment");return t.json()},getAnalytics:async()=>{let e=await fetch("/api/equipment/analytics");if(!e.ok)throw Error("Failed to fetch equipment analytics");return e.json()}};function n(e){return(0,s.useQuery)({queryKey:["equipment",e],queryFn:()=>i.getEquipment(e)})}function l(e){return(0,s.useQuery)({queryKey:["equipment-assignments",e],queryFn:()=>i.getAssignments(e),staleTime:3e4})}function c(){let e=(0,a.useQueryClient)();return(0,t.useMutation)({mutationFn:e=>{let{id:t,data:s}=e;return i.updateAssignment(t,s)},onSuccess:t=>{e.invalidateQueries({queryKey:["equipment-assignments"]}),e.invalidateQueries({queryKey:["equipment"]}),r.toast.success(t.message||"Assignment updated successfully")},onError:e=>{r.toast.error(e.message)}})}function o(){let e=(0,a.useQueryClient)();return(0,t.useMutation)({mutationFn:i.deleteAssignment,onSuccess:t=>{e.invalidateQueries({queryKey:["equipment-assignments"]}),e.invalidateQueries({queryKey:["equipment"]}),r.toast.success(t.message||"Assignment deleted successfully")},onError:e=>{r.toast.error(e.message)}})}function d(){return(0,s.useQuery)({queryKey:["equipment-analytics"],queryFn:()=>i.getAnalytics(),staleTime:3e5})}function u(e){return(0,s.useQuery)({queryKey:["equipment-assignments","crew",e],queryFn:async()=>{let t=await fetch("/api/resources/equipment-assignments?crew_id=".concat(e,"&active_only=true"));if(!t.ok)throw Error("Failed to fetch equipment assignments");return t.json()},enabled:!!e,staleTime:3e4})}},29041,e=>{"use strict";e.s(["useCreateVehicle",()=>l,"useCrewVehicleAssignments",()=>c,"useVehicles",()=>n]);var t=e.i(54616),s=e.i(66027),a=e.i(12598),r=e.i(46696);let i={getVehicles:async e=>{let t=new URLSearchParams;(null==e?void 0:e.type)&&t.append("type",e.type),(null==e?void 0:e.status)&&t.append("status",e.status),(null==e?void 0:e.owned)&&t.append("owned",e.owned),(null==e?void 0:e.search)&&t.append("search",e.search),(null==e?void 0:e.page)&&t.append("page",e.page.toString()),(null==e?void 0:e.per_page)&&t.append("per_page",e.per_page.toString());let s="/api/vehicles".concat(t.toString()?"?".concat(t.toString()):""),a=await fetch(s);if(!a.ok)throw Error("Failed to fetch vehicles");return a.json()},createVehicle:async e=>{let t=await fetch("/api/vehicles",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error((await t.json()).error||"Failed to create vehicle");let s=await t.json();return s.vehicle||s}};function n(e){return(0,s.useQuery)({queryKey:["vehicles",e],queryFn:()=>i.getVehicles(e)})}function l(){let e=(0,a.useQueryClient)();return(0,t.useMutation)({mutationFn:i.createVehicle,onSuccess:()=>{e.invalidateQueries({queryKey:["vehicles"]}),r.toast.success("Vehicle created successfully")},onError:e=>{r.toast.error(e.message)}})}function c(e){return(0,s.useQuery)({queryKey:["vehicle-assignments","crew",e],queryFn:async()=>{let t=await fetch("/api/resources/vehicle-assignments?crew_id=".concat(e,"&active_only=true"));if(!t.ok)throw Error("Failed to fetch vehicle assignments");return t.json()},enabled:!!e,staleTime:3e4})}},68499,e=>{"use strict";e.s(["AlertDialog",()=>A,"AlertDialogAction",()=>R,"AlertDialogCancel",()=>B,"AlertDialogContent",()=>P,"AlertDialogDescription",()=>U,"AlertDialogFooter",()=>M,"AlertDialogHeader",()=>E,"AlertDialogTitle",()=>K,"AlertDialogTrigger",()=>Q],68499);var t=e.i(43476),s=e.i(71645),a=e.i(30030),r=e.i(20783),i=e.i(26999),n=e.i(81140),l=e.i(91918),c="AlertDialog",[o,d]=(0,a.createContextScope)(c,[i.createDialogScope]),u=(0,i.createDialogScope)(),m=e=>{let{__scopeAlertDialog:s,...a}=e,r=u(s);return(0,t.jsx)(i.Root,{...r,...a,modal:!0})};m.displayName=c;var x=s.forwardRef((e,s)=>{let{__scopeAlertDialog:a,...r}=e,n=u(a);return(0,t.jsx)(i.Trigger,{...n,...r,ref:s})});x.displayName="AlertDialogTrigger";var h=e=>{let{__scopeAlertDialog:s,...a}=e,r=u(s);return(0,t.jsx)(i.Portal,{...r,...a})};h.displayName="AlertDialogPortal";var p=s.forwardRef((e,s)=>{let{__scopeAlertDialog:a,...r}=e,n=u(a);return(0,t.jsx)(i.Overlay,{...n,...r,ref:s})});p.displayName="AlertDialogOverlay";var f="AlertDialogContent",[j,g]=o(f),y=(0,l.createSlottable)("AlertDialogContent"),v=s.forwardRef((e,a)=>{let{__scopeAlertDialog:l,children:c,...o}=e,d=u(l),m=s.useRef(null),x=(0,r.useComposedRefs)(a,m),h=s.useRef(null);return(0,t.jsx)(i.WarningProvider,{contentName:f,titleName:w,docsSlug:"alert-dialog",children:(0,t.jsx)(j,{scope:l,cancelRef:h,children:(0,t.jsxs)(i.Content,{role:"alertdialog",...d,...o,ref:x,onOpenAutoFocus:(0,n.composeEventHandlers)(o.onOpenAutoFocus,e=>{var t;e.preventDefault(),null==(t=h.current)||t.focus({preventScroll:!0})}),onPointerDownOutside:e=>e.preventDefault(),onInteractOutside:e=>e.preventDefault(),children:[(0,t.jsx)(y,{children:c}),(0,t.jsx)(F,{contentRef:m})]})})})});v.displayName=f;var w="AlertDialogTitle",N=s.forwardRef((e,s)=>{let{__scopeAlertDialog:a,...r}=e,n=u(a);return(0,t.jsx)(i.Title,{...n,...r,ref:s})});N.displayName=w;var b="AlertDialogDescription",C=s.forwardRef((e,s)=>{let{__scopeAlertDialog:a,...r}=e,n=u(a);return(0,t.jsx)(i.Description,{...n,...r,ref:s})});C.displayName=b;var _=s.forwardRef((e,s)=>{let{__scopeAlertDialog:a,...r}=e,n=u(a);return(0,t.jsx)(i.Close,{...n,...r,ref:s})});_.displayName="AlertDialogAction";var q="AlertDialogCancel",k=s.forwardRef((e,s)=>{let{__scopeAlertDialog:a,...n}=e,{cancelRef:l}=g(q,a),c=u(a),o=(0,r.useComposedRefs)(s,l);return(0,t.jsx)(i.Close,{...c,...n,ref:o})});k.displayName=q;var F=e=>{let{contentRef:t}=e,a="`".concat(f,"` requires a description for the component to be accessible for screen reader users.\n\nYou can add a description to the `").concat(f,"` by passing a `").concat(b,"` component as a child, which also benefits sighted users by adding visible context to the dialog.\n\nAlternatively, you can use your own component as a description by assigning it an `id` and passing the same value to the `aria-describedby` prop in `").concat(f,"`. If the description is confusing or duplicative for sighted users, you can use the `@radix-ui/react-visually-hidden` primitive as a wrapper around your description component.\n\nFor more information, see https://radix-ui.com/primitives/docs/components/alert-dialog");return s.useEffect(()=>{var e;document.getElementById(null==(e=t.current)?void 0:e.getAttribute("aria-describedby"))||console.warn(a)},[a,t]),null},T=e.i(75157),D=e.i(19455);let A=m,Q=x,S=s.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(p,{className:(0,T.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r,ref:s})});S.displayName=p.displayName;let P=s.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsxs)(h,{children:[(0,t.jsx)(S,{}),(0,t.jsx)(v,{ref:s,className:(0,T.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...r})]})});P.displayName=v.displayName;let E=e=>{let{className:s,...a}=e;return(0,t.jsx)("div",{className:(0,T.cn)("flex flex-col space-y-2 text-center sm:text-left",s),...a})};E.displayName="AlertDialogHeader";let M=e=>{let{className:s,...a}=e;return(0,t.jsx)("div",{className:(0,T.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...a})};M.displayName="AlertDialogFooter";let K=s.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(N,{ref:s,className:(0,T.cn)("text-lg font-semibold",a),...r})});K.displayName=N.displayName;let U=s.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(C,{ref:s,className:(0,T.cn)("text-sm text-muted-foreground",a),...r})});U.displayName=C.displayName;let R=s.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(_,{ref:s,className:(0,T.cn)((0,D.buttonVariants)(),a),...r})});R.displayName=_.displayName;let B=s.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(k,{ref:s,className:(0,T.cn)((0,D.buttonVariants)({variant:"outline"}),"mt-2 sm:mt-0",a),...r})});B.displayName=k.displayName},43432,e=>{"use strict";e.s(["Phone",()=>t],43432);let t=(0,e.i(75254).default)("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]])},63488,e=>{"use strict";e.s(["Mail",()=>t],63488);let t=(0,e.i(75254).default)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]])},98919,e=>{"use strict";e.s(["Shield",()=>t],98919);let t=(0,e.i(75254).default)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},40160,e=>{"use strict";e.s(["Download",()=>t],40160);let t=(0,e.i(75254).default)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]])},69074,e=>{"use strict";e.s(["Upload",()=>t],69074);let t=(0,e.i(75254).default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]])},68148,e=>{"use strict";e.s(["Progress",()=>y],68148);var t=e.i(43476),s=e.i(71645),a=e.i(30030),r=e.i(48425),i="Progress",[n,l]=(0,a.createContextScope)(i),[c,o]=n(i),d=s.forwardRef((e,s)=>{var a,i,n,l;let{__scopeProgress:o,value:d=null,max:u,getValueLabel:m=x,...g}=e;(u||0===u)&&!f(u)&&console.error((a="".concat(u),i="Progress","Invalid prop `max` of value `".concat(a,"` supplied to `").concat(i,"`. Only numbers greater than 0 are valid max values. Defaulting to `").concat(100,"`.")));let y=f(u)?u:100;null===d||j(d,y)||console.error((n="".concat(d),l="Progress","Invalid prop `value` of value `".concat(n,"` supplied to `").concat(l,"`. The `value` prop must be:\n  - a positive number\n  - less than the value passed to `max` (or ").concat(100," if no `max` prop is set)\n  - `null` or `undefined` if the progress is indeterminate.\n\nDefaulting to `null`.")));let v=j(d,y)?d:null,w=p(v)?m(v,y):void 0;return(0,t.jsx)(c,{scope:o,value:v,max:y,children:(0,t.jsx)(r.Primitive.div,{"aria-valuemax":y,"aria-valuemin":0,"aria-valuenow":p(v)?v:void 0,"aria-valuetext":w,role:"progressbar","data-state":h(v,y),"data-value":null!=v?v:void 0,"data-max":y,...g,ref:s})})});d.displayName=i;var u="ProgressIndicator",m=s.forwardRef((e,s)=>{var a;let{__scopeProgress:i,...n}=e,l=o(u,i);return(0,t.jsx)(r.Primitive.div,{"data-state":h(l.value,l.max),"data-value":null!=(a=l.value)?a:void 0,"data-max":l.max,...n,ref:s})});function x(e,t){return"".concat(Math.round(e/t*100),"%")}function h(e,t){return null==e?"indeterminate":e===t?"complete":"loading"}function p(e){return"number"==typeof e}function f(e){return p(e)&&!isNaN(e)&&e>0}function j(e,t){return p(e)&&!isNaN(e)&&e<=t&&e>=0}m.displayName=u;var g=e.i(75157);let y=s.forwardRef((e,s)=>{let{className:a,value:r,...i}=e;return(0,t.jsx)(d,{ref:s,className:(0,g.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",a),...i,children:(0,t.jsx)(m,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(r||0),"%)")}})})});y.displayName=d.displayName},46897,e=>{"use strict";e.s(["MapPin",()=>t],46897);let t=(0,e.i(75254).default)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},3116,e=>{"use strict";e.s(["Clock",()=>t],3116);let t=(0,e.i(75254).default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},86536,e=>{"use strict";e.s(["Eye",()=>t],86536);let t=(0,e.i(75254).default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},7233,e=>{"use strict";e.s(["Plus",()=>t],7233);let t=(0,e.i(75254).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},27612,e=>{"use strict";e.s(["Trash2",()=>t],27612);let t=(0,e.i(75254).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])},88511,e=>{"use strict";e.s(["Edit",()=>t],88511);let t=(0,e.i(75254).default)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},20306,e=>{"use strict";e.s(["useCreateCrew",()=>o,"useCreateTeam",()=>h,"useCrew",()=>c,"useDeleteCrew",()=>u,"useForemenUsers",()=>x,"useGlobalTeams",()=>m,"useProjectTeams",()=>p,"useTeams",()=>l,"useUpdateCrew",()=>d,"useUpdateTeam",()=>f]);var t=e.i(66027),s=e.i(54616),a=e.i(12598),r=e.i(46696),i=e.i(41931);let n={all:["teams"],crews:()=>[...n.all,"crews"],crew:e=>[...n.all,"crew",e]};function l(){return(0,t.useQuery)({queryKey:n.crews(),queryFn:async()=>{let e=await fetch("/api/crews");if(!e.ok)throw Error("Failed to fetch crews");return(await e.json()).crews||[]},staleTime:3e4})}function c(e){return(0,t.useQuery)({queryKey:n.crew(e),queryFn:()=>i.teamsApi.getCrew(e),enabled:!!e,staleTime:3e5})}function o(){let e=(0,a.useQueryClient)();return(0,s.useMutation)({mutationFn:e=>i.teamsApi.createCrew(e),onSuccess:t=>{e.invalidateQueries({queryKey:n.crews()}),e.setQueryData(n.crew(t.id),t),r.toast.success("Team created successfully")},onError:e=>{r.toast.error("Failed to create team: ".concat(e.message))}})}function d(){let e=(0,a.useQueryClient)();return(0,s.useMutation)({mutationFn:e=>{let{id:t,data:s}=e;return i.teamsApi.updateCrew(t,s)},onMutate:async t=>{let{id:s,data:a}=t;await e.cancelQueries({queryKey:n.crew(s)});let r=e.getQueryData(n.crew(s));return e.setQueryData(n.crew(s),e=>e?{...e,...a}:e),{previousCrew:r}},onError:(t,s,a)=>{let{id:i}=s;(null==a?void 0:a.previousCrew)&&e.setQueryData(n.crew(i),a.previousCrew),r.toast.error("Failed to update team: ".concat(t.message))},onSuccess:()=>{e.invalidateQueries({queryKey:n.crews()}),r.toast.success("Team updated successfully")},onSettled:(t,s,a)=>{let{id:r}=a;e.invalidateQueries({queryKey:n.crew(r)})}})}function u(){let e=(0,a.useQueryClient)();return(0,s.useMutation)({mutationFn:e=>i.teamsApi.deleteCrew(e),onSuccess:(t,s)=>{e.removeQueries({queryKey:n.crew(s)}),e.invalidateQueries({queryKey:n.crews()}),r.toast.success("Team deleted successfully")},onError:e=>{r.toast.error("Failed to delete team: ".concat(e.message))}})}function m(){return(0,t.useQuery)({queryKey:["global-teams"],queryFn:async()=>{let e=await fetch("/api/crews");if(!e.ok)throw Error("Failed to fetch global teams");let t=(await e.json()).crews||[],s={};return t.forEach(e=>{e.project_id&&(s[e.name]=(s[e.name]||0)+1)}),t.map(e=>{var t;return{id:e.id,name:e.name,foreman_name:(null==(t=e.foreman)?void 0:t.full_name)||e.foreman_name,is_active:"active"===e.status,project_count:s[e.name]||0,specialization:"mixed"}})}})}function x(){return(0,t.useQuery)({queryKey:["foremen-users"],queryFn:async()=>{let e=await fetch("/api/users?role=foreman&is_active=true");if(!e.ok){let e=await fetch("/api/users?role=pm&is_active=true");if(!e.ok)throw Error("Failed to fetch users");return(await e.json()).items||[]}let t=await e.json();if(0===t.items.length){let e=await fetch("/api/users?is_active=true");if(!e.ok)throw Error("Failed to fetch users");return((await e.json()).items||[]).filter(e=>"foreman"===e.role||"pm"===e.role)}return t.items||[]}})}function h(){let e=(0,a.useQueryClient)();return(0,s.useMutation)({mutationFn:async e=>{let t=await fetch("/api/crews",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error((await t.json()).error||"Failed to create team");return t.json()},onSuccess:(t,s)=>{s.project_id&&(e.invalidateQueries({queryKey:["project-teams",s.project_id]}),e.invalidateQueries({queryKey:["project-preparation",s.project_id]})),e.invalidateQueries({queryKey:["global-teams"]}),e.invalidateQueries({queryKey:n.crews()}),r.toast.success(t.message||"Team created successfully")},onError:e=>{r.toast.error(e.message)}})}function p(e){return(0,t.useQuery)({queryKey:["project-teams",e],queryFn:async()=>{let t=await fetch("/api/crews?project_id=".concat(e));if(!t.ok)throw Error("Failed to fetch project teams");return(await t.json()).crews||[]},enabled:!!e})}function f(){let e=(0,a.useQueryClient)();return(0,s.useMutation)({mutationFn:async e=>{let{id:t,data:s}=e,a=await fetch("/api/crews/".concat(t),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok)throw Error((await a.json()).error||"Failed to update team");return a.json()},onSuccess:(t,s)=>{e.invalidateQueries({queryKey:["project-teams"]}),e.invalidateQueries({queryKey:["global-teams"]}),e.invalidateQueries({queryKey:n.crews()}),e.invalidateQueries({queryKey:["project-preparation"]}),r.toast.success(t.message||"Team updated successfully")},onError:e=>{r.toast.error(e.message)}})}},79002,e=>{"use strict";e.s(["UserPlus",()=>t],79002);let t=(0,e.i(75254).default)("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]])},32548,e=>{"use strict";e.s(["default",()=>b]);var t=e.i(43476),s=e.i(71645),a=e.i(66027),r=e.i(12598),i=e.i(78583),n=e.i(98919),l=e.i(78894),c=e.i(69638),o=e.i(3116),d=e.i(40160),u=e.i(86536),m=e.i(37727),x=e.i(7233),h=e.i(76639),p=e.i(19455),f=e.i(15288),j=e.i(87486),g=e.i(77572),y=e.i(40446);async function v(e){let t=await fetch("/api/users/".concat(e,"/documents"));if(!t.ok)throw Error("Failed to fetch documents");return t.json()}function w(e){let{document:s}=e,a=function(e){switch(e){case"active":return"bg-green-500";case"expired":return"bg-red-500";case"expiring_soon":return"bg-yellow-500";case"pending":return"bg-blue-500";default:return"bg-gray-500"}}(s.status),x=function(e){switch(e){case"active":return(0,t.jsx)(c.CheckCircle,{className:"h-4 w-4"});case"expired":return(0,t.jsx)(l.AlertTriangle,{className:"h-4 w-4"});case"expiring_soon":case"pending":return(0,t.jsx)(o.Clock,{className:"h-4 w-4"});case"inactive":return(0,t.jsx)(m.X,{className:"h-4 w-4"});default:return(0,t.jsx)(i.FileText,{className:"h-4 w-4"})}}(s.status),h=function(e){switch(e){case"active":return"Действителен";case"expired":return"Истёк";case"expiring_soon":return"Истекает скоро";case"pending":return"В ожидании";case"inactive":return"Неактивен";default:return"Неизвестен"}}(s.status),g=(0,r.useQueryClient)(),y=async()=>{try{console.log('💾 Скачиваю документ "'.concat(s.file_name,'" для работника ID: ').concat(s.user_id));let e="/api/users/".concat(s.user_id,"/documents/").concat(s.id,"/download"),t=await fetch(e);if(!t.ok)throw Error("Failed to download document");let a=await t.blob(),r=window.URL.createObjectURL(a),i=window.document.createElement("a");i.href=r,i.download=s.file_name,window.document.body.appendChild(i),i.click(),window.URL.revokeObjectURL(r),window.document.body.removeChild(i)}catch(e){console.error("Download failed:",e),alert("Ошибка при скачивании документа")}},v=async()=>{if(window.confirm('Вы уверены, что хотите удалить документ "'.concat(s.file_name,'"?')))try{if(console.log('🗑️ Удаляю документ "'.concat(s.file_name,'" для работника ID: ').concat(s.user_id)),!(await fetch("/api/users/".concat(s.user_id,"/documents/").concat(s.id),{method:"DELETE"})).ok)throw Error("Failed to delete document");console.log('✅ Документ "'.concat(s.file_name,'" успешно удален')),g.invalidateQueries({queryKey:["worker-documents",s.user_id]}),alert("Документ успешно удален")}catch(e){console.error("Delete failed:",e),alert("Ошибка при удалении документа")}};return(0,t.jsxs)(f.Card,{className:"mb-4",children:[(0,t.jsx)(f.CardHeader,{className:"pb-3",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)(f.CardTitle,{className:"text-lg flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:s.category.color}}),s.category.name_ru||s.category.name_en]}),(0,t.jsxs)(j.Badge,{variant:"secondary",className:"".concat(a," text-white flex items-center gap-1"),children:[x,h]})]})}),(0,t.jsxs)(f.CardContent,{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[s.document_number&&(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium text-muted-foreground",children:"Номер документа:"}),(0,t.jsx)("p",{children:s.document_number})]}),s.issuing_authority&&(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium text-muted-foreground",children:"Выдавший орган:"}),(0,t.jsx)("p",{children:s.issuing_authority})]}),s.issue_date&&(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium text-muted-foreground",children:"Дата выдачи:"}),(0,t.jsx)("p",{children:new Date(s.issue_date).toLocaleDateString("ru-RU")})]}),s.expiry_date&&(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium text-muted-foreground",children:"Дата истечения:"}),(0,t.jsx)("p",{className:"expired"===s.status?"text-red-600 font-medium":"expiring_soon"===s.status?"text-yellow-600 font-medium":"",children:new Date(s.expiry_date).toLocaleDateString("ru-RU")})]})]}),s.notes&&(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium text-muted-foreground",children:"Примечания:"}),(0,t.jsx)("p",{className:"text-sm mt-1",children:s.notes})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between pt-2 border-t",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,t.jsx)(i.FileText,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:s.file_name}),(0,t.jsxs)("span",{children:["(",function(e){if(0===e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]}(s.file_size),")"]}),s.is_verified&&(0,t.jsxs)(j.Badge,{variant:"outline",className:"text-green-600 border-green-600",children:[(0,t.jsx)(n.Shield,{className:"h-3 w-3 mr-1"}),"Проверен"]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(p.Button,{variant:"outline",size:"sm",onClick:()=>{let e="/api/users/".concat(s.user_id,"/documents/").concat(s.id,"/view");console.log('👁️ Открываю документ "'.concat(s.file_name,'" для просмотра')),window.open(e,"_blank")},children:[(0,t.jsx)(u.Eye,{className:"h-4 w-4 mr-1"}),"Просмотр"]}),(0,t.jsxs)(p.Button,{variant:"outline",size:"sm",onClick:y,children:[(0,t.jsx)(d.Download,{className:"h-4 w-4 mr-1"}),"Скачать"]}),(0,t.jsxs)(p.Button,{variant:"outline",size:"sm",onClick:v,className:"text-red-600 hover:text-red-700",children:[(0,t.jsx)(m.X,{className:"h-4 w-4 mr-1"}),"Удалить"]})]})]})]})]})}function N(e){let{documents:s}=e,a=s.reduce((e,t)=>{let s=t.category.name_ru||t.category.name_en;return e[s]||(e[s]=[]),e[s].push(t),e},{});return(0,t.jsx)("div",{className:"space-y-6",children:Object.entries(a).map(e=>{let[s,a]=e;return(0,t.jsxs)("div",{children:[(0,t.jsxs)("h3",{className:"font-semibold text-lg mb-3 flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:a[0].category.color}}),s,(0,t.jsx)(j.Badge,{variant:"outline",children:a.length})]}),a.map(e=>(0,t.jsx)(w,{document:e},e.id))]},s)})})}function b(e){let{userId:n,userName:l,trigger:c}=e,[o,d]=(0,s.useState)(!1),[u,m]=(0,s.useState)(!1),j=(0,r.useQueryClient)(),{data:w,isLoading:b,error:C}=(0,a.useQuery)({queryKey:["worker-documents",n],queryFn:()=>v(n),enabled:o}),_=(0,t.jsxs)(p.Button,{variant:"outline",size:"sm",children:[(0,t.jsx)(i.FileText,{className:"h-4 w-4 mr-1"}),"Документы"]});return(0,t.jsxs)(h.Dialog,{open:o,onOpenChange:d,children:[(0,t.jsx)(h.DialogTrigger,{asChild:!0,children:c||_}),(0,t.jsxs)(h.DialogContent,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[(0,t.jsx)(h.DialogHeader,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)(h.DialogTitle,{className:"flex items-center gap-2",children:[(0,t.jsx)(i.FileText,{className:"h-5 w-5"}),"Документы работника: ",l]}),(0,t.jsx)(h.DialogDescription,{children:"Просмотр всех документов работника (страховка, разрешения, удостоверения)"})]}),(0,t.jsxs)(p.Button,{onClick:()=>m(!0),className:"flex items-center gap-2",children:[(0,t.jsx)(x.Plus,{className:"h-4 w-4"}),"Добавить документ"]})]})}),b&&(0,t.jsx)("div",{className:"flex justify-center py-8",children:(0,t.jsx)("div",{className:"h-6 w-6 animate-spin rounded-full border-2 border-primary border-t-transparent"})}),C&&(0,t.jsx)("div",{className:"text-center py-8",children:(0,t.jsx)("p",{className:"text-destructive",children:"Ошибка загрузки документов"})}),w&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,t.jsx)(f.Card,{children:(0,t.jsxs)(f.CardContent,{className:"p-4 text-center",children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:w.stats.total}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Всего"})]})}),(0,t.jsx)(f.Card,{children:(0,t.jsxs)(f.CardContent,{className:"p-4 text-center",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-green-600",children:w.stats.active}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Действительных"})]})}),(0,t.jsx)(f.Card,{children:(0,t.jsxs)(f.CardContent,{className:"p-4 text-center",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-yellow-600",children:w.stats.expiring_soon}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Истекают скоро"})]})}),(0,t.jsx)(f.Card,{children:(0,t.jsxs)(f.CardContent,{className:"p-4 text-center",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-red-600",children:w.stats.expired}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:"Истёкших"})]})})]}),0===w.documents.length?(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(i.FileText,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,t.jsx)("h3",{className:"mt-2 text-sm font-semibold",children:"Нет документов"}),(0,t.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"У этого работника пока нет загруженных документов."})]}):(0,t.jsxs)(g.Tabs,{defaultValue:"all",className:"w-full",children:[(0,t.jsxs)(g.TabsList,{className:"grid w-full grid-cols-4",children:[(0,t.jsxs)(g.TabsTrigger,{value:"all",children:["Все (",w.stats.total,")"]}),(0,t.jsxs)(g.TabsTrigger,{value:"active",children:["Действительные (",w.stats.active,")"]}),(0,t.jsxs)(g.TabsTrigger,{value:"expiring",children:["Истекают (",w.stats.expiring_soon,")"]}),(0,t.jsxs)(g.TabsTrigger,{value:"expired",children:["Истёкшие (",w.stats.expired,")"]})]}),(0,t.jsx)(g.TabsContent,{value:"all",className:"mt-6",children:(0,t.jsx)(N,{documents:w.documents})}),(0,t.jsx)(g.TabsContent,{value:"active",className:"mt-6",children:(0,t.jsx)(N,{documents:w.documents.filter(e=>"active"===e.status)})}),(0,t.jsx)(g.TabsContent,{value:"expiring",className:"mt-6",children:(0,t.jsx)(N,{documents:w.documents.filter(e=>"expiring_soon"===e.status)})}),(0,t.jsx)(g.TabsContent,{value:"expired",className:"mt-6",children:(0,t.jsx)(N,{documents:w.documents.filter(e=>"expired"===e.status)})})]})]})]}),(0,t.jsx)(h.Dialog,{open:u,onOpenChange:m,children:(0,t.jsxs)(h.DialogContent,{className:"max-w-2xl",children:[(0,t.jsxs)(h.DialogHeader,{children:[(0,t.jsxs)(h.DialogTitle,{children:["Загрузить документ для ",l]}),(0,t.jsx)(h.DialogDescription,{children:"Загрузите новый документ (паспорт, разрешение на работу, страховка и т.д.)"})]}),(0,t.jsx)(y.DocumentUpload,{userId:n,onUploadComplete:e=>{console.log('✅ Документ "'.concat(e.file_name,'" успешно добавлен для работника: ').concat(l," (ID: ").concat(n,")")),m(!1),j.invalidateQueries({queryKey:["worker-documents",n]}),j.invalidateQueries({queryKey:["user-documents-categories",n]})}})]})})]})}},89357,e=>{"use strict";e.s(["default",()=>U]);var t=e.i(43476),s=e.i(71645),a=e.i(18566),r=e.i(53145),i=e.i(94814),n=e.i(81307),l=e.i(71689),c=e.i(61911),o=e.i(88511),d=e.i(56909),u=e.i(37727),m=e.i(46897),x=e.i(87316),h=e.i(63488),p=e.i(43432),f=e.i(79002),j=e.i(27612),g=e.i(39616),y=e.i(95116),v=e.i(15788),w=e.i(88844),N=e.i(19455),b=e.i(93479),C=e.i(15288),_=e.i(87486),q=e.i(10204),k=e.i(3133),F=e.i(67489),T=e.i(68499),D=e.i(20306),A=e.i(46835),Q=e.i(32661),S=e.i(71436),P=e.i(77126),E=e.i(29041),M=e.i(32548);let K=n.z.object({name:n.z.string().min(1,"Team name is required"),foreman_user_id:n.z.string().optional(),project_id:n.z.string().optional()});function U(){var e,n,U;let R=(0,a.useRouter)(),B=(0,a.useParams)(),{canManageTeams:L}=(0,S.usePermissions)(),[z,V]=(0,s.useState)(!1),I=B.id,{data:O,isLoading:H,error:W}=(0,D.useCrew)(I),X=(0,D.useUpdateCrew)(),J=(0,D.useDeleteCrew)(),{data:G}=(0,A.useUsers)({page:1,per_page:100}),{data:Y,isLoading:Z}=(0,Q.useProjects)({page:1,per_page:50}),{data:$,isLoading:ee}=(0,P.useCrewEquipmentAssignments)(I),{data:et,isLoading:es}=(0,E.useCrewVehicleAssignments)(I),ea=(null==G?void 0:G.items)||[],er=(null==Y?void 0:Y.items)||[],ei=ea.filter(e=>["foreman","pm","admin"].includes(e.role)),en=(0,r.useForm)({resolver:(0,i.zodResolver)(K),defaultValues:{name:(null==O?void 0:O.name)||"",foreman_user_id:(null==O?void 0:O.foreman_user_id)||"",project_id:(null==O?void 0:O.project_id)||""}});(0,s.useEffect)(()=>{O&&en.reset({name:O.name,foreman_user_id:O.foreman_user_id||"",project_id:O.project_id||""})},[O,en]);let el=async e=>{if(O)try{let t={name:e.name,foreman_user_id:"none"===e.foreman_user_id?void 0:e.foreman_user_id,project_id:"none"===e.project_id?void 0:e.project_id};await X.mutateAsync({id:O.id,data:t}),V(!1)}catch(e){console.error("Failed to update team:",e)}},ec=async()=>{if(O)try{await J.mutateAsync(O.id),R.push("/dashboard/teams")}catch(e){console.error("Failed to delete team:",e)}};return H?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)("div",{className:"h-10 w-20 bg-muted animate-pulse rounded"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"h-8 w-64 bg-muted animate-pulse rounded"}),(0,t.jsx)("div",{className:"h-4 w-96 mt-2 bg-muted animate-pulse rounded"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsx)("div",{className:"h-96 bg-muted animate-pulse rounded"}),(0,t.jsx)("div",{className:"h-96 bg-muted animate-pulse rounded"})]})]}):W||!O?(0,t.jsx)("div",{className:"space-y-6",children:(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)(N.Button,{variant:"ghost",size:"sm",onClick:()=>R.back(),className:"flex items-center space-x-2",children:[(0,t.jsx)(l.ArrowLeft,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Back"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold tracking-tight text-destructive",children:"Team Not Found"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"The team you're looking for doesn't exist or has been deleted."})]})]})}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)(N.Button,{variant:"ghost",size:"sm",onClick:()=>R.back(),className:"flex items-center space-x-2",children:[(0,t.jsx)(l.ArrowLeft,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Back"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:O.name}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Team details and member management"})]})]}),L&&(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[z?(0,t.jsxs)(N.Button,{variant:"outline",onClick:()=>V(!1),className:"flex items-center space-x-2",children:[(0,t.jsx)(u.X,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Cancel"})]}):(0,t.jsxs)(N.Button,{variant:"outline",onClick:()=>V(!0),className:"flex items-center space-x-2",children:[(0,t.jsx)(o.Edit,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Edit Team"})]}),(0,t.jsxs)(T.AlertDialog,{children:[(0,t.jsx)(T.AlertDialogTrigger,{asChild:!0,children:(0,t.jsx)(N.Button,{variant:"destructive",size:"sm",children:(0,t.jsx)(j.Trash2,{className:"h-4 w-4"})})}),(0,t.jsxs)(T.AlertDialogContent,{children:[(0,t.jsxs)(T.AlertDialogHeader,{children:[(0,t.jsx)(T.AlertDialogTitle,{children:"Delete Team"}),(0,t.jsxs)(T.AlertDialogDescription,{children:['Are you sure you want to delete "',O.name,'"? This action cannot be undone.']})]}),(0,t.jsxs)(T.AlertDialogFooter,{children:[(0,t.jsx)(T.AlertDialogCancel,{children:"Cancel"}),(0,t.jsx)(T.AlertDialogAction,{onClick:ec,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsxs)(C.Card,{children:[(0,t.jsxs)(C.CardHeader,{children:[(0,t.jsxs)(C.CardTitle,{className:"flex items-center space-x-2",children:[(0,t.jsx)(g.Settings,{className:"h-5 w-5"}),(0,t.jsx)("span",{children:"Team Information"})]}),(0,t.jsx)(C.CardDescription,{children:"Basic team details and assignments"})]}),(0,t.jsx)(C.CardContent,{children:z?(0,t.jsx)(k.Form,{...en,children:(0,t.jsxs)("form",{onSubmit:en.handleSubmit(el),className:"space-y-4",children:[(0,t.jsx)(k.FormField,{control:en.control,name:"name",render:e=>{let{field:s}=e;return(0,t.jsxs)(k.FormItem,{children:[(0,t.jsx)(k.FormLabel,{children:"Team Name *"}),(0,t.jsx)(k.FormControl,{children:(0,t.jsx)(b.Input,{placeholder:"e.g., Installation Team Alpha",...s})}),(0,t.jsx)(k.FormMessage,{})]})}}),(0,t.jsx)(k.FormField,{control:en.control,name:"foreman_user_id",render:e=>{let{field:s}=e;return(0,t.jsxs)(k.FormItem,{children:[(0,t.jsx)(k.FormLabel,{children:"Team Leader / Foreman"}),(0,t.jsxs)(F.Select,{onValueChange:s.onChange,value:s.value,children:[(0,t.jsx)(k.FormControl,{children:(0,t.jsx)(F.SelectTrigger,{children:(0,t.jsx)(F.SelectValue,{placeholder:"Select team leader"})})}),(0,t.jsxs)(F.SelectContent,{children:[(0,t.jsx)(F.SelectItem,{value:"none",children:"No leader assigned"}),ei.map(e=>(0,t.jsxs)(F.SelectItem,{value:e.id,children:[e.full_name," (",e.role,")"]},e.id))]})]}),(0,t.jsx)(k.FormMessage,{})]})}}),(0,t.jsx)(k.FormField,{control:en.control,name:"project_id",render:e=>{let{field:s}=e;return(0,t.jsxs)(k.FormItem,{children:[(0,t.jsx)(k.FormLabel,{children:"Assign to Project"}),(0,t.jsxs)(F.Select,{onValueChange:s.onChange,value:s.value,children:[(0,t.jsx)(k.FormControl,{children:(0,t.jsx)(F.SelectTrigger,{children:(0,t.jsx)(F.SelectValue,{placeholder:"Select project (optional)"})})}),(0,t.jsxs)(F.SelectContent,{children:[(0,t.jsx)(F.SelectItem,{value:"none",children:"No project assigned"}),Z?(0,t.jsx)(F.SelectItem,{value:"loading",disabled:!0,children:"Loading projects..."}):er.map(e=>(0,t.jsx)(F.SelectItem,{value:e.id,children:e.name},e.id))]})]}),(0,t.jsx)(k.FormMessage,{})]})}}),(0,t.jsxs)("div",{className:"flex justify-end space-x-2 pt-4",children:[(0,t.jsxs)(N.Button,{type:"button",variant:"outline",onClick:()=>V(!1),children:[(0,t.jsx)(u.X,{className:"mr-2 h-4 w-4"}),"Cancel"]}),(0,t.jsxs)(N.Button,{type:"submit",disabled:X.isPending,children:[X.isPending?(0,t.jsx)("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-background border-t-transparent mr-2"}):(0,t.jsx)(d.Save,{className:"mr-2 h-4 w-4"}),"Save Changes"]})]})]})}):(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(q.Label,{className:"text-sm font-medium",children:"Team Name"}),(0,t.jsx)("p",{className:"text-lg",children:O.name})]}),O.foreman&&(0,t.jsxs)("div",{children:[(0,t.jsx)(q.Label,{className:"text-sm font-medium",children:"Team Leader / Foreman"}),(0,t.jsxs)("div",{className:"flex items-center space-x-2 mt-1",children:[(0,t.jsx)(_.Badge,{variant:"default",children:O.foreman.role}),(0,t.jsx)("span",{className:"text-sm",children:O.foreman.full_name})]}),O.foreman.email&&(0,t.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-muted-foreground mt-1",children:[(0,t.jsx)(h.Mail,{className:"h-3 w-3"}),(0,t.jsx)("span",{children:O.foreman.email})]}),O.foreman.phone&&(0,t.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-muted-foreground",children:[(0,t.jsx)(p.Phone,{className:"h-3 w-3"}),(0,t.jsx)("span",{children:O.foreman.phone})]})]}),O.project_name&&(0,t.jsxs)("div",{children:[(0,t.jsx)(q.Label,{className:"text-sm font-medium",children:"Assigned Project"}),(0,t.jsxs)("div",{className:"flex items-center space-x-2 mt-1",children:[(0,t.jsx)(m.MapPin,{className:"h-4 w-4 text-muted-foreground"}),(0,t.jsx)("span",{children:O.project_name})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(q.Label,{className:"text-sm font-medium",children:"Status"}),(0,t.jsx)("div",{className:"mt-1",children:(0,t.jsx)(_.Badge,{variant:"secondary",children:O.status})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(q.Label,{className:"text-sm font-medium",children:"Created"}),(0,t.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-muted-foreground mt-1",children:[(0,t.jsx)(x.Calendar,{className:"h-3 w-3"}),(0,t.jsx)("span",{children:new Date(O.created_at).toLocaleDateString()})]})]})]})})]}),(0,t.jsxs)(C.Card,{children:[(0,t.jsx)(C.CardHeader,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)(C.CardTitle,{className:"flex items-center space-x-2",children:[(0,t.jsx)(c.Users,{className:"h-5 w-5"}),(0,t.jsxs)("span",{children:["Team Members (",(null==(e=O.members)?void 0:e.length)||0,")"]})]}),(0,t.jsx)(C.CardDescription,{children:"Current team members and their roles"})]}),L&&(0,t.jsxs)(N.Button,{variant:"outline",onClick:()=>R.push("/dashboard/teams/".concat(I,"/members")),className:"flex items-center space-x-2",children:[(0,t.jsx)(f.UserPlus,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Manage Members"})]})]})}),(0,t.jsx)(C.CardContent,{children:(0,t.jsx)("div",{className:"space-y-3",children:(null==(n=O.members)?void 0:n.length)===0?(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(f.UserPlus,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,t.jsx)("h3",{className:"mt-2 text-sm font-semibold",children:"No team members"}),(0,t.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"This team doesn't have any members assigned yet."}),L&&(0,t.jsxs)(N.Button,{variant:"outline",className:"mt-4",onClick:()=>R.push("/dashboard/teams/".concat(I,"/members")),children:[(0,t.jsx)(f.UserPlus,{className:"mr-2 h-4 w-4"}),"Add Members"]})]}):null==(U=O.members)?void 0:U.map(e=>(0,t.jsxs)("div",{className:"flex items-center space-x-3 p-3 border rounded-lg",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"font-medium text-sm",children:e.user.full_name}),(0,t.jsx)("div",{className:"text-xs text-muted-foreground",children:e.user.email||e.user.phone||"No contact info"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(_.Badge,{variant:(e=>{switch(e){case"foreman":return"default";case"crew":case"worker":return"secondary";default:return"outline"}})(e.user.role||""),children:e.user.role}),(0,t.jsx)(_.Badge,{variant:"outline",children:e.role_in_crew}),(0,t.jsx)(M.default,{userId:e.user.id,userName:e.user.full_name})]})]},e.id))})})]})]}),(0,t.jsxs)(C.Card,{children:[(0,t.jsx)(C.CardHeader,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)(C.CardTitle,{className:"flex items-center space-x-2",children:[(0,t.jsx)(w.Package,{className:"h-5 w-5"}),(0,t.jsx)("span",{children:"Assigned Resources"})]}),(0,t.jsx)(C.CardDescription,{children:"Equipment and vehicles assigned to this crew"})]}),L&&(0,t.jsxs)(N.Button,{variant:"outline",size:"sm",onClick:()=>R.push("/dashboard/equipment/assignments/new"),className:"flex items-center space-x-2",children:[(0,t.jsx)(w.Package,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Assign Resource"})]})]})}),(0,t.jsx)(C.CardContent,{children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,t.jsx)(y.Wrench,{className:"h-5 w-5 text-muted-foreground"}),(0,t.jsxs)("span",{className:"text-lg font-semibold",children:["Equipment (",(null==$?void 0:$.length)||0,")"]})]}),ee?(0,t.jsx)("div",{className:"space-y-2",children:Array.from({length:2}).map((e,s)=>(0,t.jsx)("div",{className:"h-16 bg-muted animate-pulse rounded"},s))}):(null==$?void 0:$.length)?(0,t.jsx)("div",{className:"space-y-3",children:null==$?void 0:$.map(e=>{var s,a;return(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/5 transition-colors",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(y.Wrench,{className:"h-5 w-5 text-muted-foreground"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium",children:(null==(s=e.equipment)?void 0:s.name)||"Unknown Equipment"}),(null==(a=e.equipment)?void 0:a.inventory_no)&&(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:["#",e.equipment.inventory_no]})]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"text-xs text-muted-foreground",children:e.is_permanent?"Permanent":"Temporary"}),e.project_name&&(0,t.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Project: ",e.project_name]})]})]},e.id)})}):(0,t.jsxs)("div",{className:"text-center py-6 border rounded-lg bg-muted/10",children:[(0,t.jsx)(y.Wrench,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,t.jsx)("p",{className:"mt-2 text-sm text-muted-foreground",children:"No equipment assigned"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,t.jsx)(v.Truck,{className:"h-5 w-5 text-muted-foreground"}),(0,t.jsxs)("span",{className:"text-lg font-semibold",children:["Vehicles (",(null==et?void 0:et.length)||0,")"]})]}),es?(0,t.jsx)("div",{className:"space-y-2",children:Array.from({length:2}).map((e,s)=>(0,t.jsx)("div",{className:"h-16 bg-muted animate-pulse rounded"},s))}):(null==et?void 0:et.length)?(0,t.jsx)("div",{className:"space-y-3",children:null==et?void 0:et.map(e=>{var s,a,r;return(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/5 transition-colors",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(v.Truck,{className:"h-5 w-5 text-muted-foreground"}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"font-medium",children:[null==(s=e.vehicle)?void 0:s.brand," ",null==(a=e.vehicle)?void 0:a.model]}),(null==(r=e.vehicle)?void 0:r.plate_number)&&(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:["🚗 ",e.vehicle.plate_number]})]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"text-xs text-muted-foreground",children:e.is_permanent?"Permanent":"Temporary"}),e.project_name&&(0,t.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Project: ",e.project_name]})]})]},e.id)})}):(0,t.jsxs)("div",{className:"text-center py-6 border rounded-lg bg-muted/10",children:[(0,t.jsx)(v.Truck,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,t.jsx)("p",{className:"mt-2 text-sm text-muted-foreground",children:"No vehicles assigned"})]})]})]})})]})]})}}]);