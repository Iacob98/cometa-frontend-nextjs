(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,24687,e=>{"use strict";e.s(["Textarea",()=>s]);var r=e.i(43476),t=e.i(71645),a=e.i(75157);let s=t.forwardRef((e,t)=>{let{className:s,...i}=e;return(0,r.jsx)("textarea",{className:(0,a.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...i})});s.displayName="Textarea"},71689,e=>{"use strict";e.s(["ArrowLeft",()=>r],71689);let r=(0,e.i(75254).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},56909,e=>{"use strict";e.s(["Save",()=>r],56909);let r=(0,e.i(75254).default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},4382,e=>{"use strict";e.s(["invalidateAllMaterialQueries",()=>u,"useAdjustStock",()=>f,"useAssignMaterialToProject",()=>b,"useCreateMaterial",()=>j,"useDeleteMaterial",()=>g,"useDeleteMaterialAssignment",()=>M,"useLowStockMaterials",()=>h,"useMaterial",()=>m,"useMaterials",()=>d,"useOrders",()=>F,"useSuppliers",()=>v,"useUnifiedProjectMaterials",()=>y,"useUnifiedWarehouseMaterials",()=>p,"useUpdateMaterial",()=>x,"useUpdateMaterialAssignment",()=>w]);var r=e.i(66027),t=e.i(54616),a=e.i(12598),s=e.i(46696),i=e.i(41931);let l={all:["materials"],lists:()=>[...l.all,"list"],list:e=>[...l.lists(),e],details:()=>[...l.all,"detail"],detail:e=>[...l.details(),e],lowStock:()=>[...l.all,"low-stock"]},n={all:["suppliers"],lists:()=>[...n.all,"list"],details:()=>[...n.all,"detail"],detail:e=>[...n.details(),e]},o={all:["allocations"],lists:()=>[...o.all,"list"],list:e=>[...o.lists(),e],details:()=>[...o.all,"detail"],detail:e=>[...o.details(),e]},c={all:["orders"],lists:()=>[...c.all,"list"],list:e=>[...c.lists(),e],details:()=>[...c.all,"detail"],detail:e=>[...c.details(),e]};function u(e){e.invalidateQueries({queryKey:l.all}),e.invalidateQueries({queryKey:o.all}),e.invalidateQueries({queryKey:c.all}),e.invalidateQueries({queryKey:[...l.all,"unified-warehouse"]}),e.invalidateQueries({queryKey:[...l.all,"allocation-targets"]}),e.refetchQueries({queryKey:[...l.all,"unified-warehouse"],type:"active"})}function d(e){return(0,r.useQuery)({queryKey:l.list(e||{}),queryFn:()=>i.materialsApi.getMaterials(e),staleTime:12e4})}function m(e){return(0,r.useQuery)({queryKey:l.detail(e),queryFn:()=>i.materialsApi.getMaterial(e),enabled:!!e,staleTime:3e5})}function h(){return(0,r.useQuery)({queryKey:l.lowStock(),queryFn:async()=>{let e=await fetch("/api/materials/low-stock");if(!e.ok)throw Error("Failed to fetch low stock materials");return(await e.json()).materials||[]},staleTime:12e4})}function p(){return(0,r.useQuery)({queryKey:[...l.all,"unified-warehouse"],queryFn:async()=>{let e=await fetch("/api/materials/unified?view=warehouse");if(!e.ok)throw Error("Failed to fetch warehouse materials");return(await e.json()).materials||[]},staleTime:3e4,gcTime:3e5,refetchOnWindowFocus:!0,refetchInterval:6e4})}function y(e){return(0,r.useQuery)({queryKey:[...o.all,"project",e,"unified"],queryFn:async()=>{let r=await fetch("/api/materials/unified?view=project_allocations&project_id=".concat(e));if(!r.ok)throw Error("Failed to fetch project materials");let t=await r.json();return{materials:t.materials||[],summary:t.allocation_summary}},enabled:!!e,staleTime:6e4,gcTime:3e5})}function j(){let e=(0,a.useQueryClient)();return(0,t.useMutation)({mutationFn:e=>i.materialsApi.createMaterial(e),onSuccess:r=>{e.invalidateQueries({queryKey:l.lists()}),e.setQueryData(l.detail(r.id),r),s.toast.success("Material created successfully")},onError:e=>{s.toast.error("Failed to create material: ".concat(e.message))}})}function x(){let e=(0,a.useQueryClient)();return(0,t.useMutation)({mutationFn:e=>{let{id:r,data:t}=e;return i.materialsApi.updateMaterial(r,t)},onMutate:async r=>{let{id:t,data:a}=r;await e.cancelQueries({queryKey:l.detail(t)});let s=e.getQueryData(l.detail(t));return e.setQueryData(l.detail(t),e=>e?{...e,...a}:e),{previousMaterial:s}},onError:(r,t,a)=>{let{id:i}=t;(null==a?void 0:a.previousMaterial)&&e.setQueryData(l.detail(i),a.previousMaterial),s.toast.error("Failed to update material: ".concat(r.message))},onSuccess:()=>{e.invalidateQueries({queryKey:l.lists()}),e.invalidateQueries({queryKey:l.lowStock()}),s.toast.success("Material updated successfully")},onSettled:(r,t,a)=>{let{id:s}=a;e.invalidateQueries({queryKey:l.detail(s)})}})}function g(){let e=(0,a.useQueryClient)();return(0,t.useMutation)({mutationFn:e=>i.materialsApi.deleteMaterial(e),onSuccess:(r,t)=>{e.removeQueries({queryKey:l.detail(t)}),e.invalidateQueries({queryKey:l.lists()}),e.invalidateQueries({queryKey:l.lowStock()}),s.toast.success("Material deleted successfully")},onError:e=>{s.toast.error("Failed to delete material: ".concat(e.message))}})}function f(){let e=(0,a.useQueryClient)();return(0,t.useMutation)({mutationFn:e=>{let{id:r,adjustment:t}=e;return i.materialsApi.adjustStock(r,t)},onSuccess:r=>{e.setQueryData(l.detail(r.id),r),e.invalidateQueries({queryKey:l.lists()}),e.invalidateQueries({queryKey:l.lowStock()}),e.invalidateQueries({queryKey:[...l.all,"unified-warehouse"]}),e.invalidateQueries({queryKey:[...l.all,"allocation-targets"]}),s.toast.success("Stock adjusted successfully")},onError:e=>{s.toast.error("Failed to adjust stock: ".concat(e.message))}})}function v(){return(0,r.useQuery)({queryKey:n.lists(),queryFn:()=>i.suppliersApi.getSuppliers(),staleTime:6e5})}function F(e){return(0,r.useQuery)({queryKey:c.list(e||{}),queryFn:()=>i.materialOrdersApi.getOrders(e),staleTime:18e4})}function b(){let e=(0,a.useQueryClient)();return(0,t.useMutation)({mutationFn:async e=>{let r=await fetch("/api/materials/assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!r.ok)throw Error((await r.json()).message||"Failed to assign material");return r.json()},onSuccess:(r,t)=>{e.invalidateQueries({queryKey:[...l.all,"project",t.project_id]}),e.invalidateQueries({queryKey:[...o.all,"project",t.project_id,"unified"]}),e.invalidateQueries({queryKey:[...l.all,"warehouse"]}),e.invalidateQueries({queryKey:[...l.all,"unified-warehouse"]}),e.invalidateQueries({queryKey:[...l.all,"allocation-targets"]}),e.refetchQueries({queryKey:[...o.all,"project",t.project_id,"unified"]}),e.refetchQueries({queryKey:[...l.all,"unified-warehouse"]}),s.toast.success("Material assigned successfully")},onError:e=>{s.toast.error("Failed to assign material: ".concat(e.message))}})}function w(){let e=(0,a.useQueryClient)();return(0,t.useMutation)({mutationFn:async e=>{let{assignment_id:r,...t}=e,a=await fetch("/api/materials/assignments/".concat(r),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!a.ok)throw Error((await a.json()).message||"Failed to update material assignment");return a.json()},onSuccess:(r,t)=>{e.invalidateQueries({predicate:e=>"materials"===e.queryKey[0]&&"project"===e.queryKey[1]}),e.invalidateQueries({predicate:e=>e.queryKey.includes("unified")}),e.invalidateQueries({queryKey:[...l.all,"warehouse"]}),e.invalidateQueries({queryKey:[...l.all,"unified-warehouse"]}),e.invalidateQueries({queryKey:[...l.all,"allocation-targets"]}),s.toast.success("Material assignment updated successfully")},onError:e=>{s.toast.error("Failed to update material assignment: ".concat(e.message))}})}function M(){let e=(0,a.useQueryClient)();return(0,t.useMutation)({mutationFn:async e=>{let r=await fetch("/api/materials/assignments/".concat(e),{method:"DELETE"});if(!r.ok)throw Error((await r.json()).message||"Failed to delete material assignment");return r.json()},onSuccess:(r,t)=>{e.invalidateQueries({predicate:e=>"materials"===e.queryKey[0]&&"project"===e.queryKey[1]}),e.invalidateQueries({predicate:e=>e.queryKey.includes("unified")}),e.invalidateQueries({queryKey:[...l.all,"warehouse"]}),e.invalidateQueries({queryKey:[...l.all,"unified-warehouse"]}),e.invalidateQueries({queryKey:[...l.all,"allocation-targets"]}),s.toast.success("Material assignment deleted successfully")},onError:e=>{s.toast.error("Failed to delete material assignment: ".concat(e.message))}})}},323,e=>{"use strict";e.s(["default",()=>f]);var r=e.i(43476),t=e.i(18566),a=e.i(53145),s=e.i(94814),i=e.i(81307),l=e.i(71689),n=e.i(56909),o=e.i(37727),c=e.i(88844),u=e.i(19455),d=e.i(93479),m=e.i(24687),h=e.i(15288),p=e.i(3133),y=e.i(67489),j=e.i(4382);let x=i.z.object({name:i.z.string().min(1,"Material name is required"),description:i.z.string().optional(),unit:i.z.string().min(1,"Unit is required"),sku:i.z.string().optional(),default_price_eur:i.z.coerce.number().min(0,"Price must be non-negative").optional(),purchase_price_eur:i.z.coerce.number().min(0,"Purchase price must be non-negative").optional(),initial_stock:i.z.coerce.number().min(0,"Initial stock must be non-negative").optional(),min_stock_level:i.z.coerce.number().min(0,"Minimum stock level must be non-negative").optional()}),g=[{value:"pcs",label:"Pieces (pcs)"},{value:"m",label:"Meters (m)"},{value:"m2",label:"Square meters (m²)"},{value:"kg",label:"Kilograms (kg)"},{value:"t",label:"Tons (t)"},{value:"l",label:"Liters (L)"},{value:"m3",label:"Cubic meters (m³)"},{value:"roll",label:"Rolls"},{value:"other",label:"Other"}];function f(){let e=(0,t.useRouter)(),i=(0,j.useCreateMaterial)(),f=(0,a.useForm)({resolver:(0,s.zodResolver)(x),defaultValues:{name:"",description:"",unit:"",sku:"",default_price_eur:0,purchase_price_eur:0,initial_stock:0,min_stock_level:0}}),v=async r=>{try{await i.mutateAsync(r),e.push("/dashboard/materials")}catch(e){console.error("Failed to create material:",e)}};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"flex items-center justify-between",children:(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)(u.Button,{variant:"ghost",size:"sm",onClick:()=>e.back(),className:"flex items-center space-x-2",children:[(0,r.jsx)(l.ArrowLeft,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:"Back"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Create New Material"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Add a new material to your inventory system"})]})]})}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,r.jsx)("div",{className:"lg:col-span-2",children:(0,r.jsxs)(h.Card,{children:[(0,r.jsxs)(h.CardHeader,{children:[(0,r.jsxs)(h.CardTitle,{className:"flex items-center space-x-2",children:[(0,r.jsx)(c.Package,{className:"h-5 w-5"}),(0,r.jsx)("span",{children:"Material Information"})]}),(0,r.jsx)(h.CardDescription,{children:"Enter the basic information for the new material"})]}),(0,r.jsx)(h.CardContent,{children:(0,r.jsx)(p.Form,{...f,children:(0,r.jsxs)("form",{onSubmit:f.handleSubmit(v),className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsx)(p.FormField,{control:f.control,name:"name",render:e=>{let{field:t}=e;return(0,r.jsxs)(p.FormItem,{className:"md:col-span-2",children:[(0,r.jsx)(p.FormLabel,{children:"Material Name *"}),(0,r.jsx)(p.FormControl,{children:(0,r.jsx)(d.Input,{placeholder:"e.g., Single Mode Fiber Cable 12-strand",...t})}),(0,r.jsx)(p.FormMessage,{})]})}}),(0,r.jsx)(p.FormField,{control:f.control,name:"sku",render:e=>{let{field:t}=e;return(0,r.jsxs)(p.FormItem,{children:[(0,r.jsx)(p.FormLabel,{children:"SKU"}),(0,r.jsx)(p.FormControl,{children:(0,r.jsx)(d.Input,{placeholder:"e.g., FOC-SM-12",...t})}),(0,r.jsx)(p.FormDescription,{children:"Stock Keeping Unit (optional)"}),(0,r.jsx)(p.FormMessage,{})]})}}),(0,r.jsx)(p.FormField,{control:f.control,name:"unit",render:e=>{let{field:t}=e;return(0,r.jsxs)(p.FormItem,{children:[(0,r.jsx)(p.FormLabel,{children:"Unit of Measurement *"}),(0,r.jsxs)(y.Select,{onValueChange:t.onChange,value:t.value,children:[(0,r.jsx)(p.FormControl,{children:(0,r.jsx)(y.SelectTrigger,{children:(0,r.jsx)(y.SelectValue,{placeholder:"Select unit"})})}),(0,r.jsx)(y.SelectContent,{children:g.map(e=>(0,r.jsx)(y.SelectItem,{value:e.value,children:e.label},e.value))})]}),(0,r.jsx)(p.FormMessage,{})]})}}),(0,r.jsx)(p.FormField,{control:f.control,name:"description",render:e=>{let{field:t}=e;return(0,r.jsxs)(p.FormItem,{className:"md:col-span-2",children:[(0,r.jsx)(p.FormLabel,{children:"Description"}),(0,r.jsx)(p.FormControl,{children:(0,r.jsx)(m.Textarea,{placeholder:"Detailed description of the material, specifications, etc.",rows:3,...t})}),(0,r.jsx)(p.FormMessage,{})]})}})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"border-t pt-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium mb-4",children:"Pricing"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsx)(p.FormField,{control:f.control,name:"purchase_price_eur",render:e=>{let{field:t}=e;return(0,r.jsxs)(p.FormItem,{children:[(0,r.jsx)(p.FormLabel,{children:"Purchase Price (EUR)"}),(0,r.jsx)(p.FormControl,{children:(0,r.jsx)(d.Input,{type:"number",step:"0.01",min:"0",placeholder:"0.00",...t})}),(0,r.jsx)(p.FormDescription,{children:"Cost price from supplier"}),(0,r.jsx)(p.FormMessage,{})]})}}),(0,r.jsx)(p.FormField,{control:f.control,name:"default_price_eur",render:e=>{let{field:t}=e;return(0,r.jsxs)(p.FormItem,{children:[(0,r.jsx)(p.FormLabel,{children:"Selling Price (EUR)"}),(0,r.jsx)(p.FormControl,{children:(0,r.jsx)(d.Input,{type:"number",step:"0.01",min:"0",placeholder:"0.00",...t})}),(0,r.jsx)(p.FormDescription,{children:"Default selling price"}),(0,r.jsx)(p.FormMessage,{})]})}})]})]}),(0,r.jsxs)("div",{className:"border-t pt-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium mb-4",children:"Inventory"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsx)(p.FormField,{control:f.control,name:"initial_stock",render:e=>{let{field:t}=e;return(0,r.jsxs)(p.FormItem,{children:[(0,r.jsx)(p.FormLabel,{children:"Initial Stock Quantity"}),(0,r.jsx)(p.FormControl,{children:(0,r.jsx)(d.Input,{type:"number",step:"0.001",min:"0",placeholder:"0",...t})}),(0,r.jsx)(p.FormDescription,{children:"Starting inventory amount"}),(0,r.jsx)(p.FormMessage,{})]})}}),(0,r.jsx)(p.FormField,{control:f.control,name:"min_stock_level",render:e=>{let{field:t}=e;return(0,r.jsxs)(p.FormItem,{children:[(0,r.jsx)(p.FormLabel,{children:"Minimum Stock Level"}),(0,r.jsx)(p.FormControl,{children:(0,r.jsx)(d.Input,{type:"number",step:"0.001",min:"0",placeholder:"0",...t})}),(0,r.jsx)(p.FormDescription,{children:"Alert when stock falls below this level"}),(0,r.jsx)(p.FormMessage,{})]})}})]})]})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,r.jsxs)(u.Button,{type:"button",variant:"outline",onClick:()=>e.back(),children:[(0,r.jsx)(o.X,{className:"mr-2 h-4 w-4"}),"Cancel"]}),(0,r.jsxs)(u.Button,{type:"submit",disabled:i.isPending,children:[i.isPending?(0,r.jsx)("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-background border-t-transparent mr-2"}):(0,r.jsx)(n.Save,{className:"mr-2 h-4 w-4"}),"Create Material"]})]})]})})})]})}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)(h.Card,{children:[(0,r.jsx)(h.CardHeader,{children:(0,r.jsx)(h.CardTitle,{children:"Quick Tips"})}),(0,r.jsxs)(h.CardContent,{className:"space-y-4 text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium",children:"Material Name"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:'Use descriptive names that include key specifications like "Single Mode Fiber Cable 12-strand"'})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium",children:"SKU"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Create unique identifiers for easy tracking and ordering"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium",children:"Units"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Choose the most appropriate unit for purchasing and usage tracking"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium",children:"Pricing"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Purchase price helps track costs, selling price is used for project estimates"})]})]})]}),(0,r.jsxs)(h.Card,{children:[(0,r.jsx)(h.CardHeader,{children:(0,r.jsx)(h.CardTitle,{children:"Categories"})}),(0,r.jsxs)(h.CardContent,{className:"text-sm",children:[(0,r.jsx)("p",{className:"text-muted-foreground",children:"Materials are automatically categorized based on their names:"}),(0,r.jsxs)("ul",{className:"mt-2 space-y-1 text-muted-foreground",children:[(0,r.jsx)("li",{children:"• Cables - Fiber, copper cables"}),(0,r.jsx)("li",{children:"• Connectors - SC, LC, splice closures"}),(0,r.jsx)("li",{children:"• Tools - Installation equipment"}),(0,r.jsx)("li",{children:"• Conduits - Ducts, pipes"}),(0,r.jsx)("li",{children:"• Equipment - Hardware devices"})]})]})]})]})]})]})}}]);