(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,31464,e=>{"use strict";e.s(["default",()=>es],31464);var s=e.i(43476),a=e.i(71645),l=e.i(18566),r=e.i(53145),n=e.i(94814),t=e.i(81307),i=e.i(7233),d=e.i(55436),c=e.i(61911),o=e.i(79002),m=e.i(86536),x=e.i(88511),h=e.i(27612),u=e.i(43432),j=e.i(63488),p=e.i(46897),g=e.i(78583),f=e.i(87316),N=e.i(98919),v=e.i(48256);let b=(0,e.i(75254).default)("code",[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]]);var w=e.i(19455),C=e.i(93479),y=e.i(15288),k=e.i(87486),T=e.i(84774),F=e.i(55146),_=e.i(77572),D=e.i(76639),S=e.i(3133),P=e.i(67489),I=e.i(57428),M=e.i(20306),A=e.i(46835),U=e.i(12598),B=e.i(32548),z=e.i(71436),L=e.i(54616),H=e.i(66027),E=e.i(37727),R=e.i(31278),O=e.i(84614),V=e.i(10204),q=e.i(46696);let W=t.z.object({email:t.z.string().optional().refine(e=>!e||t.z.string().email().safeParse(e).success,{message:"Invalid email format"}),first_name:t.z.string().min(1,"First name is required").min(2,"First name must be at least 2 characters").max(50,"First name must not exceed 50 characters"),last_name:t.z.string().min(1,"Last name is required").min(2,"Last name must be at least 2 characters").max(50,"Last name must not exceed 50 characters"),role:t.z.enum(["admin","pm","foreman","crew","viewer"],{required_error:"Please select a role"}),phone:t.z.string().optional().refine(e=>!e||e.length>=10,{message:"Phone number must be at least 10 digits"}),pin_code:t.z.string().optional().refine(e=>!e||e.length>=4&&e.length<=6&&/^\d+$/.test(e),{message:"PIN code must be 4-6 digits"}),skills:t.z.array(t.z.string()).default([]).optional(),lang_pref:t.z.enum(["en","de","ru","uz","tr"]).default("de").optional()}).refine(e=>e.email||e.phone,{message:"Either email or phone number is required",path:["email"]});async function K(e){let s=await fetch("/api/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!s.ok)throw Error((await s.json()).detail||"Failed to create user");return s.json()}async function Q(e,s){let a=await fetch("/api/users/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok)throw Error((await a.json()).detail||"Failed to update user");return a.json()}async function G(){let e=await fetch("/api/auth/skills");if(!e.ok)throw Error("Failed to fetch skills");return e.json()}function J(e){let{onSuccess:l,onCancel:t,defaultRole:d="crew",editMode:c=!1,initialData:o}=e,[m,x]=(0,a.useState)(c&&(null==o?void 0:o.skills)?o.skills:[]),[h,p]=(0,a.useState)(""),g=(0,U.useQueryClient)(),{data:f,isLoading:T}=(0,H.useQuery)({queryKey:["skills"],queryFn:G,staleTime:3e5}),F=(0,r.useForm)({resolver:(0,n.zodResolver)(W),defaultValues:c&&o?{email:o.email||"",first_name:o.first_name||"",last_name:o.last_name||"",role:o.role||d,phone:o.phone||"",pin_code:o.pin_code||"",skills:o.skills||[],lang_pref:o.lang_pref||"de"}:{email:"",first_name:"",last_name:"",role:d,phone:"",pin_code:"",skills:[],lang_pref:"de"}}),_=(0,L.useMutation)({mutationFn:c&&o?e=>Q(o.id,e):K,onSuccess:e=>{let s=c?"updated":"created";q.toast.success("User ".concat(s," successfully!"),{description:"".concat(e.first_name," ").concat(e.last_name," has been ").concat(s,".")}),g.invalidateQueries({queryKey:["users"]}),c||(F.reset(),x([])),null==l||l(e)},onError:e=>{let s=c?"update":"create";q.toast.error("Failed to ".concat(s," user"),{description:e.message})}}),D=async e=>{let s={...e,skills:m};_.mutate(s)},M=()=>{h.trim()&&!m.includes(h.trim())&&(x(e=>[...e,h.trim()]),p(""))},A=(null==f?void 0:f.predefined_skills)||[];return(0,s.jsxs)(y.Card,{className:"w-full max-w-2xl mx-auto",children:[(0,s.jsxs)(y.CardHeader,{children:[(0,s.jsxs)(y.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(O.User,{className:"h-5 w-5"}),c?"Edit User":"Create New User"]}),(0,s.jsx)(y.CardDescription,{children:c?"Update user information, roles, and system access.":"Add a new user to the COMETA system. PIN codes will be automatically generated if not provided."})]}),(0,s.jsx)(y.CardContent,{children:(0,s.jsx)(S.Form,{...F,children:(0,s.jsxs)("form",{onSubmit:F.handleSubmit(D),className:"space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("h3",{className:"text-lg font-medium flex items-center gap-2",children:[(0,s.jsx)(O.User,{className:"h-4 w-4"}),"Personal Information"]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsx)(S.FormField,{control:F.control,name:"first_name",render:e=>{let{field:a}=e;return(0,s.jsxs)(S.FormItem,{children:[(0,s.jsx)(S.FormLabel,{children:"First Name"}),(0,s.jsx)(S.FormControl,{children:(0,s.jsx)(C.Input,{placeholder:"Enter first name",...a,disabled:_.isPending})}),(0,s.jsx)(S.FormMessage,{})]})}}),(0,s.jsx)(S.FormField,{control:F.control,name:"last_name",render:e=>{let{field:a}=e;return(0,s.jsxs)(S.FormItem,{children:[(0,s.jsx)(S.FormLabel,{children:"Last Name"}),(0,s.jsx)(S.FormControl,{children:(0,s.jsx)(C.Input,{placeholder:"Enter last name",...a,disabled:_.isPending})}),(0,s.jsx)(S.FormMessage,{})]})}})]}),(0,s.jsx)(S.FormField,{control:F.control,name:"email",render:e=>{let{field:a}=e;return(0,s.jsxs)(S.FormItem,{children:[(0,s.jsxs)(S.FormLabel,{className:"flex items-center gap-2",children:[(0,s.jsx)(j.Mail,{className:"h-4 w-4"}),"Email Address (Optional)"]}),(0,s.jsx)(S.FormControl,{children:(0,s.jsx)(C.Input,{type:"email",placeholder:"Enter email address",...a,disabled:_.isPending})}),(0,s.jsx)(S.FormDescription,{children:"Either email or phone number is required for login."}),(0,s.jsx)(S.FormMessage,{})]})}}),(0,s.jsx)(S.FormField,{control:F.control,name:"phone",render:e=>{let{field:a}=e;return(0,s.jsxs)(S.FormItem,{children:[(0,s.jsxs)(S.FormLabel,{className:"flex items-center gap-2",children:[(0,s.jsx)(u.Phone,{className:"h-4 w-4"}),"Phone Number (Optional)"]}),(0,s.jsx)(S.FormControl,{children:(0,s.jsx)(C.Input,{type:"tel",placeholder:"Enter phone number",...a,disabled:_.isPending})}),(0,s.jsx)(S.FormDescription,{children:"Either email or phone number is required for login."}),(0,s.jsx)(S.FormMessage,{})]})}})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("h3",{className:"text-lg font-medium flex items-center gap-2",children:[(0,s.jsx)(N.Shield,{className:"h-4 w-4"}),"System Access"]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsx)(S.FormField,{control:F.control,name:"role",render:e=>{let{field:a}=e;return(0,s.jsxs)(S.FormItem,{children:[(0,s.jsx)(S.FormLabel,{children:"Role"}),(0,s.jsxs)(P.Select,{onValueChange:a.onChange,defaultValue:a.value,disabled:_.isPending,children:[(0,s.jsx)(S.FormControl,{children:(0,s.jsx)(P.SelectTrigger,{children:(0,s.jsx)(P.SelectValue,{placeholder:"Select user role"})})}),(0,s.jsxs)(P.SelectContent,{children:[(0,s.jsx)(P.SelectItem,{value:"admin",children:"Administrator"}),(0,s.jsx)(P.SelectItem,{value:"pm",children:"Project Manager"}),(0,s.jsx)(P.SelectItem,{value:"foreman",children:"Foreman"}),(0,s.jsx)(P.SelectItem,{value:"crew",children:"Field Worker"}),(0,s.jsx)(P.SelectItem,{value:"viewer",children:"Viewer (Read-only)"})]})]}),(0,s.jsx)(S.FormDescription,{children:"Determines what the user can access in the system."}),(0,s.jsx)(S.FormMessage,{})]})}}),(0,s.jsx)(S.FormField,{control:F.control,name:"pin_code",render:e=>{let{field:a}=e;return(0,s.jsxs)(S.FormItem,{children:[(0,s.jsxs)(S.FormLabel,{className:"flex items-center gap-2",children:[(0,s.jsx)(b,{className:"h-4 w-4"}),"PIN Code (Optional)"]}),(0,s.jsx)(S.FormControl,{children:(0,s.jsx)(C.Input,{type:"text",placeholder:"Leave empty for auto-generation",maxLength:6,...a,disabled:_.isPending})}),(0,s.jsx)(S.FormDescription,{children:"4-6 digits. If empty, will be generated automatically."}),(0,s.jsx)(S.FormMessage,{})]})}})]}),(0,s.jsx)(S.FormField,{control:F.control,name:"lang_pref",render:e=>{let{field:a}=e;return(0,s.jsxs)(S.FormItem,{children:[(0,s.jsxs)(S.FormLabel,{className:"flex items-center gap-2",children:[(0,s.jsx)(v.Globe,{className:"h-4 w-4"}),"Language Preference"]}),(0,s.jsxs)(P.Select,{onValueChange:a.onChange,defaultValue:a.value,disabled:_.isPending,children:[(0,s.jsx)(S.FormControl,{children:(0,s.jsx)(P.SelectTrigger,{className:"w-full md:w-[200px]",children:(0,s.jsx)(P.SelectValue,{})})}),(0,s.jsxs)(P.SelectContent,{children:[(0,s.jsx)(P.SelectItem,{value:"de",children:"German (Deutsch)"}),(0,s.jsx)(P.SelectItem,{value:"en",children:"English"}),(0,s.jsx)(P.SelectItem,{value:"ru",children:"Russian (Русский)"}),(0,s.jsx)(P.SelectItem,{value:"uz",children:"Uzbek (O'zbek)"}),(0,s.jsx)(P.SelectItem,{value:"tr",children:"Turkish (Türkçe)"})]})]}),(0,s.jsx)(S.FormMessage,{})]})}})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h3",{className:"text-lg font-medium",children:"Skills & Competencies"}),m.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)(V.Label,{className:"text-sm font-medium",children:"Selected Skills:"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:m.map(e=>(0,s.jsxs)(k.Badge,{variant:"secondary",className:"pr-1",children:[e,(0,s.jsx)(w.Button,{type:"button",variant:"ghost",size:"sm",className:"h-auto p-1 ml-1",onClick:()=>{x(s=>s.filter(s=>s!==e))},disabled:_.isPending,children:(0,s.jsx)(E.X,{className:"h-3 w-3"})})]},e))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(V.Label,{className:"text-sm font-medium",children:"Add Custom Skill:"}),(0,s.jsxs)("div",{className:"flex gap-2 mt-2",children:[(0,s.jsx)(C.Input,{placeholder:"Enter skill name",value:h,onChange:e=>p(e.target.value),onKeyPress:e=>"Enter"===e.key&&(e.preventDefault(),M()),disabled:_.isPending}),(0,s.jsx)(w.Button,{type:"button",variant:"outline",size:"sm",onClick:M,disabled:!h.trim()||_.isPending,children:(0,s.jsx)(i.Plus,{className:"h-4 w-4"})})]})]}),T?(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,s.jsx)(R.Loader2,{className:"h-4 w-4 animate-spin"}),"Loading skills..."]}):(0,s.jsxs)("div",{children:[(0,s.jsx)(V.Label,{className:"text-sm font-medium",children:"Select from predefined skills:"}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 mt-2 max-h-60 overflow-y-auto",children:A.map(e=>(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(I.Checkbox,{id:e,checked:m.includes(e),onCheckedChange:()=>{x(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},disabled:_.isPending}),(0,s.jsx)(V.Label,{htmlFor:e,className:"text-sm font-normal cursor-pointer",children:e})]},e))})]})]}),(0,s.jsxs)("div",{className:"flex gap-4 pt-6 border-t",children:[t&&(0,s.jsx)(w.Button,{type:"button",variant:"outline",onClick:t,disabled:_.isPending,children:"Cancel"}),(0,s.jsx)(w.Button,{type:"submit",disabled:_.isPending,className:"flex-1",children:_.isPending?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(R.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),c?"Updating User...":"Creating User..."]}):c?"Update User":"Create User"})]})]})})})]})}var X=e.i(43531),Y=e.i(8406);async function $(e,s){let a=await fetch("/api/crews/".concat(e,"/members"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:s,role_in_crew:"worker"})});if(!a.ok)throw Error((await a.json()).error||"Failed to add user to team");return a.json()}function Z(e){let{user:r,teams:n,children:t,open:i,onOpenChange:d,onSuccess:c}=e,[m,x]=(0,a.useState)(!1),h=d||x,[u,j]=(0,a.useState)(""),{toast:p}=(0,Y.useToast)(),g=(0,U.useQueryClient)(),f=(0,l.useRouter)(),N=n.filter(e=>{var s;return!(null==(s=e.members)?void 0:s.some(e=>e.user_id===r.id))}),v=(0,L.useMutation)({mutationFn:e=>{let{teamId:s,userId:a}=e;return $(s,a)},onSuccess:()=>{g.invalidateQueries({queryKey:["teams"]}),g.invalidateQueries({queryKey:["teams","crews"]}),g.invalidateQueries({queryKey:["crews"]}),g.invalidateQueries({queryKey:["users"]});let e=n.find(e=>e.id===u);p({title:"Пользователь добавлен в команду",description:"".concat(r.full_name,' добавлен в команду "').concat(null==e?void 0:e.name,'"')}),h(!1),j(""),c&&c()},onError:e=>{p({title:"Ошибка",description:e.message||"Не удалось добавить пользователя в команду",variant:"destructive"})}});return(0,s.jsxs)(D.Dialog,{open:void 0!==i?i:m,onOpenChange:h,children:[t&&(0,s.jsx)(D.DialogTrigger,{asChild:!0,children:t}),(0,s.jsxs)(D.DialogContent,{className:"sm:max-w-md",children:[(0,s.jsxs)(D.DialogHeader,{children:[(0,s.jsx)(D.DialogTitle,{children:"Назначить пользователя в команду"}),(0,s.jsxs)(D.DialogDescription,{children:["Выберите команду для добавления пользователя ",(0,s.jsx)("strong",{children:r.full_name})]})]}),(0,s.jsxs)("div",{className:"space-y-4 py-4",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3 p-3 border rounded-lg bg-muted/50",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("div",{className:"font-medium",children:r.full_name}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:r.email})]}),(0,s.jsx)(k.Badge,{variant:"outline",children:r.role})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(V.Label,{htmlFor:"team-select",children:"Выберите команду"}),N.length>0?(0,s.jsxs)(P.Select,{value:u,onValueChange:j,children:[(0,s.jsx)(P.SelectTrigger,{children:(0,s.jsx)(P.SelectValue,{placeholder:"Выберите команду"})}),(0,s.jsx)(P.SelectContent,{children:N.map(e=>(0,s.jsx)(P.SelectItem,{value:e.id,children:(0,s.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:e.name}),e.project_name&&(0,s.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Проект: ",e.project_name]})]}),(0,s.jsxs)(k.Badge,{variant:"secondary",className:"ml-2",children:[e.member_count," участников"]})]})},e.id))})]}):(0,s.jsxs)("div",{className:"text-center py-4 text-muted-foreground",children:[(0,s.jsx)(o.UserPlus,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),(0,s.jsx)("p",{className:"text-sm",children:"Пользователь уже назначен во все доступные команды"})]})]})]}),(0,s.jsxs)(D.DialogFooter,{className:"flex-col sm:flex-row gap-2",children:[u&&(0,s.jsx)(w.Button,{type:"button",variant:"outline",onClick:()=>{u&&(h(!1),f.push("/dashboard/teams/".concat(u,"/members")))},className:"w-full sm:w-auto",children:"Управлять участниками"}),(0,s.jsxs)("div",{className:"flex gap-2 w-full sm:w-auto",children:[(0,s.jsx)(w.Button,{type:"button",variant:"outline",onClick:()=>h(!1),className:"flex-1 sm:flex-initial",children:"Отмена"}),(0,s.jsxs)(w.Button,{type:"button",onClick:()=>{if(!u)return void p({title:"Ошибка",description:"Выберите команду для назначения",variant:"destructive"});v.mutate({teamId:u,userId:r.id})},disabled:!u||v.isPending||0===N.length,className:"flex-1 sm:flex-initial",children:[v.isPending?(0,s.jsx)("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-background border-t-transparent mr-2"}):(0,s.jsx)(X.Check,{className:"mr-2 h-4 w-4"}),"Назначить"]})]})]})]})]})}let ee=t.z.object({name:t.z.string().min(1,"Team name is required"),foreman_user_id:t.z.string().optional(),project_id:t.z.string().optional(),description:t.z.string().optional()});function es(){let e=(0,l.useRouter)(),{canManageTeams:t}=(0,z.usePermissions)(),L=(0,M.useDeleteCrew)(),H=(0,M.useCreateTeam)(),E=(0,M.useUpdateTeam)(),R=(0,A.useUpdateUser)(),O=(0,A.useDeleteUser)(),[V,q]=(0,a.useState)(""),[W,K]=(0,a.useState)(!1),[Q,G]=(0,a.useState)(!1),[X,Y]=(0,a.useState)(!1),[$,es]=(0,a.useState)(!1),[ea,el]=(0,a.useState)(!1),[er,en]=(0,a.useState)(!1),[et,ei]=(0,a.useState)(!1),[ed,ec]=(0,a.useState)(null),[eo,em]=(0,a.useState)(null),[ex,eh]=(0,a.useState)(null),[eu,ej]=(0,a.useState)(null),[ep,eg]=(0,a.useState)("crew"),[ef,eN]=(0,a.useState)(new Set),[ev,eb]=(0,a.useState)(!1),[ew,eC]=(0,a.useState)(""),ey=(0,r.useForm)({resolver:(0,n.zodResolver)(ee),defaultValues:{name:"",foreman_user_id:"none",project_id:"none",description:""}}),ek=(0,r.useForm)({resolver:(0,n.zodResolver)(ee),defaultValues:{name:"",foreman_user_id:"none",project_id:"none",description:""}}),{data:eT,isLoading:eF,error:e_}=(0,M.useTeams)();(0,U.useQueryClient)();let{data:eD,isLoading:eS}=(0,A.useUsers)({page:1,per_page:100}),{data:eP}=(0,M.useForemenUsers)(),eI=(null==eD?void 0:eD.items)||[],eM=e=>!!eT&&eT.some(s=>{var a,l;return(null==(a=s.foreman)?void 0:a.id)===e||(null==(l=s.members)?void 0:l.some(s=>s.user_id===e))}),eA=eI.filter(e=>["crew","worker","foreman"].includes(e.role)&&!eM(e.id)),eU=eI.filter(e=>{var s,a;return!V||e.full_name.toLowerCase().includes(V.toLowerCase())||(null==(s=e.email)?void 0:s.toLowerCase().includes(V.toLowerCase()))||e.role.toLowerCase().includes(V.toLowerCase())||(null==(a=e.skills)?void 0:a.some(e=>e.toLowerCase().includes(V.toLowerCase())))}),eB=async(e,s)=>{confirm('Are you sure you want to delete "'.concat(s,'"? This action cannot be undone.'))&&await L.mutateAsync(e)},ez=e=>{em(e),es(!0)},eL=e=>{ej(e),el(!0),es(!1)},eH=e=>{em(e),en(!0),es(!1)},eE=async()=>{if(eo)try{await O.mutateAsync(eo.id),en(!1),em(null)}catch(e){console.error("Failed to delete user:",e)}},eR=(e,s)=>{let a=new Set(ef);s?a.add(e):a.delete(e),eN(a)},eO=e=>{e?eN(new Set(eU.map(e=>e.id))):eN(new Set)},eV=e=>{eC(e),eb(!0)},eq=async()=>{if(ew&&0!==ef.size)try{let e=Array.from(ef);if("delete"===ew)await Promise.all(e.map(e=>O.mutateAsync(e)));else if(ew.startsWith("role_")){let s=ew.replace("role_","");await Promise.all(e.map(e=>{let a=eI.find(s=>s.id===e);if(a)return R.mutateAsync({id:e,data:{...a,role:s}})}))}eb(!1),eN(new Set),eC("")}catch(e){console.error("Failed to perform bulk action:",e)}},eW=async e=>{try{let s={...e,foreman_user_id:"none"===e.foreman_user_id?void 0:e.foreman_user_id,project_id:"none"===e.project_id?void 0:e.project_id};await H.mutateAsync(s),G(!1),ey.reset()}catch(e){console.error("Failed to create team:",e)}},eK=e=>{var s;ec(e),ek.setValue("name",e.name),ek.setValue("foreman_user_id",(null==(s=e.foreman)?void 0:s.id)||"none"),ek.setValue("project_id",e.project_id||"none"),ek.setValue("description",e.description||""),Y(!0)},eQ=async e=>{if(ed)try{let s={...e,foreman_user_id:"none"===e.foreman_user_id?void 0:e.foreman_user_id,project_id:"none"===e.project_id?void 0:e.project_id};await E.mutateAsync({id:ed.id,data:s}),Y(!1),ec(null),ek.reset()}catch(e){console.error("Failed to update team:",e)}},eG=e=>{switch(e){case"foreman":return"default";case"crew":case"worker":return"secondary";default:return"outline"}};return e_?(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Teams"})}),(0,s.jsx)(y.Card,{children:(0,s.jsx)(y.CardContent,{className:"py-8",children:(0,s.jsx)("div",{className:"text-center text-muted-foreground",children:"Failed to load teams. Please try again later."})})})]}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Teams"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Manage work crews and team assignments"})]}),t&&(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsxs)(w.Button,{variant:"outline",onClick:()=>{eg("crew"),K(!0)},children:[(0,s.jsx)(o.UserPlus,{className:"mr-2 h-4 w-4"}),"Add Team Member"]}),(0,s.jsxs)(w.Button,{onClick:()=>G(!0),children:[(0,s.jsx)(i.Plus,{className:"mr-2 h-4 w-4"}),"New Team"]})]})]}),(0,s.jsxs)(_.Tabs,{defaultValue:"crews",className:"space-y-4",children:[(0,s.jsxs)(_.TabsList,{children:[(0,s.jsxs)(_.TabsTrigger,{value:"crews",children:["Work Crews (",(null==eT?void 0:eT.length)||0,")"]}),(0,s.jsxs)(_.TabsTrigger,{value:"available",children:["Available Workers (",eA.length,")"]}),(0,s.jsxs)(_.TabsTrigger,{value:"all-users",children:["All Users (",eI.length,")"]}),(0,s.jsx)(_.TabsTrigger,{value:"overview",children:"Team Overview"})]}),(0,s.jsxs)(_.TabsContent,{value:"crews",className:"space-y-6",children:[(0,s.jsxs)(y.Card,{children:[(0,s.jsxs)(y.CardHeader,{children:[(0,s.jsx)(y.CardTitle,{children:"Filter Teams"}),(0,s.jsx)(y.CardDescription,{children:"Search teams by name or foreman"})]}),(0,s.jsx)(y.CardContent,{children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(d.Search,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),(0,s.jsx)(C.Input,{placeholder:"Search teams by name, foreman, or project...",value:V,onChange:e=>q(e.target.value),className:"pl-8"})]})})]}),(0,s.jsx)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:eF?[...Array(6)].map((e,a)=>(0,s.jsx)(y.Card,{children:(0,s.jsx)(y.CardContent,{className:"p-6",children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"h-4 bg-muted animate-pulse rounded"}),(0,s.jsx)("div",{className:"h-3 bg-muted animate-pulse rounded w-3/4"}),(0,s.jsx)("div",{className:"h-3 bg-muted animate-pulse rounded w-1/2"})]})})},a)):(null==eT?void 0:eT.length)===0?(0,s.jsx)("div",{className:"col-span-full",children:(0,s.jsx)(y.Card,{children:(0,s.jsx)(y.CardContent,{className:"py-8",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(c.Users,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,s.jsx)("h3",{className:"mt-2 text-sm font-semibold",children:"No teams found"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"Get started by creating your first work crew."}),t&&(0,s.jsxs)(w.Button,{className:"mt-4",onClick:()=>e.push("/dashboard/teams/new"),children:[(0,s.jsx)(i.Plus,{className:"mr-2 h-4 w-4"}),"Create Team"]})]})})})}):null==eT?void 0:eT.filter(e=>{var s,a;return!V||e.name.toLowerCase().includes(V.toLowerCase())||(null==(a=e.foreman)||null==(s=a.full_name)?void 0:s.toLowerCase().includes(V.toLowerCase()))}).map(a=>{var l;return(0,s.jsxs)(y.Card,{className:"hover:shadow-md transition-shadow",children:[(0,s.jsx)(y.CardHeader,{className:"pb-3",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(y.CardTitle,{className:"text-lg",children:a.name}),t&&(0,s.jsxs)(F.DropdownMenu,{children:[(0,s.jsx)(F.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsxs)(w.Button,{variant:"ghost",className:"h-8 w-8 p-0",children:[(0,s.jsx)("span",{className:"sr-only",children:"Open menu"}),(0,s.jsx)(x.Edit,{className:"h-4 w-4"})]})}),(0,s.jsxs)(F.DropdownMenuContent,{align:"end",children:[(0,s.jsx)(F.DropdownMenuLabel,{children:"Actions"}),(0,s.jsxs)(F.DropdownMenuItem,{onClick:()=>e.push("/dashboard/teams/".concat(a.id)),children:[(0,s.jsx)(m.Eye,{className:"mr-2 h-4 w-4"}),"View Details"]}),(0,s.jsxs)(F.DropdownMenuItem,{onClick:()=>eK(a),children:[(0,s.jsx)(x.Edit,{className:"mr-2 h-4 w-4"}),"Edit Team"]}),(0,s.jsx)(F.DropdownMenuSeparator,{}),(0,s.jsxs)(F.DropdownMenuItem,{className:"text-destructive",onClick:()=>eB(a.id,a.name),children:[(0,s.jsx)(h.Trash2,{className:"mr-2 h-4 w-4"}),"Delete Team"]})]})]})]})}),(0,s.jsxs)(y.CardContent,{className:"space-y-4",children:[a.foreman&&(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)(k.Badge,{variant:"default",children:"Foreman"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-sm",children:a.foreman.full_name}),(0,s.jsxs)("div",{className:"text-xs text-muted-foreground flex items-center space-x-1",children:[(0,s.jsx)(u.Phone,{className:"h-3 w-3"}),(0,s.jsx)("span",{children:a.foreman.phone||"—"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"text-sm font-medium flex items-center space-x-1",children:[(0,s.jsx)(c.Users,{className:"h-4 w-4"}),(0,s.jsxs)("span",{children:["Team Members (",a.member_count||0,")"]})]}),(null==(l=a.members)?void 0:l.length)?(0,s.jsxs)("div",{className:"space-y-1",children:[a.members.slice(0,3).map(e=>{var a,l,r;return(0,s.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,s.jsx)("span",{children:(null==(a=e.user)?void 0:a.full_name)||"Unknown"}),(0,s.jsx)(k.Badge,{variant:eG((null==(l=e.user)?void 0:l.role)||""),children:(null==(r=e.user)?void 0:r.role)||"—"})]},e.id)}),a.members.length>3&&(0,s.jsxs)("div",{className:"text-xs text-muted-foreground",children:["+",a.members.length-3," more"]})]}):(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"No members assigned"})]}),a.project_id&&(0,s.jsx)("div",{className:"pt-2 border-t",children:(0,s.jsxs)("div",{className:"text-xs text-muted-foreground flex items-center space-x-1",children:[(0,s.jsx)(p.MapPin,{className:"h-3 w-3"}),(0,s.jsxs)("span",{children:["Assigned to Project ",a.project_id]})]})}),(0,s.jsxs)("div",{className:"flex space-x-2 pt-2",children:[(0,s.jsxs)(w.Button,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>e.push("/dashboard/teams/".concat(a.id)),children:[(0,s.jsx)(m.Eye,{className:"mr-2 h-3 w-3"}),"View"]}),t&&(0,s.jsxs)(w.Button,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>eK(a),children:[(0,s.jsx)(x.Edit,{className:"mr-2 h-3 w-3"}),"Edit"]})]})]})]},a.id)})})]}),(0,s.jsx)(_.TabsContent,{value:"available",className:"space-y-6",children:(0,s.jsxs)(y.Card,{children:[(0,s.jsxs)(y.CardHeader,{children:[(0,s.jsxs)(y.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(o.UserPlus,{className:"h-5 w-5"}),"Available Workers (",eA.length,")"]}),(0,s.jsx)(y.CardDescription,{children:"Workers available for team assignment (excludes already assigned workers)"})]}),(0,s.jsx)(y.CardContent,{children:eS?(0,s.jsx)("div",{className:"space-y-4",children:[void 0,void 0,void 0,void 0,void 0].map((e,a)=>(0,s.jsxs)("div",{className:"flex space-x-4",children:[(0,s.jsx)("div",{className:"h-4 bg-muted animate-pulse rounded flex-1"}),(0,s.jsx)("div",{className:"h-4 bg-muted animate-pulse rounded w-20"})]},a))}):0===eA.length?(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)(o.UserPlus,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,s.jsx)("h3",{className:"mt-2 text-sm font-semibold",children:"All workers assigned"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:'All available workers are currently assigned to teams. Check the "All Users" tab to see assignment status.'})]}):(0,s.jsxs)("div",{className:"space-y-4",children:[ef.size>0&&(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg border",children:[(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsxs)("span",{className:"text-sm font-medium",children:[ef.size," user",ef.size>1?"s":""," selected"]})}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(F.DropdownMenu,{children:[(0,s.jsx)(F.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsx)(w.Button,{variant:"outline",size:"sm",children:"Change Role"})}),(0,s.jsxs)(F.DropdownMenuContent,{children:[(0,s.jsx)(F.DropdownMenuLabel,{children:"Assign Role"}),(0,s.jsx)(F.DropdownMenuSeparator,{}),(0,s.jsx)(F.DropdownMenuItem,{onClick:()=>eV("role_admin"),children:"Administrator"}),(0,s.jsx)(F.DropdownMenuItem,{onClick:()=>eV("role_pm"),children:"Project Manager"}),(0,s.jsx)(F.DropdownMenuItem,{onClick:()=>eV("role_foreman"),children:"Foreman"}),(0,s.jsx)(F.DropdownMenuItem,{onClick:()=>eV("role_crew"),children:"Crew Member"}),(0,s.jsx)(F.DropdownMenuItem,{onClick:()=>eV("role_viewer"),children:"Viewer"})]})]}),(0,s.jsxs)(w.Button,{variant:"destructive",size:"sm",onClick:()=>eV("delete"),children:[(0,s.jsx)(h.Trash2,{className:"h-4 w-4 mr-1"}),"Delete Selected"]}),(0,s.jsx)(w.Button,{variant:"ghost",size:"sm",onClick:()=>eN(new Set),children:"Clear Selection"})]})]}),(0,s.jsxs)(T.Table,{children:[(0,s.jsx)(T.TableHeader,{children:(0,s.jsxs)(T.TableRow,{children:[(0,s.jsx)(T.TableHead,{className:"w-[50px]",children:(0,s.jsx)(I.Checkbox,{checked:ef.size>0&&ef.size===eA.length,onCheckedChange:e=>eO(e),"aria-label":"Select all users"})}),(0,s.jsx)(T.TableHead,{children:"Name"}),(0,s.jsx)(T.TableHead,{children:"Role"}),(0,s.jsx)(T.TableHead,{children:"PIN Code"}),(0,s.jsx)(T.TableHead,{children:"Skills"}),(0,s.jsx)(T.TableHead,{children:"Contact"}),(0,s.jsx)(T.TableHead,{className:"w-[100px]",children:"Actions"})]})}),(0,s.jsx)(T.TableBody,{children:eA.map(e=>(0,s.jsxs)(T.TableRow,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>ez(e),children:[(0,s.jsx)(T.TableCell,{onClick:e=>e.stopPropagation(),children:(0,s.jsx)(I.Checkbox,{checked:ef.has(e.id),onCheckedChange:s=>eR(e.id,s),"aria-label":"Select ".concat(e.full_name)})}),(0,s.jsx)(T.TableCell,{children:(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:e.full_name}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:e.email})]})}),(0,s.jsx)(T.TableCell,{children:(0,s.jsx)(k.Badge,{variant:eG(e.role),children:e.role})}),(0,s.jsx)(T.TableCell,{children:(0,s.jsx)("div",{className:"text-sm font-mono",children:e.pin_code?(0,s.jsx)("span",{className:"bg-muted px-2 py-1 rounded text-xs",children:e.pin_code}):(0,s.jsx)("span",{className:"text-muted-foreground",children:"—"})})}),(0,s.jsx)(T.TableCell,{children:(0,s.jsx)("div",{className:"flex flex-wrap gap-1 max-w-[200px]",children:e.skills&&e.skills.length>0?(0,s.jsxs)(s.Fragment,{children:[e.skills.slice(0,2).map((e,a)=>(0,s.jsx)(k.Badge,{variant:"secondary",className:"text-xs",children:e},a)),e.skills.length>2&&(0,s.jsxs)(k.Badge,{variant:"outline",className:"text-xs",children:["+",e.skills.length-2]})]}):(0,s.jsx)("span",{className:"text-muted-foreground text-sm",children:"No skills"})})}),(0,s.jsx)(T.TableCell,{children:(0,s.jsx)("div",{className:"text-sm",children:e.phone&&(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,s.jsx)(u.Phone,{className:"h-3 w-3"}),(0,s.jsx)("span",{children:e.phone})]})})}),(0,s.jsx)(T.TableCell,{children:t&&(0,s.jsx)(Z,{user:e,teams:eT||[],children:(0,s.jsxs)(w.Button,{variant:"outline",size:"sm",onClick:e=>e.stopPropagation(),children:[(0,s.jsx)(o.UserPlus,{className:"mr-2 h-3 w-3"}),"Assign"]})})})]},e.id))})]})]})})]})}),(0,s.jsx)(_.TabsContent,{value:"all-users",className:"space-y-6",children:(0,s.jsxs)(y.Card,{children:[(0,s.jsxs)(y.CardHeader,{children:[(0,s.jsxs)(y.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(c.Users,{className:"h-5 w-5"}),"All Users (",eI.length,")"]}),(0,s.jsx)(y.CardDescription,{children:"Complete user directory with all roles and management capabilities"})]}),(0,s.jsx)(y.CardContent,{children:eS?(0,s.jsx)("div",{className:"space-y-4",children:[...Array(10)].map((e,a)=>(0,s.jsxs)("div",{className:"flex space-x-4",children:[(0,s.jsx)("div",{className:"h-4 bg-muted animate-pulse rounded flex-1"}),(0,s.jsx)("div",{className:"h-4 bg-muted animate-pulse rounded w-20"})]},a))}):0===eI.length?(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)(c.Users,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,s.jsx)("h3",{className:"mt-2 text-sm font-semibold",children:"No users found"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"Get started by creating your first user account."})]}):(0,s.jsxs)("div",{className:"space-y-4",children:[ef.size>0&&(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg border",children:[(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsxs)("span",{className:"text-sm font-medium",children:[ef.size," user",ef.size>1?"s":""," selected"]})}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(F.DropdownMenu,{children:[(0,s.jsx)(F.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsx)(w.Button,{variant:"outline",size:"sm",children:"Change Role"})}),(0,s.jsxs)(F.DropdownMenuContent,{children:[(0,s.jsx)(F.DropdownMenuLabel,{children:"Assign Role"}),(0,s.jsx)(F.DropdownMenuSeparator,{}),(0,s.jsx)(F.DropdownMenuItem,{onClick:()=>eV("role_admin"),children:"Administrator"}),(0,s.jsx)(F.DropdownMenuItem,{onClick:()=>eV("role_pm"),children:"Project Manager"}),(0,s.jsx)(F.DropdownMenuItem,{onClick:()=>eV("role_foreman"),children:"Foreman"}),(0,s.jsx)(F.DropdownMenuItem,{onClick:()=>eV("role_crew"),children:"Crew Member"}),(0,s.jsx)(F.DropdownMenuItem,{onClick:()=>eV("role_viewer"),children:"Viewer"})]})]}),(0,s.jsxs)(w.Button,{variant:"destructive",size:"sm",onClick:()=>eV("delete"),children:[(0,s.jsx)(h.Trash2,{className:"h-4 w-4 mr-1"}),"Delete Selected"]}),(0,s.jsx)(w.Button,{variant:"ghost",size:"sm",onClick:()=>eN(new Set),children:"Clear Selection"})]})]}),(0,s.jsxs)(T.Table,{children:[(0,s.jsx)(T.TableHeader,{children:(0,s.jsxs)(T.TableRow,{children:[(0,s.jsx)(T.TableHead,{className:"w-[50px]",children:(0,s.jsx)(I.Checkbox,{checked:ef.size>0&&ef.size===eU.length,onCheckedChange:e=>eO(e),"aria-label":"Select all users"})}),(0,s.jsx)(T.TableHead,{children:"Name"}),(0,s.jsx)(T.TableHead,{children:"Role"}),(0,s.jsx)(T.TableHead,{children:"PIN Code"}),(0,s.jsx)(T.TableHead,{children:"Skills"}),(0,s.jsx)(T.TableHead,{children:"Contact"}),(0,s.jsx)(T.TableHead,{children:"Status"}),(0,s.jsx)(T.TableHead,{children:"Team Status"}),(0,s.jsx)(T.TableHead,{className:"w-[100px]",children:"Actions"})]})}),(0,s.jsx)(T.TableBody,{children:eU.map(e=>(0,s.jsxs)(T.TableRow,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>ez(e),children:[(0,s.jsx)(T.TableCell,{onClick:e=>e.stopPropagation(),children:(0,s.jsx)(I.Checkbox,{checked:ef.has(e.id),onCheckedChange:s=>eR(e.id,s),"aria-label":"Select ".concat(e.full_name)})}),(0,s.jsx)(T.TableCell,{children:(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:e.full_name}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:e.email})]})}),(0,s.jsx)(T.TableCell,{children:(0,s.jsx)(k.Badge,{variant:eG(e.role),children:e.role})}),(0,s.jsx)(T.TableCell,{children:(0,s.jsx)("div",{className:"text-sm font-mono",children:e.pin_code?(0,s.jsx)("span",{className:"bg-muted px-2 py-1 rounded text-xs",children:e.pin_code}):(0,s.jsx)("span",{className:"text-muted-foreground",children:"—"})})}),(0,s.jsx)(T.TableCell,{children:(0,s.jsx)("div",{className:"flex flex-wrap gap-1 max-w-[200px]",children:e.skills&&e.skills.length>0?(0,s.jsxs)(s.Fragment,{children:[e.skills.slice(0,2).map((e,a)=>(0,s.jsx)(k.Badge,{variant:"secondary",className:"text-xs",children:e},a)),e.skills.length>2&&(0,s.jsxs)(k.Badge,{variant:"outline",className:"text-xs",children:["+",e.skills.length-2]})]}):(0,s.jsx)("span",{className:"text-muted-foreground text-sm",children:"No skills"})})}),(0,s.jsx)(T.TableCell,{children:(0,s.jsx)("div",{className:"text-sm",children:e.phone&&(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,s.jsx)(u.Phone,{className:"h-3 w-3"}),(0,s.jsx)("span",{children:e.phone})]})})}),(0,s.jsx)(T.TableCell,{children:(0,s.jsx)(k.Badge,{variant:e.is_active?"default":"secondary",children:e.is_active?"Active":"Inactive"})}),(0,s.jsx)(T.TableCell,{children:eM(e.id)?(0,s.jsx)(k.Badge,{variant:"default",className:"bg-green-600",children:"Assigned"}):["crew","worker","foreman"].includes(e.role)?(0,s.jsx)(k.Badge,{variant:"outline",children:"Available"}):(0,s.jsx)(k.Badge,{variant:"secondary",children:"N/A"})}),(0,s.jsx)(T.TableCell,{children:t&&(0,s.jsxs)(F.DropdownMenu,{children:[(0,s.jsx)(F.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsx)(w.Button,{variant:"outline",size:"sm",onClick:e=>e.stopPropagation(),children:"Actions"})}),(0,s.jsxs)(F.DropdownMenuContent,{align:"end",children:[(0,s.jsx)(F.DropdownMenuLabel,{children:"User Actions"}),(0,s.jsxs)(F.DropdownMenuItem,{onClick:s=>{s.stopPropagation(),ez(e)},children:[(0,s.jsx)(m.Eye,{className:"mr-2 h-4 w-4"}),"View Details"]}),(0,s.jsxs)(F.DropdownMenuItem,{onClick:s=>{s.stopPropagation(),eL(e)},children:[(0,s.jsx)(x.Edit,{className:"mr-2 h-4 w-4"}),"Edit User"]}),["crew","worker","foreman"].includes(e.role)&&!eM(e.id)&&(0,s.jsxs)(F.DropdownMenuItem,{onClick:s=>{s.stopPropagation(),eh(e),ei(!0)},children:[(0,s.jsx)(o.UserPlus,{className:"mr-2 h-4 w-4"}),"Assign to Team"]}),(0,s.jsx)(F.DropdownMenuSeparator,{}),(0,s.jsxs)(F.DropdownMenuItem,{className:"text-destructive",onClick:s=>{s.stopPropagation(),eH(e)},children:[(0,s.jsx)(h.Trash2,{className:"mr-2 h-4 w-4"}),"Delete User"]})]})]})})]},e.id))})]})]})})]})}),(0,s.jsxs)(_.TabsContent,{value:"overview",className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:[(0,s.jsxs)(y.Card,{children:[(0,s.jsxs)(y.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(y.CardTitle,{className:"text-sm font-medium",children:"Total Teams"}),(0,s.jsx)(c.Users,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsxs)(y.CardContent,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:(null==eT?void 0:eT.length)||0}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Active work crews"})]})]}),(0,s.jsxs)(y.Card,{children:[(0,s.jsxs)(y.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(y.CardTitle,{className:"text-sm font-medium",children:"Total Workers"}),(0,s.jsx)(o.UserPlus,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsxs)(y.CardContent,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:(null==eT?void 0:eT.reduce((e,s)=>e+(s.member_count||0),0))||0}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Assigned to teams"})]})]}),(0,s.jsxs)(y.Card,{children:[(0,s.jsxs)(y.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(y.CardTitle,{className:"text-sm font-medium",children:"Available Workers"}),(0,s.jsx)(o.UserPlus,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsxs)(y.CardContent,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:eA.length}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Not assigned to teams"})]})]}),(0,s.jsxs)(y.Card,{children:[(0,s.jsxs)(y.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(y.CardTitle,{className:"text-sm font-medium",children:"Active Projects"}),(0,s.jsx)(p.MapPin,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsxs)(y.CardContent,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:new Set(null==eT?void 0:eT.filter(e=>e.project_id).map(e=>e.project_id)).size||0}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"With assigned teams"})]})]})]}),(0,s.jsxs)(y.Card,{children:[(0,s.jsxs)(y.CardHeader,{children:[(0,s.jsx)(y.CardTitle,{children:"Team Performance Overview"}),(0,s.jsx)(y.CardDescription,{children:"Team productivity and workload analysis"})]}),(0,s.jsxs)(y.CardContent,{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h4",{className:"text-sm font-medium",children:"Skills Distribution Across Teams"}),(0,s.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:(()=>{let e={};return eI.forEach(s=>{s.skills&&Array.isArray(s.skills)&&s.skills.forEach(s=>{e[s]=(e[s]||0)+1})}),Object.entries(e).sort((e,s)=>{let[,a]=e,[,l]=s;return l-a}).slice(0,6).map(e=>{let[a,l]=e;return(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{className:"font-medium",children:a}),(0,s.jsxs)("span",{className:"text-muted-foreground",children:[l," workers"]})]}),(0,s.jsx)("div",{className:"w-full bg-muted rounded-full h-2",children:(0,s.jsx)("div",{className:"bg-primary h-2 rounded-full",style:{width:"".concat(Math.min(l/eI.length*100,100),"%")}})})]},a)})})()})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h4",{className:"text-sm font-medium",children:"Role Distribution"}),(0,s.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-5",children:(()=>{let e={admin:"bg-red-500",pm:"bg-blue-500",foreman:"bg-green-500",crew:"bg-yellow-500",viewer:"bg-gray-500"};return["admin","pm","foreman","crew","viewer"].map(a=>{let l=eI.filter(e=>e.role===a).length,r=eI.length>0?l/eI.length*100:0;return(0,s.jsxs)("div",{className:"text-center space-y-2",children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:l}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground capitalize",children:a}),(0,s.jsx)("div",{className:"w-full bg-muted rounded-full h-2",children:(0,s.jsx)("div",{className:"h-2 rounded-full ".concat(e[a]),style:{width:"".concat(r,"%")}})})]},a)})})()})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h4",{className:"text-sm font-medium",children:"Team Assignment Status"}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,s.jsx)(y.Card,{children:(0,s.jsx)(y.CardContent,{className:"p-4",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-green-600",children:(null==eT?void 0:eT.reduce((e,s)=>e+(s.member_count||0),0))||0}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Assigned Workers"}),(0,s.jsxs)("div",{className:"text-xs text-green-600 mt-1",children:[(null==eT?void 0:eT.length)||0," active teams"]})]})})}),(0,s.jsx)(y.Card,{children:(0,s.jsx)(y.CardContent,{className:"p-4",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:eA.length}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Available Workers"}),(0,s.jsx)("div",{className:"text-xs text-blue-600 mt-1",children:"Ready for assignment"})]})})}),(0,s.jsx)(y.Card,{children:(0,s.jsx)(y.CardContent,{className:"p-4",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsxs)("div",{className:"text-2xl font-bold text-purple-600",children:[(()=>{let e=(null==eT?void 0:eT.reduce((e,s)=>e+(s.member_count||0),0))||0,s=eI.filter(e=>["crew","worker","foreman"].includes(e.role)).length;return s>0?Math.round(e/s*100):0})(),"%"]}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Utilization Rate"}),(0,s.jsx)("div",{className:"text-xs text-purple-600 mt-1",children:"Team efficiency"})]})})})]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h4",{className:"text-sm font-medium",children:"Recent Team Activities"}),(0,s.jsx)("div",{className:"space-y-3",children:eT&&eT.length>0?eT.slice(0,5).map(e=>{var a;return(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-sm",children:e.name}),(0,s.jsxs)("div",{className:"text-xs text-muted-foreground",children:[e.member_count||0," members • Foreman: ",(null==(a=e.foreman)?void 0:a.full_name)||"Not assigned"]})]})]}),(0,s.jsx)(k.Badge,{variant:"secondary",className:"text-xs",children:"Active"})]},e.id)}):(0,s.jsx)("div",{className:"text-center py-4 text-muted-foreground text-sm",children:"No team activities to display"})})]})]})]})]})]}),(0,s.jsx)(D.Dialog,{open:W,onOpenChange:K,children:(0,s.jsxs)(D.DialogContent,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,s.jsxs)(D.DialogHeader,{children:[(0,s.jsx)(D.DialogTitle,{children:"Add New Team Member"}),(0,s.jsx)(D.DialogDescription,{children:"Create a new team member account with automatic PIN generation and skills management. You can select any role and assign them to teams later."})]}),(0,s.jsx)(J,{onSuccess:()=>{K(!1)},onCancel:()=>K(!1),defaultRole:ep})]})}),(0,s.jsx)(D.Dialog,{open:Q,onOpenChange:G,children:(0,s.jsxs)(D.DialogContent,{className:"sm:max-w-[500px]",children:[(0,s.jsxs)(D.DialogHeader,{children:[(0,s.jsx)(D.DialogTitle,{children:"Create New Team"}),(0,s.jsx)(D.DialogDescription,{children:"Create a new work crew/team with a name and optional foreman assignment."})]}),(0,s.jsx)(S.Form,{...ey,children:(0,s.jsxs)("form",{onSubmit:ey.handleSubmit(eW),className:"space-y-4",children:[(0,s.jsx)(S.FormField,{control:ey.control,name:"name",render:e=>{let{field:a}=e;return(0,s.jsxs)(S.FormItem,{children:[(0,s.jsx)(S.FormLabel,{children:"Team Name *"}),(0,s.jsx)(S.FormControl,{children:(0,s.jsx)(C.Input,{placeholder:"e.g., Alpha Team, Fiber Crew 1",...a})}),(0,s.jsx)(S.FormMessage,{})]})}}),(0,s.jsx)(S.FormField,{control:ey.control,name:"foreman_user_id",render:e=>{let{field:a}=e;return(0,s.jsxs)(S.FormItem,{children:[(0,s.jsx)(S.FormLabel,{children:"Foreman (Optional)"}),(0,s.jsxs)(P.Select,{onValueChange:a.onChange,defaultValue:a.value,children:[(0,s.jsx)(S.FormControl,{children:(0,s.jsx)(P.SelectTrigger,{children:(0,s.jsx)(P.SelectValue,{placeholder:"Select foreman..."})})}),(0,s.jsxs)(P.SelectContent,{children:[(0,s.jsx)(P.SelectItem,{value:"none",children:"No foreman assigned"}),null==eP?void 0:eP.map(e=>(0,s.jsxs)(P.SelectItem,{value:e.id,children:[e.first_name," ",e.last_name," (",e.role,")"]},e.id))]})]}),(0,s.jsx)(S.FormMessage,{})]})}}),(0,s.jsx)(S.FormField,{control:ey.control,name:"description",render:e=>{let{field:a}=e;return(0,s.jsxs)(S.FormItem,{children:[(0,s.jsx)(S.FormLabel,{children:"Description (Optional)"}),(0,s.jsx)(S.FormControl,{children:(0,s.jsx)(C.Input,{placeholder:"Team specialization or notes...",...a})}),(0,s.jsx)(S.FormMessage,{})]})}}),(0,s.jsxs)("div",{className:"flex justify-end space-x-2 pt-4",children:[(0,s.jsx)(w.Button,{type:"button",variant:"outline",onClick:()=>{G(!1),ey.reset()},children:"Cancel"}),(0,s.jsxs)(w.Button,{type:"submit",disabled:H.isPending,children:[H.isPending?(0,s.jsx)("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-background border-t-transparent mr-2"}):(0,s.jsx)(i.Plus,{className:"mr-2 h-4 w-4"}),"Create Team"]})]})]})})]})}),(0,s.jsx)(D.Dialog,{open:X,onOpenChange:Y,children:(0,s.jsxs)(D.DialogContent,{className:"sm:max-w-[500px]",children:[(0,s.jsxs)(D.DialogHeader,{children:[(0,s.jsx)(D.DialogTitle,{children:"Edit Team"}),(0,s.jsx)(D.DialogDescription,{children:"Update team information and assignments."})]}),(0,s.jsx)(S.Form,{...ek,children:(0,s.jsxs)("form",{onSubmit:ek.handleSubmit(eQ),className:"space-y-4",children:[(0,s.jsx)(S.FormField,{control:ek.control,name:"name",render:e=>{let{field:a}=e;return(0,s.jsxs)(S.FormItem,{children:[(0,s.jsx)(S.FormLabel,{children:"Team Name *"}),(0,s.jsx)(S.FormControl,{children:(0,s.jsx)(C.Input,{placeholder:"e.g., Alpha Team, Fiber Crew 1",...a})}),(0,s.jsx)(S.FormMessage,{})]})}}),(0,s.jsx)(S.FormField,{control:ek.control,name:"foreman_user_id",render:e=>{let{field:a}=e;return(0,s.jsxs)(S.FormItem,{children:[(0,s.jsx)(S.FormLabel,{children:"Foreman"}),(0,s.jsxs)(P.Select,{onValueChange:a.onChange,value:a.value,children:[(0,s.jsx)(S.FormControl,{children:(0,s.jsx)(P.SelectTrigger,{children:(0,s.jsx)(P.SelectValue,{placeholder:"Select foreman..."})})}),(0,s.jsxs)(P.SelectContent,{children:[(0,s.jsx)(P.SelectItem,{value:"none",children:"No foreman assigned"}),null==eP?void 0:eP.map(e=>(0,s.jsxs)(P.SelectItem,{value:e.id,children:[e.first_name," ",e.last_name," (",e.role,")"]},e.id))]})]}),(0,s.jsx)(S.FormMessage,{})]})}}),(0,s.jsx)(S.FormField,{control:ek.control,name:"description",render:e=>{let{field:a}=e;return(0,s.jsxs)(S.FormItem,{children:[(0,s.jsx)(S.FormLabel,{children:"Description"}),(0,s.jsx)(S.FormControl,{children:(0,s.jsx)(C.Input,{placeholder:"Team specialization or notes...",...a})}),(0,s.jsx)(S.FormMessage,{})]})}}),(0,s.jsxs)("div",{className:"flex justify-end space-x-2 pt-4",children:[(0,s.jsx)(w.Button,{type:"button",variant:"outline",onClick:()=>{Y(!1),ec(null),ek.reset()},children:"Cancel"}),(0,s.jsxs)(w.Button,{type:"submit",disabled:E.isPending,children:[E.isPending?(0,s.jsx)("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-background border-t-transparent mr-2"}):(0,s.jsx)(x.Edit,{className:"mr-2 h-4 w-4"}),"Update Team"]})]})]})})]})}),(0,s.jsx)(D.Dialog,{open:$,onOpenChange:es,children:(0,s.jsxs)(D.DialogContent,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,s.jsxs)(D.DialogHeader,{children:[(0,s.jsxs)(D.DialogTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(c.Users,{className:"h-5 w-5"}),"User Details - ",null==eo?void 0:eo.full_name]}),(0,s.jsx)(D.DialogDescription,{children:"Complete user profile information, skills, and management options"})]}),eo&&(0,s.jsxs)("div",{className:"grid gap-6 py-4",children:[(0,s.jsxs)(y.Card,{children:[(0,s.jsx)(y.CardHeader,{children:(0,s.jsxs)(y.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(c.Users,{className:"h-4 w-4"}),"Personal Information"]})}),(0,s.jsxs)(y.CardContent,{className:"grid gap-4 md:grid-cols-2",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Full Name"}),(0,s.jsx)("div",{className:"text-sm",children:eo.full_name})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Email"}),(0,s.jsxs)("div",{className:"text-sm flex items-center gap-2",children:[(0,s.jsx)(j.Mail,{className:"h-3 w-3"}),eo.email]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Phone"}),(0,s.jsxs)("div",{className:"text-sm flex items-center gap-2",children:[(0,s.jsx)(u.Phone,{className:"h-3 w-3"}),eo.phone||"—"]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Language Preference"}),(0,s.jsxs)("div",{className:"text-sm flex items-center gap-2",children:[(0,s.jsx)(v.Globe,{className:"h-3 w-3"}),eo.lang_pref||"—"]})]})]})]}),(0,s.jsxs)(y.Card,{children:[(0,s.jsx)(y.CardHeader,{children:(0,s.jsxs)(y.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(N.Shield,{className:"h-4 w-4"}),"System Access"]})}),(0,s.jsxs)(y.CardContent,{className:"grid gap-4 md:grid-cols-3",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Role"}),(0,s.jsx)(k.Badge,{variant:eG(eo.role),children:eo.role})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"PIN Code"}),(0,s.jsxs)("div",{className:"text-sm font-mono flex items-center gap-2",children:[(0,s.jsx)(b,{className:"h-3 w-3"}),eo.pin_code?(0,s.jsx)("span",{className:"bg-muted px-2 py-1 rounded",children:eo.pin_code}):"—"]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium text-muted-foreground",children:"Created"}),(0,s.jsxs)("div",{className:"text-sm flex items-center gap-2",children:[(0,s.jsx)(f.Calendar,{className:"h-3 w-3"}),eo.created_at?new Date(eo.created_at).toLocaleDateString():"—"]})]})]})]}),(0,s.jsxs)(y.Card,{children:[(0,s.jsx)(y.CardHeader,{children:(0,s.jsx)(y.CardTitle,{children:"Skills & Competencies"})}),(0,s.jsx)(y.CardContent,{children:eo.skills&&eo.skills.length>0?(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:eo.skills.map((e,a)=>(0,s.jsx)(k.Badge,{variant:"secondary",children:e},a))}):(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"No skills assigned"})})]}),(0,s.jsxs)(y.Card,{children:[(0,s.jsxs)(y.CardHeader,{children:[(0,s.jsxs)(y.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(g.FileText,{className:"h-4 w-4"}),"Documents"]}),(0,s.jsx)(y.CardDescription,{children:"User documents, contracts, and certifications"})]}),(0,s.jsx)(y.CardContent,{children:(0,s.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,s.jsx)(g.FileText,{className:"mx-auto h-12 w-12 mb-4"}),(0,s.jsx)("p",{children:"Document management integration will be implemented"}),(0,s.jsx)("p",{className:"text-xs mt-2",children:"This will connect to the existing document system"})]})})]}),(0,s.jsxs)("div",{className:"flex gap-2 pt-4 border-t",children:[t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(w.Button,{variant:"outline",className:"flex-1",onClick:()=>eL(eo),children:[(0,s.jsx)(x.Edit,{className:"mr-2 h-4 w-4"}),"Edit User"]}),(0,s.jsx)(B.default,{userId:eo.id,userName:"".concat(eo.first_name," ").concat(eo.last_name),trigger:(0,s.jsxs)(w.Button,{variant:"outline",className:"flex-1",children:[(0,s.jsx)(g.FileText,{className:"mr-2 h-4 w-4"}),"Manage Documents"]})}),["crew","worker","foreman"].includes(eo.role)&&!eM(eo.id)&&(0,s.jsxs)(w.Button,{variant:"outline",className:"flex-1",onClick:e=>{e.stopPropagation(),eh(eo),ei(!0)},children:[(0,s.jsx)(o.UserPlus,{className:"mr-2 h-4 w-4"}),"Assign to Team"]}),(0,s.jsxs)(w.Button,{variant:"destructive",size:"sm",onClick:()=>eH(eo),children:[(0,s.jsx)(h.Trash2,{className:"mr-2 h-4 w-4"}),"Delete"]})]}),(0,s.jsx)(w.Button,{variant:"outline",onClick:()=>es(!1),children:"Close"})]})]})]})}),(0,s.jsx)(D.Dialog,{open:ea,onOpenChange:el,children:(0,s.jsxs)(D.DialogContent,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,s.jsxs)(D.DialogHeader,{children:[(0,s.jsxs)(D.DialogTitle,{children:["Edit User - ",null==eu?void 0:eu.full_name]}),(0,s.jsx)(D.DialogDescription,{children:"Update user information, role, and skills. Changes will be saved immediately."})]}),eu&&(0,s.jsx)(J,{onSuccess:()=>{el(!1),ej(null)},onCancel:()=>{el(!1),ej(null)},defaultRole:eu.role,editMode:!0,initialData:eu})]})}),(0,s.jsx)(D.Dialog,{open:er,onOpenChange:en,children:(0,s.jsxs)(D.DialogContent,{className:"sm:max-w-[425px]",children:[(0,s.jsxs)(D.DialogHeader,{children:[(0,s.jsxs)(D.DialogTitle,{className:"flex items-center gap-2 text-destructive",children:[(0,s.jsx)(h.Trash2,{className:"h-5 w-5"}),"Delete User"]}),(0,s.jsx)(D.DialogDescription,{children:"Are you sure you want to delete this user? This action cannot be undone."})]}),eo&&(0,s.jsxs)("div",{className:"py-4",children:[(0,s.jsxs)("div",{className:"bg-muted p-4 rounded-lg space-y-2",children:[(0,s.jsx)("div",{className:"font-medium",children:eo.full_name}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:eo.email}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(k.Badge,{variant:eG(eo.role),children:eo.role}),eo.pin_code&&(0,s.jsxs)("span",{className:"text-xs bg-muted-foreground/20 px-2 py-1 rounded font-mono",children:["PIN: ",eo.pin_code]})]})]}),(0,s.jsxs)("div",{className:"mt-4 p-3 bg-destructive/10 rounded-lg border border-destructive/20",children:[(0,s.jsx)("div",{className:"text-sm text-destructive font-medium",children:"⚠️ Warning"}),(0,s.jsx)("div",{className:"text-sm text-destructive/80 mt-1",children:"This will permanently delete the user account and remove them from all teams. Any associated work entries and documents will remain but will no longer be linked to this user."})]})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[(0,s.jsx)(w.Button,{variant:"outline",onClick:()=>{en(!1),em(null)},disabled:O.isPending,children:"Cancel"}),(0,s.jsx)(w.Button,{variant:"destructive",onClick:eE,disabled:O.isPending,children:O.isPending?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-background border-t-transparent mr-2"}),"Deleting..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h.Trash2,{className:"mr-2 h-4 w-4"}),"Delete User"]})})]})]})}),(0,s.jsx)(D.Dialog,{open:ev,onOpenChange:eb,children:(0,s.jsxs)(D.DialogContent,{className:"sm:max-w-[425px]",children:[(0,s.jsxs)(D.DialogHeader,{children:[(0,s.jsxs)(D.DialogTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(c.Users,{className:"h-5 w-5"}),"Confirm Bulk Action"]}),(0,s.jsx)(D.DialogDescription,{children:"delete"===ew?"Are you sure you want to delete ".concat(ef.size," user").concat(ef.size>1?"s":"","? This action cannot be undone."):ew.startsWith("role_")?"Are you sure you want to change the role of ".concat(ef.size," user").concat(ef.size>1?"s":""," to ").concat(ew.replace("role_",""),"?"):"Please confirm this bulk action."})]}),(0,s.jsxs)("div",{className:"py-4",children:[(0,s.jsxs)("div",{className:"bg-muted p-4 rounded-lg space-y-2",children:[(0,s.jsxs)("div",{className:"font-medium",children:["Selected Users (",ef.size,"):"]}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground space-y-1 max-h-32 overflow-y-auto",children:Array.from(ef).map(e=>{let a=eI.find(s=>s.id===e);return a?(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{children:a.full_name}),(0,s.jsx)(k.Badge,{variant:eG(a.role),className:"text-xs",children:a.role})]},e):null})})]}),"delete"===ew&&(0,s.jsxs)("div",{className:"mt-4 p-3 bg-destructive/10 rounded-lg border border-destructive/20",children:[(0,s.jsx)("div",{className:"text-sm text-destructive font-medium",children:"⚠️ Warning"}),(0,s.jsx)("div",{className:"text-sm text-destructive/80 mt-1",children:"This will permanently delete the selected users and remove them from all teams. Any associated work entries and documents will remain but will no longer be linked to these users."})]})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[(0,s.jsx)(w.Button,{variant:"outline",onClick:()=>{eb(!1),eC("")},disabled:R.isPending||O.isPending,children:"Cancel"}),(0,s.jsx)(w.Button,{variant:"delete"===ew?"destructive":"default",onClick:eq,disabled:R.isPending||O.isPending,children:R.isPending||O.isPending?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-background border-t-transparent mr-2"}),"Processing..."]}):"delete"===ew?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h.Trash2,{className:"mr-2 h-4 w-4"}),"Delete Users"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.Users,{className:"mr-2 h-4 w-4"}),"Update Roles"]})})]})]})}),ex&&(0,s.jsx)(Z,{user:ex,teams:eT||[],open:et,onOpenChange:e=>{ei(e),e||eh(null)}})]})}}]);