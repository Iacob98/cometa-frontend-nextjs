(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,32661,e=>{"use strict";e.s(["useCreateProject",()=>o,"useDeleteProject",()=>m,"useProject",()=>c,"useProjectStats",()=>u,"useProjects",()=>i,"useUpdateProject",()=>d]);var t=e.i(66027),s=e.i(54616),r=e.i(12598),a=e.i(46696),l=e.i(41931);let n={all:["projects"],lists:()=>[...n.all,"list"],list:e=>[...n.lists(),e],details:()=>[...n.all,"detail"],detail:e=>[...n.details(),e]};function i(e){return(0,t.useQuery)({queryKey:n.list(e||{}),queryFn:()=>l.projectsApi.getProjects(e),staleTime:3e5})}function c(e){return(0,t.useQuery)({queryKey:n.detail(e),queryFn:()=>l.projectsApi.getProject(e),enabled:!!e,staleTime:3e5})}function o(){let e=(0,r.useQueryClient)();return(0,s.useMutation)({mutationFn:e=>l.projectsApi.createProject(e),onSuccess:t=>{e.invalidateQueries({queryKey:n.lists()}),e.setQueryData(n.detail(t.id),t),a.toast.success("Project created successfully")},onError:e=>{a.toast.error("Failed to create project: ".concat(e.message))}})}function d(){let e=(0,r.useQueryClient)();return(0,s.useMutation)({mutationFn:e=>{let{id:t,data:s}=e;return l.projectsApi.updateProject(t,s)},onMutate:async t=>{let{id:s,data:r}=t;await e.cancelQueries({queryKey:n.detail(s)});let a=e.getQueryData(n.detail(s));return e.setQueryData(n.detail(s),e=>e?{...e,...r}:e),{previousProject:a}},onError:(t,s,r)=>{let{id:l}=s;(null==r?void 0:r.previousProject)&&e.setQueryData(n.detail(l),r.previousProject),a.toast.error("Failed to update project: ".concat(t.message))},onSuccess:t=>{e.invalidateQueries({queryKey:n.lists()}),a.toast.success("Project updated successfully")},onSettled:(t,s,r)=>{let{id:a}=r;e.invalidateQueries({queryKey:n.detail(a)})}})}function m(){let e=(0,r.useQueryClient)();return(0,s.useMutation)({mutationFn:e=>l.projectsApi.deleteProject(e),onSuccess:(t,s)=>{e.removeQueries({queryKey:n.detail(s)}),e.invalidateQueries({queryKey:n.lists()}),a.toast.success("Project deleted successfully")},onError:e=>{a.toast.error("Failed to delete project: ".concat(e.message))}})}function u(e){return(0,t.useQuery)({queryKey:[...n.detail(e),"stats"],queryFn:async()=>{let t=await fetch("/api/projects/".concat(e,"/stats"));if(!t.ok)throw Error("Failed to fetch project statistics");return t.json()},staleTime:12e4,enabled:!!e})}},71689,e=>{"use strict";e.s(["ArrowLeft",()=>t],71689);let t=(0,e.i(75254).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},56909,e=>{"use strict";e.s(["Save",()=>t],56909);let t=(0,e.i(75254).default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},47697,e=>{"use strict";e.s(["CalendarIcon",()=>t.default]);var t=e.i(61277)},74983,e=>{"use strict";e.s(["default",()=>v]);var t=e.i(43476),s=e.i(18566),r=e.i(53145),a=e.i(94814),l=e.i(81307),n=e.i(47697),i=e.i(71689),c=e.i(56909),o=e.i(7486),d=e.i(78894),m=e.i(19455),u=e.i(15288),j=e.i(3133),x=e.i(93479),h=e.i(67489),p=e.i(32661),g=e.i(71436);let F=l.z.object({name:l.z.string().min(1,"Project name is required").max(255,"Project name too long"),customer:l.z.string().optional(),city:l.z.string().optional(),address:l.z.string().optional(),contact_24h:l.z.string().optional(),start_date:l.z.string().optional(),end_date_plan:l.z.string().optional(),total_length_m:l.z.coerce.number().min(0,"Length must be positive"),base_rate_per_m:l.z.coerce.number().min(0,"Rate must be positive"),language_default:l.z.enum(["ru","en","de","uz","tr"]),status:l.z.enum(["draft","active","waiting_invoice","closed"])});function v(){let e=(0,s.useParams)(),l=(0,s.useRouter)(),{canManageProjects:v}=(0,g.usePermissions)(),f=(0,p.useUpdateProject)(),y=e.id,{data:b,isLoading:_,error:C}=(0,p.useProject)(y),N=(0,r.useForm)({resolver:(0,a.zodResolver)(F),defaultValues:{name:"",customer:"",city:"",address:"",contact_24h:"",start_date:"",end_date_plan:"",total_length_m:0,base_rate_per_m:15.5,language_default:"de",status:"draft"}});b&&!N.formState.isDirty&&N.reset({name:b.name,customer:b.customer||"",city:b.city||"",address:b.address||"",contact_24h:b.contact_24h||"",start_date:b.start_date?new Date(b.start_date).toISOString().split("T")[0]:"",end_date_plan:b.end_date_plan?new Date(b.end_date_plan).toISOString().split("T")[0]:"",total_length_m:b.total_length_m,base_rate_per_m:b.base_rate_per_m,language_default:b.language_default||"de",status:b.status});let w=async e=>{try{let t={...e,start_date:e.start_date||void 0,end_date_plan:e.end_date_plan||void 0};await f.mutateAsync({id:y,data:t}),l.push("/dashboard/projects/".concat(y))}catch(e){console.error("Failed to update project:",e)}},P=[{value:"de",label:"German (Deutsch)"},{value:"en",label:"English"},{value:"ru",label:"Russian (Русский)"},{value:"uz",label:"Uzbek (Oʻzbek)"},{value:"tr",label:"Turkish (Türkçe)"}],S=[{value:"draft",label:"Draft"},{value:"active",label:"Active"},{value:"waiting_invoice",label:"Waiting Invoice"},{value:"closed",label:"Closed"}];return v?_?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)("div",{className:"h-8 w-8 bg-muted animate-pulse rounded"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("div",{className:"h-8 w-64 bg-muted animate-pulse rounded"}),(0,t.jsx)("div",{className:"h-4 w-48 bg-muted animate-pulse rounded"})]})]}),(0,t.jsx)("div",{className:"max-w-2xl space-y-6",children:[void 0,void 0,void 0].map((e,s)=>(0,t.jsx)("div",{className:"h-48 bg-muted animate-pulse rounded-lg"},s))})]}):C||!b?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsxs)(m.Button,{variant:"ghost",size:"sm",onClick:()=>l.back(),className:"flex items-center space-x-2",children:[(0,t.jsx)(i.ArrowLeft,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Back"})]})}),(0,t.jsx)(u.Card,{children:(0,t.jsx)(u.CardContent,{className:"py-8",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(d.AlertTriangle,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,t.jsx)("h3",{className:"mt-2 text-sm font-semibold",children:"Project not found"}),(0,t.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"The project you're looking for doesn't exist or you don't have permission to view it."})]})})})]}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)(m.Button,{variant:"ghost",size:"sm",onClick:()=>l.back(),className:"flex items-center space-x-2",children:[(0,t.jsx)(i.ArrowLeft,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Back"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Edit Project"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Modify project details and configuration"})]})]})}),(0,t.jsx)("div",{className:"max-w-2xl",children:(0,t.jsx)(j.Form,{...N,children:(0,t.jsxs)("form",{onSubmit:N.handleSubmit(w),className:"space-y-6",children:[(0,t.jsxs)(u.Card,{children:[(0,t.jsxs)(u.CardHeader,{children:[(0,t.jsxs)(u.CardTitle,{className:"flex items-center space-x-2",children:[(0,t.jsx)(o.Building2,{className:"h-5 w-5"}),(0,t.jsx)("span",{children:"Basic Information"})]}),(0,t.jsx)(u.CardDescription,{children:"Update the fundamental details about the project"})]}),(0,t.jsxs)(u.CardContent,{className:"space-y-6",children:[(0,t.jsx)(j.FormField,{control:N.control,name:"name",render:e=>{let{field:s}=e;return(0,t.jsxs)(j.FormItem,{children:[(0,t.jsx)(j.FormLabel,{children:"Project Name *"}),(0,t.jsx)(j.FormControl,{children:(0,t.jsx)(x.Input,{placeholder:"e.g., Fiber Installation Berlin District 1",...s})}),(0,t.jsx)(j.FormDescription,{children:"A clear, descriptive name for the project"}),(0,t.jsx)(j.FormMessage,{})]})}}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsx)(j.FormField,{control:N.control,name:"customer",render:e=>{let{field:s}=e;return(0,t.jsxs)(j.FormItem,{children:[(0,t.jsx)(j.FormLabel,{children:"Customer"}),(0,t.jsx)(j.FormControl,{children:(0,t.jsx)(x.Input,{placeholder:"e.g., Deutsche Telekom",...s})}),(0,t.jsx)(j.FormMessage,{})]})}}),(0,t.jsx)(j.FormField,{control:N.control,name:"city",render:e=>{let{field:s}=e;return(0,t.jsxs)(j.FormItem,{children:[(0,t.jsx)(j.FormLabel,{children:"City"}),(0,t.jsx)(j.FormControl,{children:(0,t.jsx)(x.Input,{placeholder:"e.g., Berlin",...s})}),(0,t.jsx)(j.FormMessage,{})]})}})]}),(0,t.jsx)(j.FormField,{control:N.control,name:"address",render:e=>{let{field:s}=e;return(0,t.jsxs)(j.FormItem,{children:[(0,t.jsx)(j.FormLabel,{children:"Project Address"}),(0,t.jsx)(j.FormControl,{children:(0,t.jsx)(x.Input,{placeholder:"e.g., Hauptstraße 123, 10115 Berlin",...s})}),(0,t.jsx)(j.FormDescription,{children:"Primary address or area where the work will be performed"}),(0,t.jsx)(j.FormMessage,{})]})}}),(0,t.jsx)(j.FormField,{control:N.control,name:"contact_24h",render:e=>{let{field:s}=e;return(0,t.jsxs)(j.FormItem,{children:[(0,t.jsx)(j.FormLabel,{children:"24h Emergency Contact"}),(0,t.jsx)(j.FormControl,{children:(0,t.jsx)(x.Input,{placeholder:"e.g., +49 30 12345678",...s})}),(0,t.jsx)(j.FormDescription,{children:"Contact number for emergencies during the project"}),(0,t.jsx)(j.FormMessage,{})]})}}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsx)(j.FormField,{control:N.control,name:"language_default",render:e=>{let{field:s}=e;return(0,t.jsxs)(j.FormItem,{children:[(0,t.jsx)(j.FormLabel,{children:"Default Language"}),(0,t.jsxs)(h.Select,{onValueChange:s.onChange,value:s.value,children:[(0,t.jsx)(j.FormControl,{children:(0,t.jsx)(h.SelectTrigger,{children:(0,t.jsx)(h.SelectValue,{placeholder:"Select project language"})})}),(0,t.jsx)(h.SelectContent,{children:P.map(e=>(0,t.jsx)(h.SelectItem,{value:e.value,children:e.label},e.value))})]}),(0,t.jsx)(j.FormDescription,{children:"Primary language used for project documentation and interface"}),(0,t.jsx)(j.FormMessage,{})]})}}),(0,t.jsx)(j.FormField,{control:N.control,name:"status",render:e=>{let{field:s}=e;return(0,t.jsxs)(j.FormItem,{children:[(0,t.jsx)(j.FormLabel,{children:"Project Status"}),(0,t.jsxs)(h.Select,{onValueChange:s.onChange,value:s.value,children:[(0,t.jsx)(j.FormControl,{children:(0,t.jsx)(h.SelectTrigger,{children:(0,t.jsx)(h.SelectValue,{placeholder:"Select project status"})})}),(0,t.jsx)(h.SelectContent,{children:S.map(e=>(0,t.jsx)(h.SelectItem,{value:e.value,children:e.label},e.value))})]}),(0,t.jsx)(j.FormDescription,{children:"Current status of the project"}),(0,t.jsx)(j.FormMessage,{})]})}})]})]})]}),(0,t.jsxs)(u.Card,{children:[(0,t.jsxs)(u.CardHeader,{children:[(0,t.jsx)(u.CardTitle,{children:"Project Scope"}),(0,t.jsx)(u.CardDescription,{children:"Update the scope and financial parameters of the project"})]}),(0,t.jsxs)(u.CardContent,{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsx)(j.FormField,{control:N.control,name:"total_length_m",render:e=>{let{field:s}=e;return(0,t.jsxs)(j.FormItem,{children:[(0,t.jsx)(j.FormLabel,{children:"Total Length (meters) *"}),(0,t.jsx)(j.FormControl,{children:(0,t.jsx)(x.Input,{type:"number",step:"0.01",min:"0",placeholder:"e.g., 1500",...s})}),(0,t.jsx)(j.FormDescription,{children:"Total length of fiber cable to be installed"}),(0,t.jsx)(j.FormMessage,{})]})}}),(0,t.jsx)(j.FormField,{control:N.control,name:"base_rate_per_m",render:e=>{let{field:s}=e;return(0,t.jsxs)(j.FormItem,{children:[(0,t.jsx)(j.FormLabel,{children:"Rate per Meter (€) *"}),(0,t.jsx)(j.FormControl,{children:(0,t.jsx)(x.Input,{type:"number",step:"0.01",min:"0",placeholder:"e.g., 15.50",...s})}),(0,t.jsx)(j.FormDescription,{children:"Base rate charged per meter of installation"}),(0,t.jsx)(j.FormMessage,{})]})}})]}),(0,t.jsxs)("div",{className:"rounded-md bg-muted p-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"font-medium",children:"Estimated Project Value:"}),(0,t.jsxs)("span",{className:"text-lg font-bold",children:["€",(N.watch("total_length_m")*N.watch("base_rate_per_m")).toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground mt-1",children:[N.watch("total_length_m")," meters × €",N.watch("base_rate_per_m")," per meter"]})]})]})]}),(0,t.jsxs)(u.Card,{children:[(0,t.jsxs)(u.CardHeader,{children:[(0,t.jsxs)(u.CardTitle,{className:"flex items-center space-x-2",children:[(0,t.jsx)(n.CalendarIcon,{className:"h-5 w-5"}),(0,t.jsx)("span",{children:"Project Timeline"})]}),(0,t.jsx)(u.CardDescription,{children:"Update the planned start and end dates (optional)"})]}),(0,t.jsx)(u.CardContent,{className:"space-y-6",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsx)(j.FormField,{control:N.control,name:"start_date",render:e=>{let{field:s}=e;return(0,t.jsxs)(j.FormItem,{children:[(0,t.jsx)(j.FormLabel,{children:"Planned Start Date"}),(0,t.jsx)(j.FormControl,{children:(0,t.jsx)(x.Input,{type:"date",...s})}),(0,t.jsx)(j.FormMessage,{})]})}}),(0,t.jsx)(j.FormField,{control:N.control,name:"end_date_plan",render:e=>{let{field:s}=e;return(0,t.jsxs)(j.FormItem,{children:[(0,t.jsx)(j.FormLabel,{children:"Planned End Date"}),(0,t.jsx)(j.FormControl,{children:(0,t.jsx)(x.Input,{type:"date",...s})}),(0,t.jsx)(j.FormMessage,{})]})}})]})})]}),(0,t.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,t.jsx)(m.Button,{type:"button",variant:"outline",onClick:()=>l.back(),children:"Cancel"}),(0,t.jsxs)(m.Button,{type:"submit",disabled:f.isPending,className:"flex items-center space-x-2",children:[f.isPending?(0,t.jsx)("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-background border-t-transparent"}):(0,t.jsx)(c.Save,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Save Changes"})]})]})]})})})]}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsxs)(m.Button,{variant:"ghost",size:"sm",onClick:()=>l.back(),className:"flex items-center space-x-2",children:[(0,t.jsx)(i.ArrowLeft,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Back"})]})}),(0,t.jsx)(u.Card,{children:(0,t.jsx)(u.CardContent,{className:"py-8",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(d.AlertTriangle,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,t.jsx)("h3",{className:"mt-2 text-sm font-semibold",children:"Access Denied"}),(0,t.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"You don't have permission to edit projects."})]})})})]})}}]);