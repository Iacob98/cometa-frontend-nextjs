(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,51892,22305,e=>{"use strict";e.s(["Marker",()=>c],51892);var a=e.i(24049),t=e.i(50699),n=e.i(82310),i=e.i(32322);let c=(0,t.createLayerComponent)(function(e,t){let{position:c,...o}=e,s=new i.Marker(c,o);return(0,a.createElementObject)(s,(0,n.extendContext)(t,{overlayContainer:s}))},function(e,a,t){a.position!==t.position&&e.setLatLng(a.position),null!=a.icon&&a.icon!==t.icon&&e.setIcon(a.icon),null!=a.zIndexOffset&&a.zIndexOffset!==t.zIndexOffset&&e.setZIndexOffset(a.zIndexOffset),null!=a.opacity&&a.opacity!==t.opacity&&e.setOpacity(a.opacity),null!=e.dragging&&a.draggable!==t.draggable&&(!0===a.draggable?e.dragging.enable():e.dragging.disable())});e.s(["Popup",()=>s],22305);var o=e.i(71645);let s=(0,t.createOverlayComponent)(function(e,t){let n=new i.Popup(e,t.overlayContainer);return(0,a.createElementObject)(n,t)},function(e,a,t,n){let{position:i}=t;(0,o.useEffect)(function(){let{instance:t}=e;function c(e){e.popup===t&&(t.update(),n(!0))}function o(e){e.popup===t&&n(!1)}return a.map.on({popupopen:c,popupclose:o}),null==a.overlayContainer?(null!=i&&t.setLatLng(i),t.openOn(a.map)):a.overlayContainer.bindPopup(t),function(){var e;a.map.off({popupopen:c,popupclose:o}),null==(e=a.overlayContainer)||e.unbindPopup(),a.map.removeLayer(t)}},[e,a,n,i])})},64694,e=>{"use strict";e.s(["GPSTracker",()=>m,"default",()=>v],64694);var a=e.i(43476),t=e.i(71645),n=e.i(51892),i=e.i(22305),c=e.i(24049),o=e.i(50699),s=e.i(82310),r=e.i(32322);let d=(0,o.createPathComponent)(function(e,a){let{center:t,children:n,...i}=e,o=new r.Circle(t,i);return(0,c.createElementObject)(o,(0,s.extendContext)(a,{overlayContainer:o}))},function(e,a,t){a.center!==t.center&&e.setLatLng(a.center),null!=a.radius&&a.radius!==t.radius&&e.setRadius(a.radius)});var l=e.i(46897),u=e.i(34858),p=e.i(61911),x=e.i(33793),g=e.i(71436);let h=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=arguments.length>1?arguments[1]:void 0,t=e?"#ef4444":"#3b82f6",n=e?16:12,i="";return void 0!==a&&(i="rotate(".concat(a,"deg)")),r.default.divIcon({html:'\n      <div style="\n        background-color: '.concat(t,";\n        width: ").concat(n,"px;\n        height: ").concat(n,"px;\n        border: 3px solid white;\n        border-radius: 50%;\n        box-shadow: 0 2px 6px rgba(0,0,0,0.3);\n        position: relative;\n        transform: ").concat(i,';\n      ">\n        ').concat(void 0!==a?'\n          <div style="\n            position: absolute;\n            top: -8px;\n            left: 50%;\n            transform: translateX(-50%);\n            width: 0;\n            height: 0;\n            border-left: 4px solid transparent;\n            border-right: 4px solid transparent;\n            border-bottom: 8px solid '.concat(t,';\n          "></div>\n        '):"","\n      </div>\n    "),className:"gps-marker",iconSize:[n+6,n+6],iconAnchor:[(n+6)/2,(n+6)/2]})};function m(e){let{trackCurrentUser:c=!0,trackUsers:o=[],enableTracking:s=!1,showAccuracy:r=!0,onLocationUpdate:m}=e,{user:v}=(0,g.useAuth)(),[f,j]=(0,t.useState)(null),[y,b]=(0,t.useState)(null),[L,N]=(0,t.useState)(),P=(0,x.useUpdateGPSLocation)(),{data:w}=(0,x.useGPSTracking)(null==v?void 0:v.id),C=o.map(e=>(0,x.useGPSTracking)(e)),O=(0,t.useCallback)(()=>{navigator.geolocation&&s&&b(navigator.geolocation.watchPosition(e=>{let a={latitude:e.coords.latitude,longitude:e.coords.longitude,accuracy:e.coords.accuracy};j(a),null!==e.coords.heading&&void 0!==e.coords.heading&&N(e.coords.heading),(null==v?void 0:v.id)&&s&&P.mutate({userId:v.id,location:a}),m&&m(a)},e=>{console.error("GPS tracking error:",e)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0}))},[s,null==v?void 0:v.id,P,m]),k=(0,t.useCallback)(()=>{null!==y&&(navigator.geolocation.clearWatch(y),b(null))},[y]);return(0,t.useEffect)(()=>(s&&c?O():k(),()=>k()),[s,c,O,k]),(0,t.useEffect)(()=>()=>k(),[k]),(0,a.jsxs)(a.Fragment,{children:[f&&c&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.Marker,{position:[f.latitude,f.longitude],icon:h(!0,L),children:(0,a.jsx)(i.Popup,{children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(l.MapPin,{className:"w-4 h-4 text-red-500"}),(0,a.jsx)("span",{className:"font-semibold",children:"Your Location"})]}),(0,a.jsxs)("div",{className:"text-xs space-y-1",children:[(0,a.jsxs)("div",{children:["Lat: ",f.latitude.toFixed(6)]}),(0,a.jsxs)("div",{children:["Lng: ",f.longitude.toFixed(6)]}),f.accuracy&&(0,a.jsxs)("div",{children:["Accuracy: ±",Math.round(f.accuracy),"m"]}),void 0!==L&&(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(u.Navigation,{className:"w-3 h-3"}),"Heading: ",Math.round(L),"°"]})]})]})})}),r&&f.accuracy&&(0,a.jsx)(d,{center:[f.latitude,f.longitude],radius:f.accuracy,color:"#ef4444",fillOpacity:.1,weight:1})]}),(null==w?void 0:w.data)&&c&&(0,a.jsx)(n.Marker,{position:[w.data.latitude,w.data.longitude],icon:h(!0),opacity:f?.5:1,children:(0,a.jsx)(i.Popup,{children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(l.MapPin,{className:"w-4 h-4 text-red-500"}),(0,a.jsx)("span",{className:"font-semibold",children:"Last Known Location"})]}),(0,a.jsxs)("div",{className:"text-xs space-y-1",children:[(0,a.jsxs)("div",{children:["Lat: ",w.data.latitude.toFixed(6)]}),(0,a.jsxs)("div",{children:["Lng: ",w.data.longitude.toFixed(6)]}),w.data.accuracy&&(0,a.jsxs)("div",{children:["Accuracy: ±",Math.round(w.data.accuracy),"m"]}),w.data.timestamp&&(0,a.jsxs)("div",{children:["Updated: ",new Date(w.data.timestamp).toLocaleTimeString()]})]})]})})}),C.map((e,c)=>{if(!(null==e?void 0:e.data))return null;let s=o[c];return(0,a.jsxs)(t.default.Fragment,{children:[(0,a.jsx)(n.Marker,{position:[e.data.latitude,e.data.longitude],icon:h(!1),children:(0,a.jsx)(i.Popup,{children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(p.Users,{className:"w-4 h-4 text-blue-500"}),(0,a.jsx)("span",{className:"font-semibold",children:"Team Member"})]}),(0,a.jsxs)("div",{className:"text-xs space-y-1",children:[(0,a.jsxs)("div",{children:["Lat: ",e.data.latitude.toFixed(6)]}),(0,a.jsxs)("div",{children:["Lng: ",e.data.longitude.toFixed(6)]}),e.data.accuracy&&(0,a.jsxs)("div",{children:["Accuracy: ±",Math.round(e.data.accuracy),"m"]}),e.data.timestamp&&(0,a.jsxs)("div",{children:["Updated: ",new Date(e.data.timestamp).toLocaleTimeString()]})]})]})})}),r&&e.data.accuracy&&(0,a.jsx)(d,{center:[e.data.latitude,e.data.longitude],radius:e.data.accuracy,color:"#3b82f6",fillOpacity:.1,weight:1})]},s)})]})}let v=m},76637,e=>{e.n(e.i(64694))}]);