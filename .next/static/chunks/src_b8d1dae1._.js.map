{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/T7/cometa/cometa-separated-projects/cometa-frontend-nextjs/src/components/ui/alert-dialog.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAEA;AACA;AAEA;AACA;AANA;;;;;;AAQA,MAAM,cAAc,sLAAyB;AAE7C,MAAM,qBAAqB,yLAA4B;AAEvD,MAAM,oBAAoB,wLAA2B;AAErD,MAAM,mCAAqB,2KAAgB,CAGzC,QAA0B;QAAzB,EAAE,SAAS,EAAE,GAAG,OAAO;yBACxB,6LAAC,yLAA4B;QAC3B,WAAW,IAAA,4HAAE,EACX,2JACA;QAED,GAAG,KAAK;QACT,KAAK;;;;;;;KAVH;AAaN,mBAAmB,WAAW,GAAG,yLAA4B,CAAC,WAAW;AAEzE,MAAM,mCAAqB,2KAAgB,OAGzC,QAA0B;QAAzB,EAAE,SAAS,EAAE,GAAG,OAAO;yBACxB,6LAAC;;0BACC,6LAAC;;;;;0BACD,6LAAC,yLAA4B;gBAC3B,KAAK;gBACL,WAAW,IAAA,4HAAE,EACX,+fACA;gBAED,GAAG,KAAK;;;;;;;;;;;;;;AAIf,mBAAmB,WAAW,GAAG,yLAA4B,CAAC,WAAW;AAEzE,MAAM,oBAAoB;QAAC,EACzB,SAAS,EACT,GAAG,OACkC;yBACrC,6LAAC;QACC,WAAW,IAAA,4HAAE,EACX,oDACA;QAED,GAAG,KAAK;;;;;;;MATP;AAYN,kBAAkB,WAAW,GAAG;AAEhC,MAAM,oBAAoB;QAAC,EACzB,SAAS,EACT,GAAG,OACkC;yBACrC,6LAAC;QACC,WAAW,IAAA,4HAAE,EACX,iEACA;QAED,GAAG,KAAK;;;;;;;MATP;AAYN,kBAAkB,WAAW,GAAG;AAEhC,MAAM,iCAAmB,2KAAgB,OAGvC,QAA0B;QAAzB,EAAE,SAAS,EAAE,GAAG,OAAO;yBACxB,6LAAC,uLAA0B;QACzB,KAAK;QACL,WAAW,IAAA,4HAAE,EAAC,yBAAyB;QACtC,GAAG,KAAK;;;;;;;;AAGb,iBAAiB,WAAW,GAAG,uLAA0B,CAAC,WAAW;AAErE,MAAM,uCAAyB,2KAAgB,OAG7C,QAA0B;QAAzB,EAAE,SAAS,EAAE,GAAG,OAAO;yBACxB,6LAAC,6LAAgC;QAC/B,KAAK;QACL,WAAW,IAAA,4HAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;;;AAGb,uBAAuB,WAAW,GAChC,6LAAgC,CAAC,WAAW;AAE9C,MAAM,kCAAoB,2KAAgB,OAGxC,QAA0B;QAAzB,EAAE,SAAS,EAAE,GAAG,OAAO;yBACxB,6LAAC,wLAA2B;QAC1B,KAAK;QACL,WAAW,IAAA,4HAAE,EAAC,IAAA,uJAAc,KAAI;QAC/B,GAAG,KAAK;;;;;;;;AAGb,kBAAkB,WAAW,GAAG,wLAA2B,CAAC,WAAW;AAEvE,MAAM,kCAAoB,2KAAgB,QAGxC,QAA0B;QAAzB,EAAE,SAAS,EAAE,GAAG,OAAO;yBACxB,6LAAC,wLAA2B;QAC1B,KAAK;QACL,WAAW,IAAA,4HAAE,EACX,IAAA,uJAAc,EAAC;YAAE,SAAS;QAAU,IACpC,gBACA;QAED,GAAG,KAAK;;;;;;;;AAGb,kBAAkB,WAAW,GAAG,wLAA2B,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 189, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/T7/cometa/cometa-separated-projects/cometa-frontend-nextjs/src/hooks/use-teams.ts"],"sourcesContent":["import { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { toast } from \"sonner\";\nimport {\n  teamsApi,\n  type Crew,\n  type PaginatedResponse,\n} from \"@/lib/api-client\";\n\n// Query keys\nexport const teamKeys = {\n  all: [\"teams\"] as const,\n  crews: () => [...teamKeys.all, \"crews\"] as const,\n  crew: (id: string) => [...teamKeys.all, \"crew\", id] as const,\n};\n\n// Hooks\nexport function useTeams() {\n  return useQuery({\n    queryKey: teamKeys.crews(),\n    queryFn: async () => {\n      const response = await fetch('/api/crews');\n      if (!response.ok) {\n        throw new Error('Failed to fetch crews');\n      }\n      const data = await response.json();\n      return data.crews || [];\n    },\n    staleTime: 30 * 1000, // 30 seconds - frequent updates for team changes\n  });\n}\n\nexport function useCrew(id: string) {\n  return useQuery({\n    queryKey: teamKeys.crew(id),\n    queryFn: () => teamsApi.getCrew(id),\n    enabled: !!id,\n    staleTime: 5 * 60 * 1000,\n  });\n}\n\nexport function useCreateCrew() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: (data: Partial<Crew>) => teamsApi.createCrew(data),\n    onSuccess: (newCrew) => {\n      // Invalidate and refetch crews list\n      queryClient.invalidateQueries({ queryKey: teamKeys.crews() });\n\n      // Add the new crew to the cache\n      queryClient.setQueryData(teamKeys.crew(newCrew.id), newCrew);\n\n      toast.success(\"Team created successfully\");\n    },\n    onError: (error) => {\n      toast.error(`Failed to create team: ${error.message}`);\n    },\n  });\n}\n\nexport function useUpdateCrew() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: ({ id, data }: { id: string; data: Partial<Crew> }) =>\n      teamsApi.updateCrew(id, data),\n    onMutate: async ({ id, data }) => {\n      // Cancel any outgoing refetches\n      await queryClient.cancelQueries({ queryKey: teamKeys.crew(id) });\n\n      // Snapshot the previous value\n      const previousCrew = queryClient.getQueryData(teamKeys.crew(id));\n\n      // Optimistically update to the new value\n      queryClient.setQueryData(teamKeys.crew(id), (old: Crew | undefined) => {\n        if (!old) return old;\n        return { ...old, ...data };\n      });\n\n      // Return a context object with the snapshotted value\n      return { previousCrew };\n    },\n    onError: (error, { id }, context) => {\n      // If the mutation fails, use the context returned from onMutate to roll back\n      if (context?.previousCrew) {\n        queryClient.setQueryData(teamKeys.crew(id), context.previousCrew);\n      }\n      toast.error(`Failed to update team: ${error.message}`);\n    },\n    onSuccess: () => {\n      // Invalidate and refetch crews list\n      queryClient.invalidateQueries({ queryKey: teamKeys.crews() });\n      toast.success(\"Team updated successfully\");\n    },\n    onSettled: (data, error, { id }) => {\n      // Always refetch after error or success\n      queryClient.invalidateQueries({ queryKey: teamKeys.crew(id) });\n    },\n  });\n}\n\nexport function useDeleteCrew() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: (id: string) => teamsApi.deleteCrew(id),\n    onSuccess: (_, deletedId) => {\n      // Remove from cache\n      queryClient.removeQueries({ queryKey: teamKeys.crew(deletedId) });\n\n      // Invalidate crews list\n      queryClient.invalidateQueries({ queryKey: teamKeys.crews() });\n\n      toast.success(\"Team deleted successfully\");\n    },\n    onError: (error) => {\n      toast.error(`Failed to delete team: ${error.message}`);\n    },\n  });\n}\n\n// Additional interfaces for project preparation\nexport interface ProjectUser {\n  id: string;\n  name: string;\n  email: string;\n  role: string;\n  assigned_at: string;\n  assigned_by: string;\n}\n\nexport interface GlobalTeam {\n  id: string;\n  name: string;\n  foreman_name?: string;\n  is_active: boolean;\n  project_count?: number;\n  specialization?: string;\n}\n\n// Additional hooks for project preparation\nexport function useGlobalTeams() {\n  return useQuery({\n    queryKey: ['global-teams'],\n    queryFn: async (): Promise<GlobalTeam[]> => {\n      const response = await fetch('/api/crews');\n      if (!response.ok) {\n        throw new Error('Failed to fetch global teams');\n      }\n      const data = await response.json();\n      const crews = data.crews || [];\n\n      // Transform to GlobalTeam format and count projects per team\n      const projectCounts: Record<string, number> = {};\n      crews.forEach((crew: any) => {\n        if (crew.project_id) {\n          projectCounts[crew.name] = (projectCounts[crew.name] || 0) + 1;\n        }\n      });\n\n      return crews.map((crew: any) => ({\n        id: crew.id,\n        name: crew.name,\n        foreman_name: crew.foreman?.full_name || crew.foreman_name,\n        is_active: crew.status === 'active',\n        project_count: projectCounts[crew.name] || 0,\n        specialization: 'mixed'\n      }));\n    },\n  });\n}\n\nexport function useProjectUsers(projectId: string) {\n  return useQuery({\n    queryKey: ['project-users', projectId],\n    queryFn: async (): Promise<ProjectUser[]> => {\n      try {\n        const response = await fetch(`/api/projects/${projectId}/users`);\n        if (!response.ok) {\n          if (response.status === 404) {\n            return []; // No users assigned yet\n          }\n          throw new Error('Failed to fetch project users');\n        }\n        const data = await response.json();\n        return data.users || [];\n      } catch (error) {\n        console.warn('Project users not available:', error);\n        return []; // Return empty array instead of mock data\n      }\n    },\n    enabled: !!projectId,\n  });\n}\n\nexport function useForemenUsers() {\n  return useQuery({\n    queryKey: ['foremen-users'],\n    queryFn: async () => {\n      const response = await fetch('/api/users?role=foreman&is_active=true');\n      if (!response.ok) {\n        // Try to get PM users as well if no foremen\n        const pmResponse = await fetch('/api/users?role=pm&is_active=true');\n        if (!pmResponse.ok) {\n          throw new Error('Failed to fetch users');\n        }\n        const pmData = await pmResponse.json();\n        return pmData.items || [];\n      }\n      const data = await response.json();\n\n      // If no foremen, get both foremen and PMs\n      if (data.items.length === 0) {\n        const allResponse = await fetch('/api/users?is_active=true');\n        if (!allResponse.ok) {\n          throw new Error('Failed to fetch users');\n        }\n        const allData = await allResponse.json();\n        return (allData.items || []).filter((user: any) =>\n          user.role === 'foreman' || user.role === 'pm'\n        );\n      }\n\n      return data.items || [];\n    },\n  });\n}\n\nexport function useCreateTeam() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async (data: any) => {\n      const response = await fetch('/api/crews', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(data),\n      });\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'Failed to create team');\n      }\n\n      return response.json();\n    },\n    onSuccess: (data, variables) => {\n      if (variables.project_id) {\n        queryClient.invalidateQueries({ queryKey: ['project-teams', variables.project_id] });\n        queryClient.invalidateQueries({ queryKey: ['project-preparation', variables.project_id] });\n      }\n      queryClient.invalidateQueries({ queryKey: ['global-teams'] });\n      queryClient.invalidateQueries({ queryKey: teamKeys.crews() });\n      toast.success(data.message || 'Team created successfully');\n    },\n    onError: (error: Error) => {\n      toast.error(error.message);\n    },\n  });\n}\n\n// Specialized hooks\nexport function useProjectTeams(projectId: string) {\n  return useQuery({\n    queryKey: ['project-teams', projectId],\n    queryFn: async () => {\n      const response = await fetch(`/api/crews?project_id=${projectId}`);\n      if (!response.ok) {\n        throw new Error('Failed to fetch project teams');\n      }\n      const data = await response.json();\n      return data.crews || [];\n    },\n    enabled: !!projectId,\n  });\n}\n\nexport function useAvailableTeams() {\n  const { data: crews, ...rest } = useTeams();\n\n  return {\n    ...rest,\n    data: crews?.filter(crew => !crew.project_id) || [],\n  };\n}\n\nexport function useUpdateTeam() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async ({ id, data }: { id: string; data: any }) => {\n      const response = await fetch(`/api/crews/${id}`, {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(data),\n      });\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'Failed to update team');\n      }\n\n      return response.json();\n    },\n    onSuccess: (data, variables) => {\n      queryClient.invalidateQueries({ queryKey: ['project-teams'] });\n      queryClient.invalidateQueries({ queryKey: ['global-teams'] });\n      queryClient.invalidateQueries({ queryKey: teamKeys.crews() });\n      queryClient.invalidateQueries({ queryKey: ['project-preparation'] });\n      toast.success(data.message || 'Team updated successfully');\n    },\n    onError: (error: Error) => {\n      toast.error(error.message);\n    },\n  });\n}\n\nexport function useDeleteTeam() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async (id: string) => {\n      const response = await fetch(`/api/crews/${id}`, {\n        method: 'DELETE',\n      });\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'Failed to delete team');\n      }\n\n      return response.json();\n    },\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: ['project-teams'] });\n      queryClient.invalidateQueries({ queryKey: ['global-teams'] });\n      queryClient.invalidateQueries({ queryKey: teamKeys.crews() });\n      queryClient.invalidateQueries({ queryKey: ['project-preparation'] });\n      toast.success(data.message || 'Team deleted successfully');\n    },\n    onError: (error: Error) => {\n      toast.error(error.message);\n    },\n  });\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 747, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/T7/cometa/cometa-separated-projects/cometa-frontend-nextjs/src/hooks/use-users.ts"],"sourcesContent":["import { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { toast } from \"sonner\";\nimport {\n  usersApi,\n  type User,\n  type PaginatedResponse,\n} from \"@/lib/api-client\";\n\n// Query keys\nexport const userKeys = {\n  all: [\"users\"] as const,\n  lists: () => [...userKeys.all, \"list\"] as const,\n  list: (filters: any) => [...userKeys.lists(), filters] as const,\n  details: () => [...userKeys.all, \"detail\"] as const,\n  detail: (id: string) => [...userKeys.details(), id] as const,\n};\n\n// Hooks\nexport function useUsers(filters?: { role?: string; page?: number; per_page?: number }) {\n  return useQuery({\n    queryKey: userKeys.list(filters || {}),\n    queryFn: () => usersApi.getUsers(filters),\n    staleTime: 5 * 60 * 1000, // 5 minutes\n  });\n}\n\nexport function useUser(id: string) {\n  return useQuery({\n    queryKey: userKeys.detail(id),\n    queryFn: () => usersApi.getUser(id),\n    enabled: !!id,\n    staleTime: 5 * 60 * 1000,\n  });\n}\n\nexport function useCreateUser() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: (data: Partial<User>) => usersApi.createUser(data),\n    onSuccess: (newUser) => {\n      // Invalidate and refetch users list\n      queryClient.invalidateQueries({ queryKey: userKeys.lists() });\n\n      // Add the new user to the cache\n      queryClient.setQueryData(userKeys.detail(newUser.id), newUser);\n\n      toast.success(\"User created successfully\");\n    },\n    onError: (error) => {\n      toast.error(`Failed to create user: ${error.message}`);\n    },\n  });\n}\n\nexport function useUpdateUser() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: ({ id, data }: { id: string; data: Partial<User> }) =>\n      usersApi.updateUser(id, data),\n    onMutate: async ({ id, data }) => {\n      // Cancel any outgoing refetches\n      await queryClient.cancelQueries({ queryKey: userKeys.detail(id) });\n\n      // Snapshot the previous value\n      const previousUser = queryClient.getQueryData(userKeys.detail(id));\n\n      // Optimistically update to the new value\n      queryClient.setQueryData(userKeys.detail(id), (old: User | undefined) => {\n        if (!old) return old;\n        return { ...old, ...data };\n      });\n\n      // Return a context object with the snapshotted value\n      return { previousUser };\n    },\n    onError: (error, { id }, context) => {\n      // If the mutation fails, use the context returned from onMutate to roll back\n      if (context?.previousUser) {\n        queryClient.setQueryData(userKeys.detail(id), context.previousUser);\n      }\n      toast.error(`Failed to update user: ${error.message}`);\n    },\n    onSuccess: () => {\n      // Invalidate and refetch users list\n      queryClient.invalidateQueries({ queryKey: userKeys.lists() });\n      toast.success(\"User updated successfully\");\n    },\n    onSettled: (data, error, { id }) => {\n      // Always refetch after error or success\n      queryClient.invalidateQueries({ queryKey: userKeys.detail(id) });\n    },\n  });\n}\n\nexport function useDeleteUser() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: (id: string) => usersApi.deleteUser(id),\n    onSuccess: (_, deletedId) => {\n      // Remove from cache\n      queryClient.removeQueries({ queryKey: userKeys.detail(deletedId) });\n\n      // Invalidate users list\n      queryClient.invalidateQueries({ queryKey: userKeys.lists() });\n\n      toast.success(\"User deleted successfully\");\n    },\n    onError: (error) => {\n      toast.error(`Failed to delete user: ${error.message}`);\n    },\n  });\n}\n\n// Specialized hooks for common use cases\nexport function useWorkers() {\n  return useUsers({\n    role: \"crew,worker,foreman\",\n    page: 1,\n    per_page: 100,\n  });\n}\n\nexport function useForemen() {\n  return useUsers({\n    role: \"foreman\",\n    page: 1,\n    per_page: 50,\n  });\n}\n\nexport function useProjectManagers() {\n  return useUsers({\n    role: \"pm\",\n    page: 1,\n    per_page: 50,\n  });\n}"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AACA;AACA;;;;;AAOO,MAAM,WAAW;IACtB,KAAK;QAAC;KAAQ;IACd,OAAO,IAAM;eAAI,SAAS,GAAG;YAAE;SAAO;IACtC,MAAM,CAAC,UAAiB;eAAI,SAAS,KAAK;YAAI;SAAQ;IACtD,SAAS,IAAM;eAAI,SAAS,GAAG;YAAE;SAAS;IAC1C,QAAQ,CAAC,KAAe;eAAI,SAAS,OAAO;YAAI;SAAG;AACrD;AAGO,SAAS,SAAS,OAA6D;;IACpF,OAAO,IAAA,0LAAQ,EAAC;QACd,UAAU,SAAS,IAAI,CAAC,WAAW,CAAC;QACpC,OAAO;iCAAE,IAAM,0IAAQ,CAAC,QAAQ,CAAC;;QACjC,WAAW,IAAI,KAAK;IACtB;AACF;GANgB;;QACP,0LAAQ;;;AAOV,SAAS,QAAQ,EAAU;;IAChC,OAAO,IAAA,0LAAQ,EAAC;QACd,UAAU,SAAS,MAAM,CAAC;QAC1B,OAAO;gCAAE,IAAM,0IAAQ,CAAC,OAAO,CAAC;;QAChC,SAAS,CAAC,CAAC;QACX,WAAW,IAAI,KAAK;IACtB;AACF;IAPgB;;QACP,0LAAQ;;;AAQV,SAAS;;IACd,MAAM,cAAc,IAAA,2MAAc;IAElC,OAAO,IAAA,gMAAW,EAAC;QACjB,UAAU;yCAAE,CAAC,OAAwB,0IAAQ,CAAC,UAAU,CAAC;;QACzD,SAAS;yCAAE,CAAC;gBACV,oCAAoC;gBACpC,YAAY,iBAAiB,CAAC;oBAAE,UAAU,SAAS,KAAK;gBAAG;gBAE3D,gCAAgC;gBAChC,YAAY,YAAY,CAAC,SAAS,MAAM,CAAC,QAAQ,EAAE,GAAG;gBAEtD,oJAAK,CAAC,OAAO,CAAC;YAChB;;QACA,OAAO;yCAAE,CAAC;gBACR,oJAAK,CAAC,KAAK,CAAC,AAAC,0BAAuC,OAAd,MAAM,OAAO;YACrD;;IACF;AACF;IAlBgB;;QACM,2MAAc;QAE3B,gMAAW;;;AAiBb,SAAS;;IACd,MAAM,cAAc,IAAA,2MAAc;IAElC,OAAO,IAAA,gMAAW,EAAC;QACjB,UAAU;yCAAE;oBAAC,EAAE,EAAE,EAAE,IAAI,EAAuC;uBAC5D,0IAAQ,CAAC,UAAU,CAAC,IAAI;;;QAC1B,QAAQ;yCAAE;oBAAO,EAAE,EAAE,EAAE,IAAI,EAAE;gBAC3B,gCAAgC;gBAChC,MAAM,YAAY,aAAa,CAAC;oBAAE,UAAU,SAAS,MAAM,CAAC;gBAAI;gBAEhE,8BAA8B;gBAC9B,MAAM,eAAe,YAAY,YAAY,CAAC,SAAS,MAAM,CAAC;gBAE9D,yCAAyC;gBACzC,YAAY,YAAY,CAAC,SAAS,MAAM,CAAC;iDAAK,CAAC;wBAC7C,IAAI,CAAC,KAAK,OAAO;wBACjB,OAAO;4BAAE,GAAG,GAAG;4BAAE,GAAG,IAAI;wBAAC;oBAC3B;;gBAEA,qDAAqD;gBACrD,OAAO;oBAAE;gBAAa;YACxB;;QACA,OAAO;yCAAE,CAAC,cAAe;oBAAR,EAAE,EAAE,EAAE;gBACrB,6EAA6E;gBAC7E,IAAI,oBAAA,8BAAA,QAAS,YAAY,EAAE;oBACzB,YAAY,YAAY,CAAC,SAAS,MAAM,CAAC,KAAK,QAAQ,YAAY;gBACpE;gBACA,oJAAK,CAAC,KAAK,CAAC,AAAC,0BAAuC,OAAd,MAAM,OAAO;YACrD;;QACA,SAAS;yCAAE;gBACT,oCAAoC;gBACpC,YAAY,iBAAiB,CAAC;oBAAE,UAAU,SAAS,KAAK;gBAAG;gBAC3D,oJAAK,CAAC,OAAO,CAAC;YAChB;;QACA,SAAS;yCAAE,CAAC,MAAM;oBAAO,EAAE,EAAE,EAAE;gBAC7B,wCAAwC;gBACxC,YAAY,iBAAiB,CAAC;oBAAE,UAAU,SAAS,MAAM,CAAC;gBAAI;YAChE;;IACF;AACF;IAvCgB;;QACM,2MAAc;QAE3B,gMAAW;;;AAsCb,SAAS;;IACd,MAAM,cAAc,IAAA,2MAAc;IAElC,OAAO,IAAA,gMAAW,EAAC;QACjB,UAAU;yCAAE,CAAC,KAAe,0IAAQ,CAAC,UAAU,CAAC;;QAChD,SAAS;yCAAE,CAAC,GAAG;gBACb,oBAAoB;gBACpB,YAAY,aAAa,CAAC;oBAAE,UAAU,SAAS,MAAM,CAAC;gBAAW;gBAEjE,wBAAwB;gBACxB,YAAY,iBAAiB,CAAC;oBAAE,UAAU,SAAS,KAAK;gBAAG;gBAE3D,oJAAK,CAAC,OAAO,CAAC;YAChB;;QACA,OAAO;yCAAE,CAAC;gBACR,oJAAK,CAAC,KAAK,CAAC,AAAC,0BAAuC,OAAd,MAAM,OAAO;YACrD;;IACF;AACF;IAlBgB;;QACM,2MAAc;QAE3B,gMAAW;;;AAkBb,SAAS;;IACd,OAAO,SAAS;QACd,MAAM;QACN,MAAM;QACN,UAAU;IACZ;AACF;IANgB;;QACP;;;AAOF,SAAS;;IACd,OAAO,SAAS;QACd,MAAM;QACN,MAAM;QACN,UAAU;IACZ;AACF;IANgB;;QACP;;;AAOF,SAAS;;IACd,OAAO,SAAS;QACd,MAAM;QACN,MAAM;QACN,UAAU;IACZ;AACF;IANgB;;QACP","debugId":null}},
    {"offset": {"line": 1009, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/T7/cometa/cometa-separated-projects/cometa-frontend-nextjs/src/hooks/use-projects.ts"],"sourcesContent":["import { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { toast } from \"sonner\";\nimport {\n  projectsApi,\n  type Project,\n  type ProjectFilters,\n  type CreateProjectRequest,\n  type UpdateProjectRequest,\n  type PaginatedResponse,\n} from \"@/lib/api-client\";\n\n// Query keys\nexport const projectKeys = {\n  all: [\"projects\"] as const,\n  lists: () => [...projectKeys.all, \"list\"] as const,\n  list: (filters: ProjectFilters) => [...projectKeys.lists(), filters] as const,\n  details: () => [...projectKeys.all, \"detail\"] as const,\n  detail: (id: string) => [...projectKeys.details(), id] as const,\n};\n\n// Hooks\nexport function useProjects(filters?: ProjectFilters) {\n  return useQuery({\n    queryKey: projectKeys.list(filters || {}),\n    queryFn: () => projectsApi.getProjects(filters),\n    staleTime: 5 * 60 * 1000, // 5 minutes\n  });\n}\n\nexport function useProject(id: string) {\n  return useQuery({\n    queryKey: projectKeys.detail(id),\n    queryFn: () => projectsApi.getProject(id),\n    enabled: !!id,\n    staleTime: 5 * 60 * 1000, // 5 minutes\n  });\n}\n\nexport function useCreateProject() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: (data: CreateProjectRequest) => projectsApi.createProject(data),\n    onSuccess: (newProject) => {\n      // Invalidate and refetch projects list\n      queryClient.invalidateQueries({ queryKey: projectKeys.lists() });\n\n      // Add the new project to the cache\n      queryClient.setQueryData(projectKeys.detail(newProject.id), newProject);\n\n      toast.success(\"Project created successfully\");\n    },\n    onError: (error) => {\n      toast.error(`Failed to create project: ${error.message}`);\n    },\n  });\n}\n\nexport function useUpdateProject() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: ({ id, data }: { id: string; data: UpdateProjectRequest }) =>\n      projectsApi.updateProject(id, data),\n    onMutate: async ({ id, data }) => {\n      // Cancel any outgoing refetches\n      await queryClient.cancelQueries({ queryKey: projectKeys.detail(id) });\n\n      // Snapshot the previous value\n      const previousProject = queryClient.getQueryData(projectKeys.detail(id));\n\n      // Optimistically update to the new value\n      queryClient.setQueryData(projectKeys.detail(id), (old: Project | undefined) => {\n        if (!old) return old;\n        return { ...old, ...data };\n      });\n\n      // Return a context object with the snapshotted value\n      return { previousProject };\n    },\n    onError: (error, { id }, context) => {\n      // If the mutation fails, use the context returned from onMutate to roll back\n      if (context?.previousProject) {\n        queryClient.setQueryData(projectKeys.detail(id), context.previousProject);\n      }\n      toast.error(`Failed to update project: ${error.message}`);\n    },\n    onSuccess: (updatedProject) => {\n      // Invalidate and refetch projects list\n      queryClient.invalidateQueries({ queryKey: projectKeys.lists() });\n      toast.success(\"Project updated successfully\");\n    },\n    onSettled: (data, error, { id }) => {\n      // Always refetch after error or success\n      queryClient.invalidateQueries({ queryKey: projectKeys.detail(id) });\n    },\n  });\n}\n\nexport function useDeleteProject() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: (id: string) => projectsApi.deleteProject(id),\n    onSuccess: (_, deletedId) => {\n      // Remove from cache\n      queryClient.removeQueries({ queryKey: projectKeys.detail(deletedId) });\n\n      // Invalidate projects list\n      queryClient.invalidateQueries({ queryKey: projectKeys.lists() });\n\n      toast.success(\"Project deleted successfully\");\n    },\n    onError: (error) => {\n      toast.error(`Failed to delete project: ${error.message}`);\n    },\n  });\n}\n\n// Optimistic mutations for better UX\nexport function useOptimisticProjectUpdate() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: ({ id, data }: { id: string; data: Partial<Project> }) =>\n      projectsApi.updateProject(id, data),\n    onMutate: async ({ id, data }) => {\n      await queryClient.cancelQueries({ queryKey: projectKeys.detail(id) });\n\n      const previousProject = queryClient.getQueryData(projectKeys.detail(id));\n\n      queryClient.setQueryData(projectKeys.detail(id), (old: Project | undefined) => {\n        if (!old) return old;\n        return { ...old, ...data };\n      });\n\n      // Also update in lists if present\n      queryClient.setQueriesData(\n        { queryKey: projectKeys.lists() },\n        (old: PaginatedResponse<Project> | undefined) => {\n          if (!old) return old;\n\n          return {\n            ...old,\n            items: old.items.map((project) =>\n              project.id === id ? { ...project, ...data } : project\n            ),\n          };\n        }\n      );\n\n      return { previousProject };\n    },\n    onError: (error, { id }, context) => {\n      if (context?.previousProject) {\n        queryClient.setQueryData(projectKeys.detail(id), context.previousProject);\n      }\n      // Invalidate lists to revert optimistic updates\n      queryClient.invalidateQueries({ queryKey: projectKeys.lists() });\n      toast.error(`Failed to update project: ${error.message}`);\n    },\n    onSuccess: () => {\n      toast.success(\"Project updated successfully\");\n    },\n  });\n}\n\n// Project statistics hook\nexport interface ProjectStats {\n  progress: {\n    totalLength: number;\n    completedLength: number;\n    progressPercentage: number;\n    workEntries: number;\n    pendingApprovals: number;\n    teamMembers: number;\n    materialsCount: number;\n  };\n  phase: {\n    currentPhase: number;\n    totalPhases: number;\n    phaseName: string;\n    phaseProgress: number;\n  };\n  financial: {\n    projectBudget: number;\n    totalSpent: number;\n    spentPercentage: number;\n    remainingBudget: number;\n  };\n}\n\nexport function useProjectStats(projectId: string) {\n  return useQuery({\n    queryKey: [...projectKeys.detail(projectId), \"stats\"],\n    queryFn: async (): Promise<ProjectStats> => {\n      const response = await fetch(`/api/projects/${projectId}/stats`);\n      if (!response.ok) {\n        throw new Error('Failed to fetch project statistics');\n      }\n      return response.json();\n    },\n    staleTime: 2 * 60 * 1000, // 2 minutes - stats change more frequently\n    enabled: !!projectId,\n  });\n}"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AACA;AACA;;;;;AAUO,MAAM,cAAc;IACzB,KAAK;QAAC;KAAW;IACjB,OAAO,IAAM;eAAI,YAAY,GAAG;YAAE;SAAO;IACzC,MAAM,CAAC,UAA4B;eAAI,YAAY,KAAK;YAAI;SAAQ;IACpE,SAAS,IAAM;eAAI,YAAY,GAAG;YAAE;SAAS;IAC7C,QAAQ,CAAC,KAAe;eAAI,YAAY,OAAO;YAAI;SAAG;AACxD;AAGO,SAAS,YAAY,OAAwB;;IAClD,OAAO,IAAA,0LAAQ,EAAC;QACd,UAAU,YAAY,IAAI,CAAC,WAAW,CAAC;QACvC,OAAO;oCAAE,IAAM,6IAAW,CAAC,WAAW,CAAC;;QACvC,WAAW,IAAI,KAAK;IACtB;AACF;GANgB;;QACP,0LAAQ;;;AAOV,SAAS,WAAW,EAAU;;IACnC,OAAO,IAAA,0LAAQ,EAAC;QACd,UAAU,YAAY,MAAM,CAAC;QAC7B,OAAO;mCAAE,IAAM,6IAAW,CAAC,UAAU,CAAC;;QACtC,SAAS,CAAC,CAAC;QACX,WAAW,IAAI,KAAK;IACtB;AACF;IAPgB;;QACP,0LAAQ;;;AAQV,SAAS;;IACd,MAAM,cAAc,IAAA,2MAAc;IAElC,OAAO,IAAA,gMAAW,EAAC;QACjB,UAAU;4CAAE,CAAC,OAA+B,6IAAW,CAAC,aAAa,CAAC;;QACtE,SAAS;4CAAE,CAAC;gBACV,uCAAuC;gBACvC,YAAY,iBAAiB,CAAC;oBAAE,UAAU,YAAY,KAAK;gBAAG;gBAE9D,mCAAmC;gBACnC,YAAY,YAAY,CAAC,YAAY,MAAM,CAAC,WAAW,EAAE,GAAG;gBAE5D,oJAAK,CAAC,OAAO,CAAC;YAChB;;QACA,OAAO;4CAAE,CAAC;gBACR,oJAAK,CAAC,KAAK,CAAC,AAAC,6BAA0C,OAAd,MAAM,OAAO;YACxD;;IACF;AACF;IAlBgB;;QACM,2MAAc;QAE3B,gMAAW;;;AAiBb,SAAS;;IACd,MAAM,cAAc,IAAA,2MAAc;IAElC,OAAO,IAAA,gMAAW,EAAC;QACjB,UAAU;4CAAE;oBAAC,EAAE,EAAE,EAAE,IAAI,EAA8C;uBACnE,6IAAW,CAAC,aAAa,CAAC,IAAI;;;QAChC,QAAQ;4CAAE;oBAAO,EAAE,EAAE,EAAE,IAAI,EAAE;gBAC3B,gCAAgC;gBAChC,MAAM,YAAY,aAAa,CAAC;oBAAE,UAAU,YAAY,MAAM,CAAC;gBAAI;gBAEnE,8BAA8B;gBAC9B,MAAM,kBAAkB,YAAY,YAAY,CAAC,YAAY,MAAM,CAAC;gBAEpE,yCAAyC;gBACzC,YAAY,YAAY,CAAC,YAAY,MAAM,CAAC;oDAAK,CAAC;wBAChD,IAAI,CAAC,KAAK,OAAO;wBACjB,OAAO;4BAAE,GAAG,GAAG;4BAAE,GAAG,IAAI;wBAAC;oBAC3B;;gBAEA,qDAAqD;gBACrD,OAAO;oBAAE;gBAAgB;YAC3B;;QACA,OAAO;4CAAE,CAAC,cAAe;oBAAR,EAAE,EAAE,EAAE;gBACrB,6EAA6E;gBAC7E,IAAI,oBAAA,8BAAA,QAAS,eAAe,EAAE;oBAC5B,YAAY,YAAY,CAAC,YAAY,MAAM,CAAC,KAAK,QAAQ,eAAe;gBAC1E;gBACA,oJAAK,CAAC,KAAK,CAAC,AAAC,6BAA0C,OAAd,MAAM,OAAO;YACxD;;QACA,SAAS;4CAAE,CAAC;gBACV,uCAAuC;gBACvC,YAAY,iBAAiB,CAAC;oBAAE,UAAU,YAAY,KAAK;gBAAG;gBAC9D,oJAAK,CAAC,OAAO,CAAC;YAChB;;QACA,SAAS;4CAAE,CAAC,MAAM;oBAAO,EAAE,EAAE,EAAE;gBAC7B,wCAAwC;gBACxC,YAAY,iBAAiB,CAAC;oBAAE,UAAU,YAAY,MAAM,CAAC;gBAAI;YACnE;;IACF;AACF;IAvCgB;;QACM,2MAAc;QAE3B,gMAAW;;;AAsCb,SAAS;;IACd,MAAM,cAAc,IAAA,2MAAc;IAElC,OAAO,IAAA,gMAAW,EAAC;QACjB,UAAU;4CAAE,CAAC,KAAe,6IAAW,CAAC,aAAa,CAAC;;QACtD,SAAS;4CAAE,CAAC,GAAG;gBACb,oBAAoB;gBACpB,YAAY,aAAa,CAAC;oBAAE,UAAU,YAAY,MAAM,CAAC;gBAAW;gBAEpE,2BAA2B;gBAC3B,YAAY,iBAAiB,CAAC;oBAAE,UAAU,YAAY,KAAK;gBAAG;gBAE9D,oJAAK,CAAC,OAAO,CAAC;YAChB;;QACA,OAAO;4CAAE,CAAC;gBACR,oJAAK,CAAC,KAAK,CAAC,AAAC,6BAA0C,OAAd,MAAM,OAAO;YACxD;;IACF;AACF;IAlBgB;;QACM,2MAAc;QAE3B,gMAAW;;;AAkBb,SAAS;;IACd,MAAM,cAAc,IAAA,2MAAc;IAElC,OAAO,IAAA,gMAAW,EAAC;QACjB,UAAU;sDAAE;oBAAC,EAAE,EAAE,EAAE,IAAI,EAA0C;uBAC/D,6IAAW,CAAC,aAAa,CAAC,IAAI;;;QAChC,QAAQ;sDAAE;oBAAO,EAAE,EAAE,EAAE,IAAI,EAAE;gBAC3B,MAAM,YAAY,aAAa,CAAC;oBAAE,UAAU,YAAY,MAAM,CAAC;gBAAI;gBAEnE,MAAM,kBAAkB,YAAY,YAAY,CAAC,YAAY,MAAM,CAAC;gBAEpE,YAAY,YAAY,CAAC,YAAY,MAAM,CAAC;8DAAK,CAAC;wBAChD,IAAI,CAAC,KAAK,OAAO;wBACjB,OAAO;4BAAE,GAAG,GAAG;4BAAE,GAAG,IAAI;wBAAC;oBAC3B;;gBAEA,kCAAkC;gBAClC,YAAY,cAAc,CACxB;oBAAE,UAAU,YAAY,KAAK;gBAAG;8DAChC,CAAC;wBACC,IAAI,CAAC,KAAK,OAAO;wBAEjB,OAAO;4BACL,GAAG,GAAG;4BACN,OAAO,IAAI,KAAK,CAAC,GAAG;0EAAC,CAAC,UACpB,QAAQ,EAAE,KAAK,KAAK;wCAAE,GAAG,OAAO;wCAAE,GAAG,IAAI;oCAAC,IAAI;;wBAElD;oBACF;;gBAGF,OAAO;oBAAE;gBAAgB;YAC3B;;QACA,OAAO;sDAAE,CAAC,cAAe;oBAAR,EAAE,EAAE,EAAE;gBACrB,IAAI,oBAAA,8BAAA,QAAS,eAAe,EAAE;oBAC5B,YAAY,YAAY,CAAC,YAAY,MAAM,CAAC,KAAK,QAAQ,eAAe;gBAC1E;gBACA,gDAAgD;gBAChD,YAAY,iBAAiB,CAAC;oBAAE,UAAU,YAAY,KAAK;gBAAG;gBAC9D,oJAAK,CAAC,KAAK,CAAC,AAAC,6BAA0C,OAAd,MAAM,OAAO;YACxD;;QACA,SAAS;sDAAE;gBACT,oJAAK,CAAC,OAAO,CAAC;YAChB;;IACF;AACF;IA7CgB;;QACM,2MAAc;QAE3B,gMAAW;;;AAqEb,SAAS,gBAAgB,SAAiB;;IAC/C,OAAO,IAAA,0LAAQ,EAAC;QACd,UAAU;eAAI,YAAY,MAAM,CAAC;YAAY;SAAQ;QACrD,OAAO;wCAAE;gBACP,MAAM,WAAW,MAAM,MAAM,AAAC,iBAA0B,OAAV,WAAU;gBACxD,IAAI,CAAC,SAAS,EAAE,EAAE;oBAChB,MAAM,IAAI,MAAM;gBAClB;gBACA,OAAO,SAAS,IAAI;YACtB;;QACA,WAAW,IAAI,KAAK;QACpB,SAAS,CAAC,CAAC;IACb;AACF;IAbgB;;QACP,0LAAQ","debugId":null}},
    {"offset": {"line": 1329, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/T7/cometa/cometa-separated-projects/cometa-frontend-nextjs/src/hooks/use-equipment.ts"],"sourcesContent":["import { useMutation, useQuery, useQueryClient } from '@tanstack/react-query';\nimport { toast } from 'sonner';\n\nexport interface Equipment {\n  id: string;\n  type: 'machine' | 'tool' | 'measuring_device';\n  name: string;\n  inventory_no?: string;\n  owned: boolean;\n  status: 'available' | 'in_use' | 'maintenance' | 'broken';\n  purchase_price_eur: number;\n  rental_price_per_day_eur: number;\n  rental_price_per_hour_eur: number;\n  current_location?: string;\n  quantity?: number; // Available quantity in inventory\n}\n\nexport interface EquipmentAssignment {\n  id: string;\n  equipment_id: string;\n  resource_id?: string; // For unified assignments\n  project_id?: string; // Now optional - crew-based logic\n  cabinet_id?: string;\n  crew_id: string; // Now required - crew-based logic\n  from_ts: string;\n  to_ts?: string;\n  is_permanent: boolean;\n  rental_cost_per_day: number;\n  equipment: {\n    name: string;\n    type: string;\n    inventory_no?: string;\n  };\n  project_name?: string;\n  crew_name?: string;\n  is_active: boolean;\n  assignment_type?: 'equipment' | 'vehicle'; // For unified assignments\n  resource_type?: 'equipment' | 'vehicle'; // For UI distinction\n}\n\nexport interface CreateEquipmentData {\n  type: string;\n  name: string;\n  inventory_no?: string;\n  owned?: boolean;\n  status?: string;\n  purchase_price_eur?: number;\n  rental_price_per_day_eur?: number;\n  rental_price_per_hour_eur?: number;\n  current_location?: string;\n}\n\nexport interface CreateAssignmentData {\n  equipment_id: string;\n  project_id?: string; // Now optional - crew-based logic\n  cabinet_id?: string;\n  crew_id: string; // Now required - crew-based logic\n  from_ts: string;\n  to_ts?: string;\n  is_permanent?: boolean;\n  rental_cost_per_day?: number;\n}\n\nexport interface EquipmentAnalytics {\n  overview: {\n    totalHours: number;\n    efficiencyScore: number;\n    downtimeRate: number;\n    revenueGenerated: number;\n  };\n  statusDistribution: {\n    name: string;\n    value: number;\n    color: string;\n  }[];\n  utilization: {\n    name: string;\n    hours: number;\n    revenue: number;\n    assignments: number;\n  }[];\n  assignments: {\n    total: number;\n    active: number;\n    averageDailyCost: number;\n    totalDailyRevenue: number;\n    averageDuration: number;\n  };\n  equipment: {\n    totalCount: number;\n    byType: Record<string, { count: number; value: number }>;\n    byStatus: Record<string, number>;\n  };\n}\n\ninterface EquipmentFilters {\n  type?: string;\n  status?: string;\n  owned?: string;\n  search?: string;\n  page?: number;\n  per_page?: number;\n}\n\ninterface AssignmentFilters {\n  equipment_id?: string;\n  project_id?: string;\n  crew_id?: string;\n  active_only?: boolean;\n}\n\nconst api = {\n  getEquipment: async (filters?: EquipmentFilters): Promise<{ items: Equipment[]; total: number; page: number; per_page: number; total_pages: number }> => {\n    const params = new URLSearchParams();\n    if (filters?.type) params.append('type', filters.type);\n    if (filters?.status) params.append('status', filters.status);\n    if (filters?.owned) params.append('owned', filters.owned);\n    if (filters?.search) params.append('search', filters.search);\n    if (filters?.page) params.append('page', filters.page.toString());\n    if (filters?.per_page) params.append('per_page', filters.per_page.toString());\n\n    const url = `/api/equipment${params.toString() ? `?${params.toString()}` : ''}`;\n    const response = await fetch(url);\n\n    if (!response.ok) {\n      throw new Error('Failed to fetch equipment');\n    }\n\n    return response.json();\n  },\n\n  getEquipmentItem: async (id: string): Promise<Equipment> => {\n    const response = await fetch(`/api/equipment/${id}`);\n\n    if (!response.ok) {\n      throw new Error('Failed to fetch equipment');\n    }\n\n    return response.json();\n  },\n\n  createEquipment: async (data: CreateEquipmentData): Promise<Equipment> => {\n    const response = await fetch('/api/equipment', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(data),\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.error || 'Failed to create equipment');\n    }\n\n    return response.json();\n  },\n\n  updateEquipment: async (id: string, data: Partial<Equipment>): Promise<{ success: boolean }> => {\n    const response = await fetch(`/api/equipment/${id}`, {\n      method: 'PUT',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(data),\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.error || 'Failed to update equipment');\n    }\n\n    return response.json();\n  },\n\n  deleteEquipment: async (id: string): Promise<{ success: boolean }> => {\n    const response = await fetch(`/api/equipment/${id}`, {\n      method: 'DELETE',\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.error || 'Failed to delete equipment');\n    }\n\n    return response.json();\n  },\n\n  getAssignments: async (filters?: AssignmentFilters): Promise<EquipmentAssignment[]> => {\n    const params = new URLSearchParams();\n    if (filters?.equipment_id) params.append('equipment_id', filters.equipment_id);\n    if (filters?.project_id) params.append('project_id', filters.project_id);\n    if (filters?.crew_id) params.append('crew_id', filters.crew_id);\n    if (filters?.active_only) params.append('active_only', filters.active_only.toString());\n\n    // Use our new equipment assignments API\n    const url = `/api/equipment/assignments${params.toString() ? `?${params.toString()}` : ''}`;\n    const response = await fetch(url);\n\n    if (!response.ok) {\n      throw new Error('Failed to fetch equipment assignments');\n    }\n\n    const data = await response.json();\n\n    // Transform our API response to match expected format\n    const assignments = data.items || data;\n\n    // For now, use basic transformation. TODO: Enhance with actual equipment/crew names\n    return assignments.map((assignment: any) => ({\n      id: assignment.id,\n      equipment_id: assignment.equipment_id || assignment.resource_id,\n      project_id: assignment.project_id,\n      crew_id: assignment.crew_id,\n      from_ts: assignment.assigned_at,\n      to_ts: assignment.returned_at,\n      is_permanent: !assignment.returned_at, // If no return date, consider permanent\n      rental_cost_per_day: assignment.daily_rental_cost || 0,\n      equipment: {\n        name: assignment.equipment_name || `Equipment ${assignment.equipment_id?.slice(-8) || 'Unknown'}`,\n        type: assignment.resource_type || 'equipment',\n        inventory_no: assignment.equipment_id\n      },\n      project_name: assignment.project_name || (assignment.project_id ? `Project ${assignment.project_id.slice(-8)}` : undefined),\n      crew_name: assignment.crew_name || (assignment.crew_id ? `Crew ${assignment.crew_id.slice(-8)}` : undefined),\n      is_active: !assignment.returned_at,\n      assignment_type: assignment.resource_type,\n      resource_type: assignment.resource_type,\n      notes: assignment.notes\n    }));\n  },\n\n  createAssignment: async (data: CreateAssignmentData): Promise<{ success: boolean; assignment_id: string; message: string }> => {\n    const response = await fetch('/api/resources/equipment-assignments', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(data),\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.error || 'Failed to create assignment');\n    }\n\n    return response.json();\n  },\n\n  updateAssignment: async (id: string, data: Partial<EquipmentAssignment>): Promise<{ success: boolean; message: string }> => {\n    const response = await fetch(`/api/resources/equipment-assignments/${id}`, {\n      method: 'PUT',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(data),\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.error || 'Failed to update assignment');\n    }\n\n    return response.json();\n  },\n\n  deleteAssignment: async (id: string): Promise<{ success: boolean; message: string }> => {\n    const response = await fetch(`/api/resources/equipment-assignments/${id}`, {\n      method: 'DELETE',\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.error || 'Failed to delete assignment');\n    }\n\n    return response.json();\n  },\n\n  getAnalytics: async (): Promise<EquipmentAnalytics> => {\n    const response = await fetch('/api/equipment/analytics');\n\n    if (!response.ok) {\n      throw new Error('Failed to fetch equipment analytics');\n    }\n\n    return response.json();\n  },\n};\n\nexport function useEquipment(filters?: EquipmentFilters) {\n  return useQuery({\n    queryKey: ['equipment', filters],\n    queryFn: () => api.getEquipment(filters),\n  });\n}\n\nexport function useEquipmentItem(id: string) {\n  return useQuery({\n    queryKey: ['equipment', id],\n    queryFn: () => api.getEquipmentItem(id),\n    enabled: !!id,\n  });\n}\n\nexport function useCreateEquipment() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: api.createEquipment,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['equipment'] });\n      toast.success('Equipment created successfully');\n    },\n    onError: (error: Error) => {\n      toast.error(error.message);\n    },\n  });\n}\n\nexport function useUpdateEquipment() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: ({ id, data }: { id: string; data: Partial<Equipment> }) =>\n      api.updateEquipment(id, data),\n    onSuccess: (_, { id }) => {\n      queryClient.invalidateQueries({ queryKey: ['equipment'] });\n      queryClient.invalidateQueries({ queryKey: ['equipment', id] });\n      toast.success('Equipment updated successfully');\n    },\n    onError: (error: Error) => {\n      toast.error(error.message);\n    },\n  });\n}\n\nexport function useDeleteEquipment() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: api.deleteEquipment,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['equipment'] });\n      toast.success('Equipment deleted successfully');\n    },\n    onError: (error: Error) => {\n      toast.error(error.message);\n    },\n  });\n}\n\nexport function useEquipmentAssignments(filters?: AssignmentFilters) {\n  return useQuery({\n    queryKey: ['equipment-assignments', filters],\n    queryFn: () => api.getAssignments(filters),\n    staleTime: 30 * 1000, // 30 seconds - crew assignments change frequently\n  });\n}\n\nexport function useCreateAssignment() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: api.createAssignment,\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: ['equipment-assignments'] });\n      queryClient.invalidateQueries({ queryKey: ['equipment'] });\n      queryClient.invalidateQueries({ queryKey: ['crews'] }); // Also invalidate crew queries\n      toast.success(data.message || 'Assignment created successfully');\n    },\n    onError: (error: Error) => {\n      // Enhanced error handling for crew validation\n      if (error.message.includes('Crew not found') || error.message.includes('CREW_NOT_FOUND')) {\n        toast.error('Selected crew is not found or inactive. Please select a valid crew.');\n      } else if (error.message.includes('crew_id') || error.message.includes('Crew ID')) {\n        toast.error('Crew selection is required. Please select a crew for this assignment.');\n      } else {\n        toast.error(error.message);\n      }\n    },\n  });\n}\n\nexport function useUpdateAssignment() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: ({ id, data }: { id: string; data: Partial<EquipmentAssignment> }) =>\n      api.updateAssignment(id, data),\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: ['equipment-assignments'] });\n      queryClient.invalidateQueries({ queryKey: ['equipment'] });\n      toast.success(data.message || 'Assignment updated successfully');\n    },\n    onError: (error: Error) => {\n      toast.error(error.message);\n    },\n  });\n}\n\nexport function useDeleteAssignment() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: api.deleteAssignment,\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: ['equipment-assignments'] });\n      queryClient.invalidateQueries({ queryKey: ['equipment'] });\n      toast.success(data.message || 'Assignment deleted successfully');\n    },\n    onError: (error: Error) => {\n      toast.error(error.message);\n    },\n  });\n}\n\nexport function useEquipmentAnalytics() {\n  return useQuery({\n    queryKey: ['equipment-analytics'],\n    queryFn: () => api.getAnalytics(),\n    staleTime: 5 * 60 * 1000, // 5 minutes\n  });\n}\n\n// New hook for crew-based equipment assignments (only equipment)\nexport function useCrewEquipmentAssignments(crew_id?: string) {\n  return useQuery({\n    queryKey: ['equipment-assignments', 'crew', crew_id],\n    queryFn: async () => {\n      const response = await fetch(`/api/resources/equipment-assignments?crew_id=${crew_id}&active_only=true`);\n      if (!response.ok) {\n        throw new Error('Failed to fetch equipment assignments');\n      }\n      return response.json();\n    },\n    enabled: !!crew_id,\n    staleTime: 30 * 1000, // 30 seconds - crew assignments change frequently\n  });\n}\n\n// Hook for getting equipment assignments by project (filtered through crew assignments)\nexport function useProjectEquipmentAssignments(project_id?: string) {\n  return useQuery({\n    queryKey: ['equipment-assignments', 'project', project_id],\n    queryFn: () => api.getAssignments({ project_id }),\n    enabled: !!project_id,\n    staleTime: 60 * 1000, // 1 minute - project assignments are more stable\n  });\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1847, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/T7/cometa/cometa-separated-projects/cometa-frontend-nextjs/src/hooks/use-vehicles.ts"],"sourcesContent":["import { useMutation, useQuery, useQueryClient } from '@tanstack/react-query';\nimport { toast } from 'sonner';\n\nexport interface Vehicle {\n  id: string;\n  brand: string;\n  model: string;\n  plate_number: string;\n  type: 'van' | 'truck' | 'trailer' | 'excavator' | 'other' | 'car';\n  status: 'available' | 'in_use' | 'maintenance' | 'broken';\n  rental_cost_per_day: number;\n  fuel_type?: string;\n  year_manufactured?: number;\n  description?: string;\n  is_active: boolean;\n  full_name?: string;\n  age?: number;\n  current_assignment?: any;\n  assignments_count?: number;\n  created_at?: string;\n  updated_at?: string;\n}\n\nexport interface VehicleAssignment {\n  id: string;\n  vehicle_id: string;\n  project_id?: string; // Now optional - crew-based logic\n  crew_id: string; // Now required - crew-based logic\n  from_ts: string;\n  to_ts?: string;\n  is_permanent: boolean;\n  rental_cost_per_day: number;\n  vehicle: {\n    brand: string;\n    model: string;\n    plate_number: string;\n    type: string;\n  };\n  project_name?: string;\n  crew_name?: string;\n  is_active: boolean;\n}\n\nexport interface CreateVehicleData {\n  brand: string;\n  model: string;\n  plate_number: string;\n  type: string;\n  status?: string;\n  rental_cost_per_day?: number;\n  fuel_type?: string;\n  year_manufactured?: number;\n  description?: string;\n}\n\nexport interface CreateVehicleAssignmentData {\n  vehicle_id: string;\n  project_id?: string; // Now optional - crew-based logic\n  crew_id: string; // Now required - crew-based logic\n  from_ts: string;\n  to_ts?: string;\n  is_permanent?: boolean;\n  rental_cost_per_day?: number;\n}\n\nexport interface VehicleAnalytics {\n  overview: {\n    totalHours: number;\n    efficiencyScore: number;\n    downtimeRate: number;\n    revenueGenerated: number;\n  };\n  statusDistribution: {\n    name: string;\n    value: number;\n    color: string;\n  }[];\n  utilization: {\n    name: string;\n    hours: number;\n    revenue: number;\n    assignments: number;\n  }[];\n  assignments: {\n    total: number;\n    active: number;\n    averageDailyCost: number;\n    totalDailyRevenue: number;\n    averageDuration: number;\n  };\n  vehicles: {\n    totalCount: number;\n    byType: Record<string, { count: number; value: number }>;\n    byStatus: Record<string, number>;\n  };\n}\n\ninterface VehicleFilters {\n  type?: string;\n  status?: string;\n  owned?: string;\n  search?: string;\n  page?: number;\n  per_page?: number;\n}\n\ninterface VehicleAssignmentFilters {\n  vehicle_id?: string;\n  project_id?: string;\n  crew_id?: string;\n  active_only?: boolean;\n}\n\nconst api = {\n  getVehicles: async (filters?: VehicleFilters): Promise<{ items: Vehicle[]; total: number; page: number; per_page: number; total_pages: number }> => {\n    const params = new URLSearchParams();\n    if (filters?.type) params.append('type', filters.type);\n    if (filters?.status) params.append('status', filters.status);\n    if (filters?.owned) params.append('owned', filters.owned);\n    if (filters?.search) params.append('search', filters.search);\n    if (filters?.page) params.append('page', filters.page.toString());\n    if (filters?.per_page) params.append('per_page', filters.per_page.toString());\n\n    const url = `/api/vehicles${params.toString() ? `?${params.toString()}` : ''}`;\n    const response = await fetch(url);\n\n    if (!response.ok) {\n      throw new Error('Failed to fetch vehicles');\n    }\n\n    const data = await response.json();\n\n    // Transform the API response to match expected format\n    return {\n      items: data.vehicles || [],\n      total: data.pagination?.total || 0,\n      page: data.pagination?.page || 1,\n      per_page: data.pagination?.per_page || 20,\n      total_pages: data.pagination?.total_pages || 1\n    };\n  },\n\n  getVehicle: async (id: string): Promise<Vehicle> => {\n    const response = await fetch(`/api/vehicles/${id}`);\n\n    if (!response.ok) {\n      throw new Error('Failed to fetch vehicle');\n    }\n\n    return response.json();\n  },\n\n  createVehicle: async (data: CreateVehicleData): Promise<Vehicle> => {\n    const response = await fetch('/api/vehicles', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(data),\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.error || 'Failed to create vehicle');\n    }\n\n    const result = await response.json();\n    return result.vehicle || result;\n  },\n\n  updateVehicle: async (id: string, data: Partial<Vehicle>): Promise<{ success: boolean }> => {\n    const response = await fetch(`/api/vehicles/${id}`, {\n      method: 'PUT',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(data),\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.error || 'Failed to update vehicle');\n    }\n\n    return response.json();\n  },\n\n  deleteVehicle: async (id: string): Promise<{ success: boolean }> => {\n    const response = await fetch(`/api/vehicles/${id}`, {\n      method: 'DELETE',\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.error || 'Failed to delete vehicle');\n    }\n\n    return response.json();\n  },\n\n  getVehicleAssignments: async (filters?: VehicleAssignmentFilters): Promise<VehicleAssignment[]> => {\n    const params = new URLSearchParams();\n    if (filters?.vehicle_id) params.append('vehicle_id', filters.vehicle_id);\n    if (filters?.project_id) params.append('project_id', filters.project_id);\n    if (filters?.crew_id) params.append('crew_id', filters.crew_id);\n    if (filters?.active_only) params.append('active_only', filters.active_only.toString());\n\n    // Use new vehicles/assignments endpoint for crew-based logic\n    const url = `/api/resources/vehicle-assignments${params.toString() ? `?${params.toString()}` : ''}`;\n    const response = await fetch(url);\n\n    if (!response.ok) {\n      throw new Error('Failed to fetch vehicle assignments');\n    }\n\n    return response.json();\n  },\n\n  createVehicleAssignment: async (data: CreateVehicleAssignmentData): Promise<{ success: boolean; assignment_id: string; message: string }> => {\n    // Use new vehicles/assignments endpoint with crew-based logic\n    const response = await fetch('/api/resources/vehicle-assignments', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        vehicle_id: data.vehicle_id,\n        crew_id: data.crew_id, // Now required\n        project_id: data.project_id, // Now optional\n        from_ts: data.from_ts,\n        to_ts: data.to_ts,\n        is_permanent: data.is_permanent || false,\n        rental_cost_per_day: data.rental_cost_per_day\n      }),\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.error || 'Failed to create vehicle assignment');\n    }\n\n    return response.json();\n  },\n\n  updateVehicleAssignment: async (id: string, data: Partial<VehicleAssignment>): Promise<{ success: boolean; message: string }> => {\n    // Use new vehicles/assignments endpoint\n    const response = await fetch(`/api/resources/vehicle-assignments/${id}`, {\n      method: 'PUT',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(data),\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.error || 'Failed to update vehicle assignment');\n    }\n\n    return response.json();\n  },\n\n  deleteVehicleAssignment: async (id: string): Promise<{ success: boolean; message: string }> => {\n    // Use new vehicles/assignments endpoint\n    const response = await fetch(`/api/resources/vehicle-assignments/${id}`, {\n      method: 'DELETE',\n    });\n\n    if (!response.ok) {\n      const error = await response.json();\n      throw new Error(error.error || 'Failed to delete vehicle assignment');\n    }\n\n    return response.json();\n  },\n\n  getAvailableVehicles: async (): Promise<Vehicle[]> => {\n    const response = await fetch('/api/resources/vehicles/available');\n\n    if (!response.ok) {\n      throw new Error('Failed to fetch available vehicles');\n    }\n\n    return response.json();\n  },\n\n  getVehicleAnalytics: async (): Promise<VehicleAnalytics> => {\n    const response = await fetch('/api/vehicles/analytics');\n\n    if (!response.ok) {\n      throw new Error('Failed to fetch vehicle analytics');\n    }\n\n    return response.json();\n  },\n};\n\nexport function useVehicles(filters?: VehicleFilters) {\n  return useQuery({\n    queryKey: ['vehicles', filters],\n    queryFn: () => api.getVehicles(filters),\n  });\n}\n\nexport function useVehicle(id: string) {\n  return useQuery({\n    queryKey: ['vehicles', id],\n    queryFn: () => api.getVehicle(id),\n    enabled: !!id,\n  });\n}\n\nexport function useCreateVehicle() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: api.createVehicle,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['vehicles'] });\n      toast.success('Vehicle created successfully');\n    },\n    onError: (error: Error) => {\n      toast.error(error.message);\n    },\n  });\n}\n\nexport function useUpdateVehicle() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: ({ id, data }: { id: string; data: Partial<Vehicle> }) =>\n      api.updateVehicle(id, data),\n    onSuccess: (_, { id }) => {\n      queryClient.invalidateQueries({ queryKey: ['vehicles'] });\n      queryClient.invalidateQueries({ queryKey: ['vehicles', id] });\n      toast.success('Vehicle updated successfully');\n    },\n    onError: (error: Error) => {\n      toast.error(error.message);\n    },\n  });\n}\n\nexport function useDeleteVehicle() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: api.deleteVehicle,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['vehicles'] });\n      toast.success('Vehicle deleted successfully');\n    },\n    onError: (error: Error) => {\n      toast.error(error.message);\n    },\n  });\n}\n\nexport function useVehicleAssignments(filters?: VehicleAssignmentFilters) {\n  return useQuery({\n    queryKey: ['vehicle-assignments', filters],\n    queryFn: () => api.getVehicleAssignments(filters),\n    staleTime: 30 * 1000, // 30 seconds - crew assignments change frequently\n  });\n}\n\nexport function useCreateVehicleAssignment() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: api.createVehicleAssignment,\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: ['vehicle-assignments'] });\n      queryClient.invalidateQueries({ queryKey: ['vehicles'] });\n      queryClient.invalidateQueries({ queryKey: ['crews'] }); // Also invalidate crew queries\n      toast.success(data.message || 'Vehicle assignment created successfully');\n    },\n    onError: (error: Error) => {\n      // Enhanced error handling for crew validation\n      if (error.message.includes('Crew not found') || error.message.includes('CREW_NOT_FOUND')) {\n        toast.error('Selected crew is not found or inactive. Please select a valid crew.');\n      } else if (error.message.includes('crew_id') || error.message.includes('Crew ID')) {\n        toast.error('Crew selection is required. Please select a crew for this assignment.');\n      } else {\n        toast.error(error.message);\n      }\n    },\n  });\n}\n\nexport function useUpdateVehicleAssignment() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: ({ id, data }: { id: string; data: Partial<VehicleAssignment> }) =>\n      api.updateVehicleAssignment(id, data),\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: ['vehicle-assignments'] });\n      queryClient.invalidateQueries({ queryKey: ['vehicles'] });\n      toast.success(data.message || 'Vehicle assignment updated successfully');\n    },\n    onError: (error: Error) => {\n      toast.error(error.message);\n    },\n  });\n}\n\nexport function useDeleteVehicleAssignment() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: api.deleteVehicleAssignment,\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: ['vehicle-assignments'] });\n      queryClient.invalidateQueries({ queryKey: ['vehicles'] });\n      toast.success(data.message || 'Vehicle assignment deleted successfully');\n    },\n    onError: (error: Error) => {\n      toast.error(error.message);\n    },\n  });\n}\n\nexport function useAvailableVehicles() {\n  return useQuery({\n    queryKey: ['vehicles', 'available'],\n    queryFn: () => api.getAvailableVehicles(),\n    staleTime: 30 * 1000, // 30 seconds\n  });\n}\n\nexport function useVehicleAnalytics() {\n  return useQuery({\n    queryKey: ['vehicle-analytics'],\n    queryFn: () => api.getVehicleAnalytics(),\n    staleTime: 5 * 60 * 1000, // 5 minutes\n  });\n}\n\n// New hook for crew-based vehicle assignments (only vehicles)\nexport function useCrewVehicleAssignments(crew_id?: string) {\n  return useQuery({\n    queryKey: ['vehicle-assignments', 'crew', crew_id],\n    queryFn: async () => {\n      const response = await fetch(`/api/resources/vehicle-assignments?crew_id=${crew_id}&active_only=true`);\n      if (!response.ok) {\n        throw new Error('Failed to fetch vehicle assignments');\n      }\n      return response.json();\n    },\n    enabled: !!crew_id,\n    staleTime: 30 * 1000, // 30 seconds - crew assignments change frequently\n  });\n}\n\n// Hook for getting vehicle assignments by project (filtered through crew assignments)\nexport function useProjectVehicleAssignments(project_id?: string) {\n  return useQuery({\n    queryKey: ['vehicle-assignments', 'project', project_id],\n    queryFn: () => api.getVehicleAssignments({ project_id }),\n    enabled: !!project_id,\n    staleTime: 60 * 1000, // 1 minute - project assignments are more stable\n  });\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2386, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/T7/cometa/cometa-separated-projects/cometa-frontend-nextjs/src/components/ui/textarea.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n"],"names":[],"mappings":";;;;;AAAA;AAEA;;;;AAEA,MAAM,yBAAW,2KAAgB,MAG/B,QAA0B;QAAzB,EAAE,SAAS,EAAE,GAAG,OAAO;IACxB,qBACE,6LAAC;QACC,WAAW,IAAA,4HAAE,EACX,qTACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;;AACA,SAAS,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 2421, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/T7/cometa/cometa-separated-projects/cometa-frontend-nextjs/src/components/ui/progress.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAEA;AALA;;;;;AAOA,MAAM,yBAAW,2KAAgB,MAG/B,QAAiC;QAAhC,EAAE,SAAS,EAAE,KAAK,EAAE,GAAG,OAAO;yBAC/B,6LAAC,+KAAsB;QACrB,KAAK;QACL,WAAW,IAAA,4HAAE,EACX,iEACA;QAED,GAAG,KAAK;kBAET,cAAA,6LAAC,oLAA2B;YAC1B,WAAU;YACV,OAAO;gBAAE,WAAW,AAAC,eAAiC,OAAnB,MAAM,CAAC,SAAS,CAAC,GAAE;YAAI;;;;;;;;;;;;;AAIhE,SAAS,WAAW,GAAG,+KAAsB,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 2469, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/T7/cometa/cometa-separated-projects/cometa-frontend-nextjs/src/hooks/use-documents.ts"],"sourcesContent":["'use client';\n\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { toast } from 'sonner';\nimport type {\n  WorkerDocument,\n  DocumentCategory,\n  DocumentsResponse,\n  DocumentStatus,\n  DocumentCategoryCode\n} from '@/types';\n\nexport interface DocumentFilters {\n  user_id?: string;\n  category_code?: DocumentCategoryCode;\n  status?: DocumentStatus;\n  search?: string;\n  page?: number;\n  per_page?: number;\n}\n\nexport interface CreateDocumentRequest {\n  user_id: string;\n  category_id: string;\n  document_number?: string;\n  issuing_authority?: string;\n  issue_date?: string;\n  expiry_date?: string;\n  valid_until?: string;\n  file_url: string;\n  file_name: string;\n  file_size?: number;\n  file_type: string;\n  notes?: string;\n}\n\nexport interface VerifyDocumentRequest {\n  document_id: string;\n  verified: boolean;\n  notes?: string;\n}\n\n// Query keys\nexport const documentKeys = {\n  all: ['documents'] as const,\n  lists: () => [...documentKeys.all, 'list'] as const,\n  list: (filters: DocumentFilters) => [...documentKeys.lists(), filters] as const,\n  categories: () => [...documentKeys.all, 'categories'] as const,\n  stats: () => [...documentKeys.all, 'stats'] as const,\n};\n\n// Fetch documents with filters\nexport function useDocuments(filters: DocumentFilters = {}) {\n  const searchParams = new URLSearchParams();\n\n  Object.entries(filters).forEach(([key, value]) => {\n    if (value !== undefined && value !== null && value !== '') {\n      searchParams.append(key, value.toString());\n    }\n  });\n\n  return useQuery({\n    queryKey: documentKeys.list(filters),\n    queryFn: async (): Promise<DocumentsResponse> => {\n      const response = await fetch(`/api/documents?${searchParams.toString()}`);\n      if (!response.ok) {\n        throw new Error('Failed to fetch documents');\n      }\n      return response.json();\n    },\n  });\n}\n\n// Upload new document\nexport function useUploadDocument() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async (data: CreateDocumentRequest) => {\n      const response = await fetch('/api/documents', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(data),\n      });\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'Failed to upload document');\n      }\n\n      return response.json();\n    },\n    onSuccess: () => {\n      // Invalidate all document queries to refresh data\n      queryClient.invalidateQueries({ queryKey: documentKeys.all });\n      toast.success('Document uploaded successfully');\n    },\n    onError: (error: Error) => {\n      console.error('Failed to upload document:', error);\n      toast.error(error.message || 'Failed to upload document');\n    },\n  });\n}\n\n// Verify document\nexport function useVerifyDocument() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async (data: VerifyDocumentRequest) => {\n      const response = await fetch(`/api/documents/${data.document_id}/verify`, {\n        method: 'PATCH',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          verified: data.verified,\n          notes: data.notes,\n        }),\n      });\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'Failed to verify document');\n      }\n\n      return response.json();\n    },\n    onSuccess: (_, variables) => {\n      // Invalidate document queries to refresh data\n      queryClient.invalidateQueries({ queryKey: documentKeys.all });\n      toast.success(variables.verified ? 'Document verified successfully' : 'Document verification removed');\n    },\n    onError: (error: Error) => {\n      console.error('Failed to verify document:', error);\n      toast.error(error.message || 'Failed to verify document');\n    },\n  });\n}\n\n// Delete document\nexport function useDeleteDocument() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async (documentId: string) => {\n      const response = await fetch(`/api/documents/${documentId}`, {\n        method: 'DELETE',\n      });\n\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.error || 'Failed to delete document');\n      }\n\n      return response.json();\n    },\n    onSuccess: () => {\n      // Invalidate document queries to refresh data\n      queryClient.invalidateQueries({ queryKey: documentKeys.all });\n      toast.success('Document deleted successfully');\n    },\n    onError: (error: Error) => {\n      console.error('Failed to delete document:', error);\n      toast.error(error.message || 'Failed to delete document');\n    },\n  });\n}\n\n// Specialized hooks for common use cases\nexport function useUserDocuments(userId?: string) {\n  return useDocuments({\n    user_id: userId,\n    page: 1,\n    per_page: 50,\n  });\n}\n\nexport function useDocumentsByCategory(categoryCode?: DocumentCategoryCode) {\n  return useDocuments({\n    category_code: categoryCode,\n    page: 1,\n    per_page: 50,\n  });\n}\n\nexport function useExpiredDocuments() {\n  return useDocuments({\n    status: 'expired',\n    page: 1,\n    per_page: 50,\n  });\n}\n\nexport function useExpiringDocuments() {\n  return useDocuments({\n    status: 'expiring_soon',\n    page: 1,\n    per_page: 50,\n  });\n}\n\nexport function usePendingVerifications() {\n  return useDocuments({\n    status: 'pending',\n    page: 1,\n    per_page: 50,\n  });\n}\n\n// Document categories and status constants\nexport const DOCUMENT_CATEGORIES: DocumentCategoryCode[] = [\n  'WORK_PERMIT',\n  'INSURANCE',\n  'ID_DOCUMENT',\n  'VISA',\n  'MEDICAL',\n  'SAFETY_TRAINING',\n  'PASSPORT',\n  'DRIVING_LICENSE',\n];\n\nexport const DOCUMENT_STATUSES: DocumentStatus[] = [\n  'active',\n  'expired',\n  'expiring_soon',\n  'pending',\n  'inactive',\n];\n\n// Helper function to get status label\nexport function getStatusLabel(status: DocumentStatus): string {\n  const labels: Record<DocumentStatus, string> = {\n    active: 'Active',\n    expired: 'Expired',\n    expiring_soon: 'Expiring Soon',\n    pending: 'Pending Verification',\n    inactive: 'Inactive',\n  };\n\n  return labels[status] || status;\n}\n\n// Helper function to get status color\nexport function getStatusColor(status: DocumentStatus): string {\n  const colors: Record<DocumentStatus, string> = {\n    active: 'bg-green-100 text-green-800',\n    expired: 'bg-red-100 text-red-800',\n    expiring_soon: 'bg-yellow-100 text-yellow-800',\n    pending: 'bg-blue-100 text-blue-800',\n    inactive: 'bg-gray-100 text-gray-800',\n  };\n\n  return colors[status] || 'bg-gray-100 text-gray-800';\n}\n\n// Helper function to get category label\nexport function getCategoryLabel(categoryCode: DocumentCategoryCode): string {\n  const labels: Record<DocumentCategoryCode, string> = {\n    WORK_PERMIT: 'Work Permit',\n    INSURANCE: 'Insurance',\n    ID_DOCUMENT: 'ID Document',\n    VISA: 'Visa',\n    MEDICAL: 'Medical Certificate',\n    SAFETY_TRAINING: 'Safety Training',\n    PASSPORT: 'Passport',\n    DRIVING_LICENSE: 'Driving License',\n  };\n\n  return labels[categoryCode] || categoryCode.replace(/_/g, ' ');\n}\n\n// Helper function to check if document is expiring soon\nexport function isExpiringSign(document: WorkerDocument): boolean {\n  if (!document.expiry_date) return false;\n\n  const expiry = new Date(document.expiry_date);\n  const now = new Date();\n  const daysUntilExpiry = Math.ceil((expiry.getTime() - now.getTime()) / (1000 * 60 * 60 * 24));\n\n  return daysUntilExpiry >= 0 && daysUntilExpiry <= 30;\n}\n\n// Helper function to check if document is expired\nexport function isExpired(document: WorkerDocument): boolean {\n  if (!document.expiry_date) return false;\n\n  const expiry = new Date(document.expiry_date);\n  const now = new Date();\n\n  return expiry < now;\n}\n\n// Helper function to get days until expiry\nexport function getDaysUntilExpiry(document: WorkerDocument): number | null {\n  if (!document.expiry_date) return null;\n\n  const expiry = new Date(document.expiry_date);\n  const now = new Date();\n\n  return Math.ceil((expiry.getTime() - now.getTime()) / (1000 * 60 * 60 * 24));\n}\n\n// Helper function to format file size\nexport function formatFileSize(bytes: number): string {\n  if (bytes === 0) return '0 Bytes';\n\n  const k = 1024;\n  const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\n\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\n}\n\n// Helper function to get file type icon\nexport function getFileTypeIcon(fileType: string): string {\n  if (fileType.includes('pdf')) return '';\n  if (fileType.includes('image')) return '';\n  if (fileType.includes('word') || fileType.includes('document')) return '';\n  if (fileType.includes('excel') || fileType.includes('spreadsheet')) return '';\n  if (fileType.includes('powerpoint') || fileType.includes('presentation')) return '';\n  return '';\n}\n\n// Document categories hook - get all available categories\nexport function useDocumentCategories() {\n  return useQuery({\n    queryKey: documentKeys.categories(),\n    queryFn: async (): Promise<DocumentCategory[]> => {\n      const response = await fetch('/api/documents');\n      if (!response.ok) {\n        throw new Error('Failed to fetch document categories');\n      }\n      const data = await response.json();\n      return data.categories || [];\n    },\n    staleTime: 5 * 60 * 1000, // 5 minutes\n  });\n}\n\n// Document search hook - search across document content\nexport function useSearchDocuments() {\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async (searchRequest: {\n      query: string;\n      include_content?: boolean;\n      highlight?: boolean;\n      fuzzy?: boolean;\n    }) => {\n      const searchParams = new URLSearchParams();\n      searchParams.append('search', searchRequest.query);\n      if (searchRequest.include_content) searchParams.append('include_content', 'true');\n      if (searchRequest.highlight) searchParams.append('highlight', 'true');\n      if (searchRequest.fuzzy) searchParams.append('fuzzy', 'true');\n\n      const response = await fetch(`/api/documents/search?${searchParams.toString()}`);\n      if (!response.ok) {\n        throw new Error('Failed to search documents');\n      }\n      return response.json();\n    },\n    onSuccess: (data) => {\n      // Cache search results temporarily\n      queryClient.setQueryData(['documents', 'search', data.query], data);\n    },\n    onError: (error: Error) => {\n      toast.error(`Search failed: ${error.message}`);\n    },\n  });\n}\n\n// Document actions hook - for action menus and operations\nexport function useDocumentActions() {\n  const queryClient = useQueryClient();\n\n  const shareDocument = useMutation({\n    mutationFn: async ({ documentId, accessLevel }: { documentId: string; accessLevel: 'public' | 'private' | 'team' }) => {\n      const response = await fetch(`/api/documents/${documentId}/share`, {\n        method: 'PATCH',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ access_level: accessLevel }),\n      });\n      if (!response.ok) throw new Error('Failed to share document');\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: documentKeys.all });\n      toast.success('Document sharing updated');\n    },\n    onError: (error: Error) => toast.error(error.message),\n  });\n\n  const downloadDocument = useMutation({\n    mutationFn: async (documentId: string) => {\n      const response = await fetch(`/api/documents/${documentId}/download`);\n      if (!response.ok) throw new Error('Failed to download document');\n      const blob = await response.blob();\n      return { blob, response };\n    },\n    onError: (error: Error) => toast.error(error.message),\n  });\n\n  const duplicateDocument = useMutation({\n    mutationFn: async (documentId: string) => {\n      const response = await fetch(`/api/documents/${documentId}/duplicate`, {\n        method: 'POST',\n      });\n      if (!response.ok) throw new Error('Failed to duplicate document');\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: documentKeys.all });\n      toast.success('Document duplicated');\n    },\n    onError: (error: Error) => toast.error(error.message),\n  });\n\n  return {\n    shareDocument,\n    downloadDocument,\n    duplicateDocument,\n  };\n}\n\n// Document classification hook - for auto-categorizing documents\nexport function useClassifyDocument() {\n  return useMutation({\n    mutationFn: async (file: File) => {\n      // Simple classification based on file extension and name\n      const fileName = file.name.toLowerCase();\n      const fileType = file.type.toLowerCase();\n\n      // Classify based on file name patterns\n      if (fileName.includes('passport') || fileName.includes('')) {\n        return { category_code: 'PASSPORT', confidence: 0.9 };\n      }\n      if (fileName.includes('visa') || fileName.includes('')) {\n        return { category_code: 'VISA', confidence: 0.85 };\n      }\n      if (fileName.includes('permit') || fileName.includes('')) {\n        return { category_code: 'WORK_PERMIT', confidence: 0.8 };\n      }\n      if (fileName.includes('insurance') || fileName.includes('')) {\n        return { category_code: 'INSURANCE', confidence: 0.8 };\n      }\n      if (fileName.includes('medical') || fileName.includes('')) {\n        return { category_code: 'MEDICAL', confidence: 0.75 };\n      }\n      if (fileName.includes('safety') || fileName.includes('')) {\n        return { category_code: 'SAFETY_TRAINING', confidence: 0.75 };\n      }\n      if (fileName.includes('license') || fileName.includes('')) {\n        return { category_code: 'DRIVING_LICENSE', confidence: 0.7 };\n      }\n\n      // Default to ID document for images\n      if (fileType.includes('image')) {\n        return { category_code: 'ID_DOCUMENT', confidence: 0.5 };\n      }\n\n      // Default classification\n      return { category_code: 'ID_DOCUMENT', confidence: 0.3 };\n    },\n    onError: (error: Error) => {\n      console.warn('Document classification failed:', error);\n    },\n  });\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3089, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/T7/cometa/cometa-separated-projects/cometa-frontend-nextjs/src/components/documents/document-upload.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useState, useCallback } from \"react\";\nimport { useDropzone } from \"react-dropzone\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { Upload, X, FileText, Image, FileIcon, AlertCircle } from \"lucide-react\";\nimport { toast } from \"sonner\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Progress } from \"@/components/ui/progress\";\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardHeader,\n  CardTitle,\n} from \"@/components/ui/card\";\nimport {\n  useUploadDocument,\n  useDocumentCategories,\n  useClassifyDocument,\n} from \"@/hooks/use-documents\";\nimport { cn } from \"@/lib/utils\";\nimport type {\n  CreateDocumentRequest,\n  DocumentCategoryCode,\n  DocumentAccessLevel,\n} from \"@/types\";\n\ninterface DocumentUploadProps {\n  projectId?: string;\n  houseId?: string;\n  workEntryId?: string;\n  teamId?: string;\n  userId?: string;\n  onUploadComplete?: (document: any) => void;\n  maxFiles?: number;\n  acceptedFileTypes?: string[];\n  maxFileSize?: number; // in bytes\n}\n\ninterface FileWithPreview {\n  file: File; // Original File object\n  preview?: string;\n  category?: DocumentCategoryCode;\n  tags?: string[];\n  description?: string;\n  accessLevel?: DocumentAccessLevel;\n  documentNumber?: string;\n  issuingAuthority?: string;\n  issueDate?: string;\n  expiryDate?: string;\n  // File properties for compatibility\n  name: string;\n  size: number;\n  type: string;\n}\n\nconst getFileIcon = (fileType: string | undefined) => {\n  if (!fileType) return FileIcon;\n  if (fileType.startsWith(\"image/\")) return Image;\n  if (fileType.includes(\"pdf\") || fileType.includes(\"document\")) return FileText;\n  return FileIcon;\n};\n\nconst formatFileSize = (bytes: number): string => {\n  if (bytes === 0) return \"0 Bytes\";\n  const k = 1024;\n  const sizes = [\"Bytes\", \"KB\", \"MB\", \"GB\"];\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + \" \" + sizes[i];\n};\n\nexport function DocumentUpload({\n  projectId,\n  houseId,\n  workEntryId,\n  teamId,\n  userId,\n  onUploadComplete,\n  maxFiles = 10,\n  acceptedFileTypes = [\n    \"image/*\",\n    \"application/pdf\",\n    \"application/msword\", // .doc files\n    \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\", // .docx files\n    \"application/vnd.ms-excel\", // .xls files\n    \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\", // .xlsx files\n    \".doc\",\n    \".docx\",\n    \".xls\",\n    \".xlsx\"\n  ],\n  maxFileSize = 50 * 1024 * 1024, // 50MB\n}: DocumentUploadProps) {\n  const [files, setFiles] = useState<FileWithPreview[]>([]);\n  const [uploading, setUploading] = useState(false);\n  const [uploadProgress, setUploadProgress] = useState<Record<string, number>>({});\n\n  const uploadDocument = useUploadDocument();\n\n  // Custom upload function for user documents\n  const uploadUserDocument = async (file: FileWithPreview, userId: string) => {\n    console.log('Starting upload for:', file.name, 'to user:', userId, 'category:', file.category);\n\n    if (!file.category) {\n      throw new Error('Please select a document category before uploading');\n    }\n\n    // Use the original file object from our wrapper\n    const formData = new FormData();\n    formData.append('file', file.file); // Use the original File object\n    formData.append('category_id', file.category || '');\n    formData.append('document_number', file.documentNumber || '');\n    formData.append('issuing_authority', file.issuingAuthority || '');\n    formData.append('issue_date', file.issueDate || '');\n    formData.append('expiry_date', file.expiryDate || '');\n    formData.append('notes', file.description || '');\n\n    console.log('FormData prepared:', {\n      fileName: file.name,\n      fileSize: file.size,\n      fileType: file.type,\n      categoryId: file.category,\n      notes: file.description || ''\n    });\n\n    console.log('FormData entries:');\n    for (const [key, value] of formData.entries()) {\n      if (value instanceof File) {\n        console.log(`  ${key}: File(name=\"${value.name}\", size=${value.size}, type=\"${value.type}\")`);\n      } else {\n        console.log(`  ${key}: \"${value}\"`);\n      }\n    }\n\n    const response = await fetch(`/api/users/${userId}/documents`, {\n      method: 'POST',\n      body: formData,\n    });\n\n    console.log('Response status:', response.status, response.statusText);\n\n    if (!response.ok) {\n      let errorMessage = 'Failed to upload document';\n      try {\n        const errorText = await response.text();\n        console.log('Error response text:', errorText);\n        if (errorText && errorText.trim()) {\n          try {\n            const error = JSON.parse(errorText);\n            errorMessage = error.error || error.message || errorMessage;\n          } catch (parseError) {\n            // If JSON parsing fails, use the raw text as error message\n            errorMessage = errorText;\n          }\n        }\n      } catch (e) {\n        errorMessage = `HTTP ${response.status}: ${response.statusText}`;\n      }\n      console.error('Upload error:', errorMessage);\n      throw new Error(errorMessage);\n    }\n\n    const result = await response.json();\n    console.log('Upload successful:', result);\n    return result;\n  };\n  // Custom hook to fetch document categories\n  const { data: userDocumentsData } = useQuery({\n    queryKey: ['user-documents-categories', userId],\n    queryFn: async () => {\n      if (!userId) return { categories: [] };\n      const response = await fetch(`/api/users/${userId}/documents`);\n      if (!response.ok) throw new Error('Failed to fetch categories');\n      return response.json();\n    },\n    enabled: !!userId,\n  });\n\n  const categories = userDocumentsData?.categories || [];\n  const classifyDocument = useClassifyDocument();\n\n  const onDrop = useCallback(\n    async (acceptedFiles: File[]) => {\n      console.log('  :', acceptedFiles.map(f => ({\n        name: f.name,\n        size: f.size,\n        type: f.type\n      })));\n\n      if (files.length + acceptedFiles.length > maxFiles) {\n        toast.error(`Maximum ${maxFiles} files allowed`);\n        return;\n      }\n\n      const newFiles: FileWithPreview[] = acceptedFiles.map((file) => {\n        console.log('  :', {\n          name: file.name,\n          size: file.size,\n          type: file.type,\n          constructor: file.constructor.name\n        });\n\n        // Create preview for images\n        const preview = file.type.startsWith(\"image/\")\n          ? URL.createObjectURL(file)\n          : undefined;\n\n        // Create a wrapper object that preserves the original File object\n        const enhancedFile: FileWithPreview = {\n          file, // Store the original File object\n          preview,\n          category: undefined,\n          tags: [],\n          description: \"\",\n          accessLevel: \"project\",\n          documentNumber: \"\",\n          issuingAuthority: \"\",\n          issueDate: \"\",\n          expiryDate: \"\",\n          // Copy File properties for compatibility\n          name: file.name,\n          size: file.size,\n          type: file.type\n        };\n\n        console.log('  :', {\n          name: enhancedFile.name,\n          size: enhancedFile.size,\n          type: enhancedFile.type,\n          hasPreview: !!enhancedFile.preview,\n          originalFile: enhancedFile.file,\n          hasArrayBuffer: typeof enhancedFile.file.arrayBuffer === 'function',\n          hasStream: typeof enhancedFile.file.stream === 'function'\n        });\n\n        return enhancedFile;\n      });\n\n      console.log('    :', newFiles.length);\n      setFiles((prev) => [...prev, ...newFiles]);\n\n      // Auto-classify documents\n      for (const file of newFiles) {\n        try {\n          const result = await classifyDocument.mutateAsync(file.file);\n\n          setFiles((prev) =>\n            prev.map((f) =>\n              f.name === file.name && f.size === file.size\n                ? {\n                    ...f,\n                    category: result.category_code as DocumentCategoryCode,\n                    tags: [], // No tags returned from this hook\n                  }\n                : f\n            )\n          );\n        } catch (error) {\n          console.error(\"Classification failed for\", file.name, error);\n        }\n      }\n    },\n    [files.length, maxFiles, classifyDocument]\n  );\n\n  const { getRootProps, getInputProps, isDragActive } = useDropzone({\n    onDrop,\n    accept: {\n      'image/*': ['.png', '.jpg', '.jpeg', '.gif', '.bmp', '.webp'],\n      'application/pdf': ['.pdf'],\n      'application/msword': ['.doc'],\n      'application/vnd.openxmlformats-officedocument.wordprocessingml.document': ['.docx'],\n      'application/vnd.ms-excel': ['.xls'],\n      'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet': ['.xlsx'],\n    },\n    maxSize: maxFileSize,\n    multiple: true,\n  });\n\n  const removeFile = (index: number) => {\n    setFiles((prev) => {\n      const file = prev[index];\n      if (file.preview) {\n        URL.revokeObjectURL(file.preview);\n      }\n      return prev.filter((_, i) => i !== index);\n    });\n  };\n\n  const updateFileMetadata = (\n    index: number,\n    field: keyof FileWithPreview,\n    value: any\n  ) => {\n    setFiles((prev) =>\n      prev.map((file, i) =>\n        i === index ? { ...file, [field]: value } : file\n      )\n    );\n  };\n\n  const handleUpload = async () => {\n    if (files.length === 0) {\n      toast.error(\",    \");\n      return;\n    }\n    if (!userId) {\n      toast.error(\"User ID is required for uploading documents\");\n      return;\n    }\n\n    // Check if all files have categories\n    const filesWithoutCategory = files.filter(file => !file.category);\n    if (filesWithoutCategory.length > 0) {\n      toast.error(\",     \");\n      return;\n    }\n\n    console.log('   :', files.map((f, i) => ({\n      name: f.name || `file-${i}`,\n      size: f.size,\n      type: f.type,\n      category: f.category\n    })));\n\n    setUploading(true);\n\n    for (const [index, file] of files.entries()) {\n      // Store original filename before it gets corrupted\n      const originalFileName = file.name || `file-${index}`;\n\n      try {\n        setUploadProgress((prev) => ({ ...prev, [originalFileName]: 0 }));\n\n        // Simulate progress (in real implementation, this would come from upload progress)\n        const progressInterval = setInterval(() => {\n          setUploadProgress((prev) => ({\n            ...prev,\n            [originalFileName]: Math.min(prev[originalFileName] + 10, 90),\n          }));\n        }, 100);\n\n        const document = await uploadUserDocument(file, userId);\n\n        clearInterval(progressInterval);\n        setUploadProgress((prev) => ({ ...prev, [originalFileName]: 100 }));\n\n        onUploadComplete?.(document);\n      } catch (error) {\n        console.error(\"Upload failed for\", originalFileName, error);\n        setUploadProgress((prev) => ({ ...prev, [originalFileName]: -1 }));\n      }\n    }\n\n    setUploading(false);\n    setFiles([]);\n    setUploadProgress({});\n  };\n\n  return (\n    <Card className=\"w-full\">\n      <CardHeader>\n        <CardTitle>Upload Documents</CardTitle>\n        <CardDescription>\n          Drag and drop files or click to select. Maximum {maxFiles} files,{\" \"}\n          {formatFileSize(maxFileSize)} each.\n        </CardDescription>\n      </CardHeader>\n      <CardContent className=\"space-y-4\">\n        {/* Drop Zone */}\n        <div\n          {...getRootProps()}\n          className={cn(\n            \"border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors\",\n            isDragActive\n              ? \"border-primary bg-primary/10\"\n              : \"border-muted-foreground/25 hover:border-primary/50\"\n          )}\n        >\n          <input {...getInputProps()} />\n          <Upload className=\"mx-auto h-12 w-12 text-muted-foreground mb-4\" />\n          {isDragActive ? (\n            <p className=\"text-primary\">Drop the files here...</p>\n          ) : (\n            <div>\n              <p className=\"text-muted-foreground mb-2\">\n                Drag and drop files here, or click to select files\n              </p>\n              <p className=\"text-sm text-muted-foreground\">\n                Supported: {acceptedFileTypes.join(\", \")}\n              </p>\n            </div>\n          )}\n        </div>\n\n        {/* File List */}\n        {files.length > 0 && (\n          <div className=\"space-y-4\">\n            <h4 className=\"font-medium\">Files to Upload ({files.length})</h4>\n            {files.map((file, index) => {\n              const FileIconComponent = getFileIcon(file.type);\n              const progress = uploadProgress[file.name] || 0;\n              const isError = progress === -1;\n\n              return (\n                <Card key={`${file.name}-${file.size}`} className=\"p-4\">\n                  <div className=\"flex items-start gap-4\">\n                    {/* File Icon/Preview */}\n                    <div className=\"flex-shrink-0\">\n                      {file.preview ? (\n                        <img\n                          src={file.preview}\n                          alt={file.name}\n                          className=\"w-16 h-16 object-cover rounded\"\n                          onLoad={() => URL.revokeObjectURL(file.preview!)}\n                        />\n                      ) : (\n                        <div className=\"w-16 h-16 bg-muted rounded flex items-center justify-center\">\n                          <FileIconComponent className=\"w-8 h-8 text-muted-foreground\" />\n                        </div>\n                      )}\n                    </div>\n\n                    {/* File Details */}\n                    <div className=\"flex-1 space-y-3\">\n                      <div className=\"flex items-start justify-between\">\n                        <div>\n                          <p className=\"font-medium truncate max-w-xs\">\n                            {file.name}\n                          </p>\n                          <p className=\"text-sm text-muted-foreground\">\n                            {formatFileSize(file.size)}\n                          </p>\n                        </div>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => removeFile(index)}\n                          disabled={uploading}\n                        >\n                          <X className=\"w-4 h-4\" />\n                        </Button>\n                      </div>\n\n                      {/* Metadata Form */}\n                      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\n                        <div>\n                          <Label htmlFor={`category-${index}`}>Category</Label>\n                          <Select\n                            value={file.category || \"\"}\n                            onValueChange={(value) =>\n                              updateFileMetadata(index, \"category\", value)\n                            }\n                            disabled={uploading}\n                          >\n                            <SelectTrigger>\n                              <SelectValue placeholder=\"Select category\" />\n                            </SelectTrigger>\n                            <SelectContent>\n                              {categories?.map((category: any) => (\n                                <SelectItem key={category.id} value={category.id}>\n                                  {category.name_en || category.name_ru || category.code}\n                                </SelectItem>\n                              ))}\n                            </SelectContent>\n                          </Select>\n                        </div>\n\n                        <div>\n                          <Label htmlFor={`access-${index}`}>Access Level</Label>\n                          <Select\n                            value={file.accessLevel || \"project\"}\n                            onValueChange={(value) =>\n                              updateFileMetadata(index, \"accessLevel\", value)\n                            }\n                            disabled={uploading}\n                          >\n                            <SelectTrigger>\n                              <SelectValue />\n                            </SelectTrigger>\n                            <SelectContent>\n                              <SelectItem value=\"public\">Public</SelectItem>\n                              <SelectItem value=\"project\">Project</SelectItem>\n                              <SelectItem value=\"team\">Team</SelectItem>\n                              <SelectItem value=\"private\">Private</SelectItem>\n                              <SelectItem value=\"admin\">Admin Only</SelectItem>\n                            </SelectContent>\n                          </Select>\n                        </div>\n\n                        <div>\n                          <Label htmlFor={`document-number-${index}`}>Document Number</Label>\n                          <Input\n                            id={`document-number-${index}`}\n                            placeholder=\"Document number...\"\n                            value={file.documentNumber || \"\"}\n                            onChange={(e) =>\n                              updateFileMetadata(index, \"documentNumber\", e.target.value)\n                            }\n                            disabled={uploading}\n                          />\n                        </div>\n\n                        <div>\n                          <Label htmlFor={`issuing-authority-${index}`}>Issuing Authority</Label>\n                          <Input\n                            id={`issuing-authority-${index}`}\n                            placeholder=\"Issuing authority...\"\n                            value={file.issuingAuthority || \"\"}\n                            onChange={(e) =>\n                              updateFileMetadata(index, \"issuingAuthority\", e.target.value)\n                            }\n                            disabled={uploading}\n                          />\n                        </div>\n\n                        <div>\n                          <Label htmlFor={`issue-date-${index}`}>Issue Date</Label>\n                          <Input\n                            id={`issue-date-${index}`}\n                            type=\"date\"\n                            value={file.issueDate || \"\"}\n                            onChange={(e) =>\n                              updateFileMetadata(index, \"issueDate\", e.target.value)\n                            }\n                            disabled={uploading}\n                          />\n                        </div>\n\n                        <div>\n                          <Label htmlFor={`expiry-date-${index}`}>Expiry Date</Label>\n                          <Input\n                            id={`expiry-date-${index}`}\n                            type=\"date\"\n                            value={file.expiryDate || \"\"}\n                            onChange={(e) =>\n                              updateFileMetadata(index, \"expiryDate\", e.target.value)\n                            }\n                            disabled={uploading}\n                          />\n                        </div>\n                      </div>\n\n                      <div>\n                        <Label htmlFor={`description-${index}`}>Description</Label>\n                        <Textarea\n                          id={`description-${index}`}\n                          placeholder=\"Optional description...\"\n                          value={file.description || \"\"}\n                          onChange={(e) =>\n                            updateFileMetadata(index, \"description\", e.target.value)\n                          }\n                          disabled={uploading}\n                          rows={2}\n                        />\n                      </div>\n\n                      {/* Tags */}\n                      {file.tags && file.tags.length > 0 && (\n                        <div>\n                          <Label>Suggested Tags</Label>\n                          <div className=\"flex flex-wrap gap-1 mt-1\">\n                            {file.tags.map((tag, tagIndex) => (\n                              <Badge key={tagIndex} variant=\"secondary\">\n                                {tag}\n                              </Badge>\n                            ))}\n                          </div>\n                        </div>\n                      )}\n\n                      {/* Upload Progress */}\n                      {uploading && progress >= 0 && (\n                        <div className=\"space-y-1\">\n                          <div className=\"flex items-center justify-between text-sm\">\n                            <span>Uploading...</span>\n                            <span>{progress}%</span>\n                          </div>\n                          <Progress value={progress} className=\"h-2\" />\n                        </div>\n                      )}\n\n                      {/* Error State */}\n                      {isError && (\n                        <div className=\"flex items-center gap-2 text-destructive text-sm\">\n                          <AlertCircle className=\"w-4 h-4\" />\n                          <span>Upload failed</span>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                </Card>\n              );\n            })}\n\n            {/* Upload Button */}\n            <div className=\"flex justify-end\">\n              <Button\n                onClick={handleUpload}\n                disabled={uploading || files.length === 0}\n                className=\"min-w-32\"\n              >\n                {uploading ? \"Uploading...\" : `Upload ${files.length} Files`}\n              </Button>\n            </div>\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 4083, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/T7/cometa/cometa-separated-projects/cometa-frontend-nextjs/src/components/documents/worker-documents-dialog.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport { useQuery, useQueryClient } from \"@tanstack/react-query\";\nimport {\n  FileText,\n  Shield,\n  Calendar,\n  AlertTriangle,\n  CheckCircle,\n  Clock,\n  Download,\n  Eye,\n  X,\n  Plus\n} from \"lucide-react\";\n\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { DocumentUpload } from \"./document-upload\";\n\nimport type { DocumentsResponse, WorkerDocument, DocumentStatus } from \"@/types\";\n\ninterface WorkerDocumentsDialogProps {\n  userId: string;\n  userName: string;\n  trigger?: React.ReactNode;\n}\n\nasync function fetchWorkerDocuments(userId: string): Promise<DocumentsResponse> {\n  const response = await fetch(`/api/users/${userId}/documents`);\n  if (!response.ok) {\n    throw new Error('Failed to fetch documents');\n  }\n  return response.json();\n}\n\nfunction getStatusColor(status: DocumentStatus): string {\n  switch (status) {\n    case 'active':\n      return 'bg-green-500';\n    case 'expired':\n      return 'bg-red-500';\n    case 'expiring_soon':\n      return 'bg-yellow-500';\n    case 'pending':\n      return 'bg-blue-500';\n    case 'inactive':\n      return 'bg-gray-500';\n    default:\n      return 'bg-gray-500';\n  }\n}\n\nfunction getStatusIcon(status: DocumentStatus) {\n  switch (status) {\n    case 'active':\n      return <CheckCircle className=\"h-4 w-4\" />;\n    case 'expired':\n      return <AlertTriangle className=\"h-4 w-4\" />;\n    case 'expiring_soon':\n      return <Clock className=\"h-4 w-4\" />;\n    case 'pending':\n      return <Clock className=\"h-4 w-4\" />;\n    case 'inactive':\n      return <X className=\"h-4 w-4\" />;\n    default:\n      return <FileText className=\"h-4 w-4\" />;\n  }\n}\n\nfunction getStatusText(status: DocumentStatus): string {\n  switch (status) {\n    case 'active':\n      return '';\n    case 'expired':\n      return '';\n    case 'expiring_soon':\n      return ' ';\n    case 'pending':\n      return ' ';\n    case 'inactive':\n      return '';\n    default:\n      return '';\n  }\n}\n\nfunction formatFileSize(bytes: number): string {\n  if (bytes === 0) return '0 Bytes';\n  const k = 1024;\n  const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\n}\n\nfunction DocumentCard({ document }: { document: WorkerDocument }) {\n  const statusColor = getStatusColor(document.status);\n  const statusIcon = getStatusIcon(document.status);\n  const statusText = getStatusText(document.status);\n  const queryClient = useQueryClient();\n\n  const handleView = () => {\n    // Open document in new tab for viewing (not downloading)\n    const viewUrl = `/api/users/${document.user_id}/documents/${document.id}/view`;\n    console.log(`   \"${document.file_name}\"  `);\n    window.open(viewUrl, '_blank');\n  };\n\n  const handleDownload = async () => {\n    try {\n      console.log(`   \"${document.file_name}\"   ID: ${document.user_id}`);\n      // Download the document using the API endpoint\n      const downloadUrl = `/api/users/${document.user_id}/documents/${document.id}/download`;\n\n      const response = await fetch(downloadUrl);\n      if (!response.ok) {\n        throw new Error('Failed to download document');\n      }\n\n      // Create blob from response\n      const blob = await response.blob();\n\n      // Create download link\n      const url = window.URL.createObjectURL(blob);\n      const link = window.document.createElement('a');\n      link.href = url;\n      link.download = document.file_name;\n      window.document.body.appendChild(link);\n      link.click();\n\n      // Cleanup\n      window.URL.revokeObjectURL(url);\n      window.document.body.removeChild(link);\n    } catch (error) {\n      console.error('Download failed:', error);\n      alert('   ');\n    }\n  };\n\n  const handleDelete = async () => {\n    const confirmDelete = window.confirm(` ,     \"${document.file_name}\"?`);\n    if (!confirmDelete) return;\n\n    try {\n      console.log(`   \"${document.file_name}\"   ID: ${document.user_id}`);\n\n      const response = await fetch(`/api/users/${document.user_id}/documents/${document.id}`, {\n        method: 'DELETE',\n      });\n\n      if (!response.ok) {\n        throw new Error('Failed to delete document');\n      }\n\n      console.log(`  \"${document.file_name}\"  `);\n\n      // Refresh the documents list\n      queryClient.invalidateQueries({\n        queryKey: ['worker-documents', document.user_id]\n      });\n\n      alert('  ');\n\n    } catch (error) {\n      console.error('Delete failed:', error);\n      alert('   ');\n    }\n  };\n\n  return (\n    <Card className=\"mb-4\">\n      <CardHeader className=\"pb-3\">\n        <div className=\"flex items-center justify-between\">\n          <CardTitle className=\"text-lg flex items-center gap-2\">\n            <div\n              className=\"w-3 h-3 rounded-full\"\n              style={{ backgroundColor: document.category.color }}\n            />\n            {document.category.name_ru || document.category.name_en}\n          </CardTitle>\n          <Badge\n            variant=\"secondary\"\n            className={`${statusColor} text-white flex items-center gap-1`}\n          >\n            {statusIcon}\n            {statusText}\n          </Badge>\n        </div>\n      </CardHeader>\n      <CardContent className=\"space-y-3\">\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm\">\n          {document.document_number && (\n            <div>\n              <span className=\"font-medium text-muted-foreground\"> :</span>\n              <p>{document.document_number}</p>\n            </div>\n          )}\n\n          {document.issuing_authority && (\n            <div>\n              <span className=\"font-medium text-muted-foreground\"> :</span>\n              <p>{document.issuing_authority}</p>\n            </div>\n          )}\n\n          {document.issue_date && (\n            <div>\n              <span className=\"font-medium text-muted-foreground\"> :</span>\n              <p>{new Date(document.issue_date).toLocaleDateString('ru-RU')}</p>\n            </div>\n          )}\n\n          {document.expiry_date && (\n            <div>\n              <span className=\"font-medium text-muted-foreground\"> :</span>\n              <p className={document.status === 'expired' ? 'text-red-600 font-medium' : document.status === 'expiring_soon' ? 'text-yellow-600 font-medium' : ''}>\n                {new Date(document.expiry_date).toLocaleDateString('ru-RU')}\n              </p>\n            </div>\n          )}\n        </div>\n\n        {document.notes && (\n          <div>\n            <span className=\"font-medium text-muted-foreground\">:</span>\n            <p className=\"text-sm mt-1\">{document.notes}</p>\n          </div>\n        )}\n\n        <div className=\"flex items-center justify-between pt-2 border-t\">\n          <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n            <FileText className=\"h-4 w-4\" />\n            <span>{document.file_name}</span>\n            <span>({formatFileSize(document.file_size)})</span>\n            {document.is_verified && (\n              <Badge variant=\"outline\" className=\"text-green-600 border-green-600\">\n                <Shield className=\"h-3 w-3 mr-1\" />\n                \n              </Badge>\n            )}\n          </div>\n\n          <div className=\"flex gap-2\">\n            <Button variant=\"outline\" size=\"sm\" onClick={handleView}>\n              <Eye className=\"h-4 w-4 mr-1\" />\n              \n            </Button>\n            <Button variant=\"outline\" size=\"sm\" onClick={handleDownload}>\n              <Download className=\"h-4 w-4 mr-1\" />\n              \n            </Button>\n            <Button variant=\"outline\" size=\"sm\" onClick={handleDelete} className=\"text-red-600 hover:text-red-700\">\n              <X className=\"h-4 w-4 mr-1\" />\n              \n            </Button>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n\nfunction DocumentsByCategory({ documents }: { documents: WorkerDocument[] }) {\n  // Group documents by category\n  const documentsByCategory = documents.reduce((acc, doc) => {\n    const categoryName = doc.category.name_ru || doc.category.name_en;\n    if (!acc[categoryName]) {\n      acc[categoryName] = [];\n    }\n    acc[categoryName].push(doc);\n    return acc;\n  }, {} as Record<string, WorkerDocument[]>);\n\n  return (\n    <div className=\"space-y-6\">\n      {Object.entries(documentsByCategory).map(([categoryName, categoryDocs]) => (\n        <div key={categoryName}>\n          <h3 className=\"font-semibold text-lg mb-3 flex items-center gap-2\">\n            <div\n              className=\"w-3 h-3 rounded-full\"\n              style={{ backgroundColor: categoryDocs[0].category.color }}\n            />\n            {categoryName}\n            <Badge variant=\"outline\">{categoryDocs.length}</Badge>\n          </h3>\n          {categoryDocs.map(doc => (\n            <DocumentCard key={doc.id} document={doc} />\n          ))}\n        </div>\n      ))}\n    </div>\n  );\n}\n\nexport default function WorkerDocumentsDialog({\n  userId,\n  userName,\n  trigger\n}: WorkerDocumentsDialogProps) {\n  const [open, setOpen] = useState(false);\n  const [showUpload, setShowUpload] = useState(false);\n  const queryClient = useQueryClient();\n\n  const { data, isLoading, error } = useQuery({\n    queryKey: ['worker-documents', userId],\n    queryFn: () => fetchWorkerDocuments(userId),\n    enabled: open, // Only fetch when dialog is open\n  });\n\n  const defaultTrigger = (\n    <Button variant=\"outline\" size=\"sm\">\n      <FileText className=\"h-4 w-4 mr-1\" />\n      \n    </Button>\n  );\n\n  return (\n    <Dialog open={open} onOpenChange={setOpen}>\n      <DialogTrigger asChild>\n        {trigger || defaultTrigger}\n      </DialogTrigger>\n      <DialogContent className=\"max-w-4xl max-h-[80vh] overflow-y-auto\">\n        <DialogHeader>\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <DialogTitle className=\"flex items-center gap-2\">\n                <FileText className=\"h-5 w-5\" />\n                 : {userName}\n              </DialogTitle>\n              <DialogDescription>\n                    (, , )\n              </DialogDescription>\n            </div>\n            <Button\n              onClick={() => setShowUpload(true)}\n              className=\"flex items-center gap-2\"\n            >\n              <Plus className=\"h-4 w-4\" />\n               \n            </Button>\n          </div>\n        </DialogHeader>\n\n        {isLoading && (\n          <div className=\"flex justify-center py-8\">\n            <div className=\"h-6 w-6 animate-spin rounded-full border-2 border-primary border-t-transparent\" />\n          </div>\n        )}\n\n        {error && (\n          <div className=\"text-center py-8\">\n            <p className=\"text-destructive\">  </p>\n          </div>\n        )}\n\n        {data && (\n          <div className=\"space-y-6\">\n            {/* Stats */}\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n              <Card>\n                <CardContent className=\"p-4 text-center\">\n                  <div className=\"text-2xl font-bold\">{data.stats.total}</div>\n                  <div className=\"text-sm text-muted-foreground\"></div>\n                </CardContent>\n              </Card>\n              <Card>\n                <CardContent className=\"p-4 text-center\">\n                  <div className=\"text-2xl font-bold text-green-600\">{data.stats.active}</div>\n                  <div className=\"text-sm text-muted-foreground\"></div>\n                </CardContent>\n              </Card>\n              <Card>\n                <CardContent className=\"p-4 text-center\">\n                  <div className=\"text-2xl font-bold text-yellow-600\">{data.stats.expiring_soon}</div>\n                  <div className=\"text-sm text-muted-foreground\"> </div>\n                </CardContent>\n              </Card>\n              <Card>\n                <CardContent className=\"p-4 text-center\">\n                  <div className=\"text-2xl font-bold text-red-600\">{data.stats.expired}</div>\n                  <div className=\"text-sm text-muted-foreground\"></div>\n                </CardContent>\n              </Card>\n            </div>\n\n            {/* Documents */}\n            {data.documents.length === 0 ? (\n              <div className=\"text-center py-8\">\n                <FileText className=\"mx-auto h-12 w-12 text-muted-foreground\" />\n                <h3 className=\"mt-2 text-sm font-semibold\"> </h3>\n                <p className=\"mt-1 text-sm text-muted-foreground\">\n                        .\n                </p>\n              </div>\n            ) : (\n              <Tabs defaultValue=\"all\" className=\"w-full\">\n                <TabsList className=\"grid w-full grid-cols-4\">\n                  <TabsTrigger value=\"all\"> ({data.stats.total})</TabsTrigger>\n                  <TabsTrigger value=\"active\"> ({data.stats.active})</TabsTrigger>\n                  <TabsTrigger value=\"expiring\"> ({data.stats.expiring_soon})</TabsTrigger>\n                  <TabsTrigger value=\"expired\"> ({data.stats.expired})</TabsTrigger>\n                </TabsList>\n\n                <TabsContent value=\"all\" className=\"mt-6\">\n                  <DocumentsByCategory documents={data.documents} />\n                </TabsContent>\n\n                <TabsContent value=\"active\" className=\"mt-6\">\n                  <DocumentsByCategory\n                    documents={data.documents.filter(doc => doc.status === 'active')}\n                  />\n                </TabsContent>\n\n                <TabsContent value=\"expiring\" className=\"mt-6\">\n                  <DocumentsByCategory\n                    documents={data.documents.filter(doc => doc.status === 'expiring_soon')}\n                  />\n                </TabsContent>\n\n                <TabsContent value=\"expired\" className=\"mt-6\">\n                  <DocumentsByCategory\n                    documents={data.documents.filter(doc => doc.status === 'expired')}\n                  />\n                </TabsContent>\n              </Tabs>\n            )}\n          </div>\n        )}\n      </DialogContent>\n\n      {/* Upload Document Dialog */}\n      <Dialog open={showUpload} onOpenChange={setShowUpload}>\n        <DialogContent className=\"max-w-2xl\">\n          <DialogHeader>\n            <DialogTitle>   {userName}</DialogTitle>\n            <DialogDescription>\n                 (,   ,   ..)\n            </DialogDescription>\n          </DialogHeader>\n          <DocumentUpload\n            userId={userId}\n            onUploadComplete={(document) => {\n              console.log(`  \"${document.file_name}\"    : ${userName} (ID: ${userId})`);\n              setShowUpload(false);\n              // Refresh the documents data\n              queryClient.invalidateQueries({\n                queryKey: ['worker-documents', userId]\n              });\n              // Also invalidate categories data since it might be fetched from the same endpoint\n              queryClient.invalidateQueries({\n                queryKey: ['user-documents-categories', userId]\n              });\n            }}\n          />\n        </DialogContent>\n      </Dialog>\n    </Dialog>\n  );\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 5220, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/T7/cometa/cometa-separated-projects/cometa-frontend-nextjs/src/app/%28dashboard%29/dashboard/teams/%5Bid%5D/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect } from \"react\";\nimport { useRouter, useParams } from \"next/navigation\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport {\n  ArrowLeft,\n  Users,\n  Edit,\n  Save,\n  X,\n  MapPin,\n  Calendar,\n  Mail,\n  Phone,\n  UserPlus,\n  Trash2,\n  Settings,\n  Wrench,\n  Truck,\n  Package\n} from \"lucide-react\";\n\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Label } from \"@/components/ui/label\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n  AlertDialogTrigger,\n} from \"@/components/ui/alert-dialog\";\n\nimport { useCrew, useUpdateCrew, useDeleteCrew } from \"@/hooks/use-teams\";\nimport { useUsers } from \"@/hooks/use-users\";\nimport { useProjects } from \"@/hooks/use-projects\";\nimport { usePermissions } from \"@/hooks/use-auth\";\nimport { useCrewEquipmentAssignments } from \"@/hooks/use-equipment\";\nimport { useCrewVehicleAssignments } from \"@/hooks/use-vehicles\";\nimport WorkerDocumentsDialog from \"@/components/documents/worker-documents-dialog\";\n\n// Validation schema for editing teams\nconst editTeamSchema = z.object({\n  name: z.string().min(1, \"Team name is required\"),\n  foreman_user_id: z.string().optional(),\n  project_id: z.string().optional(),\n});\n\ntype EditTeamFormData = z.infer<typeof editTeamSchema>;\n\nexport default function TeamDetailsPage() {\n  const router = useRouter();\n  const params = useParams();\n  const { canManageTeams } = usePermissions();\n\n  const [isEditing, setIsEditing] = useState(false);\n  const teamId = params.id as string;\n  const { data: crew, isLoading: crewLoading, error } = useCrew(teamId);\n  const updateCrew = useUpdateCrew();\n  const deleteCrew = useDeleteCrew();\n\n  const { data: usersResponse } = useUsers({\n    page: 1,\n    per_page: 100\n  });\n  const { data: projectsResponse, isLoading: projectsLoading } = useProjects({\n    page: 1,\n    per_page: 50\n  });\n\n  // Fetch crew assignments\n  const { data: equipmentAssignments, isLoading: equipmentLoading } = useCrewEquipmentAssignments(teamId);\n  const { data: vehicleAssignments, isLoading: vehicleLoading } = useCrewVehicleAssignments(teamId);\n\n  const users = usersResponse?.items || [];\n  const projects = projectsResponse?.items || [];\n  const foremen = users.filter(user => [\"foreman\", \"pm\", \"admin\"].includes(user.role));\n\n  const editTeamForm = useForm<EditTeamFormData>({\n    resolver: zodResolver(editTeamSchema),\n    defaultValues: {\n      name: crew?.name || \"\",\n      foreman_user_id: crew?.foreman_user_id || \"\",\n      project_id: crew?.project_id || \"\",\n    },\n  });\n\n  // Update form when crew data loads\n  useEffect(() => {\n    if (crew) {\n      editTeamForm.reset({\n        name: crew.name,\n        foreman_user_id: crew.foreman_user_id || \"\",\n        project_id: crew.project_id || \"\",\n      });\n    }\n  }, [crew, editTeamForm]);\n\n  const handleUpdateTeam = async (data: EditTeamFormData) => {\n    if (!crew) return;\n\n    try {\n      const teamData = {\n        name: data.name,\n        foreman_user_id: data.foreman_user_id === \"none\" ? undefined : data.foreman_user_id,\n        project_id: data.project_id === \"none\" ? undefined : data.project_id,\n      };\n\n      await updateCrew.mutateAsync({ id: crew.id, data: teamData });\n      setIsEditing(false);\n    } catch (error) {\n      console.error(\"Failed to update team:\", error);\n    }\n  };\n\n  const handleDeleteTeam = async () => {\n    if (!crew) return;\n\n    try {\n      await deleteCrew.mutateAsync(crew.id);\n      router.push(\"/dashboard/teams\");\n    } catch (error) {\n      console.error(\"Failed to delete team:\", error);\n    }\n  };\n\n\n  const getRoleColor = (role: string) => {\n    switch (role) {\n      case \"foreman\":\n        return \"default\";\n      case \"crew\":\n      case \"worker\":\n        return \"secondary\";\n      default:\n        return \"outline\";\n    }\n  };\n\n  if (crewLoading) {\n    return (\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center space-x-4\">\n          <div className=\"h-10 w-20 bg-muted animate-pulse rounded\" />\n          <div>\n            <div className=\"h-8 w-64 bg-muted animate-pulse rounded\" />\n            <div className=\"h-4 w-96 mt-2 bg-muted animate-pulse rounded\" />\n          </div>\n        </div>\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n          <div className=\"h-96 bg-muted animate-pulse rounded\" />\n          <div className=\"h-96 bg-muted animate-pulse rounded\" />\n        </div>\n      </div>\n    );\n  }\n\n  if (error || !crew) {\n    return (\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center space-x-4\">\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            onClick={() => router.back()}\n            className=\"flex items-center space-x-2\"\n          >\n            <ArrowLeft className=\"h-4 w-4\" />\n            <span>Back</span>\n          </Button>\n          <div>\n            <h1 className=\"text-3xl font-bold tracking-tight text-destructive\">Team Not Found</h1>\n            <p className=\"text-muted-foreground\">\n              The team you're looking for doesn't exist or has been deleted.\n            </p>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex items-center space-x-4\">\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            onClick={() => router.back()}\n            className=\"flex items-center space-x-2\"\n          >\n            <ArrowLeft className=\"h-4 w-4\" />\n            <span>Back</span>\n          </Button>\n          <div>\n            <h1 className=\"text-3xl font-bold tracking-tight\">{crew.name}</h1>\n            <p className=\"text-muted-foreground\">\n              Team details and member management\n            </p>\n          </div>\n        </div>\n        {canManageTeams && (\n          <div className=\"flex items-center space-x-2\">\n            {!isEditing ? (\n              <Button\n                variant=\"outline\"\n                onClick={() => setIsEditing(true)}\n                className=\"flex items-center space-x-2\"\n              >\n                <Edit className=\"h-4 w-4\" />\n                <span>Edit Team</span>\n              </Button>\n            ) : (\n              <Button\n                variant=\"outline\"\n                onClick={() => setIsEditing(false)}\n                className=\"flex items-center space-x-2\"\n              >\n                <X className=\"h-4 w-4\" />\n                <span>Cancel</span>\n              </Button>\n            )}\n            <AlertDialog>\n              <AlertDialogTrigger asChild>\n                <Button variant=\"destructive\" size=\"sm\">\n                  <Trash2 className=\"h-4 w-4\" />\n                </Button>\n              </AlertDialogTrigger>\n              <AlertDialogContent>\n                <AlertDialogHeader>\n                  <AlertDialogTitle>Delete Team</AlertDialogTitle>\n                  <AlertDialogDescription>\n                    Are you sure you want to delete \"{crew.name}\"? This action cannot be undone.\n                  </AlertDialogDescription>\n                </AlertDialogHeader>\n                <AlertDialogFooter>\n                  <AlertDialogCancel>Cancel</AlertDialogCancel>\n                  <AlertDialogAction\n                    onClick={handleDeleteTeam}\n                    className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n                  >\n                    Delete\n                  </AlertDialogAction>\n                </AlertDialogFooter>\n              </AlertDialogContent>\n            </AlertDialog>\n          </div>\n        )}\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n        {/* Team Information */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"flex items-center space-x-2\">\n              <Settings className=\"h-5 w-5\" />\n              <span>Team Information</span>\n            </CardTitle>\n            <CardDescription>\n              Basic team details and assignments\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            {!isEditing ? (\n              <div className=\"space-y-4\">\n                <div>\n                  <Label className=\"text-sm font-medium\">Team Name</Label>\n                  <p className=\"text-lg\">{crew.name}</p>\n                </div>\n\n                {crew.foreman && (\n                  <div>\n                    <Label className=\"text-sm font-medium\">Team Leader / Foreman</Label>\n                    <div className=\"flex items-center space-x-2 mt-1\">\n                      <Badge variant=\"default\">{crew.foreman.role}</Badge>\n                      <span className=\"text-sm\">{crew.foreman.full_name}</span>\n                    </div>\n                    {crew.foreman.email && (\n                      <div className=\"flex items-center space-x-2 text-sm text-muted-foreground mt-1\">\n                        <Mail className=\"h-3 w-3\" />\n                        <span>{crew.foreman.email}</span>\n                      </div>\n                    )}\n                    {crew.foreman.phone && (\n                      <div className=\"flex items-center space-x-2 text-sm text-muted-foreground\">\n                        <Phone className=\"h-3 w-3\" />\n                        <span>{crew.foreman.phone}</span>\n                      </div>\n                    )}\n                  </div>\n                )}\n\n                {crew.project_name && (\n                  <div>\n                    <Label className=\"text-sm font-medium\">Assigned Project</Label>\n                    <div className=\"flex items-center space-x-2 mt-1\">\n                      <MapPin className=\"h-4 w-4 text-muted-foreground\" />\n                      <span>{crew.project_name}</span>\n                    </div>\n                  </div>\n                )}\n\n                <div>\n                  <Label className=\"text-sm font-medium\">Status</Label>\n                  <div className=\"mt-1\">\n                    <Badge variant=\"secondary\">{crew.status}</Badge>\n                  </div>\n                </div>\n\n                <div>\n                  <Label className=\"text-sm font-medium\">Created</Label>\n                  <div className=\"flex items-center space-x-2 text-sm text-muted-foreground mt-1\">\n                    <Calendar className=\"h-3 w-3\" />\n                    <span>{new Date(crew.created_at).toLocaleDateString()}</span>\n                  </div>\n                </div>\n              </div>\n            ) : (\n              <Form {...editTeamForm}>\n                <form onSubmit={editTeamForm.handleSubmit(handleUpdateTeam)} className=\"space-y-4\">\n                  <FormField\n                    control={editTeamForm.control}\n                    name=\"name\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Team Name *</FormLabel>\n                        <FormControl>\n                          <Input\n                            placeholder=\"e.g., Installation Team Alpha\"\n                            {...field}\n                          />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={editTeamForm.control}\n                    name=\"foreman_user_id\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Team Leader / Foreman</FormLabel>\n                        <Select onValueChange={field.onChange} value={field.value}>\n                          <FormControl>\n                            <SelectTrigger>\n                              <SelectValue placeholder=\"Select team leader\" />\n                            </SelectTrigger>\n                          </FormControl>\n                          <SelectContent>\n                            <SelectItem value=\"none\">No leader assigned</SelectItem>\n                            {foremen.map((user) => (\n                              <SelectItem key={user.id} value={user.id}>\n                                {user.full_name} ({user.role})\n                              </SelectItem>\n                            ))}\n                          </SelectContent>\n                        </Select>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={editTeamForm.control}\n                    name=\"project_id\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>Assign to Project</FormLabel>\n                        <Select onValueChange={field.onChange} value={field.value}>\n                          <FormControl>\n                            <SelectTrigger>\n                              <SelectValue placeholder=\"Select project (optional)\" />\n                            </SelectTrigger>\n                          </FormControl>\n                          <SelectContent>\n                            <SelectItem value=\"none\">No project assigned</SelectItem>\n                            {projectsLoading ? (\n                              <SelectItem value=\"loading\" disabled>Loading projects...</SelectItem>\n                            ) : (\n                              projects.map((project) => (\n                                <SelectItem key={project.id} value={project.id}>\n                                  {project.name}\n                                </SelectItem>\n                              ))\n                            )}\n                          </SelectContent>\n                        </Select>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <div className=\"flex justify-end space-x-2 pt-4\">\n                    <Button\n                      type=\"button\"\n                      variant=\"outline\"\n                      onClick={() => setIsEditing(false)}\n                    >\n                      <X className=\"mr-2 h-4 w-4\" />\n                      Cancel\n                    </Button>\n                    <Button type=\"submit\" disabled={updateCrew.isPending}>\n                      {updateCrew.isPending ? (\n                        <div className=\"h-4 w-4 animate-spin rounded-full border-2 border-background border-t-transparent mr-2\" />\n                      ) : (\n                        <Save className=\"mr-2 h-4 w-4\" />\n                      )}\n                      Save Changes\n                    </Button>\n                  </div>\n                </form>\n              </Form>\n            )}\n          </CardContent>\n        </Card>\n\n        {/* Team Members */}\n        <Card>\n          <CardHeader>\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <CardTitle className=\"flex items-center space-x-2\">\n                  <Users className=\"h-5 w-5\" />\n                  <span>Team Members ({crew.members?.length || 0})</span>\n                </CardTitle>\n                <CardDescription>\n                  Current team members and their roles\n                </CardDescription>\n              </div>\n              {canManageTeams && (\n                <Button\n                  variant=\"outline\"\n                  onClick={() => router.push(`/dashboard/teams/${teamId}/members`)}\n                  className=\"flex items-center space-x-2\"\n                >\n                  <UserPlus className=\"h-4 w-4\" />\n                  <span>Manage Members</span>\n                </Button>\n              )}\n            </div>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-3\">\n              {crew.members?.length === 0 ? (\n                <div className=\"text-center py-8\">\n                  <UserPlus className=\"mx-auto h-12 w-12 text-muted-foreground\" />\n                  <h3 className=\"mt-2 text-sm font-semibold\">No team members</h3>\n                  <p className=\"mt-1 text-sm text-muted-foreground\">\n                    This team doesn't have any members assigned yet.\n                  </p>\n                  {canManageTeams && (\n                    <Button\n                      variant=\"outline\"\n                      className=\"mt-4\"\n                      onClick={() => router.push(`/dashboard/teams/${teamId}/members`)}\n                    >\n                      <UserPlus className=\"mr-2 h-4 w-4\" />\n                      Add Members\n                    </Button>\n                  )}\n                </div>\n              ) : (\n                crew.members?.map((member) => (\n                  <div\n                    key={member.id}\n                    className=\"flex items-center space-x-3 p-3 border rounded-lg\"\n                  >\n                    <div className=\"flex-1\">\n                      <div className=\"font-medium text-sm\">{member.user.full_name}</div>\n                      <div className=\"text-xs text-muted-foreground\">\n                        {member.user.email || member.user.phone || \"No contact info\"}\n                      </div>\n                    </div>\n                    <div className=\"flex items-center space-x-2\">\n                      <Badge variant={getRoleColor(member.user.role || \"\")}>\n                        {member.user.role}\n                      </Badge>\n                      <Badge variant=\"outline\">\n                        {member.role_in_crew}\n                      </Badge>\n                      <WorkerDocumentsDialog\n                        userId={member.user.id}\n                        userName={member.user.full_name}\n                      />\n                    </div>\n                  </div>\n                ))\n              )}\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Assigned Resources - Full Width Section */}\n      <Card>\n          <CardHeader>\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <CardTitle className=\"flex items-center space-x-2\">\n                  <Package className=\"h-5 w-5\" />\n                  <span>Assigned Resources</span>\n                </CardTitle>\n                <CardDescription>\n                  Equipment and vehicles assigned to this crew\n                </CardDescription>\n              </div>\n              {canManageTeams && (\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={() => router.push('/dashboard/equipment/assignments/new')}\n                  className=\"flex items-center space-x-2\"\n                >\n                  <Package className=\"h-4 w-4\" />\n                  <span>Assign Resource</span>\n                </Button>\n              )}\n            </div>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n              {/* Equipment Section */}\n              <div>\n                <div className=\"flex items-center space-x-2 mb-3\">\n                  <Wrench className=\"h-5 w-5 text-muted-foreground\" />\n                  <span className=\"text-lg font-semibold\">Equipment ({equipmentAssignments?.length || 0})</span>\n                </div>\n                {equipmentLoading ? (\n                  <div className=\"space-y-2\">\n                    {Array.from({ length: 2 }).map((_, i) => (\n                      <div key={i} className=\"h-16 bg-muted animate-pulse rounded\" />\n                    ))}\n                  </div>\n                ) : !equipmentAssignments?.length ? (\n                  <div className=\"text-center py-6 border rounded-lg bg-muted/10\">\n                    <Wrench className=\"mx-auto h-12 w-12 text-muted-foreground\" />\n                    <p className=\"mt-2 text-sm text-muted-foreground\">No equipment assigned</p>\n                  </div>\n                ) : (\n                  <div className=\"space-y-3\">\n                    {equipmentAssignments?.map((assignment) => (\n                      <div\n                        key={assignment.id}\n                        className=\"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/5 transition-colors\"\n                      >\n                        <div className=\"flex items-center space-x-3\">\n                          <Wrench className=\"h-5 w-5 text-muted-foreground\" />\n                          <div>\n                            <div className=\"font-medium\">\n                              {assignment.equipment?.name || 'Unknown Equipment'}\n                            </div>\n                            {assignment.equipment?.inventory_no && (\n                              <div className=\"text-sm text-muted-foreground\">\n                                #{assignment.equipment.inventory_no}\n                              </div>\n                            )}\n                          </div>\n                        </div>\n                        <div className=\"text-right\">\n                          <div className=\"text-xs text-muted-foreground\">\n                            {assignment.is_permanent ? 'Permanent' : 'Temporary'}\n                          </div>\n                          {assignment.project_name && (\n                            <div className=\"text-xs text-muted-foreground\">\n                              Project: {assignment.project_name}\n                            </div>\n                          )}\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </div>\n\n              {/* Vehicle Section */}\n              <div>\n                <div className=\"flex items-center space-x-2 mb-3\">\n                  <Truck className=\"h-5 w-5 text-muted-foreground\" />\n                  <span className=\"text-lg font-semibold\">Vehicles ({vehicleAssignments?.length || 0})</span>\n                </div>\n                {vehicleLoading ? (\n                  <div className=\"space-y-2\">\n                    {Array.from({ length: 2 }).map((_, i) => (\n                      <div key={i} className=\"h-16 bg-muted animate-pulse rounded\" />\n                    ))}\n                  </div>\n                ) : !vehicleAssignments?.length ? (\n                  <div className=\"text-center py-6 border rounded-lg bg-muted/10\">\n                    <Truck className=\"mx-auto h-12 w-12 text-muted-foreground\" />\n                    <p className=\"mt-2 text-sm text-muted-foreground\">No vehicles assigned</p>\n                  </div>\n                ) : (\n                  <div className=\"space-y-3\">\n                    {vehicleAssignments?.map((assignment) => (\n                      <div\n                        key={assignment.id}\n                        className=\"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/5 transition-colors\"\n                      >\n                        <div className=\"flex items-center space-x-3\">\n                          <Truck className=\"h-5 w-5 text-muted-foreground\" />\n                          <div>\n                            <div className=\"font-medium\">\n                              {assignment.vehicle?.brand} {assignment.vehicle?.model}\n                            </div>\n                            {assignment.vehicle?.plate_number && (\n                              <div className=\"text-sm text-muted-foreground\">\n                                 {assignment.vehicle.plate_number}\n                              </div>\n                            )}\n                          </div>\n                        </div>\n                        <div className=\"text-right\">\n                          <div className=\"text-xs text-muted-foreground\">\n                            {assignment.is_permanent ? 'Permanent' : 'Temporary'}\n                          </div>\n                          {assignment.project_name && (\n                            <div className=\"text-xs text-muted-foreground\">\n                              Project: {assignment.project_name}\n                            </div>\n                          )}\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n    </div>\n  );\n}"],"names":[],"mappings":"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","debugId":null}}]
}