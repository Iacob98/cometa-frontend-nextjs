(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,32661,e=>{"use strict";e.s(["useCreateProject",()=>c,"useDeleteProject",()=>u,"useProject",()=>o,"useProjectStats",()=>m,"useProjects",()=>i,"useUpdateProject",()=>d]);var t=e.i(66027),r=e.i(54616),s=e.i(12598),a=e.i(46696),l=e.i(41931);let n={all:["projects"],lists:()=>[...n.all,"list"],list:e=>[...n.lists(),e],details:()=>[...n.all,"detail"],detail:e=>[...n.details(),e]};function i(e){return(0,t.useQuery)({queryKey:n.list(e||{}),queryFn:()=>l.projectsApi.getProjects(e),staleTime:3e5})}function o(e){return(0,t.useQuery)({queryKey:n.detail(e),queryFn:()=>l.projectsApi.getProject(e),enabled:!!e,staleTime:3e5})}function c(){let e=(0,s.useQueryClient)();return(0,r.useMutation)({mutationFn:e=>l.projectsApi.createProject(e),onSuccess:t=>{e.invalidateQueries({queryKey:n.lists()}),e.setQueryData(n.detail(t.id),t),a.toast.success("Project created successfully")},onError:e=>{a.toast.error("Failed to create project: ".concat(e.message))}})}function d(){let e=(0,s.useQueryClient)();return(0,r.useMutation)({mutationFn:e=>{let{id:t,data:r}=e;return l.projectsApi.updateProject(t,r)},onMutate:async t=>{let{id:r,data:s}=t;await e.cancelQueries({queryKey:n.detail(r)});let a=e.getQueryData(n.detail(r));return e.setQueryData(n.detail(r),e=>e?{...e,...s}:e),{previousProject:a}},onError:(t,r,s)=>{let{id:l}=r;(null==s?void 0:s.previousProject)&&e.setQueryData(n.detail(l),s.previousProject),a.toast.error("Failed to update project: ".concat(t.message))},onSuccess:t=>{e.invalidateQueries({queryKey:n.lists()}),a.toast.success("Project updated successfully")},onSettled:(t,r,s)=>{let{id:a}=s;e.invalidateQueries({queryKey:n.detail(a)})}})}function u(){let e=(0,s.useQueryClient)();return(0,r.useMutation)({mutationFn:e=>l.projectsApi.deleteProject(e),onSuccess:(t,r)=>{e.removeQueries({queryKey:n.detail(r)}),e.invalidateQueries({queryKey:n.lists()}),a.toast.success("Project deleted successfully")},onError:e=>{a.toast.error("Failed to delete project: ".concat(e.message))}})}function m(e){return(0,t.useQuery)({queryKey:[...n.detail(e),"stats"],queryFn:async()=>{let t=await fetch("/api/projects/".concat(e,"/stats"));if(!t.ok)throw Error("Failed to fetch project statistics");return t.json()},staleTime:12e4,enabled:!!e})}},71689,e=>{"use strict";e.s(["ArrowLeft",()=>t],71689);let t=(0,e.i(75254).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},56909,e=>{"use strict";e.s(["Save",()=>t],56909);let t=(0,e.i(75254).default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},46835,e=>{"use strict";e.s(["useDeleteUser",()=>c,"useProjectManagers",()=>d,"useUpdateUser",()=>o,"useUsers",()=>i]);var t=e.i(66027),r=e.i(54616),s=e.i(12598),a=e.i(46696),l=e.i(41931);let n={all:["users"],lists:()=>[...n.all,"list"],list:e=>[...n.lists(),e],details:()=>[...n.all,"detail"],detail:e=>[...n.details(),e]};function i(e){return(0,t.useQuery)({queryKey:n.list(e||{}),queryFn:()=>l.usersApi.getUsers(e),staleTime:3e5})}function o(){let e=(0,s.useQueryClient)();return(0,r.useMutation)({mutationFn:e=>{let{id:t,data:r}=e;return l.usersApi.updateUser(t,r)},onMutate:async t=>{let{id:r,data:s}=t;await e.cancelQueries({queryKey:n.detail(r)});let a=e.getQueryData(n.detail(r));return e.setQueryData(n.detail(r),e=>e?{...e,...s}:e),{previousUser:a}},onError:(t,r,s)=>{let{id:l}=r;(null==s?void 0:s.previousUser)&&e.setQueryData(n.detail(l),s.previousUser),a.toast.error("Failed to update user: ".concat(t.message))},onSuccess:()=>{e.invalidateQueries({queryKey:n.lists()}),a.toast.success("User updated successfully")},onSettled:(t,r,s)=>{let{id:a}=s;e.invalidateQueries({queryKey:n.detail(a)})}})}function c(){let e=(0,s.useQueryClient)();return(0,r.useMutation)({mutationFn:e=>l.usersApi.deleteUser(e),onSuccess:(t,r)=>{e.removeQueries({queryKey:n.detail(r)}),e.invalidateQueries({queryKey:n.lists()}),a.toast.success("User deleted successfully")},onError:e=>{a.toast.error("Failed to delete user: ".concat(e.message))}})}function d(){return i({role:"pm",page:1,per_page:50})}},47697,e=>{"use strict";e.s(["CalendarIcon",()=>t.default]);var t=e.i(61277)},86909,e=>{"use strict";e.s(["requireAuth",()=>s]);var t=e.i(18566),r=e.i(71436);function s(){(function(){let e=(0,r.getStoredToken)(),t=(0,r.getStoredUser)();return e&&t?t:null})()||(0,t.redirect)("/login")}},44973,e=>{"use strict";e.s(["default",()=>y]);var t=e.i(43476),r=e.i(18566),s=e.i(53145),a=e.i(94814),l=e.i(81307),n=e.i(47697),i=e.i(71689),o=e.i(56909),c=e.i(7486),d=e.i(19455),u=e.i(15288),m=e.i(3133),j=e.i(93479),p=e.i(67489),h=e.i(32661),x=e.i(46835),g=e.i(86909);let F=l.z.object({name:l.z.string().min(1,"Project name is required").max(255,"Project name too long"),customer:l.z.string().optional(),city:l.z.string().optional(),address:l.z.string().optional(),contact_24h:l.z.string().optional(),start_date:l.z.string().optional(),end_date_plan:l.z.string().optional(),total_length_m:l.z.coerce.number().min(0,"Length must be positive"),base_rate_per_m:l.z.coerce.number().min(0,"Rate must be positive"),language_default:l.z.enum(["ru","en","de","uz","tr"]),pm_user_id:l.z.string().optional()});function y(){(0,g.requireAuth)();let e=(0,r.useRouter)(),l=(0,h.useCreateProject)(),{data:y,isLoading:f}=(0,x.useProjectManagers)(),v=(0,s.useForm)({resolver:(0,a.zodResolver)(F),defaultValues:{name:"",customer:"",city:"",address:"",contact_24h:"",start_date:"",end_date_plan:"",total_length_m:0,base_rate_per_m:15.5,language_default:"de",pm_user_id:"none"}}),_=async t=>{try{let r={...t,start_date:t.start_date||void 0,end_date_plan:t.end_date_plan||void 0,pm_user_id:"none"!==t.pm_user_id&&t.pm_user_id?t.pm_user_id:void 0},s=await l.mutateAsync(r);e.push("/dashboard/projects/".concat(s.id))}catch(e){console.error("Failed to create project:",e)}},b=[{value:"de",label:"German (Deutsch)"},{value:"en",label:"English"},{value:"ru",label:"Russian (Русский)"},{value:"uz",label:"Uzbek (Oʻzbek)"},{value:"tr",label:"Turkish (Türkçe)"}];return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)(d.Button,{variant:"ghost",size:"sm",onClick:()=>e.back(),className:"flex items-center space-x-2",children:[(0,t.jsx)(i.ArrowLeft,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Back"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Create New Project"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Set up a new fiber optic construction project"})]})]})}),(0,t.jsx)("div",{className:"max-w-2xl",children:(0,t.jsx)(m.Form,{...v,children:(0,t.jsxs)("form",{onSubmit:v.handleSubmit(_),className:"space-y-6",children:[(0,t.jsxs)(u.Card,{children:[(0,t.jsxs)(u.CardHeader,{children:[(0,t.jsxs)(u.CardTitle,{className:"flex items-center space-x-2",children:[(0,t.jsx)(c.Building2,{className:"h-5 w-5"}),(0,t.jsx)("span",{children:"Basic Information"})]}),(0,t.jsx)(u.CardDescription,{children:"Enter the fundamental details about the project"})]}),(0,t.jsxs)(u.CardContent,{className:"space-y-6",children:[(0,t.jsx)(m.FormField,{control:v.control,name:"name",render:e=>{let{field:r}=e;return(0,t.jsxs)(m.FormItem,{children:[(0,t.jsx)(m.FormLabel,{children:"Project Name *"}),(0,t.jsx)(m.FormControl,{children:(0,t.jsx)(j.Input,{placeholder:"e.g., Fiber Installation Berlin District 1",...r})}),(0,t.jsx)(m.FormDescription,{children:"A clear, descriptive name for the project"}),(0,t.jsx)(m.FormMessage,{})]})}}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsx)(m.FormField,{control:v.control,name:"customer",render:e=>{let{field:r}=e;return(0,t.jsxs)(m.FormItem,{children:[(0,t.jsx)(m.FormLabel,{children:"Customer"}),(0,t.jsx)(m.FormControl,{children:(0,t.jsx)(j.Input,{placeholder:"e.g., Deutsche Telekom",...r})}),(0,t.jsx)(m.FormMessage,{})]})}}),(0,t.jsx)(m.FormField,{control:v.control,name:"city",render:e=>{let{field:r}=e;return(0,t.jsxs)(m.FormItem,{children:[(0,t.jsx)(m.FormLabel,{children:"City"}),(0,t.jsx)(m.FormControl,{children:(0,t.jsx)(j.Input,{placeholder:"e.g., Berlin",...r})}),(0,t.jsx)(m.FormMessage,{})]})}})]}),(0,t.jsx)(m.FormField,{control:v.control,name:"address",render:e=>{let{field:r}=e;return(0,t.jsxs)(m.FormItem,{children:[(0,t.jsx)(m.FormLabel,{children:"Project Address"}),(0,t.jsx)(m.FormControl,{children:(0,t.jsx)(j.Input,{placeholder:"e.g., Hauptstraße 123, 10115 Berlin",...r})}),(0,t.jsx)(m.FormDescription,{children:"Primary address or area where the work will be performed"}),(0,t.jsx)(m.FormMessage,{})]})}}),(0,t.jsx)(m.FormField,{control:v.control,name:"contact_24h",render:e=>{let{field:r}=e;return(0,t.jsxs)(m.FormItem,{children:[(0,t.jsx)(m.FormLabel,{children:"24h Emergency Contact"}),(0,t.jsx)(m.FormControl,{children:(0,t.jsx)(j.Input,{placeholder:"e.g., +49 30 12345678",...r})}),(0,t.jsx)(m.FormDescription,{children:"Contact number for emergencies during the project"}),(0,t.jsx)(m.FormMessage,{})]})}}),(0,t.jsx)(m.FormField,{control:v.control,name:"language_default",render:e=>{let{field:r}=e;return(0,t.jsxs)(m.FormItem,{children:[(0,t.jsx)(m.FormLabel,{children:"Default Language"}),(0,t.jsxs)(p.Select,{onValueChange:r.onChange,defaultValue:r.value,children:[(0,t.jsx)(m.FormControl,{children:(0,t.jsx)(p.SelectTrigger,{children:(0,t.jsx)(p.SelectValue,{placeholder:"Select project language"})})}),(0,t.jsx)(p.SelectContent,{children:b.map(e=>(0,t.jsx)(p.SelectItem,{value:e.value,children:e.label},e.value))})]}),(0,t.jsx)(m.FormDescription,{children:"Primary language used for project documentation and interface"}),(0,t.jsx)(m.FormMessage,{})]})}}),(0,t.jsx)(m.FormField,{control:v.control,name:"pm_user_id",render:e=>{var r;let{field:s}=e;return(0,t.jsxs)(m.FormItem,{children:[(0,t.jsx)(m.FormLabel,{children:"Project Manager"}),(0,t.jsxs)(p.Select,{onValueChange:s.onChange,value:s.value,children:[(0,t.jsx)(m.FormControl,{children:(0,t.jsx)(p.SelectTrigger,{children:(0,t.jsx)(p.SelectValue,{placeholder:"Select project manager (optional)"})})}),(0,t.jsxs)(p.SelectContent,{children:[(0,t.jsx)(p.SelectItem,{value:"none",children:"No project manager assigned"}),f?(0,t.jsx)(p.SelectItem,{value:"loading",disabled:!0,children:"Loading project managers..."}):null==y||null==(r=y.items)?void 0:r.map(e=>(0,t.jsxs)(p.SelectItem,{value:e.id,children:[e.first_name," ",e.last_name," (",e.email,")"]},e.id))]})]}),(0,t.jsx)(m.FormDescription,{children:"Choose a project manager to oversee this project"}),(0,t.jsx)(m.FormMessage,{})]})}})]})]}),(0,t.jsxs)(u.Card,{children:[(0,t.jsxs)(u.CardHeader,{children:[(0,t.jsx)(u.CardTitle,{children:"Project Scope"}),(0,t.jsx)(u.CardDescription,{children:"Define the scope and financial parameters of the project"})]}),(0,t.jsxs)(u.CardContent,{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsx)(m.FormField,{control:v.control,name:"total_length_m",render:e=>{let{field:r}=e;return(0,t.jsxs)(m.FormItem,{children:[(0,t.jsx)(m.FormLabel,{children:"Total Length (meters) *"}),(0,t.jsx)(m.FormControl,{children:(0,t.jsx)(j.Input,{type:"number",step:"0.01",min:"0",placeholder:"e.g., 1500",...r})}),(0,t.jsx)(m.FormDescription,{children:"Total length of fiber cable to be installed"}),(0,t.jsx)(m.FormMessage,{})]})}}),(0,t.jsx)(m.FormField,{control:v.control,name:"base_rate_per_m",render:e=>{let{field:r}=e;return(0,t.jsxs)(m.FormItem,{children:[(0,t.jsx)(m.FormLabel,{children:"Rate per Meter (€) *"}),(0,t.jsx)(m.FormControl,{children:(0,t.jsx)(j.Input,{type:"number",step:"0.01",min:"0",placeholder:"e.g., 15.50",...r})}),(0,t.jsx)(m.FormDescription,{children:"Base rate charged per meter of installation"}),(0,t.jsx)(m.FormMessage,{})]})}})]}),(0,t.jsxs)("div",{className:"rounded-md bg-muted p-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"font-medium",children:"Estimated Project Value:"}),(0,t.jsxs)("span",{className:"text-lg font-bold",children:["€",(v.watch("total_length_m")*v.watch("base_rate_per_m")).toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground mt-1",children:[v.watch("total_length_m")," meters × €",v.watch("base_rate_per_m")," per meter"]})]})]})]}),(0,t.jsxs)(u.Card,{children:[(0,t.jsxs)(u.CardHeader,{children:[(0,t.jsxs)(u.CardTitle,{className:"flex items-center space-x-2",children:[(0,t.jsx)(n.CalendarIcon,{className:"h-5 w-5"}),(0,t.jsx)("span",{children:"Project Timeline"})]}),(0,t.jsx)(u.CardDescription,{children:"Set the planned start and end dates (optional)"})]}),(0,t.jsx)(u.CardContent,{className:"space-y-6",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsx)(m.FormField,{control:v.control,name:"start_date",render:e=>{let{field:r}=e;return(0,t.jsxs)(m.FormItem,{children:[(0,t.jsx)(m.FormLabel,{children:"Planned Start Date"}),(0,t.jsx)(m.FormControl,{children:(0,t.jsx)(j.Input,{type:"date",...r})}),(0,t.jsx)(m.FormMessage,{})]})}}),(0,t.jsx)(m.FormField,{control:v.control,name:"end_date_plan",render:e=>{let{field:r}=e;return(0,t.jsxs)(m.FormItem,{children:[(0,t.jsx)(m.FormLabel,{children:"Planned End Date"}),(0,t.jsx)(m.FormControl,{children:(0,t.jsx)(j.Input,{type:"date",...r})}),(0,t.jsx)(m.FormMessage,{})]})}})]})})]}),(0,t.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,t.jsx)(d.Button,{type:"button",variant:"outline",onClick:()=>e.back(),children:"Cancel"}),(0,t.jsxs)(d.Button,{type:"submit",disabled:l.isPending,className:"flex items-center space-x-2",children:[l.isPending?(0,t.jsx)("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-background border-t-transparent"}):(0,t.jsx)(o.Save,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Create Project"})]})]})]})})})]})}}]);