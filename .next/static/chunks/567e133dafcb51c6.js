(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,71689,e=>{"use strict";e.s(["ArrowLeft",()=>r],71689);let r=(0,e.i(75254).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},56909,e=>{"use strict";e.s(["Save",()=>r],56909);let r=(0,e.i(75254).default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},57428,e=>{"use strict";e.s(["Checkbox",()=>N],57428);var r=e.i(43476),t=e.i(71645),a=e.i(20783),n=e.i(30030),l=e.i(81140),s=e.i(69340),i=e.i(99682),o=e.i(35804),c=e.i(96626),d=e.i(48425),u="Checkbox",[h,m]=(0,n.createContextScope)(u),[p,x]=h(u);function j(e){let{__scopeCheckbox:a,checked:n,children:l,defaultChecked:i,disabled:o,form:c,name:d,onCheckedChange:h,required:m,value:x="on",internal_do_not_use_render:j}=e,[v,g]=(0,s.useControllableState)({prop:n,defaultProp:null!=i&&i,onChange:h,caller:u}),[f,b]=t.useState(null),[y,F]=t.useState(null),C=t.useRef(!1),k=!f||!!c||!!f.closest("form"),w={checked:v,disabled:o,setChecked:g,control:f,setControl:b,name:d,form:c,value:x,hasConsumerStoppedPropagationRef:C,required:m,defaultChecked:!_(i)&&i,isFormControl:k,bubbleInput:y,setBubbleInput:F};return(0,r.jsx)(p,{scope:a,...w,children:"function"==typeof j?j(w):l})}var v="CheckboxTrigger",g=t.forwardRef((e,n)=>{let{__scopeCheckbox:s,onKeyDown:i,onClick:o,...c}=e,{control:u,value:h,disabled:m,checked:p,required:j,setControl:g,setChecked:f,hasConsumerStoppedPropagationRef:b,isFormControl:y,bubbleInput:F}=x(v,s),C=(0,a.useComposedRefs)(n,g),w=t.useRef(p);return t.useEffect(()=>{let e=null==u?void 0:u.form;if(e){let r=()=>f(w.current);return e.addEventListener("reset",r),()=>e.removeEventListener("reset",r)}},[u,f]),(0,r.jsx)(d.Primitive.button,{type:"button",role:"checkbox","aria-checked":_(p)?"mixed":p,"aria-required":j,"data-state":k(p),"data-disabled":m?"":void 0,disabled:m,value:h,...c,ref:C,onKeyDown:(0,l.composeEventHandlers)(i,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,l.composeEventHandlers)(o,e=>{f(e=>!!_(e)||!e),F&&y&&(b.current=e.isPropagationStopped(),b.current||e.stopPropagation())})})});g.displayName=v;var f=t.forwardRef((e,t)=>{let{__scopeCheckbox:a,name:n,checked:l,defaultChecked:s,required:i,disabled:o,value:c,onCheckedChange:d,form:u,...h}=e;return(0,r.jsx)(j,{__scopeCheckbox:a,checked:l,defaultChecked:s,disabled:o,required:i,onCheckedChange:d,name:n,form:u,value:c,internal_do_not_use_render:e=>{let{isFormControl:n}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g,{...h,ref:t,__scopeCheckbox:a}),n&&(0,r.jsx)(C,{__scopeCheckbox:a})]})}})});f.displayName=u;var b="CheckboxIndicator",y=t.forwardRef((e,t)=>{let{__scopeCheckbox:a,forceMount:n,...l}=e,s=x(b,a);return(0,r.jsx)(c.Presence,{present:n||_(s.checked)||!0===s.checked,children:(0,r.jsx)(d.Primitive.span,{"data-state":k(s.checked),"data-disabled":s.disabled?"":void 0,...l,ref:t,style:{pointerEvents:"none",...e.style}})})});y.displayName=b;var F="CheckboxBubbleInput",C=t.forwardRef((e,n)=>{let{__scopeCheckbox:l,...s}=e,{control:c,hasConsumerStoppedPropagationRef:u,checked:h,defaultChecked:m,required:p,disabled:j,name:v,value:g,form:f,bubbleInput:b,setBubbleInput:y}=x(F,l),C=(0,a.useComposedRefs)(n,y),k=(0,i.usePrevious)(h),w=(0,o.useSize)(c);t.useEffect(()=>{if(!b)return;let e=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set,r=!u.current;if(k!==h&&e){let t=new Event("click",{bubbles:r});b.indeterminate=_(h),e.call(b,!_(h)&&h),b.dispatchEvent(t)}},[b,k,h,u]);let S=t.useRef(!_(h)&&h);return(0,r.jsx)(d.Primitive.input,{type:"checkbox","aria-hidden":!0,defaultChecked:null!=m?m:S.current,required:p,disabled:j,name:v,value:g,form:f,...s,tabIndex:-1,ref:C,style:{...s.style,...w,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});function _(e){return"indeterminate"===e}function k(e){return _(e)?"indeterminate":e?"checked":"unchecked"}C.displayName=F;var w=e.i(43531),S=e.i(75157);let N=t.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)(f,{ref:t,className:(0,S.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...n,children:(0,r.jsx)(y,{className:(0,S.cn)("flex items-center justify-center text-current"),children:(0,r.jsx)(w.Check,{className:"h-4 w-4"})})})});N.displayName=f.displayName},31278,e=>{"use strict";e.s(["Loader2",()=>r],31278);let r=(0,e.i(75254).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},72436,e=>{"use strict";e.s(["Separator",()=>o],72436);var r=e.i(43476),t=e.i(71645),a=e.i(48425),n="horizontal",l=["horizontal","vertical"],s=t.forwardRef((e,t)=>{var s;let{decorative:i,orientation:o=n,...c}=e,d=(s=o,l.includes(s))?o:n;return(0,r.jsx)(a.Primitive.div,{"data-orientation":d,...i?{role:"none"}:{"aria-orientation":"vertical"===d?d:void 0,role:"separator"},...c,ref:t})});s.displayName="Separator";var i=e.i(75157);let o=t.forwardRef((e,t)=>{let{className:a,orientation:n="horizontal",decorative:l=!0,...o}=e;return(0,r.jsx)(s,{ref:t,decorative:l,orientation:n,className:(0,i.cn)("shrink-0 bg-border","horizontal"===n?"h-[1px] w-full":"h-full w-[1px]",a),...o})});o.displayName=s.displayName},29041,e=>{"use strict";e.s(["useCreateVehicle",()=>i,"useCrewVehicleAssignments",()=>o,"useVehicles",()=>s]);var r=e.i(54616),t=e.i(66027),a=e.i(12598),n=e.i(46696);let l={getVehicles:async e=>{let r=new URLSearchParams;(null==e?void 0:e.type)&&r.append("type",e.type),(null==e?void 0:e.status)&&r.append("status",e.status),(null==e?void 0:e.owned)&&r.append("owned",e.owned),(null==e?void 0:e.search)&&r.append("search",e.search),(null==e?void 0:e.page)&&r.append("page",e.page.toString()),(null==e?void 0:e.per_page)&&r.append("per_page",e.per_page.toString());let t="/api/vehicles".concat(r.toString()?"?".concat(r.toString()):""),a=await fetch(t);if(!a.ok)throw Error("Failed to fetch vehicles");return a.json()},createVehicle:async e=>{let r=await fetch("/api/vehicles",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!r.ok)throw Error((await r.json()).error||"Failed to create vehicle");let t=await r.json();return t.vehicle||t}};function s(e){return(0,t.useQuery)({queryKey:["vehicles",e],queryFn:()=>l.getVehicles(e)})}function i(){let e=(0,a.useQueryClient)();return(0,r.useMutation)({mutationFn:l.createVehicle,onSuccess:()=>{e.invalidateQueries({queryKey:["vehicles"]}),n.toast.success("Vehicle created successfully")},onError:e=>{n.toast.error(e.message)}})}function o(e){return(0,t.useQuery)({queryKey:["vehicle-assignments","crew",e],queryFn:async()=>{let r=await fetch("/api/resources/vehicle-assignments?crew_id=".concat(e,"&active_only=true"));if(!r.ok)throw Error("Failed to fetch vehicle assignments");return r.json()},enabled:!!e,staleTime:3e4})}},5125,e=>{"use strict";e.s(["Car",()=>r],5125);let r=(0,e.i(75254).default)("car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]])},90696,e=>{"use strict";e.s(["default",()=>F]);var r=e.i(43476),t=e.i(71645),a=e.i(18566),n=e.i(53145),l=e.i(94814),s=e.i(62201),i=e.i(71689),o=e.i(5125),c=e.i(56909),d=e.i(31278),u=e.i(19455),h=e.i(15288),m=e.i(3133),p=e.i(93479),x=e.i(67489),j=e.i(57428),v=e.i(72436),g=e.i(29041);let f=s.object({brand:s.string().min(1,"Brand is required").max(100,"Brand must be less than 100 characters"),model:s.string().min(1,"Model is required").max(100,"Model must be less than 100 characters"),plate_number:s.string().min(1,"Plate number is required").max(20,"Plate number must be less than 20 characters").regex(/^[A-Z0-9\-\s]+$/i,"Plate number can only contain letters, numbers, hyphens, and spaces"),type:s.enum(["van","truck","trailer","excavator","other"],{required_error:"Vehicle type is required"}),status:s.enum(["available","in_use","maintenance","broken"],{required_error:"Status is required"}),owned:s.boolean().default(!0),rental_price_per_day_eur:s.number().min(0,"Rental price per day must be 0 or greater").default(0),rental_price_per_hour_eur:s.number().min(0,"Rental price per hour must be 0 or greater").default(0),fuel_consumption_l_100km:s.number().min(0,"Fuel consumption must be 0 or greater").default(0),current_location:s.string().max(200,"Location must be less than 200 characters").default("Main Depot"),purchase_price_eur:s.number().min(0,"Purchase price must be 0 or greater").default(0)}),b=[{value:"van",label:"Van"},{value:"truck",label:"Truck"},{value:"trailer",label:"Trailer"},{value:"excavator",label:"Excavator"},{value:"other",label:"Other"}],y=[{value:"available",label:"Available"},{value:"in_use",label:"In Use"},{value:"maintenance",label:"Maintenance"},{value:"broken",label:"Broken"}];function F(){let e=(0,a.useRouter)(),[s,F]=(0,t.useState)(!1),C=(0,g.useCreateVehicle)(),_=(0,n.useForm)({resolver:(0,l.zodResolver)(f),defaultValues:{brand:"",model:"",plate_number:"",type:"van",status:"available",owned:!0,rental_price_per_day_eur:0,rental_price_per_hour_eur:0,fuel_consumption_l_100km:0,current_location:"Main Depot",purchase_price_eur:0,year_of_manufacture:void 0,mileage_km:void 0}}),k=async r=>{try{F(!0);let t={...r,plate_number:r.plate_number.toUpperCase().trim()};await C.mutateAsync(t),e.push("/dashboard/equipment")}catch(e){console.error("Failed to create vehicle:",e)}finally{F(!1)}},w=_.watch("owned");return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"flex items-center justify-between",children:(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)(u.Button,{variant:"ghost",size:"sm",onClick:()=>e.back(),className:"flex items-center space-x-2",children:[(0,r.jsx)(i.ArrowLeft,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:"Back"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Add New Vehicle"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Add a new vehicle to your fleet with all necessary details"})]})]})}),(0,r.jsx)(m.Form,{..._,children:(0,r.jsxs)("form",{onSubmit:_.handleSubmit(k),className:"space-y-6",children:[(0,r.jsxs)(h.Card,{children:[(0,r.jsxs)(h.CardHeader,{children:[(0,r.jsxs)(h.CardTitle,{className:"flex items-center space-x-2",children:[(0,r.jsx)(o.Car,{className:"h-5 w-5"}),(0,r.jsx)("span",{children:"Basic Information"})]}),(0,r.jsx)(h.CardDescription,{children:"Enter the basic details about the vehicle"})]}),(0,r.jsxs)(h.CardContent,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsx)(m.FormField,{control:_.control,name:"brand",render:e=>{let{field:t}=e;return(0,r.jsxs)(m.FormItem,{children:[(0,r.jsx)(m.FormLabel,{children:"Brand *"}),(0,r.jsx)(m.FormControl,{children:(0,r.jsx)(p.Input,{placeholder:"e.g., Mercedes, Ford, Toyota",...t})}),(0,r.jsx)(m.FormMessage,{})]})}}),(0,r.jsx)(m.FormField,{control:_.control,name:"model",render:e=>{let{field:t}=e;return(0,r.jsxs)(m.FormItem,{children:[(0,r.jsx)(m.FormLabel,{children:"Model *"}),(0,r.jsx)(m.FormControl,{children:(0,r.jsx)(p.Input,{placeholder:"e.g., Sprinter, Transit, Hilux",...t})}),(0,r.jsx)(m.FormMessage,{})]})}}),(0,r.jsx)(m.FormField,{control:_.control,name:"plate_number",render:e=>{let{field:t}=e;return(0,r.jsxs)(m.FormItem,{children:[(0,r.jsx)(m.FormLabel,{children:"Plate Number *"}),(0,r.jsx)(m.FormControl,{children:(0,r.jsx)(p.Input,{placeholder:"e.g., ABC-123, XYZ 456",...t,onChange:e=>t.onChange(e.target.value.toUpperCase())})}),(0,r.jsx)(m.FormDescription,{children:"License plate number (will be converted to uppercase)"}),(0,r.jsx)(m.FormMessage,{})]})}}),(0,r.jsx)(m.FormField,{control:_.control,name:"type",render:e=>{let{field:t}=e;return(0,r.jsxs)(m.FormItem,{children:[(0,r.jsx)(m.FormLabel,{children:"Vehicle Type *"}),(0,r.jsxs)(x.Select,{onValueChange:t.onChange,defaultValue:t.value,children:[(0,r.jsx)(m.FormControl,{children:(0,r.jsx)(x.SelectTrigger,{children:(0,r.jsx)(x.SelectValue,{placeholder:"Select vehicle type"})})}),(0,r.jsx)(x.SelectContent,{children:b.map(e=>(0,r.jsx)(x.SelectItem,{value:e.value,children:e.label},e.value))})]}),(0,r.jsx)(m.FormMessage,{})]})}})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsx)(m.FormField,{control:_.control,name:"status",render:e=>{let{field:t}=e;return(0,r.jsxs)(m.FormItem,{children:[(0,r.jsx)(m.FormLabel,{children:"Status *"}),(0,r.jsxs)(x.Select,{onValueChange:t.onChange,defaultValue:t.value,children:[(0,r.jsx)(m.FormControl,{children:(0,r.jsx)(x.SelectTrigger,{children:(0,r.jsx)(x.SelectValue,{placeholder:"Select status"})})}),(0,r.jsx)(x.SelectContent,{children:y.map(e=>(0,r.jsx)(x.SelectItem,{value:e.value,children:e.label},e.value))})]}),(0,r.jsx)(m.FormMessage,{})]})}}),(0,r.jsx)(m.FormField,{control:_.control,name:"current_location",render:e=>{let{field:t}=e;return(0,r.jsxs)(m.FormItem,{children:[(0,r.jsx)(m.FormLabel,{children:"Current Location"}),(0,r.jsx)(m.FormControl,{children:(0,r.jsx)(p.Input,{placeholder:"e.g., Main Depot, Project Site A",...t})}),(0,r.jsx)(m.FormMessage,{})]})}})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsx)(m.FormField,{control:_.control,name:"year_of_manufacture",render:e=>{let{field:t}=e;return(0,r.jsxs)(m.FormItem,{children:[(0,r.jsx)(m.FormLabel,{children:"Year of Manufacture"}),(0,r.jsx)(m.FormControl,{children:(0,r.jsx)(p.Input,{type:"number",placeholder:"e.g., 2020",value:t.value||"",onChange:e=>t.onChange(e.target.value?parseInt(e.target.value):void 0)})}),(0,r.jsx)(m.FormMessage,{})]})}}),(0,r.jsx)(m.FormField,{control:_.control,name:"mileage_km",render:e=>{let{field:t}=e;return(0,r.jsxs)(m.FormItem,{children:[(0,r.jsx)(m.FormLabel,{children:"Mileage (km)"}),(0,r.jsx)(m.FormControl,{children:(0,r.jsx)(p.Input,{type:"number",placeholder:"e.g., 50000",value:t.value||"",onChange:e=>t.onChange(e.target.value?parseFloat(e.target.value):void 0)})}),(0,r.jsx)(m.FormMessage,{})]})}})]}),(0,r.jsx)(m.FormField,{control:_.control,name:"fuel_consumption_l_100km",render:e=>{let{field:t}=e;return(0,r.jsxs)(m.FormItem,{children:[(0,r.jsx)(m.FormLabel,{children:"Fuel Consumption (L/100km)"}),(0,r.jsx)(m.FormControl,{children:(0,r.jsx)(p.Input,{type:"number",step:"0.1",placeholder:"e.g., 8.5",...t,onChange:e=>t.onChange(e.target.value?parseFloat(e.target.value):0)})}),(0,r.jsx)(m.FormDescription,{children:"Fuel consumption in liters per 100 kilometers"}),(0,r.jsx)(m.FormMessage,{})]})}})]})]}),(0,r.jsxs)(h.Card,{children:[(0,r.jsxs)(h.CardHeader,{children:[(0,r.jsx)(h.CardTitle,{children:"Financial Information"}),(0,r.jsx)(h.CardDescription,{children:"Ownership and pricing details for the vehicle"})]}),(0,r.jsxs)(h.CardContent,{className:"space-y-4",children:[(0,r.jsx)(m.FormField,{control:_.control,name:"owned",render:e=>{let{field:t}=e;return(0,r.jsxs)(m.FormItem,{className:"flex flex-row items-start space-x-3 space-y-0",children:[(0,r.jsx)(m.FormControl,{children:(0,r.jsx)(j.Checkbox,{checked:t.value,onCheckedChange:t.onChange})}),(0,r.jsxs)("div",{className:"space-y-1 leading-none",children:[(0,r.jsx)(m.FormLabel,{children:"Company Owned Vehicle"}),(0,r.jsx)(m.FormDescription,{children:"Check if this vehicle is owned by the company (uncheck for rental vehicles)"})]})]})}}),(0,r.jsx)(v.Separator,{}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsx)(m.FormField,{control:_.control,name:"purchase_price_eur",render:e=>{let{field:t}=e;return(0,r.jsxs)(m.FormItem,{children:[(0,r.jsx)(m.FormLabel,{children:"Purchase Price (EUR)"}),(0,r.jsx)(m.FormControl,{children:(0,r.jsx)(p.Input,{type:"number",step:"0.01",placeholder:"0.00",...t,onChange:e=>t.onChange(e.target.value?parseFloat(e.target.value):0)})}),(0,r.jsx)(m.FormDescription,{children:w?"Purchase price for owned vehicle":"Not applicable for rental vehicles"}),(0,r.jsx)(m.FormMessage,{})]})}}),(0,r.jsx)(m.FormField,{control:_.control,name:"rental_price_per_day_eur",render:e=>{let{field:t}=e;return(0,r.jsxs)(m.FormItem,{children:[(0,r.jsx)(m.FormLabel,{children:"Rental Price per Day (EUR)"}),(0,r.jsx)(m.FormControl,{children:(0,r.jsx)(p.Input,{type:"number",step:"0.01",placeholder:"0.00",...t,onChange:e=>t.onChange(e.target.value?parseFloat(e.target.value):0)})}),(0,r.jsx)(m.FormDescription,{children:w?"Internal cost per day for project allocation":"External rental cost per day"}),(0,r.jsx)(m.FormMessage,{})]})}})]}),(0,r.jsx)(m.FormField,{control:_.control,name:"rental_price_per_hour_eur",render:e=>{let{field:t}=e;return(0,r.jsxs)(m.FormItem,{children:[(0,r.jsx)(m.FormLabel,{children:"Rental Price per Hour (EUR)"}),(0,r.jsx)(m.FormControl,{children:(0,r.jsx)(p.Input,{type:"number",step:"0.01",placeholder:"0.00",...t,onChange:e=>t.onChange(e.target.value?parseFloat(e.target.value):0)})}),(0,r.jsx)(m.FormDescription,{children:w?"Internal hourly cost for project allocation":"External rental cost per hour"}),(0,r.jsx)(m.FormMessage,{})]})}})]})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,r.jsx)(u.Button,{type:"button",variant:"outline",onClick:()=>e.back(),disabled:s,children:"Cancel"}),(0,r.jsx)(u.Button,{type:"submit",disabled:s,children:s?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating Vehicle..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.Save,{className:"mr-2 h-4 w-4"}),"Create Vehicle"]})})]})]})})]})}}]);