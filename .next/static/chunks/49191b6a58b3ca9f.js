(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,23177,e=>{"use strict";e.s(["TileLayer",()=>r],23177);var s=e.i(24049),a=e.i(50699),t=e.i(15212),l=e.i(32322);let r=(0,a.createTileLayerComponent)(function(e,a){let{url:r,...i}=e,c=new l.TileLayer(r,(0,t.withPane)(i,a));return(0,s.createElementObject)(c,a)},function(e,s,a){let{opacity:t,zIndex:l}=s;null!=t&&t!==a.opacity&&e.setOpacity(t),null!=l&&l!==a.zIndex&&e.setZIndex(l);let{url:r}=s;null!=r&&r!==a.url&&e.setUrl(r)})},70685,e=>{"use strict";e.s(["ProjectMap",()=>S,"default",()=>C]);var s=e.i(43476),a=e.i(71645),t=e.i(23177),l=e.i(70703),r=e.i(32322),i=e.i(52008),c=e.i(46897),n=e.i(59386),d=e.i(34858),o=e.i(39616),u=e.i(19455),m=e.i(15288),h=e.i(87486),x=e.i(99375),j=e.i(10204),p=e.i(67489),g=e.i(75157),f=e.i(33793),v=e.i(71436);let N=(0,l.default)(()=>e.A(23021),{loadableGenerated:{modules:[45426]},ssr:!1}),y=(0,l.default)(()=>e.A(45378),{loadableGenerated:{modules:[99297]},ssr:!1}),b=(0,l.default)(()=>e.A(42540),{loadableGenerated:{modules:[76637]},ssr:!1}),w=(0,l.default)(()=>e.A(93647),{loadableGenerated:{modules:[2691]},ssr:!1}),k={osm:{name:"OpenStreetMap",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'},satellite:{name:"Satellite",url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",attribution:'&copy; <a href="https://www.esri.com/">Esri</a>'},terrain:{name:"Terrain",url:"https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",attribution:'&copy; <a href="https://opentopomap.org/">OpenTopoMap</a>'}};function S(e){let{projectId:l,height:S="600px",width:C="100%",className:M,showControls:T=!0,showMeasurementTools:L=!0,showGPSTracking:z=!0,defaultCenter:P=[52.52,13.405],defaultZoom:G=13}=e,{user:A}=(0,v.useAuth)(),[O,B]=(0,a.useState)(),[I,F]=(0,a.useState)({features:!0,routes:!0,measurements:!1,gpsTracking:!1,annotations:!1}),[R,U]=(0,a.useState)({tileLayer:"osm",showGrid:!1,showScale:!0,clusteredMarkers:!1}),[E,H]=(0,a.useState)(!1),[K,V]=(0,a.useState)(null),{data:W,isLoading:Z}=(0,f.useProjectGeospatialFeatures)(l),{data:_,isLoading:q}=(0,f.useProjectGeoRoutes)(l),{data:D,isLoading:J}=(0,f.useProjectGeoMeasurements)(l),Q=(0,a.useMemo)(()=>[],[]),X=(0,a.useCallback)(e=>{B(e.id)},[]),Y=(0,a.useCallback)(e=>{console.log("Edit feature:",e)},[]),$=e=>{F(s=>({...s,[e]:!s[e]}))},ee=(0,a.useCallback)(e=>{V(e),R.showScale&&r.default.control.scale().addTo(e)},[R.showScale]),es={features:(null==W?void 0:W.total)||0,routes:(null==_?void 0:_.total)||0,measurements:(null==D?void 0:D.total)||0},ea=(()=>{let e=[];return Z&&e.push("features"),q&&e.push("routes"),J&&e.push("measurements"),e.length>0?"Loading ".concat(e.join(", "),"..."):null})();return(0,s.jsxs)("div",{className:(0,g.cn)("relative",M),style:{height:S,width:C},children:[(0,s.jsxs)(N,{center:P,zoom:G,height:S,width:C,onMapReady:ee,children:[(0,s.jsx)(t.TileLayer,{attribution:k[R.tileLayer].attribution,url:k[R.tileLayer].url}),I.features&&(null==W?void 0:W.data)&&(0,s.jsx)(y,{features:W.data,onFeatureClick:X,onFeatureEdit:Y,selectedFeatureId:O,editable:(null==A?void 0:A.role)==="admin"||(null==A?void 0:A.role)==="pm"}),I.gpsTracking&&z&&(0,s.jsx)(b,{trackCurrentUser:!0,trackUsers:Q,enableTracking:!0,showAccuracy:!0}),L&&(0,s.jsx)(w,{projectId:l,onMeasurementSave:e=>{console.log("Measurement saved:",e)}})]}),T&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(u.Button,{size:"sm",variant:"secondary",className:"absolute top-4 right-4 z-[1000]",onClick:()=>H(!E),children:[(0,s.jsx)(o.Settings,{className:"w-4 h-4 mr-1"}),E?"Hide":"Controls"]}),E&&(0,s.jsxs)(m.Card,{className:"absolute top-16 right-4 z-[1000] w-64",children:[(0,s.jsx)(m.CardHeader,{className:"pb-2",children:(0,s.jsxs)(m.CardTitle,{className:"text-sm flex items-center gap-2",children:[(0,s.jsx)(i.Layers,{className:"w-4 h-4"}),"Map Controls"]})}),(0,s.jsxs)(m.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(j.Label,{className:"text-xs font-medium",children:"Layers"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(c.MapPin,{className:"w-3 h-3"}),(0,s.jsx)("span",{className:"text-xs",children:"Features"}),(0,s.jsx)(h.Badge,{variant:"secondary",className:"text-xs",children:es.features})]}),(0,s.jsx)(x.Switch,{checked:I.features,onCheckedChange:()=>$("features"),size:"sm"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(d.Navigation,{className:"w-3 h-3"}),(0,s.jsx)("span",{className:"text-xs",children:"Routes"}),(0,s.jsx)(h.Badge,{variant:"secondary",className:"text-xs",children:es.routes})]}),(0,s.jsx)(x.Switch,{checked:I.routes,onCheckedChange:()=>$("routes"),size:"sm"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(n.Ruler,{className:"w-3 h-3"}),(0,s.jsx)("span",{className:"text-xs",children:"Measurements"}),(0,s.jsx)(h.Badge,{variant:"secondary",className:"text-xs",children:es.measurements})]}),(0,s.jsx)(x.Switch,{checked:I.measurements,onCheckedChange:()=>$("measurements"),size:"sm"})]}),z&&(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(c.MapPin,{className:"w-3 h-3"}),(0,s.jsx)("span",{className:"text-xs",children:"GPS Tracking"})]}),(0,s.jsx)(x.Switch,{checked:I.gpsTracking,onCheckedChange:()=>$("gpsTracking"),size:"sm"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(j.Label,{className:"text-xs font-medium",children:"Map Style"}),(0,s.jsxs)(p.Select,{value:R.tileLayer,onValueChange:e=>U(s=>({...s,tileLayer:e})),children:[(0,s.jsx)(p.SelectTrigger,{className:"h-8",children:(0,s.jsx)(p.SelectValue,{})}),(0,s.jsx)(p.SelectContent,{children:Object.entries(k).map(e=>{let[a,t]=e;return(0,s.jsx)(p.SelectItem,{value:a,children:t.name},a)})})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(j.Label,{className:"text-xs font-medium",children:"Options"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-xs",children:"Show Scale"}),(0,s.jsx)(x.Switch,{checked:R.showScale,onCheckedChange:e=>U(s=>({...s,showScale:e})),size:"sm"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-xs",children:"Cluster Markers"}),(0,s.jsx)(x.Switch,{checked:R.clusteredMarkers,onCheckedChange:e=>U(s=>({...s,clusteredMarkers:e})),size:"sm"})]})]})]})]})]})]}),ea&&(0,s.jsx)("div",{className:"absolute bottom-4 left-4 z-[1000]",children:(0,s.jsx)(h.Badge,{variant:"secondary",className:"text-xs",children:ea})}),(0,s.jsx)("div",{className:"absolute bottom-4 right-4 z-[1000]",children:(0,s.jsx)(m.Card,{className:"p-2",children:(0,s.jsxs)("div",{className:"text-xs space-y-1",children:[(0,s.jsx)("div",{className:"font-medium",children:"Project Map"}),(0,s.jsxs)("div",{className:"text-muted-foreground",children:[es.features," features â€¢ ",es.routes," routes"]})]})})})]})}let C=S},36114,e=>{e.n(e.i(70685))},23021,e=>{e.v(s=>Promise.all(["static/chunks/162e4d85c5d7596f.js","static/chunks/2f3425668280eb58.css"].map(s=>e.l(s))).then(()=>s(45426)))},45378,e=>{e.v(s=>Promise.all(["static/chunks/6d391a89de4309b8.js"].map(s=>e.l(s))).then(()=>s(99297)))},42540,e=>{e.v(s=>Promise.all(["static/chunks/87b64f7aec125705.js"].map(s=>e.l(s))).then(()=>s(76637)))},93647,e=>{e.v(s=>Promise.all(["static/chunks/24e99fadefc24bfe.js"].map(s=>e.l(s))).then(()=>s(2691)))}]);