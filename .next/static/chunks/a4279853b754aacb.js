(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,40582,e=>{"use strict";e.s(["default",()=>eO],40582);var s=e.i(43476),t=e.i(18566),a=e.i(71689),l=e.i(88511),r=e.i(46897),i=e.i(87316),n=e.i(61911),c=e.i(25652),d=e.i(78894),o=e.i(7486),x=e.i(43432),m=e.i(48256),h=e.i(39616),u=e.i(78583),j=e.i(40160),p=e.i(86536),g=e.i(84614),v=e.i(63488),y=e.i(98919),N=e.i(19455),b=e.i(15288),f=e.i(87486),C=e.i(77572),w=e.i(68148),_=e.i(32661),T=e.i(71436),S=e.i(66027),k=e.i(54616),F=e.i(12598),P=e.i(46696);let q={getProjectPreparation:async e=>{let s=await fetch("/api/project-preparation?project_id=".concat(e));if(!s.ok)throw Error("Failed to fetch project preparation data");return s.json()},updateProjectStatus:async e=>{let s=await fetch("/api/project-preparation",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!s.ok)throw Error((await s.json()).error||"Failed to update project status");return s.json()},getUtilityContacts:async e=>{let s=await fetch("/api/project-preparation/utility-contacts?project_id=".concat(e));if(!s.ok)throw Error("Failed to fetch utility contacts");return s.json()},createUtilityContact:async e=>{let s=await fetch("/api/project-preparation/utility-contacts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!s.ok)throw Error((await s.json()).error||"Failed to create utility contact");return s.json()},getFacilities:async e=>{let s=await fetch("/api/project-preparation/facilities?project_id=".concat(e));if(!s.ok)throw Error("Failed to fetch facilities");return s.json()},createFacility:async e=>{let s=await fetch("/api/project-preparation/facilities",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!s.ok)throw Error((await s.json()).error||"Failed to create facility");return s.json()},updateUtilityContact:async e=>{let s=await fetch("/api/project-preparation/utility-contacts/".concat(e.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!s.ok)throw Error((await s.json()).error||"Failed to update utility contact");return s.json()},deleteUtilityContact:async e=>{let s=await fetch("/api/project-preparation/utility-contacts/".concat(e),{method:"DELETE"});if(!s.ok)throw Error((await s.json()).error||"Failed to delete utility contact");return s.json()},getProjectPlans:async e=>{let s=await fetch("/api/project-preparation/plans?project_id=".concat(e));if(!s.ok)throw Error("Failed to fetch project plans");return s.json()},createProjectPlan:async e=>{let s=new FormData;s.append("file",e.file),s.append("title",e.title),s.append("description",e.description||""),s.append("plan_type",e.plan_type),s.append("project_id",e.project_id);let t=await fetch("/api/project-preparation/plans",{method:"POST",body:s});if(!t.ok)throw Error((await t.json()).error||"Failed to upload plan");return t.json()},deleteProjectPlan:async e=>{let s=await fetch("/api/project-preparation/plans/".concat(e),{method:"DELETE"});if(!s.ok)throw Error((await s.json()).error||"Failed to delete plan");return s.json()}};function A(e){return(0,S.useQuery)({queryKey:["project-preparation",e],queryFn:()=>q.getProjectPreparation(e),enabled:!!e})}var L=e.i(71645),D=e.i(2747),B=e.i(69638);e.i(14683);var H=e.i(63209),E=e.i(94351),M=e.i(15788),I=e.i(88844),U=e.i(75254);let V=(0,U.default)("building",[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]]);var R=e.i(10204),O=e.i(24687),z=e.i(67489);let Q=(0,U.default)("euro",[["path",{d:"M4 10h12",key:"1y6xl8"}],["path",{d:"M4 14h9",key:"1loblj"}],["path",{d:"M19 6a7.7 7.7 0 0 0-5.2-2A7.9 7.9 0 0 0 6 12c0 4.4 3.5 8 7.8 8 2 0 3.8-.8 5.2-2",key:"1j6lzo"}]]);var K=e.i(93479),W=e.i(84774),G=e.i(7233),J=e.i(27612),Z=e.i(69074),X=e.i(37727);let Y=[{value:"power",label:" Power",color:"bg-yellow-100 text-yellow-800"},{value:"water",label:"Water",color:"bg-blue-100 text-blue-800"},{value:"gas",label:" Gas",color:"bg-red-100 text-red-800"},{value:"telecom",label:"Telecom",color:"bg-purple-100 text-purple-800"},{value:"road",label:"Road",color:"bg-gray-100 text-gray-800"},{value:"municipality",label:"Municipality",color:"bg-green-100 text-green-800"},{value:"emergency",label:"Emergency",color:"bg-red-100 text-red-800"}],$=[{value:"site_plan",label:"Site Plan",color:"bg-blue-100 text-blue-800"},{value:"network_design",label:"Network Design",color:"bg-green-100 text-green-800"},{value:"cable_routing",label:"Cable Routing",color:"bg-purple-100 text-purple-800"},{value:"excavation_plan",label:"Excavation Plan",color:"bg-orange-100 text-orange-800"},{value:"technical_drawing",label:"Technical Drawing",color:"bg-red-100 text-red-800"},{value:"other",label:"Other",color:"bg-gray-100 text-gray-800"}];var ee=e.i(59386);let es=(0,U.default)("router",[["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",key:"w68u3i"}],["path",{d:"M6.01 18H6",key:"19vcac"}],["path",{d:"M10.01 18H10",key:"uamcmx"}],["path",{d:"M15 10v4",key:"qjz1xs"}],["path",{d:"M17.84 7.17a4 4 0 0 0-5.66 0",key:"1rif40"}],["path",{d:"M20.66 4.34a8 8 0 0 0-11.31 0",key:"6a5xfq"}]]),et=(0,U.default)("construction",[["rect",{x:"2",y:"6",width:"20",height:"8",rx:"1",key:"1estib"}],["path",{d:"M17 14v7",key:"7m2elx"}],["path",{d:"M7 14v7",key:"1cm7wv"}],["path",{d:"M17 3v3",key:"1v4jwn"}],["path",{d:"M7 3v3",key:"7o6guu"}],["path",{d:"M10 14 2.3 6.3",key:"1023jk"}],["path",{d:"m14 6 7.7 7.7",key:"1s8pl2"}],["path",{d:"m8 6 8 8",key:"hl96qh"}]]),ea={getCabinets:async e=>{let s=await fetch("/api/zone-layout/cabinets?project_id=".concat(e));if(!s.ok)throw Error("Failed to fetch cabinets");return s.json()},createCabinet:async e=>{let s=await fetch("/api/zone-layout/cabinets",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!s.ok)throw Error((await s.json()).error||"Failed to create cabinet");return s.json()},updateCabinet:async e=>{let s=await fetch("/api/zone-layout/cabinets/".concat(e.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!s.ok)throw Error((await s.json()).error||"Failed to update cabinet");return s.json()},deleteCabinet:async e=>{let s=await fetch("/api/zone-layout/cabinets/".concat(e),{method:"DELETE"});if(!s.ok)throw Error((await s.json()).error||"Failed to delete cabinet");return s.json()}},el=[{value:"road_work",label:"Road Work",description:"Traffic-related restrictions",icon:et},{value:"power_lines",label:"Power Lines",description:"High voltage lines and transformers",icon:d.AlertTriangle},{value:"utilities",label:"Water/Sewer",description:"Existing utility networks",icon:I.Package},{value:"vegetation",label:"Green Areas",description:"Trees and protected areas",icon:I.Package},{value:"buildings",label:"Existing Buildings",description:"Buildings and structures",icon:I.Package},{value:"road_crossing",label:"Road Crossings",description:"Roadways and sidewalks",icon:r.MapPin},{value:"telecom",label:"Telecom",description:"Existing cable networks",icon:es},{value:"underground",label:"Underground",description:"Subway, underground passages",icon:I.Package}],er={getHousingUnits:async e=>{let s=await fetch("/api/housing-units?project_id=".concat(e));if(!s.ok)throw Error("Failed to fetch housing units");return(await s.json()).items||[]},createHousingUnit:async e=>{let s=await fetch("/api/housing-units",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!s.ok)throw Error((await s.json()).error||"Failed to create housing unit");return s.json()},updateHousingUnit:async e=>{let s=await fetch("/api/housing-units/".concat(e.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!s.ok)throw Error((await s.json()).error||"Failed to update housing unit");return s.json()},deleteHousingUnit:async e=>{let s=await fetch("/api/housing-units/".concat(e),{method:"DELETE"});if(!s.ok)throw Error((await s.json()).error||"Failed to delete housing unit");return s.json()}};var ei=e.i(17923);let en=(0,U.default)("cloud-rain",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 14v6",key:"1j4efv"}],["path",{d:"M8 14v6",key:"17c4r9"}],["path",{d:"M12 16v6",key:"c8a4gj"}]]);var ec=e.i(91741),ed=e.i(68553);let eo=(0,U.default)("paperclip",[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]]);var ex=e.i(67757),em=e.i(53145);let eh=[{value:"full",label:"Vollständiger Anschluss",icon:E.Home},{value:"property",label:"Bis Grundstück",icon:V},{value:"in_home",label:"bis Hauswand",icon:E.Home},{value:"other",label:"Sonstiges",icon:H.AlertCircle}],eu=[{value:"trench",label:"Graben",icon:et},{value:"aerial",label:"Luftleitung",icon:en},{value:"underground",label:"Unterirdisch",icon:et},{value:"building",label:"Gebäudeverlegung",icon:et}],ej=[{value:"residential",label:"Wohngebäude",icon:E.Home},{value:"commercial",label:"Geschäftsgebäude",icon:V},{value:"mixed",label:"Gemischte Nutzung",icon:V},{value:"industrial",label:"Industriegebäude",icon:V}],ep=[{value:"not_assigned",label:"Nicht zugewiesen",color:"bg-gray-100 text-gray-800"},{value:"assigned",label:"Zugewiesen",color:"bg-blue-100 text-blue-800"},{value:"connected",label:"Verbunden",color:"bg-green-100 text-green-800"},{value:"completed",label:"Abgeschlossen",color:"bg-green-100 text-green-800"},{value:"cancelled",label:"Storniert",color:"bg-red-100 text-red-800"}],eg=[{value:"plan",label:"Bauplan",icon:ec.ClipboardList},{value:"permit",label:"Genehmigung",icon:u.FileText},{value:"contract",label:"Vertrag",icon:u.FileText},{value:"photo_before",label:"Foto vorher",icon:ed.Camera},{value:"photo_during",label:"Foto während",icon:ed.Camera},{value:"photo_after",label:"Foto nachher",icon:ed.Camera},{value:"other",label:"Sonstiges",icon:eo}];var ev=e.i(76639),ey=e.i(20306);let eN={all:["resources"],projectResources:e=>[...eN.all,"project",e],availableVehicles:()=>[...eN.all,"available-vehicles"],availableEquipment:()=>[...eN.all,"available-equipment"]},eb=[{value:"van",label:"Lieferwagen",icon:""},{value:"truck",label:"LKW",icon:""},{value:"trailer",label:"Anhänger",icon:""},{value:"excavator",label:"Bagger",icon:""},{value:"other",label:"Sonstiges",icon:""}],ef=[{value:"drill",label:"Bohrgerät",icon:""},{value:"excavator",label:"Bagger",icon:""},{value:"generator",label:"Generator",icon:""},{value:"crane",label:"Kran",icon:""},{value:"compressor",label:"Kompressor",icon:""},{value:"other",label:"Sonstiges",icon:""}];var eC=e.i(55146),ew=e.i(1928),e_=e.i(3116),eT=e.i(41071),eS=e.i(78917),ek=e.i(4382),eF=e.i(64483),eP=e.i(49933);let eq={allocated:{label:"Assigned",color:"bg-blue-100 text-blue-800"},used:{label:"Used",color:"bg-green-100 text-green-800"},returned:{label:"Returned",color:"bg-gray-100 text-gray-800"},cancelled:{label:"Cancelled",color:"bg-red-100 text-red-800"}};function eA(e){let{orders:t}=e,a=t.reduce((e,s)=>e+s.total_cost_eur,0),l=t.filter(e=>"pending"===e.status||"ordered"===e.status).length;return(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-4 pt-4 border-t",children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:t.length}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Total Orders"})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsxs)("p",{className:"text-2xl font-bold text-green-600",children:["€",a.toFixed(0)]}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Total Value"}),(0,s.jsx)("p",{className:"text-xs text-green-600 mt-1",children:"Budget Impact"})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("p",{className:"text-2xl font-bold text-orange-600",children:l}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Pending/Ordered"})]})]})}function eL(e){var t;let{order:a}=e,{data:r}=(0,eP.useMaterialOrderBudgetImpact)(a.id),n=(0,eF.useUpdateMaterialOrder)(),[c,o]=(0,L.useState)(!1),[x,m]=(0,L.useState)(a.status),[h,u]=(0,L.useState)(""),[j,p]=(0,L.useState)(a.notes||""),g=async()=>{try{let e={status:x,notes:j||void 0};"delivered"===x&&h&&(e.actual_delivery_date=h),await n.mutateAsync({id:a.id,data:e}),o(!1),P.toast.success("Order status updated successfully")}catch(e){P.toast.error("Failed to update order status")}};return(0,s.jsxs)("div",{className:"p-4 border rounded-lg hover:shadow-sm transition-shadow",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,s.jsxs)("h4",{className:"font-medium",children:["Order #",a.id.slice(0,8)]}),(0,s.jsxs)(f.Badge,{className:(e=>{switch(e){case"delivered":return"bg-green-100 text-green-800";case"ordered":return"bg-blue-100 text-blue-800";case"pending":return"bg-yellow-100 text-yellow-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}})(a.status),children:[(e=>{switch(e){case"delivered":return(0,s.jsx)(B.CheckCircle,{className:"w-4 h-4"});case"ordered":return(0,s.jsx)(M.Truck,{className:"w-4 h-4"});case"pending":return(0,s.jsx)(e_.Clock,{className:"w-4 h-4"});case"cancelled":return(0,s.jsx)(d.AlertTriangle,{className:"w-4 h-4"});default:return(0,s.jsx)(I.Package,{className:"w-4 h-4"})}})(a.status),(0,s.jsx)("span",{className:"ml-1 capitalize",children:a.status})]}),(null==r?void 0:r.has_budget_impact)&&(0,s.jsxs)(f.Badge,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:[(0,s.jsx)(Q,{className:"w-3 h-3 mr-1"}),"Budget Applied"]})]}),(0,s.jsxs)("div",{className:"space-y-1 text-sm text-gray-600",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)("span",{className:"flex items-center",children:[(0,s.jsx)(i.Calendar,{className:"w-4 h-4 mr-1"}),"Ordered: ",new Date(a.order_date).toLocaleDateString()]}),a.expected_delivery_date&&(0,s.jsxs)("span",{className:"flex items-center",children:[(0,s.jsx)(M.Truck,{className:"w-4 h-4 mr-1"}),"Expected: ",new Date(a.expected_delivery_date).toLocaleDateString()]})]}),a.actual_delivery_date&&(0,s.jsxs)("div",{className:"flex items-center text-green-600",children:[(0,s.jsx)(B.CheckCircle,{className:"w-4 h-4 mr-1"}),"Delivered: ",new Date(a.actual_delivery_date).toLocaleDateString()]}),a.supplier_name&&(0,s.jsxs)("p",{children:["Supplier: ",a.supplier_name]}),a.material_type&&(0,s.jsxs)("p",{children:["Material: ",a.material_type]}),(null==r?void 0:r.has_budget_impact)&&(0,s.jsxs)("p",{className:"text-green-600",children:["€",null==(t=r.amount_deducted)?void 0:t.toFixed(2)," deducted from project budget"]}),a.notes&&(0,s.jsxs)("p",{className:"text-gray-500 italic",children:["Note: ",a.notes]})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsxs)("p",{className:"font-semibold",children:["€",a.total_cost_eur.toFixed(2)]}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:[a.quantity," units"]}),a.unit_price_eur&&(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:["€",a.unit_price_eur,"/unit"]})]}),(0,s.jsxs)(eC.DropdownMenu,{children:[(0,s.jsx)(eC.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsx)(N.Button,{variant:"ghost",size:"sm",children:(0,s.jsx)(eT.MoreHorizontal,{className:"w-4 h-4"})})}),(0,s.jsxs)(eC.DropdownMenuContent,{align:"end",children:[(0,s.jsx)(eC.DropdownMenuLabel,{children:"Order Actions"}),(0,s.jsx)(eC.DropdownMenuSeparator,{}),(0,s.jsxs)(eC.DropdownMenuItem,{onClick:()=>o(!0),children:[(0,s.jsx)(l.Edit,{className:"w-4 h-4 mr-2"}),"Update Status"]}),(0,s.jsxs)(eC.DropdownMenuItem,{onClick:()=>window.open("/dashboard/materials?order=".concat(a.id),"_blank"),children:[(0,s.jsx)(eS.ExternalLink,{className:"w-4 h-4 mr-2"}),"View Details"]})]})]})]})]}),(0,s.jsx)(ev.Dialog,{open:c,onOpenChange:o,children:(0,s.jsxs)(ev.DialogContent,{className:"max-w-md",children:[(0,s.jsxs)(ev.DialogHeader,{children:[(0,s.jsx)(ev.DialogTitle,{children:"Update Order Status"}),(0,s.jsxs)(ev.DialogDescription,{children:["Update the status and details for Order #",a.id.slice(0,8)]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"status",children:"Order Status"}),(0,s.jsxs)(z.Select,{value:x,onValueChange:m,children:[(0,s.jsx)(z.SelectTrigger,{children:(0,s.jsx)(z.SelectValue,{})}),(0,s.jsxs)(z.SelectContent,{children:[(0,s.jsx)(z.SelectItem,{value:"pending",children:"Pending"}),(0,s.jsx)(z.SelectItem,{value:"ordered",children:"Ordered"}),(0,s.jsx)(z.SelectItem,{value:"delivered",children:"Delivered"}),(0,s.jsx)(z.SelectItem,{value:"cancelled",children:"Cancelled"})]})]})]}),"delivered"===x&&(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"actual_delivery_date",children:"Actual Delivery Date"}),(0,s.jsx)(K.Input,{id:"actual_delivery_date",type:"date",value:h,onChange:e=>u(e.target.value)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"notes",children:"Notes (Optional)"}),(0,s.jsx)(O.Textarea,{id:"notes",value:j,onChange:e=>p(e.target.value),placeholder:"Add any notes about this order...",rows:3})]}),(0,s.jsxs)("div",{className:"flex space-x-2 pt-4",children:[(0,s.jsx)(N.Button,{onClick:g,disabled:n.isPending,className:"flex-1",children:n.isPending?"Updating...":"Update Order"}),(0,s.jsx)(N.Button,{variant:"outline",onClick:()=>o(!1),className:"flex-1",children:"Cancel"})]})]})]})})]})}let eD=(0,U.default)("rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]]),eB=(0,U.default)("file-check",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]),eH=(0,U.default)("circle-pause",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9",key:"c1nkhi"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9",key:"h65svq"}]]),eE=[{id:"documentation",title:"Documentation",description:"All required documents and plans",icon:u.FileText,color:"text-blue-600",checks:["Project plans uploaded","Utility contact information complete","Building permits obtained","Safety documentation complete"]},{id:"resources",title:"Resources",description:"Teams, equipment, and materials",icon:n.Users,color:"text-green-600",checks:["Team assignments complete","Equipment allocation finalized","Material inventory sufficient","Subcontractors confirmed"]},{id:"infrastructure",title:"Infrastructure",description:"Zone layout and house connections",icon:h.Settings,color:"text-orange-600",checks:["Zone layout confirmed","Cabinet locations defined","House connections mapped","Network segments planned"]},{id:"approvals",title:"Approvals",description:"Required authorizations and sign-offs",icon:B.CheckCircle,color:"text-purple-600",checks:["Management approval obtained","Customer agreements signed","Regulatory clearances complete","Budget authorization confirmed"]}],eM=[{value:"planning",label:"Planning",color:"bg-blue-100 text-blue-800",icon:u.FileText},{value:"ready",label:"\x05Ready",color:"bg-green-100 text-green-800",icon:B.CheckCircle},{value:"active",label:"Active",color:"bg-orange-100 text-orange-800",icon:eD},{value:"on_hold",label:"On Hold",color:"bg-yellow-100 text-yellow-800",icon:eH},{value:"completed",label:"Completed",color:"bg-emerald-100 text-emerald-800",icon:B.CheckCircle}];var eI=e.i(75157);let eU=e=>{let{Component:t,projectId:a,stepName:l}=e;try{if(!t)return console.error("Component ".concat(l," is undefined")),(0,s.jsxs)("div",{className:"p-6 bg-red-50 border border-red-200 rounded-lg",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-red-800 mb-2",children:"Component Not Found"}),(0,s.jsxs)("p",{className:"text-red-600",children:["Component ",l," is not properly imported"]})]});return(0,s.jsx)(t,{projectId:a})}catch(e){return console.error("Error rendering ".concat(l,":"),e),(0,s.jsxs)("div",{className:"p-6 bg-yellow-50 border border-yellow-200 rounded-lg",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-yellow-800 mb-2",children:"Component Error"}),(0,s.jsxs)("p",{className:"text-yellow-600",children:["Error rendering ",l]}),(0,s.jsx)("p",{className:"text-sm text-yellow-500 mt-2",children:null==e?void 0:e.toString()})]})}},eV=[{id:0,title:"Project Creation",description:"Basic project information and setup",icon:u.FileText,component:function(e){let{projectId:t}=e,{data:a,isLoading:l}=A(t),n=function(){let e=(0,F.useQueryClient)();return(0,k.useMutation)({mutationFn:q.updateProjectStatus,onSuccess:(s,t)=>{e.invalidateQueries({queryKey:["project-preparation",t.project_id]}),e.invalidateQueries({queryKey:["projects"]}),P.toast.success(s.message||"Project status updated successfully")},onError:e=>{P.toast.error(e.message)}})}(),[c,d]=(0,L.useState)(!1),[o,x]=(0,L.useState)(""),[m,h]=(0,L.useState)("");if(l||!a)return(0,s.jsx)("div",{children:"Loading project overview..."});let{project:u,potential_revenue:j}=a,p=async()=>{if(!o)return void P.toast.error("Please select a status");try{await n.mutateAsync({project_id:t,status:o,reason:m}),d(!1),x(""),h("")}catch(e){}},g=e=>{switch(e){case"active":return(0,s.jsx)(B.CheckCircle,{className:"w-4 h-4 text-green-500"});case"waiting_invoice":return(0,s.jsx)(H.AlertCircle,{className:"w-4 h-4 text-blue-500"});default:return(0,s.jsx)(H.AlertCircle,{className:"w-4 h-4 text-yellow-500"})}};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)(b.Card,{children:[(0,s.jsxs)(b.CardHeader,{children:[(0,s.jsxs)(b.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(r.MapPin,{className:"w-5 h-5"}),"Basic Project Information"]}),(0,s.jsx)(b.CardDescription,{children:"Core project details and contact information"})]}),(0,s.jsx)(b.CardContent,{className:"space-y-4",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{className:"text-sm font-medium",children:"Project Name"}),(0,s.jsx)("p",{className:"text-lg font-semibold",children:u.name})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{className:"text-sm font-medium",children:"Customer"}),(0,s.jsx)("p",{className:"text-lg",children:u.customer||"Not specified"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{className:"text-sm font-medium",children:"City"}),(0,s.jsx)("p",{className:"text-lg",children:u.city||"Not specified"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{className:"text-sm font-medium",children:"Address"}),(0,s.jsx)("p",{className:"text-lg",children:u.address||"Not specified"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{className:"text-sm font-medium",children:"24/7 Contact"}),(0,s.jsx)("p",{className:"text-lg",children:u.contact_24h||"Not specified"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{className:"text-sm font-medium",children:"Project Manager"}),(0,s.jsxs)("p",{className:"text-lg",children:[u.project_manager||"Not assigned",!u.project_manager&&(0,s.jsx)("span",{className:"text-red-500 ml-2",children:"No PM assigned"})]})]})]})})]}),(0,s.jsxs)(b.Card,{children:[(0,s.jsxs)(b.CardHeader,{children:[(0,s.jsxs)(b.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(Q,{className:"w-5 h-5"}),"Planning & Revenue Information"]}),(0,s.jsx)(b.CardDescription,{children:"Project timeline and potential revenue calculation"})]}),(0,s.jsxs)(b.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)(R.Label,{className:"text-sm font-medium flex items-center gap-1",children:[(0,s.jsx)(i.Calendar,{className:"w-4 h-4"}),"Start Date"]}),(0,s.jsx)("p",{className:"text-lg",children:u.start_date||"Not set"})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)(R.Label,{className:"text-sm font-medium flex items-center gap-1",children:[(0,s.jsx)(i.Calendar,{className:"w-4 h-4"}),"Planned End Date"]}),(0,s.jsx)("p",{className:"text-lg",children:u.end_date_plan||"Not set"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{className:"text-sm font-medium",children:"Total Length"}),(0,s.jsxs)("p",{className:"text-lg font-semibold",children:[(u.total_length_m||0).toLocaleString()," m"]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{className:"text-sm font-medium",children:"Base Rate per Meter"}),(0,s.jsxs)("p",{className:"text-lg font-semibold",children:["€",(u.base_rate_per_m||0).toLocaleString(),"/m"]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{className:"text-sm font-medium",children:"Potential Revenue"}),(0,s.jsxs)("p",{className:"text-2xl font-bold text-green-600",children:["€",(j||0).toLocaleString()]})]})]})]})]}),(0,s.jsxs)(b.Card,{children:[(0,s.jsxs)(b.CardHeader,{children:[(0,s.jsxs)(b.CardTitle,{className:"flex items-center gap-2",children:[g(u.status),"Project Status Management"]}),(0,s.jsx)(b.CardDescription,{children:"Current status and status change controls"})]}),(0,s.jsxs)(b.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{className:"text-sm font-medium",children:"Current Status"}),(0,s.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[g(u.status),(0,s.jsx)(f.Badge,{className:(e=>{switch(e){case"draft":case"closed":default:return"bg-gray-100 text-gray-800";case"planning":return"bg-yellow-100 text-yellow-800";case"active":return"bg-green-100 text-green-800";case"waiting_invoice":return"bg-blue-100 text-blue-800"}})(u.status),children:u.status.charAt(0).toUpperCase()+u.status.slice(1)})]})]}),(0,s.jsx)(N.Button,{variant:"outline",onClick:()=>d(!c),children:"Change Status"})]}),c&&(0,s.jsxs)("div",{className:"border rounded-lg p-4 space-y-4 bg-gray-50",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"new-status",children:"New Status"}),(0,s.jsxs)(z.Select,{value:o,onValueChange:x,children:[(0,s.jsx)(z.SelectTrigger,{children:(0,s.jsx)(z.SelectValue,{placeholder:"Select new status"})}),(0,s.jsxs)(z.SelectContent,{children:[(0,s.jsx)(z.SelectItem,{value:"draft",children:" Draft"}),(0,s.jsx)(z.SelectItem,{value:"planning",children:"Planning"}),(0,s.jsx)(z.SelectItem,{value:"active",children:"Active"}),(0,s.jsx)(z.SelectItem,{value:"waiting_invoice",children:" Waiting Invoice"}),(0,s.jsx)(z.SelectItem,{value:"closed",children:" Closed"})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"reason",children:"Reason for Change"}),(0,s.jsx)(O.Textarea,{id:"reason",value:m,onChange:e=>h(e.target.value),placeholder:"Describe the reason for the status change...",rows:3})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(N.Button,{onClick:p,disabled:n.isPending,children:"Save Status"}),(0,s.jsx)(N.Button,{variant:"outline",onClick:()=>{d(!1),x(""),h("")},children:"Cancel"})]})]})]})]})]})}},{id:1,title:"Plans & Communications",description:"Utility contacts and communication setup",icon:x.Phone,component:function(e){let{projectId:t}=e,{data:a,isLoading:r}=(0,S.useQuery)({queryKey:["utility-contacts",t],queryFn:()=>q.getUtilityContacts(t),enabled:!!t}),i=function(){let e=(0,F.useQueryClient)();return(0,k.useMutation)({mutationFn:q.createUtilityContact,onSuccess:(s,t)=>{e.invalidateQueries({queryKey:["utility-contacts",t.project_id]}),e.invalidateQueries({queryKey:["project-preparation",t.project_id]}),P.toast.success(s.message||"Utility contact created successfully")},onError:e=>{P.toast.error(e.message)}})}(),n=function(){let e=(0,F.useQueryClient)();return(0,k.useMutation)({mutationFn:q.updateUtilityContact,onSuccess:s=>{e.invalidateQueries({queryKey:["utility-contacts"]}),e.invalidateQueries({queryKey:["project-preparation"]}),P.toast.success(s.message||"Utility contact updated successfully")},onError:e=>{P.toast.error(e.message)}})}(),c=function(){let e=(0,F.useQueryClient)();return(0,k.useMutation)({mutationFn:q.deleteUtilityContact,onSuccess:s=>{e.invalidateQueries({queryKey:["utility-contacts"]}),e.invalidateQueries({queryKey:["project-preparation"]}),P.toast.success(s.message||"Utility contact deleted successfully")},onError:e=>{P.toast.error(e.message)}})}(),{data:d,isLoading:o}=(0,S.useQuery)({queryKey:["project-plans",t],queryFn:()=>q.getProjectPlans(t),enabled:!!t}),m=function(){let e=(0,F.useQueryClient)();return(0,k.useMutation)({mutationFn:q.createProjectPlan,onSuccess:(s,t)=>{e.invalidateQueries({queryKey:["project-plans",t.project_id]}),e.invalidateQueries({queryKey:["project-preparation",t.project_id]}),P.toast.success(s.message||"Plan uploaded successfully")},onError:e=>{P.toast.error(e.message)}})}(),h=function(){let e=(0,F.useQueryClient)();return(0,k.useMutation)({mutationFn:q.deleteProjectPlan,onSuccess:s=>{e.invalidateQueries({queryKey:["project-plans"]}),e.invalidateQueries({queryKey:["project-preparation"]}),P.toast.success(s.message||"Plan deleted successfully")},onError:e=>{P.toast.error(e.message)}})}(),[y,C]=(0,L.useState)(!1),[w,_]=(0,L.useState)(null),[T,A]=(0,L.useState)({kind:"",organization:"",phone:"",email:"",contact_person:"",notes:""}),[D,B]=(0,L.useState)(!1),[H,E]=(0,L.useState)({title:"",description:"",plan_type:"",file:null}),M=async e=>{if(e.preventDefault(),!T.kind||!T.organization)return void P.toast.error("Please fill in all required fields");try{w?(await n.mutateAsync({id:w,...T}),_(null)):await i.mutateAsync({project_id:t,...T}),A({kind:"",organization:"",phone:"",email:"",contact_person:"",notes:""}),C(!1)}catch(e){}},I=async(e,s)=>{if(confirm('Are you sure you want to delete the contact for "'.concat(s,'"?')))try{await c.mutateAsync(e)}catch(e){}},U=async e=>{if(e.preventDefault(),!H.title||!H.plan_type||!H.file)return void P.toast.error("Please fill in all required fields and select a file");try{var s,a;let e=new FormData,l={bucketName:"project-documents",projectId:t,category:"plan",title:H.title,description:H.description,plan_type:H.plan_type};e.append("metadata",JSON.stringify(l)),e.append("file0",H.file);let r=await fetch("/api/upload",{method:"POST",body:e});if(!r.ok)throw Error("Upload failed with status: ".concat(r.status));let i=await r.json();if(i.error)throw Error(i.error);await m.mutateAsync({project_id:t,title:H.title,description:H.description,plan_type:H.plan_type,filename:H.file.name,file_size:H.file.size,file_url:(null==(s=i.files[0])?void 0:s.url)||"",file_path:(null==(a=i.files[0])?void 0:a.fileName)||""}),E({title:"",description:"",plan_type:"",file:null}),B(!1),P.toast.success("Plan uploaded successfully! ".concat(i.successCount," file(s) uploaded."))}catch(e){console.error("Plan upload error:",e),P.toast.error("Failed to upload plan: ".concat(e instanceof Error?e.message:"Unknown error"))}},Q=async(e,s)=>{if(confirm('Are you sure you want to delete the plan "'.concat(s,'"?')))try{await h.mutateAsync(e),P.toast.success("Plan deleted successfully")}catch(e){console.error("Plan deletion error:",e),P.toast.error("Failed to delete plan")}},ee=e=>{if(0===e)return"0 Bytes";let s=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,s)).toFixed(2))+" "+["Bytes","KB","MB","GB"][s]};return r||o?(0,s.jsx)("div",{children:"Loading..."}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-2xl font-bold",children:"Plans & Communications"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Manage project plans and utility company contacts"})]})}),(0,s.jsxs)(b.Card,{children:[(0,s.jsx)(b.CardHeader,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)(b.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(u.FileText,{className:"w-5 h-5"}),"Project Plans"]}),(0,s.jsx)(b.CardDescription,{children:"Upload and manage technical plans and documents"})]}),(0,s.jsxs)(N.Button,{onClick:()=>B(!D),className:"flex items-center gap-2",children:[(0,s.jsx)(Z.Upload,{className:"w-4 h-4"}),"Upload Plan"]})]})}),(0,s.jsxs)(b.CardContent,{children:[D&&(0,s.jsx)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 mb-6",children:(0,s.jsxs)("form",{onSubmit:U,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"plan-title",children:"Plan Title *"}),(0,s.jsx)(K.Input,{id:"plan-title",value:H.title,onChange:e=>E(s=>({...s,title:e.target.value})),placeholder:"Site plan, Network design, etc.",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"plan-type",children:"Plan Type *"}),(0,s.jsxs)(z.Select,{value:H.plan_type,onValueChange:e=>E(s=>({...s,plan_type:e})),children:[(0,s.jsx)(z.SelectTrigger,{children:(0,s.jsx)(z.SelectValue,{placeholder:"Select plan type"})}),(0,s.jsx)(z.SelectContent,{children:$.map(e=>(0,s.jsx)(z.SelectItem,{value:e.value,children:e.label},e.value))})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"plan-description",children:"Description"}),(0,s.jsx)(O.Textarea,{id:"plan-description",value:H.description,onChange:e=>E(s=>({...s,description:e.target.value})),placeholder:"Brief description of the plan...",rows:2})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"plan-file",children:"File *"}),(0,s.jsx)(K.Input,{id:"plan-file",type:"file",onChange:e=>{var s;let t=null==(s=e.target.files)?void 0:s[0];if(t){if(!["application/pdf","image/jpeg","image/png","image/gif","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(t.type))return void P.toast.error("Only PDF, image files, and Excel files are allowed");if(t.size>0xa00000)return void P.toast.error("File size must be less than 10MB");E(e=>({...e,file:t}))}},accept:".pdf,.jpg,.jpeg,.png,.gif,.xls,.xlsx",required:!0}),(0,s.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Supported formats: PDF, Images (JPG, PNG, GIF), Excel files. Max size: 10MB"}),H.file&&(0,s.jsx)("div",{className:"mt-2 p-2 bg-green-50 border border-green-200 rounded",children:(0,s.jsxs)("p",{className:"text-sm text-green-700",children:["Selected: ",H.file.name," (",ee(H.file.size),")"]})})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(N.Button,{type:"submit",disabled:m.isPending,children:[(0,s.jsx)(Z.Upload,{className:"w-4 h-4 mr-2"}),m.isPending?"Uploading...":"Upload Plan"]}),(0,s.jsx)(N.Button,{type:"button",variant:"outline",onClick:()=>{B(!1),E({title:"",description:"",plan_type:"",file:null})},children:"Cancel"})]})]})}),d&&0!==d.length?(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:d.map(e=>{let t,a=(t=e.plan_type,$.find(e=>e.value===t)||{label:t,color:"bg-gray-100 text-gray-800"});return(0,s.jsx)(b.Card,{className:"hover:shadow-md transition-shadow",children:(0,s.jsx)(b.CardContent,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)(f.Badge,{className:a.color,children:a.label}),(0,s.jsx)("h4",{className:"font-semibold mt-2 mb-1",children:e.title}),e.description&&(0,s.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:e.description}),(0,s.jsxs)("div",{className:"text-xs text-gray-500 space-y-1",children:[(0,s.jsxs)("p",{children:["File: ",e.filename]}),(0,s.jsxs)("p",{children:["Size: ",ee(e.file_size)]}),(0,s.jsxs)("p",{children:["Uploaded: ",new Date(e.uploaded_at).toLocaleDateString()]})]})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-1 ml-2",children:[(0,s.jsx)(N.Button,{variant:"ghost",size:"sm",title:"View",children:(0,s.jsx)(p.Eye,{className:"w-4 h-4"})}),(0,s.jsx)(N.Button,{variant:"ghost",size:"sm",title:"Download",children:(0,s.jsx)(j.Download,{className:"w-4 h-4"})}),(0,s.jsx)(N.Button,{variant:"ghost",size:"sm",title:"Delete",onClick:()=>Q(e.id,e.title),children:(0,s.jsx)(X.X,{className:"w-4 h-4 text-red-500"})})]})]})})},e.id)})}):(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)(u.FileText,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-medium mb-2",children:"No Plans Uploaded"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:"Upload project plans, technical drawings, and design documents to get started."}),(0,s.jsxs)(N.Button,{onClick:()=>B(!0),children:[(0,s.jsx)(Z.Upload,{className:"w-4 h-4 mr-2"}),"Upload First Plan"]})]})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"Utility Contacts"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Manage utility companies and emergency contacts for the project"})]}),(0,s.jsxs)(N.Button,{onClick:()=>C(!y),className:"flex items-center gap-2",children:[(0,s.jsx)(G.Plus,{className:"w-4 h-4"}),"Add Contact"]})]}),y&&(0,s.jsxs)(b.Card,{children:[(0,s.jsxs)(b.CardHeader,{children:[(0,s.jsx)(b.CardTitle,{children:w?"Edit Utility Contact":"Add New Utility Contact"}),(0,s.jsx)(b.CardDescription,{children:w?"Update contact information for utility company":"Add contact information for utility companies and emergency services"})]}),(0,s.jsx)(b.CardContent,{children:(0,s.jsxs)("form",{onSubmit:M,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"kind",children:"Type *"}),(0,s.jsxs)(z.Select,{value:T.kind,onValueChange:e=>A(s=>({...s,kind:e})),children:[(0,s.jsx)(z.SelectTrigger,{children:(0,s.jsx)(z.SelectValue,{placeholder:"Select utility type"})}),(0,s.jsx)(z.SelectContent,{children:Y.map(e=>(0,s.jsx)(z.SelectItem,{value:e.value,children:e.label},e.value))})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"organization",children:"Organization *"}),(0,s.jsx)(K.Input,{id:"organization",value:T.organization,onChange:e=>A(s=>({...s,organization:e.target.value})),placeholder:"Organization name",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"phone",children:"Phone Number"}),(0,s.jsx)(K.Input,{id:"phone",value:T.phone,onChange:e=>A(s=>({...s,phone:e.target.value})),placeholder:"+49 xxx xxx xxxx"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"email",children:"Email"}),(0,s.jsx)(K.Input,{id:"email",type:"email",value:T.email,onChange:e=>A(s=>({...s,email:e.target.value})),placeholder:"contact@utility.com"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"contact_person",children:"Contact Person"}),(0,s.jsx)(K.Input,{id:"contact_person",value:T.contact_person,onChange:e=>A(s=>({...s,contact_person:e.target.value})),placeholder:"John Doe"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"notes",children:"Notes"}),(0,s.jsx)(O.Textarea,{id:"notes",value:T.notes,onChange:e=>A(s=>({...s,notes:e.target.value})),placeholder:"Additional information or special instructions...",rows:3})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(N.Button,{type:"submit",disabled:i.isPending||n.isPending,children:w?"Update Contact":"Add Contact"}),(0,s.jsx)(N.Button,{type:"button",variant:"outline",onClick:()=>{_(null),A({kind:"",organization:"",phone:"",email:"",contact_person:"",notes:""}),C(!1)},children:"Cancel"})]})]})})]}),(0,s.jsxs)(b.Card,{children:[(0,s.jsxs)(b.CardHeader,{children:[(0,s.jsx)(b.CardTitle,{children:"Current Utility Contacts"}),(0,s.jsxs)(b.CardDescription,{children:[(null==a?void 0:a.length)||0," contacts configured"]})]}),(0,s.jsx)(b.CardContent,{children:a&&0!==a.length?(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)(W.Table,{children:[(0,s.jsx)(W.TableHeader,{children:(0,s.jsxs)(W.TableRow,{children:[(0,s.jsx)(W.TableHead,{children:"Type"}),(0,s.jsx)(W.TableHead,{children:"Organization"}),(0,s.jsx)(W.TableHead,{children:"Contact Person"}),(0,s.jsx)(W.TableHead,{children:"Phone"}),(0,s.jsx)(W.TableHead,{children:"Email"}),(0,s.jsx)(W.TableHead,{children:"Notes"}),(0,s.jsx)(W.TableHead,{children:"Actions"})]})}),(0,s.jsx)(W.TableBody,{children:a.map(e=>{let t,a=(t=e.kind,Y.find(e=>e.value===t)||{label:t,color:"bg-gray-100 text-gray-800"});return(0,s.jsxs)(W.TableRow,{children:[(0,s.jsx)(W.TableCell,{children:(0,s.jsx)(f.Badge,{className:a.color,children:a.label})}),(0,s.jsx)(W.TableCell,{className:"font-medium",children:e.organization}),(0,s.jsx)(W.TableCell,{children:e.contact_person?(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(g.User,{className:"w-4 h-4 text-gray-400"}),e.contact_person]}):(0,s.jsx)("span",{className:"text-gray-400",children:"-"})}),(0,s.jsx)(W.TableCell,{children:e.phone?(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(x.Phone,{className:"w-4 h-4 text-gray-400"}),(0,s.jsx)("a",{href:"tel:".concat(e.phone),className:"text-blue-600 hover:underline",children:e.phone})]}):(0,s.jsx)("span",{className:"text-gray-400",children:"-"})}),(0,s.jsx)(W.TableCell,{children:e.email?(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(v.Mail,{className:"w-4 h-4 text-gray-400"}),(0,s.jsx)("a",{href:"mailto:".concat(e.email),className:"text-blue-600 hover:underline",children:e.email})]}):(0,s.jsx)("span",{className:"text-gray-400",children:"-"})}),(0,s.jsx)(W.TableCell,{children:e.notes?(0,s.jsx)("span",{className:"text-sm text-gray-600 max-w-xs truncate block",children:e.notes}):(0,s.jsx)("span",{className:"text-gray-400",children:"-"})}),(0,s.jsx)(W.TableCell,{children:(0,s.jsxs)("div",{className:"flex gap-1",children:[(0,s.jsx)(N.Button,{variant:"ghost",size:"sm",onClick:()=>{A({kind:e.kind,organization:e.organization,phone:e.phone||"",email:e.email||"",contact_person:e.contact_person||"",notes:e.notes||""}),_(e.id),C(!0)},disabled:n.isPending,children:(0,s.jsx)(l.Edit,{className:"w-4 h-4"})}),(0,s.jsx)(N.Button,{variant:"ghost",size:"sm",onClick:()=>I(e.id,e.organization),disabled:c.isPending,children:(0,s.jsx)(J.Trash2,{className:"w-4 h-4 text-red-500"})})]})})]},e.id)})})]})}):(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)(V,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-medium mb-2",children:"No Utility Contacts"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:"Add utility companies and emergency contacts to get started."}),(0,s.jsx)(N.Button,{onClick:()=>C(!0),children:"Add First Contact"})]})})]}),a&&a.length>0&&(0,s.jsxs)(b.Card,{children:[(0,s.jsx)(b.CardHeader,{children:(0,s.jsx)(b.CardTitle,{children:"Contact Summary"})}),(0,s.jsx)(b.CardContent,{children:(0,s.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:Y.map(e=>{let t=a.filter(s=>s.kind===e.value).length;return(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:t}),(0,s.jsx)("div",{className:"text-sm text-gray-600",children:e.label})]},e.value)})})})]})]})}},{id:2,title:"Zone Layout",description:"Zone mapping and material planning",icon:r.MapPin,component:function(e){let{projectId:t}=e,{data:a,isLoading:i}=(0,S.useQuery)({queryKey:["cabinets",t],queryFn:()=>ea.getCabinets(t),enabled:!!t}),n=function(){let e=(0,F.useQueryClient)();return(0,k.useMutation)({mutationFn:ea.createCabinet,onSuccess:(s,t)=>{e.invalidateQueries({queryKey:["cabinets",t.project_id]}),e.invalidateQueries({queryKey:["project-preparation",t.project_id]}),P.toast.success(s.message||"Cabinet created successfully")},onError:e=>{P.toast.error(e.message)}})}(),c=function(){let e=(0,F.useQueryClient)();return(0,k.useMutation)({mutationFn:ea.updateCabinet,onSuccess:s=>{e.invalidateQueries({queryKey:["cabinets"]}),e.invalidateQueries({queryKey:["project-preparation"]}),P.toast.success(s.message||"Cabinet updated successfully")},onError:e=>{P.toast.error(e.message)}})}(),o=function(){let e=(0,F.useQueryClient)();return(0,k.useMutation)({mutationFn:ea.deleteCabinet,onSuccess:s=>{e.invalidateQueries({queryKey:["cabinets"]}),e.invalidateQueries({queryKey:["project-preparation"]}),P.toast.success(s.message||"Cabinet deleted successfully")},onError:e=>{P.toast.error(e.message)}})}(),[x,m]=(0,L.useState)(!1),[h,j]=(0,L.useState)(!1),[p,g]=(0,L.useState)(null),[v,y]=(0,L.useState)({code:"",name:"",address:"",notes:""}),[w,_]=(0,L.useState)({type:"",severity:"",location:"",description:""}),[T,q]=(0,L.useState)([]),A=async e=>{if(e.preventDefault(),!v.code||!v.name)return void P.toast.error("Please fill in all required fields");try{p?(await c.mutateAsync({id:p,...v}),g(null)):await n.mutateAsync({project_id:t,...v}),y({code:"",name:"",address:"",notes:""}),m(!1)}catch(e){}},D=async(e,s)=>{if(confirm('Are you sure you want to delete cabinet "'.concat(s,'"? This will also delete all associated segments.')))try{await o.mutateAsync(e)}catch(e){}},B=async e=>{if(e.preventDefault(),!w.type||!w.severity||!w.description)return void P.toast.error("Please fill in all required fields");try{let e={id:Date.now().toString(),type:w.type,severity:w.severity,location:w.location,description:w.description,createdAt:new Date().toLocaleDateString()};q(s=>[...s,e]),console.log("Saving constraint:",w),_({type:"",severity:"",location:"",description:""}),j(!1),P.toast.success("Project constraint added successfully!")}catch(e){P.toast.error("Failed to add constraint")}};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"Zone Layout Management"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Manage cabinets and project constraints"})]})}),(0,s.jsxs)(C.Tabs,{defaultValue:"cabinets",className:"space-y-6",children:[(0,s.jsxs)(C.TabsList,{className:"grid w-full grid-cols-3",children:[(0,s.jsxs)(C.TabsTrigger,{value:"cabinets",className:"flex items-center gap-2",children:[(0,s.jsx)(I.Package,{className:"w-4 h-4"}),"NVT Points"]}),(0,s.jsxs)(C.TabsTrigger,{value:"constraints",className:"flex items-center gap-2",children:[(0,s.jsx)(d.AlertTriangle,{className:"w-4 h-4"}),"Constraints"]}),(0,s.jsxs)(C.TabsTrigger,{value:"installation",className:"flex items-center gap-2",children:[(0,s.jsx)(et,{className:"w-4 h-4"}),"Installation"]})]}),(0,s.jsxs)(C.TabsContent,{value:"cabinets",className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h4",{className:"text-md font-medium",children:"NVT Points (Network Termination)"}),(0,s.jsxs)(N.Button,{onClick:()=>m(!x),className:"flex items-center gap-2",children:[(0,s.jsx)(G.Plus,{className:"w-4 h-4"}),"Add NVT Point"]})]}),x&&(0,s.jsxs)(b.Card,{children:[(0,s.jsxs)(b.CardHeader,{children:[(0,s.jsx)(b.CardTitle,{children:p?"Edit NVT Point":"Add New NVT Point"}),(0,s.jsx)(b.CardDescription,{children:p?"Update network termination point information":"Create a new network termination point for the project"})]}),(0,s.jsx)(b.CardContent,{children:(0,s.jsxs)("form",{onSubmit:A,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"code",children:"NVT Code *"}),(0,s.jsx)(K.Input,{id:"code",value:v.code,onChange:e=>y(s=>({...s,code:e.target.value})),placeholder:"9V1005",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"name",children:"Name *"}),(0,s.jsx)(K.Input,{id:"name",value:v.name,onChange:e=>y(s=>({...s,name:e.target.value})),placeholder:"Cabinet Entrance 1",required:!0})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)(R.Label,{htmlFor:"address",children:"Address"}),(0,s.jsx)(K.Input,{id:"address",value:v.address,onChange:e=>y(s=>({...s,address:e.target.value})),placeholder:"Müllerstraße 1, 13353 Berlin"})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)(R.Label,{htmlFor:"notes",children:"Notes"}),(0,s.jsx)(O.Textarea,{id:"notes",value:v.notes,onChange:e=>y(s=>({...s,notes:e.target.value})),placeholder:"Additional information...",rows:3})]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(N.Button,{type:"submit",disabled:n.isPending||c.isPending,children:p?"Update NVT Point":"Create NVT Point"}),(0,s.jsx)(N.Button,{type:"button",variant:"outline",onClick:()=>{g(null),y({code:"",name:"",address:"",notes:""}),m(!1)},children:"Cancel"})]})]})})]}),(0,s.jsxs)(b.Card,{children:[(0,s.jsxs)(b.CardHeader,{children:[(0,s.jsx)(b.CardTitle,{children:"NVT Points List"}),(0,s.jsxs)(b.CardDescription,{children:[(null==a?void 0:a.length)||0," NVT points configured"]})]}),(0,s.jsx)(b.CardContent,{children:i?(0,s.jsx)("div",{children:"Loading cabinets..."}):a&&0!==a.length?(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)(W.Table,{children:[(0,s.jsx)(W.TableHeader,{children:(0,s.jsxs)(W.TableRow,{children:[(0,s.jsx)(W.TableHead,{children:"Code"}),(0,s.jsx)(W.TableHead,{children:"Name"}),(0,s.jsx)(W.TableHead,{children:"Address"}),(0,s.jsx)(W.TableHead,{children:"Segments"}),(0,s.jsx)(W.TableHead,{children:"Total Length"}),(0,s.jsx)(W.TableHead,{children:"Actions"})]})}),(0,s.jsx)(W.TableBody,{children:a.map(e=>(0,s.jsxs)(W.TableRow,{children:[(0,s.jsx)(W.TableCell,{className:"font-medium",children:e.code}),(0,s.jsx)(W.TableCell,{children:e.name}),(0,s.jsx)(W.TableCell,{children:e.address?(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(r.MapPin,{className:"w-4 h-4 text-gray-400"}),e.address]}):(0,s.jsx)("span",{className:"text-gray-400",children:"-"})}),(0,s.jsx)(W.TableCell,{children:(0,s.jsxs)(f.Badge,{variant:"secondary",children:[e.segment_count||0," segments"]})}),(0,s.jsx)(W.TableCell,{children:e.total_length?"".concat(e.total_length.toFixed(1),"m"):"0.0m"}),(0,s.jsx)(W.TableCell,{children:(0,s.jsxs)("div",{className:"flex gap-1",children:[(0,s.jsx)(N.Button,{variant:"ghost",size:"sm",onClick:()=>{y({code:e.code,name:e.name,address:e.address||"",notes:e.notes||""}),g(e.id),m(!0)},disabled:c.isPending,children:(0,s.jsx)(l.Edit,{className:"w-4 h-4"})}),(0,s.jsx)(N.Button,{variant:"ghost",size:"sm",onClick:()=>D(e.id,e.code),disabled:o.isPending,children:(0,s.jsx)(J.Trash2,{className:"w-4 h-4 text-red-500"})})]})})]},e.id))})]})}):(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)(es,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-medium mb-2",children:"No NVT Points"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:"Add network termination points to get started."}),(0,s.jsx)(N.Button,{onClick:()=>m(!0),children:"Add First NVT Point"})]})})]})]}),(0,s.jsxs)(C.TabsContent,{value:"constraints",className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h4",{className:"text-md font-medium",children:"Project Constraints & Obstacles"}),(0,s.jsxs)(N.Button,{onClick:()=>j(!h),className:"flex items-center gap-2",children:[(0,s.jsx)(G.Plus,{className:"w-4 h-4"}),"Add Constraint"]})]}),(0,s.jsxs)(b.Card,{children:[(0,s.jsxs)(b.CardHeader,{children:[(0,s.jsx)(b.CardTitle,{children:"Planned Constraint Types"}),(0,s.jsx)(b.CardDescription,{children:"Common obstacles encountered during fiber optic installation"})]}),(0,s.jsx)(b.CardContent,{children:(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:el.map(e=>{let t=e.icon;return(0,s.jsxs)("div",{className:"flex items-start gap-3 p-3 border rounded-lg",children:[(0,s.jsx)(t,{className:"w-5 h-5 text-blue-500 mt-0.5 flex-shrink-0"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:e.label}),(0,s.jsx)("div",{className:"text-sm text-gray-600",children:e.description})]})]},e.value)})})})]}),h&&(0,s.jsxs)(b.Card,{children:[(0,s.jsxs)(b.CardHeader,{children:[(0,s.jsx)(b.CardTitle,{children:"Add Project Constraint"}),(0,s.jsx)(b.CardDescription,{children:"Document obstacles and restrictions for planning"})]}),(0,s.jsx)(b.CardContent,{children:(0,s.jsxs)("form",{onSubmit:B,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"constraint-type",children:"Constraint Type *"}),(0,s.jsxs)(z.Select,{value:w.type,onValueChange:e=>_(s=>({...s,type:e})),children:[(0,s.jsx)(z.SelectTrigger,{children:(0,s.jsx)(z.SelectValue,{placeholder:"Select constraint type"})}),(0,s.jsx)(z.SelectContent,{children:el.map(e=>{let t=e.icon;return(0,s.jsx)(z.SelectItem,{value:e.value,children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(t,{className:"w-4 h-4"}),e.label]})},e.value)})})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"severity",children:"Criticality *"}),(0,s.jsxs)(z.Select,{value:w.severity,onValueChange:e=>_(s=>({...s,severity:e})),children:[(0,s.jsx)(z.SelectTrigger,{children:(0,s.jsx)(z.SelectValue,{placeholder:"Select severity"})}),(0,s.jsxs)(z.SelectContent,{children:[(0,s.jsx)(z.SelectItem,{value:"low",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),"Low"]})}),(0,s.jsx)(z.SelectItem,{value:"medium",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),"Medium"]})}),(0,s.jsx)(z.SelectItem,{value:"high",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-3 h-3 bg-orange-500 rounded-full"}),"High"]})}),(0,s.jsx)(z.SelectItem,{value:"critical",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),"Critical"]})})]})]})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)(R.Label,{htmlFor:"location",children:"Location"}),(0,s.jsx)(K.Input,{id:"location",value:w.location,onChange:e=>_(s=>({...s,location:e.target.value})),placeholder:"Specific location or address"})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)(R.Label,{htmlFor:"description",children:"Constraint Description *"}),(0,s.jsx)(O.Textarea,{id:"description",value:w.description,onChange:e=>_(s=>({...s,description:e.target.value})),placeholder:"Describe the constraint and its impact...",rows:4,required:!0})]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(N.Button,{type:"submit",children:"Add Constraint"}),(0,s.jsx)(N.Button,{type:"button",variant:"outline",onClick:()=>{_({type:"",severity:"",location:"",description:""}),j(!1)},children:"Cancel"})]})]})})]}),T.length>0&&(0,s.jsxs)(b.Card,{children:[(0,s.jsxs)(b.CardHeader,{children:[(0,s.jsx)(b.CardTitle,{children:"Saved Project Constraints"}),(0,s.jsxs)(b.CardDescription,{children:[T.length," constraint",1!==T.length?"s":""," documented for this project"]})]}),(0,s.jsx)(b.CardContent,{children:(0,s.jsx)("div",{className:"rounded-md border",children:(0,s.jsxs)(W.Table,{children:[(0,s.jsx)(W.TableHeader,{children:(0,s.jsxs)(W.TableRow,{children:[(0,s.jsx)(W.TableHead,{children:"Type"}),(0,s.jsx)(W.TableHead,{children:"Severity"}),(0,s.jsx)(W.TableHead,{children:"Location"}),(0,s.jsx)(W.TableHead,{children:"Description"}),(0,s.jsx)(W.TableHead,{children:"Added"}),(0,s.jsx)(W.TableHead,{className:"w-[50px]",children:"Actions"})]})}),(0,s.jsx)(W.TableBody,{children:T.map(e=>{let t=el.find(s=>s.value===e.type),a=(null==t?void 0:t.icon)||I.Package;return(0,s.jsxs)(W.TableRow,{children:[(0,s.jsx)(W.TableCell,{children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(a,{className:"w-4 h-4 text-blue-500"}),(null==t?void 0:t.label)||e.type]})}),(0,s.jsx)(W.TableCell,{children:(0,s.jsx)(f.Badge,{variant:"secondary",className:(e=>{switch(e){case"low":return"bg-green-100 text-green-800";case"medium":return"bg-yellow-100 text-yellow-800";case"high":return"bg-orange-100 text-orange-800";case"critical":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}})(e.severity),children:e.severity.charAt(0).toUpperCase()+e.severity.slice(1)})}),(0,s.jsx)(W.TableCell,{children:e.location||(0,s.jsx)("span",{className:"text-gray-400",children:"-"})}),(0,s.jsx)(W.TableCell,{className:"max-w-xs",children:(0,s.jsx)("div",{className:"truncate",title:e.description,children:e.description})}),(0,s.jsx)(W.TableCell,{className:"text-sm text-gray-500",children:e.createdAt}),(0,s.jsx)(W.TableCell,{children:(0,s.jsx)(N.Button,{variant:"ghost",size:"sm",onClick:()=>{var s;return s=e.id,void(q(e=>e.filter(e=>e.id!==s)),P.toast.success("Constraint removed successfully!"))},className:"text-red-500 hover:text-red-700",children:(0,s.jsx)(J.Trash2,{className:"w-4 h-4"})})})]},e.id)})})]})})})]})]}),(0,s.jsx)(C.TabsContent,{value:"installation",className:"space-y-4",children:(0,s.jsxs)(b.Card,{children:[(0,s.jsxs)(b.CardHeader,{children:[(0,s.jsx)(b.CardTitle,{children:"Cabinet Installation Plans"}),(0,s.jsx)(b.CardDescription,{children:"Installation procedures for new cabinet enclosures"})]}),(0,s.jsxs)(b.CardContent,{children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h4",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[(0,s.jsx)(et,{className:"w-5 h-5"}),"Lower Cabinet Part"]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h5",{className:"font-medium flex items-center gap-2",children:[(0,s.jsx)(r.MapPin,{className:"w-4 h-4 text-blue-500"}),"1. Installation Site Marking"]}),(0,s.jsxs)("ul",{className:"text-sm text-gray-600 ml-6 space-y-1",children:[(0,s.jsx)("li",{children:"• Determine exact location per project"}),(0,s.jsx)("li",{children:"• Check for absence of utility lines"}),(0,s.jsx)("li",{children:"• Mark excavation outline"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h5",{className:"font-medium flex items-center gap-2",children:[(0,s.jsx)(et,{className:"w-4 h-4 text-orange-500"}),"2. Earthwork"]}),(0,s.jsxs)("ul",{className:"text-sm text-gray-600 ml-6 space-y-1",children:[(0,s.jsx)("li",{children:"• Excavate pit according to cabinet size"}),(0,s.jsx)("li",{children:"• Depth: typically 1.2-1.5m"}),(0,s.jsx)("li",{children:"• Install formwork if needed"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h5",{className:"font-medium flex items-center gap-2",children:[(0,s.jsx)(es,{className:"w-4 h-4 text-green-500"}),"3. Cable Routing"]}),(0,s.jsxs)("ul",{className:"text-sm text-gray-600 ml-6 space-y-1",children:[(0,s.jsx)("li",{children:"• Route incoming cables to installation site"}),(0,s.jsx)("li",{children:"• Prepare cable penetrations"}),(0,s.jsx)("li",{children:"• Ensure watertight sealing"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h5",{className:"font-medium flex items-center gap-2",children:[(0,s.jsx)(I.Package,{className:"w-4 h-4 text-purple-500"}),"4. Lower Part Installation"]}),(0,s.jsxs)("ul",{className:"text-sm text-gray-600 ml-6 space-y-1",children:[(0,s.jsx)("li",{children:"• Install cabinet base"}),(0,s.jsx)("li",{children:"• Level with spirit level"}),(0,s.jsx)("li",{children:"• Backfill and compact"})]})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h4",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[(0,s.jsx)(es,{className:"w-5 h-5"}),"Upper Cabinet Part"]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h5",{className:"font-medium flex items-center gap-2",children:[(0,s.jsx)(u.FileText,{className:"w-4 h-4 text-blue-500"}),"1. Preparation per Plans"]}),(0,s.jsxs)("ul",{className:"text-sm text-gray-600 ml-6 space-y-1",children:[(0,s.jsx)("li",{children:"• Study connection diagram"}),(0,s.jsx)("li",{children:"• Prepare required materials"}),(0,s.jsx)("li",{children:"• Check equipment completeness"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h5",{className:"font-medium flex items-center gap-2",children:[(0,s.jsx)(es,{className:"w-4 h-4 text-green-500"}),"2. Connection Assembly"]}),(0,s.jsxs)("ul",{className:"text-sm text-gray-600 ml-6 space-y-1",children:[(0,s.jsx)("li",{children:"• Route all cables into cabinet"}),(0,s.jsx)("li",{children:"• Perform fiber splicing per diagram"}),(0,s.jsx)("li",{children:"• Install splitters and patch panels"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h5",{className:"font-medium flex items-center gap-2",children:[(0,s.jsx)(I.Package,{className:"w-4 h-4 text-purple-500"}),"3. Equipment Connection"]}),(0,s.jsxs)("ul",{className:"text-sm text-gray-600 ml-6 space-y-1",children:[(0,s.jsx)("li",{children:"• Install active equipment"}),(0,s.jsx)("li",{children:"• Connect power supply"}),(0,s.jsx)("li",{children:"• Configure equipment"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h5",{className:"font-medium flex items-center gap-2",children:[(0,s.jsx)(ee.Ruler,{className:"w-4 h-4 text-orange-500"}),"4. Testing & Completion"]}),(0,s.jsxs)("ul",{className:"text-sm text-gray-600 ml-6 space-y-1",children:[(0,s.jsx)("li",{children:"• Test all connections"}),(0,s.jsx)("li",{children:"• Measure line attenuation"}),(0,s.jsx)("li",{children:"• Close and seal cabinet"})]})]})]})]})]}),(0,s.jsxs)("div",{className:"mt-8 border-t pt-6",children:[(0,s.jsxs)("h4",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[(0,s.jsx)(u.FileText,{className:"w-5 h-5"}),"Cabinet Plans Upload"]}),(0,s.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[(0,s.jsx)(u.FileText,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Upload Cabinet Plans"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:"Drag and drop files here or click to browse"}),(0,s.jsx)(N.Button,{variant:"outline",children:"Select Files"}),(0,s.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"Supported formats: PDF, DWG, PNG, JPG, JPEG"})]})]})]})]})})]})]})}},{id:3,title:"Facilities & Housing",description:"Setup facilities and housing arrangements",icon:V,component:function(e){let{projectId:t}=e,{data:a,isLoading:r}=(0,S.useQuery)({queryKey:["facilities",t],queryFn:()=>q.getFacilities(t),enabled:!!t}),{data:i,isLoading:n}=(0,S.useQuery)({queryKey:["housing-units",t],queryFn:()=>er.getHousingUnits(t),enabled:!!t}),c=function(){let e=(0,F.useQueryClient)();return(0,k.useMutation)({mutationFn:q.createFacility,onSuccess:(s,t)=>{e.invalidateQueries({queryKey:["facilities",t.project_id]}),e.invalidateQueries({queryKey:["project-preparation",t.project_id]}),P.toast.success(s.message||"Facility created successfully")},onError:e=>{P.toast.error(e.message)}})}(),d=function(){let e=(0,F.useQueryClient)();return(0,k.useMutation)({mutationFn:er.createHousingUnit,onSuccess:(s,t)=>{e.invalidateQueries({queryKey:["housing-units",t.project_id]}),e.invalidateQueries({queryKey:["project-preparation",t.project_id]}),P.toast.success(s.message||"Housing unit created successfully")},onError:e=>{P.toast.error(e.message)}})}(),o=function(){let e=(0,F.useQueryClient)();return(0,k.useMutation)({mutationFn:er.updateHousingUnit,onSuccess:s=>{e.invalidateQueries({queryKey:["housing-units"]}),e.invalidateQueries({queryKey:["project-preparation"]}),P.toast.success(s.message||"Housing unit updated successfully")},onError:e=>{P.toast.error(e.message)}})}(),x=function(){let e=(0,F.useQueryClient)();return(0,k.useMutation)({mutationFn:er.deleteHousingUnit,onSuccess:s=>{e.invalidateQueries({queryKey:["housing-units"]}),e.invalidateQueries({queryKey:["project-preparation"]}),P.toast.success(s.message||"Housing unit deleted successfully")},onError:e=>{P.toast.error(e.message)}})}(),[m,h]=(0,L.useState)(!1),[u,j]=(0,L.useState)(!1),[p,g]=(0,L.useState)(null),[v,y]=(0,L.useState)({type:"",rent_daily_eur:"",service_freq:"",status:"planned",start_date:"",end_date:"",location_text:""}),[w,_]=(0,L.useState)({address:"",rooms_total:"",beds_total:"",rent_daily_eur:"",status:"available"}),T=async e=>{if(e.preventDefault(),!v.type||!v.rent_daily_eur)return void P.toast.error("Please fill in all required fields");try{await c.mutateAsync({project_id:t,type:v.type,rent_daily_eur:parseFloat(v.rent_daily_eur),service_freq:v.service_freq||void 0,status:v.status,start_date:v.start_date||void 0,end_date:v.end_date||void 0,location_text:v.location_text||void 0}),y({type:"",rent_daily_eur:"",service_freq:"",status:"planned",start_date:"",end_date:"",location_text:""}),h(!1)}catch(e){}},A=async e=>{if(e.preventDefault(),!w.address||!w.rooms_total||!w.beds_total||!w.rent_daily_eur)return void P.toast.error("Please fill in all required fields");try{p?(await o.mutateAsync({id:p,address:w.address,rooms_total:parseInt(w.rooms_total),beds_total:parseInt(w.beds_total),rent_daily_eur:parseFloat(w.rent_daily_eur),status:w.status}),g(null)):await d.mutateAsync({project_id:t,address:w.address,rooms_total:parseInt(w.rooms_total),beds_total:parseInt(w.beds_total),rent_daily_eur:parseFloat(w.rent_daily_eur),status:w.status}),_({address:"",rooms_total:"",beds_total:"",rent_daily_eur:"",status:"available"}),j(!1)}catch(e){}},D=async(e,s)=>{if(confirm('Are you sure you want to delete housing unit at "'.concat(s,'"?')))try{await x.mutateAsync(e)}catch(e){}},B=e=>{switch(e){case"planned":return"bg-yellow-100 text-yellow-800";case"active":case"available":return"bg-green-100 text-green-800";case"completed":return"bg-blue-100 text-blue-800";case"occupied":return"bg-red-100 text-red-800";case"maintenance":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}};return r||n?(0,s.jsx)("div",{children:"Loading facilities and housing..."}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"Facilities & Housing Management"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Manage project facilities and housing arrangements for the team"})]}),(0,s.jsxs)(C.Tabs,{defaultValue:"facilities",className:"w-full",children:[(0,s.jsxs)(C.TabsList,{className:"grid w-full grid-cols-2",children:[(0,s.jsxs)(C.TabsTrigger,{value:"facilities",className:"flex items-center gap-2",children:[(0,s.jsx)(V,{className:"w-4 h-4"}),"Facilities"]}),(0,s.jsxs)(C.TabsTrigger,{value:"housing",className:"flex items-center gap-2",children:[(0,s.jsx)(E.Home,{className:"w-4 h-4"}),"Housing"]})]}),(0,s.jsxs)(C.TabsContent,{value:"facilities",className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-md font-medium",children:"Project Facilities"}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:[(null==a?void 0:a.length)||0," facilities configured"]})]}),(0,s.jsxs)(N.Button,{onClick:()=>h(!m),className:"flex items-center gap-2",children:[(0,s.jsx)(G.Plus,{className:"w-4 h-4"}),"Add Facility"]})]}),m&&(0,s.jsxs)(b.Card,{children:[(0,s.jsxs)(b.CardHeader,{children:[(0,s.jsx)(b.CardTitle,{children:"Add New Facility"}),(0,s.jsx)(b.CardDescription,{children:"Add a new facility for the project (e.g., office, warehouse, site office)"})]}),(0,s.jsx)(b.CardContent,{children:(0,s.jsxs)("form",{onSubmit:T,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"facility-type",children:"Facility Type *"}),(0,s.jsx)(K.Input,{id:"facility-type",value:v.type,onChange:e=>y(s=>({...s,type:e.target.value})),placeholder:"e.g., Site Office, Warehouse, Storage",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"facility-rent",children:"Daily Rent (EUR) *"}),(0,s.jsx)(K.Input,{id:"facility-rent",type:"number",step:"0.01",value:v.rent_daily_eur,onChange:e=>y(s=>({...s,rent_daily_eur:e.target.value})),placeholder:"150.00",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"facility-status",children:"Status"}),(0,s.jsxs)(z.Select,{value:v.status,onValueChange:e=>y(s=>({...s,status:e})),children:[(0,s.jsx)(z.SelectTrigger,{children:(0,s.jsx)(z.SelectValue,{})}),(0,s.jsxs)(z.SelectContent,{children:[(0,s.jsx)(z.SelectItem,{value:"planned",children:"🟡 Planned"}),(0,s.jsx)(z.SelectItem,{value:"active",children:"🟢 Active"}),(0,s.jsx)(z.SelectItem,{value:"completed",children:"🔵 Completed"})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"service-freq",children:"Service Frequency"}),(0,s.jsx)(K.Input,{id:"service-freq",value:v.service_freq,onChange:e=>y(s=>({...s,service_freq:e.target.value})),placeholder:"e.g., Weekly, Daily"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"start-date",children:"Start Date"}),(0,s.jsx)(K.Input,{id:"start-date",type:"date",value:v.start_date,onChange:e=>y(s=>({...s,start_date:e.target.value}))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"end-date",children:"End Date"}),(0,s.jsx)(K.Input,{id:"end-date",type:"date",value:v.end_date,onChange:e=>y(s=>({...s,end_date:e.target.value}))})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"location",children:"Location"}),(0,s.jsx)(K.Input,{id:"location",value:v.location_text,onChange:e=>y(s=>({...s,location_text:e.target.value})),placeholder:"Facility address or location description"})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(N.Button,{type:"submit",disabled:c.isPending,children:"Add Facility"}),(0,s.jsx)(N.Button,{type:"button",variant:"outline",onClick:()=>h(!1),children:"Cancel"})]})]})})]}),(0,s.jsx)(b.Card,{children:(0,s.jsx)(b.CardContent,{className:"p-6",children:a&&0!==a.length?(0,s.jsxs)(W.Table,{children:[(0,s.jsx)(W.TableHeader,{children:(0,s.jsxs)(W.TableRow,{children:[(0,s.jsx)(W.TableHead,{children:"Type"}),(0,s.jsx)(W.TableHead,{children:"Status"}),(0,s.jsx)(W.TableHead,{children:"Daily Rent"}),(0,s.jsx)(W.TableHead,{children:"Period"}),(0,s.jsx)(W.TableHead,{children:"Location"}),(0,s.jsx)(W.TableHead,{children:"Supplier"}),(0,s.jsx)(W.TableHead,{children:"Actions"})]})}),(0,s.jsx)(W.TableBody,{children:a.map(e=>(0,s.jsxs)(W.TableRow,{children:[(0,s.jsx)(W.TableCell,{className:"font-medium",children:e.type}),(0,s.jsx)(W.TableCell,{children:(0,s.jsx)(f.Badge,{className:B(e.status),children:e.status})}),(0,s.jsxs)(W.TableCell,{children:["€",e.rent_daily_eur.toLocaleString(),"/day"]}),(0,s.jsx)(W.TableCell,{children:e.start_date&&e.end_date?(0,s.jsxs)("span",{className:"text-sm",children:[e.start_date," - ",e.end_date]}):e.start_date?(0,s.jsxs)("span",{className:"text-sm",children:["From ",e.start_date]}):(0,s.jsx)("span",{className:"text-gray-400",children:"Not set"})}),(0,s.jsx)(W.TableCell,{children:e.location_text||(0,s.jsx)("span",{className:"text-gray-400",children:"-"})}),(0,s.jsx)(W.TableCell,{children:e.supplier_name||(0,s.jsx)("span",{className:"text-gray-400",children:"-"})}),(0,s.jsx)(W.TableCell,{children:(0,s.jsxs)("div",{className:"flex gap-1",children:[(0,s.jsx)(N.Button,{variant:"ghost",size:"sm",children:(0,s.jsx)(l.Edit,{className:"w-4 h-4"})}),(0,s.jsx)(N.Button,{variant:"ghost",size:"sm",children:(0,s.jsx)(J.Trash2,{className:"w-4 h-4 text-red-500"})})]})})]},e.id))})]}):(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)(V,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-medium mb-2",children:"No Facilities"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:"Add facilities needed for the project."}),(0,s.jsx)(N.Button,{onClick:()=>h(!0),children:"Add First Facility"})]})})})]}),(0,s.jsxs)(C.TabsContent,{value:"housing",className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-md font-medium",children:"Housing Units"}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:[(null==i?void 0:i.length)||0," housing units configured"]})]}),(0,s.jsxs)(N.Button,{onClick:()=>j(!u),className:"flex items-center gap-2",children:[(0,s.jsx)(G.Plus,{className:"w-4 h-4"}),"Add Housing"]})]}),u&&(0,s.jsxs)(b.Card,{children:[(0,s.jsxs)(b.CardHeader,{children:[(0,s.jsx)(b.CardTitle,{children:p?"Edit Housing Unit":"Add New Housing Unit"}),(0,s.jsx)(b.CardDescription,{children:p?"Update housing unit information":"Add accommodation for project team members"})]}),(0,s.jsx)(b.CardContent,{children:(0,s.jsxs)("form",{onSubmit:A,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)(R.Label,{htmlFor:"housing-address",children:"Address *"}),(0,s.jsx)(K.Input,{id:"housing-address",value:w.address,onChange:e=>_(s=>({...s,address:e.target.value})),placeholder:"Full address of the housing unit",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"rooms",children:"Total Rooms *"}),(0,s.jsx)(K.Input,{id:"rooms",type:"number",min:"1",value:w.rooms_total,onChange:e=>_(s=>({...s,rooms_total:e.target.value})),placeholder:"Number of rooms",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"beds",children:"Total Beds *"}),(0,s.jsx)(K.Input,{id:"beds",type:"number",min:"1",value:w.beds_total,onChange:e=>_(s=>({...s,beds_total:e.target.value})),placeholder:"Number of beds",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"housing-rent",children:"Daily Rent (EUR) *"}),(0,s.jsx)(K.Input,{id:"housing-rent",type:"number",step:"0.01",value:w.rent_daily_eur,onChange:e=>_(s=>({...s,rent_daily_eur:e.target.value})),placeholder:"Daily rental cost",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"housing-status",children:"Status"}),(0,s.jsxs)(z.Select,{value:w.status,onValueChange:e=>_(s=>({...s,status:e})),children:[(0,s.jsx)(z.SelectTrigger,{children:(0,s.jsx)(z.SelectValue,{})}),(0,s.jsxs)(z.SelectContent,{children:[(0,s.jsx)(z.SelectItem,{value:"available",children:"🟢 Available"}),(0,s.jsx)(z.SelectItem,{value:"occupied",children:"🔴 Occupied"}),(0,s.jsx)(z.SelectItem,{value:"maintenance",children:"🟡 Maintenance"})]})]})]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(N.Button,{type:"submit",disabled:d.isPending||o.isPending,children:p?"Update Housing Unit":"Add Housing Unit"}),(0,s.jsx)(N.Button,{type:"button",variant:"outline",onClick:()=>{g(null),_({address:"",rooms_total:"",beds_total:"",rent_daily_eur:"",status:"available"}),j(!1)},children:"Cancel"})]})]})})]}),(0,s.jsx)(b.Card,{children:(0,s.jsx)(b.CardContent,{className:"p-6",children:i&&0!==i.length?(0,s.jsxs)(W.Table,{children:[(0,s.jsx)(W.TableHeader,{children:(0,s.jsxs)(W.TableRow,{children:[(0,s.jsx)(W.TableHead,{children:"Address"}),(0,s.jsx)(W.TableHead,{children:"Rooms"}),(0,s.jsx)(W.TableHead,{children:"Area (sqm)"}),(0,s.jsx)(W.TableHead,{children:"Type"}),(0,s.jsx)(W.TableHead,{children:"Status"}),(0,s.jsx)(W.TableHead,{children:"Actions"})]})}),(0,s.jsx)(W.TableBody,{children:null==i?void 0:i.map(e=>(0,s.jsxs)(W.TableRow,{children:[(0,s.jsx)(W.TableCell,{className:"font-medium",children:e.full_address||e.unit_number||"N/A"}),(0,s.jsx)(W.TableCell,{children:e.room_count||"N/A"}),(0,s.jsx)(W.TableCell,{children:e.area_sqm||"N/A"}),(0,s.jsx)(W.TableCell,{children:e.unit_type}),(0,s.jsx)(W.TableCell,{children:(0,s.jsx)(f.Badge,{className:B(e.status),children:e.status})}),(0,s.jsx)(W.TableCell,{children:(0,s.jsxs)("div",{className:"flex gap-1",children:[(0,s.jsx)(N.Button,{variant:"ghost",size:"sm",onClick:()=>{_({address:e.address,rooms_total:e.rooms_total.toString(),beds_total:e.beds_total.toString(),rent_daily_eur:e.rent_daily_eur.toString(),status:e.status}),g(e.id),j(!0)},disabled:o.isPending,children:(0,s.jsx)(l.Edit,{className:"w-4 h-4"})}),(0,s.jsx)(N.Button,{variant:"ghost",size:"sm",onClick:()=>D(e.id,e.address),disabled:x.isPending,children:(0,s.jsx)(J.Trash2,{className:"w-4 h-4 text-red-500"})})]})})]},e.id))})]}):(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)(E.Home,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-medium mb-2",children:"No Housing Units"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:"Add housing accommodations for the project team."}),(0,s.jsx)(N.Button,{onClick:()=>j(!0),children:"Add First Housing Unit"})]})})})]})]})]})}},{id:4,title:"Teams & Access",description:"Team assignments and access management",icon:n.Users,component:function(e){var t,a;let{projectId:l}=e,{data:r,isLoading:i}=(0,ey.useProjectTeams)(l),{data:c,isLoading:d}=(0,ey.useGlobalTeams)(),o=(0,ey.useUpdateTeam)(),[x,m]=(0,L.useState)(!1),h=async(e,s)=>{if(confirm('Are you sure you want to unassign team "'.concat(s,'" from this project?')))try{await o.mutateAsync({id:e,data:{project_id:null}})}catch(e){}},u=async e=>{try{await o.mutateAsync({id:e,data:{project_id:l}})}catch(e){}};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"Project Teams"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Manage project teams. Foremen automatically get Work Entry access rights."})]})}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h4",{className:"text-md font-medium",children:"Teams Assigned to Project"}),(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsxs)(ev.Dialog,{open:x,onOpenChange:m,children:[(0,s.jsx)(ev.DialogTrigger,{asChild:!0,children:(0,s.jsxs)(N.Button,{variant:"outline",className:"flex items-center gap-2",children:[(0,s.jsx)(G.Plus,{className:"w-4 h-4"}),"Assign Team"]})}),(0,s.jsxs)(ev.DialogContent,{className:"sm:max-w-[425px]",children:[(0,s.jsxs)(ev.DialogHeader,{children:[(0,s.jsx)(ev.DialogTitle,{children:"Assign Team to Project"}),(0,s.jsx)(ev.DialogDescription,{children:"Select a team to assign to this project. Only unassigned teams are shown."})]}),(0,s.jsx)("div",{className:"space-y-4 py-4",children:(null==c||null==(t=c.filter(e=>!(null==r?void 0:r.find(s=>s.id===e.id))))?void 0:t.length)===0?(0,s.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,s.jsx)(n.Users,{className:"mx-auto h-8 w-8 mb-2 text-gray-400"}),(0,s.jsx)("p",{children:"No available teams to assign"}),(0,s.jsx)("p",{className:"text-sm",children:"All teams are already assigned to projects"})]}):(0,s.jsx)("div",{className:"grid gap-2",children:null==c||null==(a=c.filter(e=>!(null==r?void 0:r.find(s=>s.id===e.id))))?void 0:a.map(e=>(0,s.jsx)(N.Button,{variant:"ghost",className:"justify-start h-auto p-3 border border-gray-200 hover:border-blue-300",onClick:()=>{u(e.id),m(!1)},children:(0,s.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,s.jsxs)("div",{className:"text-left",children:[(0,s.jsx)("div",{className:"font-medium",children:e.name}),e.foreman_name&&(0,s.jsxs)("div",{className:"text-sm text-gray-600 flex items-center gap-1",children:[(0,s.jsx)(y.Shield,{className:"w-3 h-3"}),e.foreman_name]})]}),(0,s.jsxs)("div",{className:"text-right text-sm text-gray-500",children:[(0,s.jsxs)("div",{children:[e.member_count||0," members"]}),e.is_active&&(0,s.jsx)("div",{className:"text-green-600",children:"Active"})]})]})},e.id))})})]})]})})]}),(0,s.jsxs)(b.Card,{children:[(0,s.jsxs)(b.CardHeader,{children:[(0,s.jsx)(b.CardTitle,{children:"Project Teams"}),(0,s.jsxs)(b.CardDescription,{children:[(null==r?void 0:r.length)||0," teams assigned to this project"]})]}),(0,s.jsx)(b.CardContent,{children:i?(0,s.jsx)("div",{children:"Loading teams..."}):r&&0!==r.length?(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)(W.Table,{children:[(0,s.jsx)(W.TableHeader,{children:(0,s.jsxs)(W.TableRow,{children:[(0,s.jsx)(W.TableHead,{children:"Team Name"}),(0,s.jsx)(W.TableHead,{children:"Foreman"}),(0,s.jsx)(W.TableHead,{children:"Status"}),(0,s.jsx)(W.TableHead,{children:"Members"}),(0,s.jsx)(W.TableHead,{children:"Actions"})]})}),(0,s.jsx)(W.TableBody,{children:null==r?void 0:r.map(e=>(0,s.jsxs)(W.TableRow,{children:[(0,s.jsx)(W.TableCell,{className:"font-medium",children:e.name}),(0,s.jsx)(W.TableCell,{children:e.foreman_name?(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(y.Shield,{className:"w-4 h-4 text-blue-600"}),e.foreman_name]}):(0,s.jsx)("span",{className:"text-gray-400",children:"Not assigned"})}),(0,s.jsx)(W.TableCell,{children:(0,s.jsx)(f.Badge,{variant:e.is_active?"default":"secondary",children:e.is_active?"Active":"Inactive"})}),(0,s.jsx)(W.TableCell,{children:(0,s.jsxs)(f.Badge,{variant:"outline",children:[e.member_count||0," members"]})}),(0,s.jsx)(W.TableCell,{children:(0,s.jsxs)(N.Button,{variant:"ghost",size:"sm",onClick:()=>h(e.id,e.name),disabled:o.isPending,children:[(0,s.jsx)(J.Trash2,{className:"w-4 h-4 text-red-500"}),"Unassign"]})})]},e.id))})]})}):(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)(n.Users,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-medium mb-2",children:"No Teams Assigned"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:"Assign teams from the global teams list to get started."})]})})]}),r&&r.length>0&&(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,s.jsx)(b.Card,{children:(0,s.jsxs)(b.CardContent,{className:"p-4",children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:r.length}),(0,s.jsx)("div",{className:"text-sm text-gray-600",children:"Total Teams"})]})}),(0,s.jsx)(b.Card,{children:(0,s.jsxs)(b.CardContent,{className:"p-4",children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:r.filter(e=>e.foreman_name).length}),(0,s.jsx)("div",{className:"text-sm text-gray-600",children:"With Foremen"})]})}),(0,s.jsx)(b.Card,{children:(0,s.jsxs)(b.CardContent,{className:"p-4",children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:r.filter(e=>e.is_active).length}),(0,s.jsx)("div",{className:"text-sm text-gray-600",children:"Active Teams"})]})}),(0,s.jsx)(b.Card,{children:(0,s.jsxs)(b.CardContent,{className:"p-4",children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:r.reduce((e,s)=>e+(s.member_count||0),0)}),(0,s.jsx)("div",{className:"text-sm text-gray-600",children:"Total Members"})]})})]}),(0,s.jsxs)(b.Card,{children:[(0,s.jsxs)(b.CardHeader,{children:[(0,s.jsx)(b.CardTitle,{children:"Team Access Rights"}),(0,s.jsx)(b.CardDescription,{children:"Foremen automatically get Work Entry permissions when their team is assigned to this project"})]}),(0,s.jsx)(b.CardContent,{children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-start gap-3 p-3 border rounded-lg bg-blue-50",children:[(0,s.jsx)(y.Shield,{className:"w-5 h-5 text-blue-600 mt-0.5"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-blue-800",children:"Foreman Access"}),(0,s.jsx)("div",{className:"text-sm text-blue-600",children:"Can create Work Entries and upload progress photos for their team's work"})]})]}),(0,s.jsxs)("div",{className:"flex items-start gap-3 p-3 border rounded-lg bg-green-50",children:[(0,s.jsx)(n.Users,{className:"w-5 h-5 text-green-600 mt-0.5"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium text-green-800",children:"Crew Members"}),(0,s.jsx)("div",{className:"text-sm text-green-600",children:"Work under foreman supervision, can view work assignments"})]})]})]})})]})]})}},{id:5,title:"Resources",description:"Vehicle and equipment management",icon:M.Truck,component:function(e){var t,a,r,c;let{projectId:d}=e,[o,x]=(0,L.useState)("assigned"),[m,u]=(0,L.useState)(null),[j,p]=(0,L.useState)(!1),{data:g,isLoading:v}=(0,S.useQuery)({queryKey:eN.availableVehicles(),queryFn:async()=>[],staleTime:12e4}),{data:y,isLoading:w}=(0,S.useQuery)({queryKey:eN.availableEquipment(),queryFn:async()=>[],staleTime:12e4}),{data:_,isLoading:T,error:q}=(0,S.useQuery)({queryKey:eN.projectResources(d),queryFn:async()=>({vehicles:[],equipment:[],summary:{total_resources:0,total_vehicles:0,total_equipment:0,total_cost:0}}),enabled:!!d,staleTime:3e5}),A=function(){let e=(0,F.useQueryClient)();return(0,k.useMutation)({mutationFn:async e=>{throw Error("Vehicle assignment feature is not yet implemented")},onSuccess:(s,t)=>{e.invalidateQueries({queryKey:eN.projectResources(t.project_id)}),e.invalidateQueries({queryKey:eN.availableVehicles()}),P.toast.success("Vehicle assigned successfully")},onError:e=>{P.toast.error("Failed to assign vehicle: ".concat(e.message))}})}(),B=function(){let e=(0,F.useQueryClient)();return(0,k.useMutation)({mutationFn:async e=>{throw Error("Equipment assignment feature is not yet implemented")},onSuccess:(s,t)=>{e.invalidateQueries({queryKey:eN.projectResources(t.project_id)}),e.invalidateQueries({queryKey:eN.availableEquipment()}),P.toast.success("Equipment assigned successfully")},onError:e=>{P.toast.error("Failed to assign equipment: ".concat(e.message))}})}(),E=function(){let e=(0,F.useQueryClient)();return(0,k.useMutation)({mutationFn:async e=>{let s=await fetch("/api/resources/rental-vehicles",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!s.ok)throw Error((await s.json()).message||"Failed to create rental vehicle");return s.json()},onSuccess:(s,t)=>{e.invalidateQueries({queryKey:eN.projectResources(t.project_id)}),e.invalidateQueries({queryKey:eN.availableVehicles()}),P.toast.success("Rental vehicle created and assigned successfully")},onError:e=>{P.toast.error("Failed to create rental vehicle: ".concat(e.message))}})}(),I=function(){let e=(0,F.useQueryClient)();return(0,k.useMutation)({mutationFn:async e=>{let s=await fetch("/api/resources/rental-equipment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!s.ok)throw Error((await s.json()).message||"Failed to create rental equipment");return s.json()},onSuccess:(s,t)=>{e.invalidateQueries({queryKey:eN.projectResources(t.project_id)}),e.invalidateQueries({queryKey:eN.availableEquipment()}),P.toast.success("Rental equipment created and assigned successfully")},onError:e=>{P.toast.error("Failed to create rental equipment: ".concat(e.message))}})}(),U=function(){let e=(0,F.useQueryClient)();return(0,k.useMutation)({mutationFn:async e=>{let{projectId:s,resourceId:t,resourceType:a}=e;throw Error("Resource assignment removal feature is not yet implemented")},onSuccess:(s,t)=>{e.invalidateQueries({queryKey:eN.projectResources(t.projectId)}),"vehicle"===t.resourceType?e.invalidateQueries({queryKey:eN.availableVehicles()}):e.invalidateQueries({queryKey:eN.availableEquipment()}),P.toast.success("Resource assignment removed successfully")},onError:e=>{P.toast.error("Failed to remove resource assignment: ".concat(e.message))}})}(),V=(0,em.useForm)(),W=(0,em.useForm)(),G=(0,em.useForm)(),Z=(0,em.useForm)(),X=(0,em.useForm)();if(v||w||T)return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)(D.Skeleton,{className:"h-8 w-1/3"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,s.jsx)(D.Skeleton,{className:"h-24"}),(0,s.jsx)(D.Skeleton,{className:"h-24"}),(0,s.jsx)(D.Skeleton,{className:"h-24"}),(0,s.jsx)(D.Skeleton,{className:"h-24"})]}),(0,s.jsx)(D.Skeleton,{className:"h-96"})]});if(q){let e=(null==q?void 0:q.message)||"Unknown error";return(0,s.jsx)(b.Card,{children:(0,s.jsx)(b.CardContent,{className:"p-6",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(H.AlertCircle,{className:"mx-auto h-12 w-12 text-red-500 mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Error Loading Resources"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:e}),(0,s.jsx)(N.Button,{onClick:()=>window.location.reload(),children:"Try Again"})]})})})}let Y=async e=>{try{await A.mutateAsync({...e,project_id:d}),V.reset(),u(null),x("assigned")}catch(e){}},$=async e=>{try{await B.mutateAsync({...e,project_id:d}),W.reset(),u(null),x("assigned")}catch(e){}},ee=async e=>{try{await E.mutateAsync({...e,project_id:d}),G.reset(),x("assigned")}catch(e){}},es=async e=>{try{await I.mutateAsync({...e,project_id:d}),Z.reset(),x("assigned")}catch(e){}},et=async(e,s,t)=>{if(confirm("Are you sure you want to remove ".concat(t," from this project?")))try{await U.mutateAsync({projectId:d,resourceId:e,resourceType:s})}catch(e){}},ea=(e,s)=>{u({id:e.id,type:s,data:e}),X.setValue("period",e.period||""),X.setValue("operator_name","vehicle"===s?e.driver_name||"":e.operator_name||""),X.setValue("purpose",e.purpose||""),X.setValue("daily_rate",e.daily_rate||""),X.setValue("notes",e.contract_notes||e.notes||""),p(!0)},el=()=>{u(null),p(!1),X.reset()},er=async e=>{if(m)try{console.log("Updating resource:",{resourceId:m.id,type:m.type,updates:e}),P.toast.success("".concat("vehicle"===m.type?"Vehicle":"Equipment"," updated successfully")),p(!1),u(null),X.reset(),refetch()}catch(e){P.toast.error("Failed to update resource")}},ei=(null==_||null==(t=_.summary)?void 0:t.total_resources)||0,en=(null==_||null==(a=_.summary)?void 0:a.total_vehicles)||0,ec=(null==_||null==(r=_.summary)?void 0:r.total_equipment)||0,ed=(null==_||null==(c=_.summary)?void 0:c.total_cost)||0,eo=(null==g?void 0:g.length)||0,ex=(null==y?void 0:y.length)||0;return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-2xl font-bold",children:"Resource Management"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Available vehicles and equipment for project assignment"})]})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,s.jsx)(b.Card,{children:(0,s.jsx)(b.CardContent,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(h.Settings,{className:"w-5 h-5 text-blue-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"Available Resources"}),v||w?(0,s.jsx)(D.Skeleton,{className:"h-8 w-12 mb-1"}):(0,s.jsx)("p",{className:"text-2xl font-bold",children:eo+ex}),(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:["Assigned: ",ei]})]})]})})}),(0,s.jsx)(b.Card,{children:(0,s.jsx)(b.CardContent,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(M.Truck,{className:"w-5 h-5 text-green-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"Available Vehicles"}),v?(0,s.jsx)(D.Skeleton,{className:"h-8 w-12 mb-1"}):(0,s.jsx)("p",{className:"text-2xl font-bold",children:eo}),(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:["Assigned: ",en]})]})]})})}),(0,s.jsx)(b.Card,{children:(0,s.jsx)(b.CardContent,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(h.Settings,{className:"w-5 h-5 text-purple-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"Available Equipment"}),w?(0,s.jsx)(D.Skeleton,{className:"h-8 w-12 mb-1"}):(0,s.jsx)("p",{className:"text-2xl font-bold",children:ex}),(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:["Assigned: ",ec]})]})]})})}),(0,s.jsx)(b.Card,{children:(0,s.jsx)(b.CardContent,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(Q,{className:"w-5 h-5 text-orange-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"Project Cost"}),(0,s.jsxs)("p",{className:"text-2xl font-bold",children:["€",ed.toFixed(0)]}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Daily assignment costs"})]})]})})})]}),(0,s.jsxs)(C.Tabs,{value:o,onValueChange:x,children:[(0,s.jsxs)(C.TabsList,{className:"grid w-full grid-cols-5",children:[(0,s.jsx)(C.TabsTrigger,{value:"assigned",children:"Assigned Resources"}),(0,s.jsx)(C.TabsTrigger,{value:"assign-vehicle",children:"Assign Vehicle"}),(0,s.jsx)(C.TabsTrigger,{value:"assign-equipment",children:"Assign Equipment"}),(0,s.jsx)(C.TabsTrigger,{value:"rent-vehicle",children:"Rent Vehicle"}),(0,s.jsx)(C.TabsTrigger,{value:"rent-equipment",children:"Rent Equipment"})]}),(0,s.jsx)(C.TabsContent,{value:"assigned",className:"space-y-4",children:(0,s.jsxs)(b.Card,{children:[(0,s.jsxs)(b.CardHeader,{children:[(0,s.jsx)(b.CardTitle,{children:"Project Resources"}),(0,s.jsx)(b.CardDescription,{children:"Vehicles and equipment assigned directly to project or via crews working on this project"})]}),(0,s.jsx)(b.CardContent,{children:ei>0?(0,s.jsxs)("div",{className:"space-y-6",children:[(null==_?void 0:_.vehicles)&&_.vehicles.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsxs)("h4",{className:"text-lg font-semibold mb-3 flex items-center",children:[(0,s.jsx)(M.Truck,{className:"w-5 h-5 mr-2"}),"Vehicles (",_.vehicles.length,")"]}),(0,s.jsx)("div",{className:"grid gap-4",children:_.vehicles.map(e=>{var t;return(0,s.jsx)(b.Card,{className:"border-l-4 border-l-blue-500",children:(0,s.jsx)(b.CardContent,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,s.jsx)(f.Badge,{variant:"secondary",children:e.type.toUpperCase()}),(0,s.jsx)(f.Badge,{variant:e.owned?"default":"destructive",children:e.owned?"Owned":"Rental"}),e.assignment_source&&(0,s.jsx)(f.Badge,{variant:"crew_based"===e.assignment_source?"outline":"default",children:"crew_based"===e.assignment_source?"Via Crew":"Direct"})]}),(0,s.jsxs)("h5",{className:"font-semibold",children:[e.brand," ",e.model]}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["Plate: ",e.plate_number]}),e.crew_name&&(0,s.jsxs)("p",{className:"text-sm text-blue-600 flex items-center",children:[(0,s.jsx)(n.Users,{className:"w-4 h-4 mr-1"}),"Assigned to: ",e.crew_name]}),(0,s.jsxs)("div",{className:"flex items-center space-x-4 mt-2 text-sm",children:[(0,s.jsxs)("span",{className:"flex items-center",children:[(0,s.jsx)(i.Calendar,{className:"w-4 h-4 mr-1"}),e.period]}),(0,s.jsxs)("span",{className:"flex items-center",children:[(0,s.jsx)(Q,{className:"w-4 h-4 mr-1"}),e.daily_rate?"€".concat(e.daily_rate,"/day"):"Owned"]})]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsxs)("p",{className:"font-semibold",children:["€",(null==(t=e.total_cost)?void 0:t.toFixed(2))||"0.00"]}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:[e.days||"Unlimited"," days"]}),(0,s.jsxs)("div",{className:"flex space-x-2 mt-2",children:[(0,s.jsx)(N.Button,{size:"sm",variant:"outline",onClick:()=>ea(e,"vehicle"),children:(0,s.jsx)(l.Edit,{className:"w-4 h-4"})}),(0,s.jsx)(N.Button,{size:"sm",variant:"destructive",onClick:()=>et(e.id,"vehicle","".concat(e.brand," ").concat(e.model)),disabled:U.isPending,children:(0,s.jsx)(J.Trash2,{className:"w-4 h-4"})})]})]})]})})},e.id)})})]}),(null==_?void 0:_.equipment)&&_.equipment.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsxs)("h4",{className:"text-lg font-semibold mb-3 flex items-center",children:[(0,s.jsx)(h.Settings,{className:"w-5 h-5 mr-2"}),"Equipment (",_.equipment.length,")"]}),(0,s.jsx)("div",{className:"grid gap-4",children:_.equipment.map(e=>{var t;return(0,s.jsx)(b.Card,{className:"border-l-4 border-l-purple-500",children:(0,s.jsx)(b.CardContent,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,s.jsx)(f.Badge,{variant:"secondary",children:e.type.toUpperCase()}),(0,s.jsx)(f.Badge,{variant:e.owned?"default":"destructive",children:e.owned?"Owned":"Rental"}),e.assignment_source&&(0,s.jsx)(f.Badge,{variant:"crew_based"===e.assignment_source?"outline":"default",children:"crew_based"===e.assignment_source?"Via Crew":"Direct"})]}),(0,s.jsx)("h5",{className:"font-semibold",children:e.name}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["Inventory: ",e.inventory_no]}),e.crew_name&&(0,s.jsxs)("p",{className:"text-sm text-purple-600 flex items-center",children:[(0,s.jsx)(n.Users,{className:"w-4 h-4 mr-1"}),"Assigned to: ",e.crew_name]}),(0,s.jsxs)("div",{className:"flex items-center space-x-4 mt-2 text-sm",children:[(0,s.jsxs)("span",{className:"flex items-center",children:[(0,s.jsx)(i.Calendar,{className:"w-4 h-4 mr-1"}),e.period]}),(0,s.jsxs)("span",{className:"flex items-center",children:[(0,s.jsx)(Q,{className:"w-4 h-4 mr-1"}),e.daily_rate?"€".concat(e.daily_rate,"/day"):"Owned"]})]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsxs)("p",{className:"font-semibold",children:["€",(null==(t=e.total_cost)?void 0:t.toFixed(2))||"0.00"]}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:[e.days||"Unlimited"," days"]}),(0,s.jsxs)("div",{className:"flex space-x-2 mt-2",children:[(0,s.jsx)(N.Button,{size:"sm",variant:"outline",onClick:()=>ea(e,"equipment"),children:(0,s.jsx)(l.Edit,{className:"w-4 h-4"})}),(0,s.jsx)(N.Button,{size:"sm",variant:"destructive",onClick:()=>et(e.id,"equipment",e.name),disabled:U.isPending,children:(0,s.jsx)(J.Trash2,{className:"w-4 h-4"})})]})]})]})})},e.id)})})]})]}):(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(h.Settings,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-medium mb-2",children:"No Resources Available"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:"Resources will automatically appear when crews with assigned vehicles and equipment are added to this project."}),(0,s.jsxs)("div",{className:"space-y-2 text-sm text-gray-600",children:[(0,s.jsx)("p",{children:"• Direct resource assignment to project"}),(0,s.jsx)("p",{children:"• Automatic crew-based resource assignment"}),(0,s.jsx)("p",{children:"• Rental and cost planning"})]})]})})]})}),(0,s.jsx)(C.TabsContent,{value:"assign-vehicle",children:(0,s.jsxs)(b.Card,{children:[(0,s.jsxs)(b.CardHeader,{children:[(0,s.jsx)(b.CardTitle,{children:(null==m?void 0:m.type)==="vehicle"?"Edit Vehicle Assignment":"Assign Vehicle"}),(0,s.jsx)(b.CardDescription,{children:(null==m?void 0:m.type)==="vehicle"?"Update the vehicle assignment details":"Assign an existing vehicle to this project"})]}),(0,s.jsx)(b.CardContent,{children:(0,s.jsxs)("form",{onSubmit:V.handleSubmit(Y),className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"vehicle_id",children:"Vehicle"}),(0,s.jsxs)(z.Select,{onValueChange:e=>V.setValue("vehicle_id",e),children:[(0,s.jsx)(z.SelectTrigger,{children:(0,s.jsx)(z.SelectValue,{placeholder:"Select vehicle"})}),(0,s.jsx)(z.SelectContent,{children:null==g?void 0:g.map(e=>(0,s.jsxs)(z.SelectItem,{value:e.id,children:[e.brand," ",e.model," (",e.plate_number,")",e.rental_price_per_day_eur&&" - €".concat(e.rental_price_per_day_eur,"/day")]},e.id))})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"driver_name",children:"Driver (Optional)"}),(0,s.jsx)(K.Input,{placeholder:"Driver name",...V.register("driver_name")})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"from_date",children:"Start Date"}),(0,s.jsx)(K.Input,{type:"date",...V.register("from_date",{required:!0})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"to_date",children:"End Date (Optional)"}),(0,s.jsx)(K.Input,{type:"date",...V.register("to_date")})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"purpose",children:"Purpose"}),(0,s.jsx)(K.Input,{placeholder:"Material transport, site operations...",...V.register("purpose")})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"notes",children:"Notes"}),(0,s.jsx)(O.Textarea,{placeholder:"Special conditions, operational requirements...",...V.register("notes")})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(N.Button,{type:"submit",className:"flex-1",disabled:A.isPending,children:A.isPending?(null==m?void 0:m.type)==="vehicle"?"Updating...":"Assigning...":(null==m?void 0:m.type)==="vehicle"?"Update Assignment":"Assign Vehicle"}),(null==m?void 0:m.type)==="vehicle"&&(0,s.jsx)(N.Button,{type:"button",variant:"outline",onClick:el,disabled:A.isPending,children:"Cancel"})]})]})})]})}),(0,s.jsx)(C.TabsContent,{value:"assign-equipment",children:(0,s.jsxs)(b.Card,{children:[(0,s.jsxs)(b.CardHeader,{children:[(0,s.jsx)(b.CardTitle,{children:(null==m?void 0:m.type)==="equipment"?"Edit Equipment Assignment":"Assign Equipment"}),(0,s.jsx)(b.CardDescription,{children:(null==m?void 0:m.type)==="equipment"?"Update the equipment assignment details":"Assign existing equipment to this project"})]}),(0,s.jsx)(b.CardContent,{children:(0,s.jsxs)("form",{onSubmit:W.handleSubmit($),className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"equipment_id",children:"Equipment"}),(0,s.jsxs)(z.Select,{onValueChange:e=>W.setValue("equipment_id",e),children:[(0,s.jsx)(z.SelectTrigger,{children:(0,s.jsx)(z.SelectValue,{placeholder:"Select equipment"})}),(0,s.jsx)(z.SelectContent,{children:null==y?void 0:y.map(e=>(0,s.jsxs)(z.SelectItem,{value:e.id,children:[e.name," (",e.inventory_no,")",e.rental_price_per_day_eur&&" - €".concat(e.rental_price_per_day_eur,"/day")]},e.id))})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"operator_name",children:"Operator (Optional)"}),(0,s.jsx)(K.Input,{placeholder:"Operator name",...W.register("operator_name")})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"from_date",children:"Start Date"}),(0,s.jsx)(K.Input,{type:"date",...W.register("from_date",{required:!0})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"to_date",children:"End Date (Optional)"}),(0,s.jsx)(K.Input,{type:"date",...W.register("to_date")})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"purpose",children:"Purpose"}),(0,s.jsx)(K.Input,{placeholder:"Drilling, excavation, material processing...",...W.register("purpose")})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"notes",children:"Notes"}),(0,s.jsx)(O.Textarea,{placeholder:"Maintenance requirements, special conditions...",...W.register("notes")})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(N.Button,{type:"submit",className:"flex-1",disabled:B.isPending,children:B.isPending?(null==m?void 0:m.type)==="equipment"?"Updating...":"Assigning...":(null==m?void 0:m.type)==="equipment"?"Update Assignment":"Assign Equipment"}),(null==m?void 0:m.type)==="equipment"&&(0,s.jsx)(N.Button,{type:"button",variant:"outline",onClick:el,disabled:B.isPending,children:"Cancel"})]})]})})]})}),(0,s.jsx)(C.TabsContent,{value:"rent-vehicle",children:(0,s.jsxs)(b.Card,{children:[(0,s.jsxs)(b.CardHeader,{children:[(0,s.jsx)(b.CardTitle,{children:"Create Rental Vehicle"}),(0,s.jsx)(b.CardDescription,{children:"Add a new rental vehicle and assign it to the project"})]}),(0,s.jsx)(b.CardContent,{children:(0,s.jsxs)("form",{onSubmit:G.handleSubmit(ee),className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"brand",children:"Brand"}),(0,s.jsx)(K.Input,{placeholder:"e.g. Mercedes, Volvo",...G.register("brand",{required:!0})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"model",children:"Model"}),(0,s.jsx)(K.Input,{placeholder:"e.g. Sprinter, FH16",...G.register("model",{required:!0})})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"plate_number",children:"License Plate"}),(0,s.jsx)(K.Input,{placeholder:"e.g. B-MW 1234",...G.register("plate_number",{required:!0})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"type",children:"Vehicle Type"}),(0,s.jsxs)(z.Select,{onValueChange:e=>G.setValue("type",e),children:[(0,s.jsx)(z.SelectTrigger,{children:(0,s.jsx)(z.SelectValue,{placeholder:"Select type"})}),(0,s.jsx)(z.SelectContent,{children:eb.map(e=>(0,s.jsx)(z.SelectItem,{value:e.value,children:e.label},e.value))})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"rental_company",children:"Rental Company"}),(0,s.jsx)(K.Input,{placeholder:"Company name",...G.register("rental_company",{required:!0})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"daily_rate",children:"Daily Rate (€)"}),(0,s.jsx)(K.Input,{type:"number",step:"0.01",placeholder:"50.00",...G.register("daily_rate",{required:!0,valueAsNumber:!0})})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"hourly_rate",children:"Hourly Rate (€) - Optional"}),(0,s.jsx)(K.Input,{type:"number",step:"0.01",placeholder:"5.00",...G.register("hourly_rate",{valueAsNumber:!0})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"fuel_consumption",children:"Fuel Consumption (l/100km)"}),(0,s.jsx)(K.Input,{type:"number",step:"0.1",placeholder:"8.0",...G.register("fuel_consumption",{required:!0,valueAsNumber:!0})})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"rental_start",children:"Rental Start"}),(0,s.jsx)(K.Input,{type:"date",...G.register("rental_start",{required:!0})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"rental_end",children:"Rental End (Optional)"}),(0,s.jsx)(K.Input,{type:"date",...G.register("rental_end")})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"driver_name",children:"Driver (Optional)"}),(0,s.jsx)(K.Input,{placeholder:"Driver name",...G.register("driver_name")})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"purpose",children:"Purpose"}),(0,s.jsx)(K.Input,{placeholder:"Transport, site operations...",...G.register("purpose")})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"contract_notes",children:"Contract Details"}),(0,s.jsx)(O.Textarea,{placeholder:"Contract number, special conditions...",...G.register("contract_notes")})]}),(0,s.jsx)(N.Button,{type:"submit",className:"w-full",disabled:E.isPending,children:E.isPending?"Creating...":"Create Rental Vehicle"})]})})]})}),(0,s.jsx)(C.TabsContent,{value:"rent-equipment",children:(0,s.jsxs)(b.Card,{children:[(0,s.jsxs)(b.CardHeader,{children:[(0,s.jsx)(b.CardTitle,{children:"Create Rental Equipment"}),(0,s.jsx)(b.CardDescription,{children:"Add new rental equipment and assign it to the project"})]}),(0,s.jsx)(b.CardContent,{children:(0,s.jsxs)("form",{onSubmit:Z.handleSubmit(es),className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"name",children:"Equipment Name"}),(0,s.jsx)(K.Input,{placeholder:"e.g. Hydraulic Earth Drill",...Z.register("name",{required:!0})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"type",children:"Equipment Type"}),(0,s.jsxs)(z.Select,{onValueChange:e=>Z.setValue("type",e),children:[(0,s.jsx)(z.SelectTrigger,{children:(0,s.jsx)(z.SelectValue,{placeholder:"Select type"})}),(0,s.jsx)(z.SelectContent,{children:ef.map(e=>(0,s.jsx)(z.SelectItem,{value:e.value,children:e.label},e.value))})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"inventory_no",children:"Inventory Number"}),(0,s.jsx)(K.Input,{placeholder:"e.g. EQ-2024-001",...Z.register("inventory_no",{required:!0})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"rental_company",children:"Rental Company"}),(0,s.jsx)(K.Input,{placeholder:"Company name",...Z.register("rental_company",{required:!0})})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"daily_rate",children:"Daily Rate (€)"}),(0,s.jsx)(K.Input,{type:"number",step:"0.01",placeholder:"25.00",...Z.register("daily_rate",{required:!0,valueAsNumber:!0})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"hourly_rate",children:"Hourly Rate (€) - Optional"}),(0,s.jsx)(K.Input,{type:"number",step:"0.01",placeholder:"3.00",...Z.register("hourly_rate",{valueAsNumber:!0})})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"rental_start",children:"Rental Start"}),(0,s.jsx)(K.Input,{type:"date",...Z.register("rental_start",{required:!0})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"rental_end",children:"Rental End (Optional)"}),(0,s.jsx)(K.Input,{type:"date",...Z.register("rental_end")})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"operator_name",children:"Operator (Optional)"}),(0,s.jsx)(K.Input,{placeholder:"Operator name",...Z.register("operator_name")})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"purpose",children:"Purpose"}),(0,s.jsx)(K.Input,{placeholder:"Drilling, material processing...",...Z.register("purpose")})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"contract_notes",children:"Contract Details"}),(0,s.jsx)(O.Textarea,{placeholder:"Contract number, maintenance agreements...",...Z.register("contract_notes")})]}),(0,s.jsx)(N.Button,{type:"submit",className:"w-full",disabled:I.isPending,children:I.isPending?"Creating...":"Create Rental Equipment"})]})})]})})]}),(0,s.jsx)(ev.Dialog,{open:j,onOpenChange:p,children:(0,s.jsxs)(ev.DialogContent,{className:"max-w-md",children:[(0,s.jsxs)(ev.DialogHeader,{children:[(0,s.jsxs)(ev.DialogTitle,{children:["Edit ",(null==m?void 0:m.type)==="vehicle"?"Vehicle":"Equipment"]}),(0,s.jsx)(ev.DialogDescription,{children:"Update resource details and assignment information"})]}),m&&(0,s.jsxs)("form",{onSubmit:X.handleSubmit(er),className:"space-y-4",children:[(0,s.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,s.jsx)("h4",{className:"font-semibold mb-2",children:"vehicle"===m.type?"".concat(m.data.brand," ").concat(m.data.model):m.data.name}),(0,s.jsx)("div",{className:"text-sm text-gray-600 space-y-1",children:"vehicle"===m.type?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("p",{children:["Plate: ",m.data.plate_number]}),(0,s.jsxs)("p",{children:["Type: ",m.data.type]}),(0,s.jsxs)("p",{children:["Status: ",m.data.owned?"Owned":"Rental"]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("p",{children:["Inventory: ",m.data.inventory_no]}),(0,s.jsxs)("p",{children:["Type: ",m.data.type]}),(0,s.jsxs)("p",{children:["Status: ",m.data.owned?"Owned":"Rental"]})]})})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"edit-period",children:"Assignment Period"}),(0,s.jsx)(K.Input,{id:"edit-period",placeholder:"2024-01-15 - 2024-02-15",...X.register("period")})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"edit-operator",children:"vehicle"===m.type?"Driver Name":"Operator Name"}),(0,s.jsx)(K.Input,{id:"edit-operator",placeholder:"Enter name",...X.register("operator_name")})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"edit-purpose",children:"Purpose"}),(0,s.jsx)(K.Input,{id:"edit-purpose",placeholder:"Transportation, drilling, etc.",...X.register("purpose")})]}),m.data.rental_company&&(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"edit-daily-rate",children:"Daily Rate (€)"}),(0,s.jsx)(K.Input,{id:"edit-daily-rate",type:"number",placeholder:"50",...X.register("daily_rate",{valueAsNumber:!0})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"edit-notes",children:"Notes"}),(0,s.jsx)(O.Textarea,{id:"edit-notes",placeholder:"Additional information...",...X.register("notes")})]})]}),(0,s.jsxs)("div",{className:"flex space-x-2 pt-4",children:[(0,s.jsx)(N.Button,{type:"submit",className:"flex-1",children:"Update"}),(0,s.jsx)(N.Button,{type:"button",variant:"outline",onClick:el,className:"flex-1",children:"Cancel"})]})]})]})})]})}},{id:6,title:"Materials",description:"Material allocation and ordering",icon:I.Package,component:function(e){var a,r,n,c,o,x,m,h,u,j,p,g,v,y;let{projectId:w}=e,T=(0,t.useRouter)(),[S,k]=(0,L.useState)("assigned"),[F,q]=(0,L.useState)(null),[A,E]=(0,L.useState)(!1),[M,U]=(0,L.useState)(!1),{data:V,isLoading:W,error:G,refetch:Z}=(0,ek.useUnifiedProjectMaterials)(w),{data:X,isLoading:Y,error:$}=(0,ek.useUnifiedWarehouseMaterials)(),{data:ee}=(0,eF.useMaterialOrders)({project_id:w}),{data:es}=(0,_.useProjects)(),et=(null==ee?void 0:ee.items)||[];null==es||null==(a=es.items)||a.find(e=>e.id===w);let ea=(0,ek.useAssignMaterialToProject)(),el=(0,ek.useUpdateMaterialAssignment)(),er=(0,ek.useDeleteMaterialAssignment)();(0,ek.useCreateMaterial)();let ei=(0,em.useForm)(),en=(0,em.useForm)();if((0,em.useForm)(),W)return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)(D.Skeleton,{className:"h-8 w-1/3"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,s.jsx)(D.Skeleton,{className:"h-24"}),(0,s.jsx)(D.Skeleton,{className:"h-24"}),(0,s.jsx)(D.Skeleton,{className:"h-24"}),(0,s.jsx)(D.Skeleton,{className:"h-24"})]}),(0,s.jsx)(D.Skeleton,{className:"h-96"})]});if(G)return(0,s.jsx)(b.Card,{children:(0,s.jsx)(b.CardContent,{className:"p-6",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(H.AlertCircle,{className:"mx-auto h-12 w-12 text-red-500 mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Error Loading Materials"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:G.message}),(0,s.jsx)(N.Button,{onClick:()=>Z(),children:"Try Again"})]})})});let ec=async e=>{try{await ea.mutateAsync({...e,project_id:w}),ei.reset(),Z(),P.toast.success("Material assigned successfully")}catch(e){P.toast.error("Failed to assign material")}},ed=async e=>{if(F)try{await el.mutateAsync({assignment_id:F.id,...e}),en.reset(),q(null),E(!1),Z(),P.toast.success("Material assignment updated successfully")}catch(e){P.toast.error("Failed to update material assignment")}},eo=async e=>{if(window.confirm("Are you sure you want to delete this material assignment?"))try{await er.mutateAsync(e),Z(),P.toast.success("Material assignment deleted successfully")}catch(e){P.toast.error("Failed to delete material assignment")}},ex=(null==V||null==(r=V.materials)?void 0:r.length)||0,eh=(null==V||null==(c=V.materials)||null==(n=c.filter(e=>"allocated"===e.status))?void 0:n.length)||0,eu=(null==V||null==(x=V.materials)||null==(o=x.filter(e=>"used"===e.status))?void 0:o.length)||0,ej=(null==V||null==(m=V.materials)?void 0:m.reduce((e,s)=>e+(s.total_cost||0),0))||0;return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-2xl font-bold",children:"Materials Management"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Material allocation and ordering for projects"})]})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,s.jsx)(b.Card,{children:(0,s.jsx)(b.CardContent,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(I.Package,{className:"w-5 h-5 text-blue-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"Total Materials"}),(0,s.jsx)("p",{className:"text-2xl font-bold",children:ex})]})]})})}),(0,s.jsx)(b.Card,{children:(0,s.jsx)(b.CardContent,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(e_.Clock,{className:"w-5 h-5 text-orange-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"Pending"}),(0,s.jsx)("p",{className:"text-2xl font-bold",children:eh})]})]})})}),(0,s.jsx)(b.Card,{children:(0,s.jsx)(b.CardContent,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(B.CheckCircle,{className:"w-5 h-5 text-green-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"Used"}),(0,s.jsx)("p",{className:"text-2xl font-bold",children:eu})]})]})})}),(0,s.jsx)(b.Card,{children:(0,s.jsx)(b.CardContent,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(Q,{className:"w-5 h-5 text-purple-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"Total Cost"}),(0,s.jsxs)("p",{className:"text-2xl font-bold",children:["€",ej.toFixed(0)]})]})]})})})]}),(0,s.jsxs)(C.Tabs,{value:S,onValueChange:k,children:[(0,s.jsxs)(C.TabsList,{className:"grid w-full grid-cols-3",children:[(0,s.jsx)(C.TabsTrigger,{value:"assigned",children:"Assigned Materials"}),(0,s.jsx)(C.TabsTrigger,{value:"assign",children:"Assign Materials"}),(0,s.jsx)(C.TabsTrigger,{value:"order",children:"Order Materials"})]}),(0,s.jsx)(C.TabsContent,{value:"assigned",className:"space-y-4",children:(0,s.jsxs)(b.Card,{children:[(0,s.jsxs)(b.CardHeader,{children:[(0,s.jsx)(b.CardTitle,{children:"Project Materials"}),(0,s.jsx)(b.CardDescription,{children:"Materials currently assigned to this project"})]}),(0,s.jsx)(b.CardContent,{children:(null==V||null==(h=V.materials)?void 0:h.length)>0?(0,s.jsx)("div",{className:"space-y-4",children:null==V||null==(u=V.materials)?void 0:u.map(e=>{var t,a,r,n,c,d,o;return(0,s.jsx)(b.Card,{className:"border-l-4 border-l-blue-500",children:(0,s.jsx)(b.CardContent,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,s.jsx)(f.Badge,{className:(null==(t=eq[e.status])?void 0:t.color)||"bg-gray-100 text-gray-800",children:(null==(a=eq[e.status])?void 0:a.label)||e.status}),(0,s.jsx)(f.Badge,{variant:"outline",children:(null==(r=e.material)?void 0:r.sku)||e.sku||"No SKU"})]}),(0,s.jsx)("h5",{className:"font-semibold",children:(null==(n=e.material)?void 0:n.name)||e.name||"Unknown Material"}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["Quantity: ",e.allocated_qty," ",(null==(c=e.material)?void 0:c.unit)||e.unit]}),(0,s.jsxs)("div",{className:"flex items-center space-x-4 mt-2 text-sm",children:[(0,s.jsxs)("span",{className:"flex items-center",children:[(0,s.jsx)(i.Calendar,{className:"w-4 h-4 mr-1"}),e.allocation_date,e.return_date&&" - ".concat(e.return_date)]}),(0,s.jsxs)("span",{className:"flex items-center",children:[(0,s.jsx)(Q,{className:"w-4 h-4 mr-1"}),"€",(null==(d=e.material)?void 0:d.price)||e.unit_price||0,"/unit"]})]}),e.notes&&(0,s.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["Note: ",e.notes]}),e.allocated_by_name&&(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:["Assigned by: ",e.allocated_by_name]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsxs)("p",{className:"font-semibold",children:["€",(null==(o=e.total_cost)?void 0:o.toFixed(2))||"0.00"]}),(0,s.jsxs)("div",{className:"flex space-x-2 mt-2",children:[(0,s.jsx)(N.Button,{size:"sm",variant:"outline",onClick:()=>{q(e),en.setValue("quantity",e.allocated_qty),en.setValue("unit_price",e.unit_price),en.setValue("from_date",e.allocation_date),en.setValue("to_date",e.return_date||""),en.setValue("notes",e.notes||""),E(!0)},children:(0,s.jsx)(l.Edit,{className:"w-4 h-4"})}),(0,s.jsx)(N.Button,{size:"sm",variant:"destructive",onClick:()=>eo(e.id),disabled:er.isPending,children:(0,s.jsx)(J.Trash2,{className:"w-4 h-4"})})]})]})]})})},e.id)})}):(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(I.Package,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-medium mb-2",children:"No Materials Assigned"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:"Assign materials to start tracking inventory for this project."}),(0,s.jsxs)(N.Button,{onClick:()=>k("assign"),children:[(0,s.jsx)(I.Package,{className:"w-4 h-4 mr-2"}),"Assign Materials"]})]})})]})}),(0,s.jsx)(C.TabsContent,{value:"assign",children:(0,s.jsxs)(b.Card,{children:[(0,s.jsxs)(b.CardHeader,{children:[(0,s.jsx)(b.CardTitle,{children:"Assign Materials to Project"}),(0,s.jsx)(b.CardDescription,{children:"Select materials from warehouse inventory to assign to this project"})]}),(0,s.jsx)(b.CardContent,{children:Y?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)(D.Skeleton,{className:"h-12"}),(0,s.jsx)(D.Skeleton,{className:"h-32"})]}):$?(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)(H.AlertCircle,{className:"mx-auto h-8 w-8 text-red-500 mb-2"}),(0,s.jsx)("p",{className:"text-red-600",children:"Failed to load warehouse materials"})]}):X&&X.length>0?(0,s.jsxs)("form",{onSubmit:ei.handleSubmit(ec),className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"material_id",children:"Select Material"}),(0,s.jsxs)(z.Select,{onValueChange:e=>ei.setValue("material_id",e),children:[(0,s.jsx)(z.SelectTrigger,{children:(0,s.jsx)(z.SelectValue,{placeholder:"Select material from warehouse"})}),(0,s.jsx)(z.SelectContent,{children:X.map(e=>(0,s.jsx)(z.SelectItem,{value:e.id,children:(0,s.jsxs)("div",{className:"flex justify-between items-center w-full",children:[(0,s.jsx)("span",{children:e.name}),(0,s.jsxs)("span",{className:"text-sm text-gray-500",children:["Available: ",e.available_qty," ",e.unit," | €",e.price,"/unit"]})]})},e.id))})]})]}),ei.watch("material_id")&&(0,s.jsxs)(s.Fragment,{children:[(()=>{let e=X.find(e=>e.id===ei.watch("material_id"));return e?(0,s.jsxs)("div",{className:"p-4 border rounded-lg bg-gray-50",children:[(0,s.jsx)("h4",{className:"font-semibold mb-2",children:"Material Details"}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium",children:"Current Stock"}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("p",{className:"".concat(e.available_qty>e.min_stock?"text-green-600":e.available_qty>0?"text-orange-600":"text-red-600"),children:[e.available_qty," ",e.unit," available"]}),e.is_over_allocated&&(0,s.jsxs)("p",{className:"text-red-500 text-xs font-medium",children:["⚠️ ",e.over_allocated_qty," ",e.unit," over-allocated"]}),(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:["Total: ",e.total_qty," | Reserved: ",e.reserved_qty]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium",children:"Unit Price"}),(0,s.jsxs)("p",{children:["€",e.price]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium",children:"Description"}),(0,s.jsx)("p",{className:"text-gray-600",children:e.description||"No description"})]})]})]}):null})(),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"quantity",children:"Quantity"}),(0,s.jsx)(K.Input,{type:"number",step:"0.1",min:"0.1",placeholder:"Enter quantity",...ei.register("quantity",{required:!0,valueAsNumber:!0})}),ei.watch("quantity")&&(()=>{let e=X.find(e=>e.id===ei.watch("material_id")),t=ei.watch("quantity");if(e&&t>e.available_qty){let a=t-e.available_qty;return(0,s.jsxs)("div",{className:"mt-2 p-2 bg-orange-50 border border-orange-200 rounded text-sm",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-1 text-orange-700",children:[(0,s.jsx)(d.AlertTriangle,{className:"w-4 h-4"}),(0,s.jsx)("span",{className:"font-medium",children:"Over-allocation Warning"})]}),(0,s.jsxs)("p",{className:"text-orange-600 mt-1",children:["Requesting ",t," but only ",e.available_qty," ",e.unit," available. This will create an over-allocation of ",a.toFixed(1)," ",e.unit,"."]})]})}return null})()]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"from_date",children:"Start Date"}),(0,s.jsx)(K.Input,{type:"date",...ei.register("from_date",{required:!0})})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"to_date",children:"End Date (Optional)"}),(0,s.jsx)(K.Input,{type:"date",...ei.register("to_date")})]}),(0,s.jsx)("div",{children:ei.watch("quantity")&&(0,s.jsxs)("div",{className:"p-3 bg-blue-50 rounded-lg",children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"Estimated Cost"}),(0,s.jsxs)("p",{className:"text-lg font-bold text-blue-600",children:["€",((ei.watch("quantity")||0)*((null==(j=X.find(e=>e.id===ei.watch("material_id")))?void 0:j.price)||0)).toFixed(2)]})]})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"notes",children:"Notes (Optional)"}),(0,s.jsx)(O.Textarea,{placeholder:"Special conditions or requirements...",...ei.register("notes")})]})]}),(0,s.jsx)(N.Button,{type:"submit",className:"w-full",disabled:ea.isPending||!ei.watch("material_id")||!ei.watch("quantity"),children:ea.isPending?"Assigning...":"Assign Material"})]}):(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(d.AlertTriangle,{className:"mx-auto h-12 w-12 text-orange-400 mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-medium mb-2",children:"No Available Materials"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:"No materials are currently available in the warehouse."}),(0,s.jsxs)(N.Button,{variant:"outline",children:[(0,s.jsx)(ew.ShoppingCart,{className:"w-4 h-4 mr-2"}),"Add Materials to Warehouse"]})]})})]})}),(0,s.jsx)(C.TabsContent,{value:"order",children:(0,s.jsxs)(b.Card,{children:[(0,s.jsxs)(b.CardHeader,{children:[(0,s.jsxs)(b.CardTitle,{className:"flex items-center space-x-2",children:[(0,s.jsx)(ew.ShoppingCart,{className:"w-5 h-5"}),(0,s.jsx)("span",{children:"Order Materials"})]}),(0,s.jsx)(b.CardDescription,{children:"Order materials from suppliers for this project"})]}),(0,s.jsx)(b.CardContent,{children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-semibold text-blue-900",children:"Need to place a complex order?"}),(0,s.jsx)("p",{className:"text-sm text-blue-700 mt-1",children:"Use the full materials ordering interface for multiple items and advanced options"})]}),(0,s.jsxs)(N.Button,{variant:"outline",onClick:()=>T.push("/dashboard/materials/order?project_id=".concat(w)),className:"border-blue-300 text-blue-700 hover:bg-blue-100",children:[(0,s.jsx)(ew.ShoppingCart,{className:"w-4 h-4 mr-2"}),"Full Order Interface"]})]})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Recent Orders for this Project"}),et&&et.length>0?(0,s.jsxs)("div",{className:"space-y-3",children:[et.slice(0,5).map(e=>(0,s.jsx)(eL,{order:e},e.id)),et.length>5&&(0,s.jsxs)(N.Button,{variant:"outline",onClick:()=>T.push("/dashboard/materials"),className:"w-full",children:["View All Orders (",et.length,")"]})]}):(0,s.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,s.jsx)(I.Package,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),(0,s.jsx)("p",{children:"No material orders for this project yet"}),(0,s.jsxs)(N.Button,{onClick:()=>T.push("/dashboard/materials/order?project_id=".concat(w)),className:"mt-3",children:[(0,s.jsx)(ew.ShoppingCart,{className:"w-4 h-4 mr-2"}),"Create First Order"]})]})]}),et&&et.length>0&&(0,s.jsx)(eA,{orders:et})]})})]})})]}),(0,s.jsx)(ev.Dialog,{open:A,onOpenChange:E,children:(0,s.jsxs)(ev.DialogContent,{className:"max-w-md",children:[(0,s.jsxs)(ev.DialogHeader,{children:[(0,s.jsx)(ev.DialogTitle,{children:"Edit Material Assignment"}),(0,s.jsx)(ev.DialogDescription,{children:"Update material assignment details"})]}),F&&(0,s.jsxs)("form",{onSubmit:en.handleSubmit(ed),className:"space-y-4",children:[(0,s.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,s.jsx)("h4",{className:"font-semibold mb-2",children:(null==(p=F.material)?void 0:p.name)||F.name||"Unknown Material"}),(0,s.jsxs)("div",{className:"text-sm text-gray-600 space-y-1",children:[(0,s.jsxs)("p",{children:["SKU: ",(null==(g=F.material)?void 0:g.sku)||F.sku||"No SKU"]}),(0,s.jsxs)("p",{children:["Unit: ",(null==(v=F.material)?void 0:v.unit)||F.unit]}),(0,s.jsxs)("p",{children:["Status: ",(null==(y=eq[F.status])?void 0:y.label)||F.status]})]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"edit-quantity",children:"Quantity"}),(0,s.jsx)(K.Input,{id:"edit-quantity",type:"number",step:"0.1",placeholder:"Enter quantity",...en.register("quantity",{required:!0,valueAsNumber:!0})}),(0,s.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["Unit: ",F.unit]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"edit-unit-price",children:"Unit Price (€)"}),(0,s.jsx)(K.Input,{id:"edit-unit-price",type:"number",step:"0.01",placeholder:"Enter unit price",...en.register("unit_price",{required:!0,valueAsNumber:!0})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"edit-from-date",children:"Start Date"}),(0,s.jsx)(K.Input,{id:"edit-from-date",type:"date",...en.register("from_date",{required:!0})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"edit-to-date",children:"End Date"}),(0,s.jsx)(K.Input,{id:"edit-to-date",type:"date",...en.register("to_date")})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"edit-notes",children:"Notes"}),(0,s.jsx)(O.Textarea,{id:"edit-notes",placeholder:"Additional notes...",...en.register("notes")})]}),en.watch("quantity")&&en.watch("unit_price")&&(0,s.jsxs)("div",{className:"p-3 bg-blue-50 rounded-lg",children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"Total Cost"}),(0,s.jsxs)("p",{className:"text-lg font-bold text-blue-600",children:["€",((en.watch("quantity")||0)*(en.watch("unit_price")||0)).toFixed(2)]})]})]}),(0,s.jsxs)("div",{className:"flex space-x-2 pt-4",children:[(0,s.jsx)(N.Button,{type:"submit",className:"flex-1",disabled:el.isPending,children:el.isPending?"Updating...":"Update"}),(0,s.jsx)(N.Button,{type:"button",variant:"outline",onClick:()=>{q(null),E(!1),en.reset()},className:"flex-1",children:"Cancel"})]})]})]})})]})}},{id:7,title:"Houses",description:"House connection tracking",icon:E.Home,component:function(e){var t,a,r,c,d,o,m,h;let{projectId:j}=e,[p,g]=(0,L.useState)("houses"),[v,y]=(0,L.useState)(null),[w,_]=(0,L.useState)(null),{data:T,isLoading:S,error:k,refetch:F}=(0,ex.useProjectHouses)(j),q=[],A=(0,ex.useCreateHouse)(),B=(0,ex.useUpdateHouse)(),M=(0,ex.useDeleteHouse)(),I=(0,em.useForm)(),U=(0,em.useForm)();if(S)return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)(D.Skeleton,{className:"h-8 w-1/3"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,s.jsx)(D.Skeleton,{className:"h-24"}),(0,s.jsx)(D.Skeleton,{className:"h-24"}),(0,s.jsx)(D.Skeleton,{className:"h-24"}),(0,s.jsx)(D.Skeleton,{className:"h-24"})]}),(0,s.jsx)(D.Skeleton,{className:"h-96"})]});if(k)return(0,s.jsx)(b.Card,{children:(0,s.jsx)(b.CardContent,{className:"p-6",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(H.AlertCircle,{className:"mx-auto h-12 w-12 text-red-500 mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Error Loading Houses"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:k.message}),(0,s.jsx)(N.Button,{onClick:()=>F(),children:"Try Again"})]})})});let V=async e=>{try{await A.mutateAsync({...e,project_id:j}),I.reset(),F(),P.toast.success("House added successfully")}catch(e){P.toast.error("Failed to add house")}},Q=async(e,s)=>{try{await B.mutateAsync({house_id:e,...s}),U.reset(),y(null),F(),P.toast.success("House updated successfully")}catch(e){P.toast.error("Failed to update house")}},W=async e=>{if(window.confirm("Are you sure you want to delete this house?"))try{await M.mutateAsync(e),F(),P.toast.success("House deleted successfully")}catch(e){P.toast.error("Failed to delete house")}},X=(null==T||null==(t=T.houses)?void 0:t.length)||0,Y=(null==T||null==(r=T.houses)||null==(a=r.filter(e=>"connected"===e.status))?void 0:a.length)||0,$=(null==T||null==(d=T.houses)||null==(c=d.filter(e=>"assigned"===e.status))?void 0:c.length)||0,ee=(null==T||null==(o=T.houses)?void 0:o.reduce((e,s)=>e+(s.apartment_count||1),0))||0;return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-2xl font-bold",children:"🏠 HA & HP+"}),(0,s.jsx)("p",{className:"text-gray-600",children:"House management, connection status, and documentation"})]})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,s.jsx)(b.Card,{children:(0,s.jsx)(b.CardContent,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(E.Home,{className:"w-5 h-5 text-blue-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"Häuser gesamt"}),(0,s.jsx)("p",{className:"text-2xl font-bold",children:X})]})]})})}),(0,s.jsx)(b.Card,{children:(0,s.jsx)(b.CardContent,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(n.Users,{className:"w-5 h-5 text-green-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"Verbunden"}),(0,s.jsx)("p",{className:"text-2xl font-bold",children:Y})]})]})})}),(0,s.jsx)(b.Card,{children:(0,s.jsx)(b.CardContent,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(i.Calendar,{className:"w-5 h-5 text-orange-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"Zugewiesen"}),(0,s.jsx)("p",{className:"text-2xl font-bold",children:$})]})]})})}),(0,s.jsx)(b.Card,{children:(0,s.jsx)(b.CardContent,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(E.Home,{className:"w-5 h-5 text-purple-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"Einheiten gesamt"}),(0,s.jsx)("p",{className:"text-2xl font-bold",children:ee})]})]})})})]}),(0,s.jsxs)(C.Tabs,{value:p,onValueChange:g,children:[(0,s.jsxs)(C.TabsList,{className:"grid w-full grid-cols-4",children:[(0,s.jsx)(C.TabsTrigger,{value:"houses",children:"Projekthäuser"}),(0,s.jsx)(C.TabsTrigger,{value:"add",children:"Haus hinzufügen"}),(0,s.jsx)(C.TabsTrigger,{value:"status",children:"Anschlussstatus"}),(0,s.jsx)(C.TabsTrigger,{value:"documents",children:"Hausdokumente"})]}),(0,s.jsx)(C.TabsContent,{value:"houses",className:"space-y-4",children:(0,s.jsxs)(b.Card,{children:[(0,s.jsxs)(b.CardHeader,{children:[(0,s.jsx)(b.CardTitle,{children:"Liste der Projekthäuser"}),(0,s.jsx)(b.CardDescription,{children:"Houses assigned to this project with connection details"})]}),(0,s.jsx)(b.CardContent,{children:X>0?(0,s.jsx)("div",{className:"space-y-4",children:null==T||null==(m=T.houses)?void 0:m.map(e=>{var t,a;return(0,s.jsx)(b.Card,{className:"border-l-4 border-l-blue-500",children:(0,s.jsx)(b.CardContent,{className:"p-4",children:v===e.id?(0,s.jsxs)("form",{onSubmit:U.handleSubmit(s=>Q(e.id,s)),className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"address",children:"Address"}),(0,s.jsx)(K.Input,{defaultValue:e.address,...U.register("address",{required:!0})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"house_number",children:"House Number"}),(0,s.jsx)(K.Input,{defaultValue:e.house_number||"",...U.register("house_number")})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"connection_type",children:"Connection Type"}),(0,s.jsxs)(z.Select,{onValueChange:e=>U.setValue("connection_type",e),defaultValue:e.connection_type,children:[(0,s.jsx)(z.SelectTrigger,{children:(0,s.jsx)(z.SelectValue,{})}),(0,s.jsx)(z.SelectContent,{children:eh.map(e=>(0,s.jsx)(z.SelectItem,{value:e.value,children:e.label},e.value))})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"method",children:"Installation Method"}),(0,s.jsxs)(z.Select,{onValueChange:e=>U.setValue("method",e),defaultValue:e.method,children:[(0,s.jsx)(z.SelectTrigger,{children:(0,s.jsx)(z.SelectValue,{})}),(0,s.jsx)(z.SelectContent,{children:eu.map(e=>(0,s.jsx)(z.SelectItem,{value:e.value,children:e.label},e.value))})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"status",children:"Status"}),(0,s.jsxs)(z.Select,{onValueChange:e=>U.setValue("status",e),defaultValue:e.status,children:[(0,s.jsx)(z.SelectTrigger,{children:(0,s.jsx)(z.SelectValue,{})}),(0,s.jsx)(z.SelectContent,{children:ep.map(e=>(0,s.jsx)(z.SelectItem,{value:e.value,children:e.label},e.value))})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"planned_connection_date",children:"Planned Date"}),(0,s.jsx)(K.Input,{type:"date",defaultValue:e.planned_connection_date||"",...U.register("planned_connection_date")})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"notes",children:"Notes"}),(0,s.jsx)(O.Textarea,{defaultValue:e.notes||"",...U.register("notes")})]}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)(N.Button,{type:"submit",disabled:B.isPending,children:B.isPending?"Updating...":"Update"}),(0,s.jsx)(N.Button,{type:"button",variant:"outline",onClick:()=>y(null),children:"Cancel"})]})]}):(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,s.jsx)(f.Badge,{className:(null==(t=ep.find(s=>s.value===e.status))?void 0:t.color)||"bg-gray-100 text-gray-800",children:(null==(a=ep.find(s=>s.value===e.status))?void 0:a.label)||e.status}),(0,s.jsxs)(f.Badge,{variant:"outline",children:[(()=>{let t=eh.find(s=>s.value===e.connection_type),a=null==t?void 0:t.icon;return a?(0,s.jsx)(a,{className:"w-4 h-4 mr-1"}):null})(),e.connection_type]}),(0,s.jsxs)(f.Badge,{variant:"outline",children:[(()=>{let t=eu.find(s=>s.value===e.method),a=null==t?void 0:t.icon;return a?(0,s.jsx)(a,{className:"w-4 h-4 mr-1"}):null})(),e.method]})]}),(0,s.jsx)("h5",{className:"font-semibold",children:e.address}),e.house_number&&(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["House Number: ",e.house_number]}),(0,s.jsxs)("div",{className:"flex items-center space-x-4 mt-2 text-sm",children:[(0,s.jsxs)("span",{className:"flex items-center",children:[(0,s.jsx)(E.Home,{className:"w-4 h-4 mr-1"}),e.apartment_count," Units"]}),e.planned_connection_date&&(0,s.jsxs)("span",{className:"flex items-center",children:[(0,s.jsx)(i.Calendar,{className:"w-4 h-4 mr-1"}),e.planned_connection_date]}),e.contact_name&&(0,s.jsxs)("span",{className:"flex items-center",children:[(0,s.jsx)(x.Phone,{className:"w-4 h-4 mr-1"}),e.contact_name]})]}),e.notes&&(0,s.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:["Note: ",e.notes]})]}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)(N.Button,{size:"sm",variant:"outline",onClick:()=>y(e.id),children:(0,s.jsx)(l.Edit,{className:"w-4 h-4"})}),(0,s.jsx)(N.Button,{size:"sm",variant:"destructive",onClick:()=>W(e.id),disabled:M.isPending,children:(0,s.jsx)(J.Trash2,{className:"w-4 h-4"})})]})]})})},e.id)})}):(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(E.Home,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Keine Häuser dem Projekt hinzugefügt"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:"Add houses to start tracking connections for this project."}),(0,s.jsxs)(N.Button,{onClick:()=>g("add"),children:[(0,s.jsx)(G.Plus,{className:"w-4 h-4 mr-2"}),"Haus hinzufügen"]})]})})]})}),(0,s.jsx)(C.TabsContent,{value:"add",children:(0,s.jsxs)(b.Card,{children:[(0,s.jsxs)(b.CardHeader,{children:[(0,s.jsx)(b.CardTitle,{children:"🏠 Haus zum Projekt hinzufügen"}),(0,s.jsx)(b.CardDescription,{children:"Add a new house to this project with connection details"})]}),(0,s.jsx)(b.CardContent,{children:(0,s.jsxs)("form",{onSubmit:I.handleSubmit(V),className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"address",children:"Address *"}),(0,s.jsx)(K.Input,{placeholder:"Hauptstraße 15, 10115 Berlin",...I.register("address",{required:!0})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"house_number",children:"House Number"}),(0,s.jsx)(K.Input,{placeholder:"123A",...I.register("house_number")})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"apartment_count",children:"Number of Apartments"}),(0,s.jsx)(K.Input,{type:"number",min:"1",defaultValue:"1",...I.register("apartment_count",{required:!0,valueAsNumber:!0})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"floor_count",children:"Number of Floors"}),(0,s.jsx)(K.Input,{type:"number",min:"1",defaultValue:"1",...I.register("floor_count",{required:!0,valueAsNumber:!0})})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"connection_type",children:"Connection Type"}),(0,s.jsxs)(z.Select,{onValueChange:e=>I.setValue("connection_type",e),children:[(0,s.jsx)(z.SelectTrigger,{children:(0,s.jsx)(z.SelectValue,{placeholder:"Select connection type"})}),(0,s.jsx)(z.SelectContent,{children:eh.map(e=>(0,s.jsx)(z.SelectItem,{value:e.value,children:e.label},e.value))})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"method",children:"Installation Method"}),(0,s.jsxs)(z.Select,{onValueChange:e=>I.setValue("method",e),children:[(0,s.jsx)(z.SelectTrigger,{children:(0,s.jsx)(z.SelectValue,{placeholder:"Select installation method"})}),(0,s.jsx)(z.SelectContent,{children:eu.map(e=>(0,s.jsx)(z.SelectItem,{value:e.value,children:e.label},e.value))})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"house_type",children:"Building Type"}),(0,s.jsxs)(z.Select,{onValueChange:e=>I.setValue("house_type",e),children:[(0,s.jsx)(z.SelectTrigger,{children:(0,s.jsx)(z.SelectValue,{placeholder:"Select building type"})}),(0,s.jsx)(z.SelectContent,{children:ej.map(e=>(0,s.jsx)(z.SelectItem,{value:e.value,children:e.label},e.value))})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"planned_connection_date",children:"Planned Connection Date"}),(0,s.jsx)(K.Input,{type:"date",...I.register("planned_connection_date")})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"contact_name",children:"Contact Person"}),(0,s.jsx)(K.Input,{placeholder:"Max Mustermann",...I.register("contact_name")})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"contact_phone",children:"Phone"}),(0,s.jsx)(K.Input,{placeholder:"+49 30 12345678",...I.register("contact_phone")})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"contact_email",children:"Email"}),(0,s.jsx)(K.Input,{type:"email",placeholder:"max.mustermann@example.com",...I.register("contact_email")})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"notes",children:"Notes"}),(0,s.jsx)(O.Textarea,{placeholder:"Besonderheiten beim Anschluss, Zugangshinweise...",...I.register("notes")})]}),(0,s.jsx)(N.Button,{type:"submit",className:"w-full",disabled:A.isPending,children:A.isPending?"Adding...":"Haus hinzufügen"})]})})]})}),(0,s.jsx)(C.TabsContent,{value:"status",children:(0,s.jsxs)(b.Card,{children:[(0,s.jsxs)(b.CardHeader,{children:[(0,s.jsx)(b.CardTitle,{children:"Übersicht Anschlussstatus"}),(0,s.jsx)(b.CardDescription,{children:"Connection status overview with statistics"})]}),(0,s.jsx)(b.CardContent,{children:X>0?(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:ep.map(e=>{var t,a;let l=(null==T||null==(a=T.houses)||null==(t=a.filter(s=>s.status===e.value))?void 0:t.length)||0,r=X>0?Math.round(l/X*100):0;return(0,s.jsx)(b.Card,{children:(0,s.jsxs)(b.CardContent,{className:"p-4 text-center",children:[(0,s.jsx)("div",{className:"inline-flex items-center px-2 py-1 rounded-full text-sm font-medium ".concat(e.color," mb-2"),children:e.label}),(0,s.jsx)("p",{className:"text-2xl font-bold",children:l}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:[r,"% of houses"]})]})},e.value)})}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h4",{className:"text-lg font-semibold",children:"Connection Progress"}),ep.map(e=>{var t,a;let l=(null==T||null==(a=T.houses)||null==(t=a.filter(s=>s.status===e.value))?void 0:t.length)||0,r=X>0?l/X*100:0;return(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm font-medium",children:e.label}),(0,s.jsxs)("span",{className:"text-sm",children:[l," houses (",r.toFixed(1),"%)"]})]}),(0,s.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,s.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat(r,"%")}})})]},e.value)})]})]}):(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(ei.BarChart3,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-medium mb-2",children:"No Status Data"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Add houses to view connection status statistics."})]})})]})}),(0,s.jsx)(C.TabsContent,{value:"documents",children:(0,s.jsxs)(b.Card,{children:[(0,s.jsxs)(b.CardHeader,{children:[(0,s.jsx)(b.CardTitle,{children:"📎 Verwaltung der Hausdokumente"}),(0,s.jsx)(b.CardDescription,{children:"Manage documents for project houses"})]}),(0,s.jsx)(b.CardContent,{children:X>0?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"house_select",children:"Select House"}),(0,s.jsxs)(z.Select,{onValueChange:_,children:[(0,s.jsx)(z.SelectTrigger,{children:(0,s.jsx)(z.SelectValue,{placeholder:"Select house for document management"})}),(0,s.jsx)(z.SelectContent,{children:null==T||null==(h=T.houses)?void 0:h.map(e=>(0,s.jsxs)(z.SelectItem,{value:e.id,children:[e.address," ",e.house_number&&"(".concat(e.house_number,")")]},e.id))})]})]}),w&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)(b.Card,{children:[(0,s.jsx)(b.CardHeader,{children:(0,s.jsx)(b.CardTitle,{className:"text-lg",children:"Upload Document"})}),(0,s.jsx)(b.CardContent,{children:(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"doc_type",children:"Document Type"}),(0,s.jsxs)(z.Select,{children:[(0,s.jsx)(z.SelectTrigger,{children:(0,s.jsx)(z.SelectValue,{placeholder:"Select document type"})}),(0,s.jsx)(z.SelectContent,{children:eg.map(e=>(0,s.jsx)(z.SelectItem,{value:e.value,children:e.label},e.value))})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"file",children:"File"}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(K.Input,{type:"file",accept:".pdf,.doc,.docx,.jpg,.jpeg,.png,.xls,.xlsx"}),(0,s.jsxs)(N.Button,{type:"button",disabled:!1,children:[(0,s.jsx)(Z.Upload,{className:"w-4 h-4 mr-2"}),"Upload"]})]})]})]})})]}),q&&q.length>0?(0,s.jsxs)(b.Card,{children:[(0,s.jsx)(b.CardHeader,{children:(0,s.jsx)(b.CardTitle,{className:"text-lg",children:"Existing Documents"})}),(0,s.jsx)(b.CardContent,{children:(0,s.jsx)("div",{className:"space-y-2",children:q.map(e=>{var t;return(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)(u.FileText,{className:"w-5 h-5 text-gray-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium",children:e.filename}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:[(null==(t=eg.find(s=>s.value===e.doc_type))?void 0:t.label)||e.doc_type," • Uploaded ",e.upload_date]})]})]}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)(N.Button,{size:"sm",variant:"outline",children:"View"}),(0,s.jsx)(N.Button,{size:"sm",variant:"destructive",children:(0,s.jsx)(J.Trash2,{className:"w-4 h-4"})})]})]},e.id)})})})]}):(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)(u.FileText,{className:"mx-auto h-8 w-8 text-gray-400 mb-2"}),(0,s.jsx)("p",{className:"text-gray-600",children:"No documents uploaded for this house"})]})]})]}):(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(u.FileText,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-medium mb-2",children:"No Houses Available"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Add houses to manage documents."})]})})]})})]})]})}},{id:8,title:"Readiness",description:"Final readiness checks and activation",icon:B.CheckCircle,component:function(e){var t,a,l,r;let{projectId:i}=e,[n,c]=(0,L.useState)("overview"),[o,x]=(0,L.useState)(null),{data:m,isLoading:h,error:u,refetch:j}=(0,S.useQuery)({queryKey:["project-readiness",i],queryFn:async()=>{let e=await fetch("/api/project-readiness/".concat(i));if(!e.ok)throw Error("Failed to fetch project readiness data");return e.json()},enabled:!!i,staleTime:12e4}),{data:p}=(0,S.useQuery)({queryKey:["project-checklist",i],queryFn:async()=>{let e=await fetch("/api/project-readiness/".concat(i,"/checklist"));if(!e.ok)throw Error("Failed to fetch project checklist");return e.json()},enabled:!!i,staleTime:3e5}),g=function(){let e=(0,F.useQueryClient)();return(0,k.useMutation)({mutationFn:async e=>{let s=await fetch("/api/project-readiness/".concat(e.project_id,"/status"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:e.status})});if(!s.ok)throw Error((await s.json()).message||"Failed to update project status");return s.json()},onSuccess:(s,t)=>{e.invalidateQueries({queryKey:["project-readiness",t.project_id]}),e.invalidateQueries({queryKey:["projects"]}),P.toast.success("Project status updated successfully")},onError:e=>{P.toast.error("Failed to update project status: ".concat(e.message))}})}(),v=function(){let e=(0,F.useQueryClient)();return(0,k.useMutation)({mutationFn:async e=>{let s=await fetch("/api/project-activation",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!s.ok)throw Error((await s.json()).message||"Failed to create project activation");return s.json()},onSuccess:(s,t)=>{e.invalidateQueries({queryKey:["project-readiness",t.project_id]}),e.invalidateQueries({queryKey:["projects"]}),P.toast.success("Project activation created successfully")},onError:e=>{P.toast.error("Failed to create project activation: ".concat(e.message))}})}(),y=(0,em.useForm)();if(h)return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)(D.Skeleton,{className:"h-8 w-1/3"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,s.jsx)(D.Skeleton,{className:"h-24"}),(0,s.jsx)(D.Skeleton,{className:"h-24"}),(0,s.jsx)(D.Skeleton,{className:"h-24"}),(0,s.jsx)(D.Skeleton,{className:"h-24"})]}),(0,s.jsx)(D.Skeleton,{className:"h-96"})]});if(u)return(0,s.jsx)(b.Card,{children:(0,s.jsx)(b.CardContent,{className:"p-6",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(H.AlertCircle,{className:"mx-auto h-12 w-12 text-red-500 mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Error Loading Readiness Data"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:u.message}),(0,s.jsx)(N.Button,{onClick:()=>j(),children:"Try Again"})]})})});let _=async e=>{try{await g.mutateAsync({project_id:i,status:e}),j(),P.toast.success("Project status updated to ".concat(e))}catch(e){P.toast.error("Failed to update project status")}},T=async e=>{try{await v.mutateAsync({...e,project_id:i}),y.reset(),j(),P.toast.success("Project activation initiated successfully")}catch(e){P.toast.error("Failed to activate project")}},q=(null==m?void 0:m.overall_readiness)||0,A=(null==m?void 0:m.total_checks)||0,E=(null==m?void 0:m.completed_checks)||0,M=(null==m?void 0:m.project_status)||"planning";return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(eD,{className:"w-6 h-6 text-blue-600"}),(0,s.jsx)("h3",{className:"text-2xl font-bold",children:"Project Readiness & Activation"})]}),(0,s.jsx)("p",{className:"text-gray-600",children:"Final checks and project activation management"})]}),(0,s.jsx)("div",{className:"flex items-center space-x-2",children:(0,s.jsx)(f.Badge,{className:(null==(t=eM.find(e=>e.value===M))?void 0:t.color)||"bg-gray-100 text-gray-800",children:(null==(a=eM.find(e=>e.value===M))?void 0:a.label)||M})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,s.jsx)(b.Card,{children:(0,s.jsx)(b.CardContent,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(eD,{className:"w-5 h-5 text-blue-500"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"Overall Readiness"}),(0,s.jsxs)("p",{className:"text-2xl font-bold",children:[q,"%"]}),(0,s.jsx)(w.Progress,{value:q,className:"mt-2"})]})]})})}),(0,s.jsx)(b.Card,{children:(0,s.jsx)(b.CardContent,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(B.CheckCircle,{className:"w-5 h-5 text-green-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"Checks Complete"}),(0,s.jsxs)("p",{className:"text-2xl font-bold",children:[E,"/",A]})]})]})})}),(0,s.jsx)(b.Card,{children:(0,s.jsx)(b.CardContent,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(e_.Clock,{className:"w-5 h-5 text-orange-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"Days to Start"}),(0,s.jsx)("p",{className:"text-2xl font-bold",children:(null==m?void 0:m.days_to_start)||"--"})]})]})})}),(0,s.jsx)(b.Card,{children:(0,s.jsx)(b.CardContent,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(d.AlertTriangle,{className:"w-5 h-5 text-red-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"Critical Issues"}),(0,s.jsx)("p",{className:"text-2xl font-bold",children:(null==m?void 0:m.critical_issues)||0})]})]})})})]}),(0,s.jsxs)(C.Tabs,{value:n,onValueChange:c,children:[(0,s.jsxs)(C.TabsList,{className:"grid w-full grid-cols-3",children:[(0,s.jsx)(C.TabsTrigger,{value:"overview",children:"Readiness Overview"}),(0,s.jsx)(C.TabsTrigger,{value:"checklist",children:"\x05Checklist"}),(0,s.jsx)(C.TabsTrigger,{value:"activation",children:"Activation"})]}),(0,s.jsxs)(C.TabsContent,{value:"overview",className:"space-y-4",children:[(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:eE.map(e=>{var t;let a=null==m||null==(t=m.categories)?void 0:t[e.id],l=(null==a?void 0:a.completed)||0,r=e.checks.length,i=r>0?Math.round(l/r*100):0,n=e.icon;return(0,s.jsxs)(b.Card,{className:"cursor-pointer transition-all ".concat(o===e.id?"ring-2 ring-blue-500":""),onClick:()=>x(o===e.id?null:e.id),children:[(0,s.jsxs)(b.CardHeader,{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(n,{className:"w-5 h-5 ".concat(e.color)}),(0,s.jsx)(b.CardTitle,{className:"text-lg",children:e.title})]}),(0,s.jsxs)(f.Badge,{variant:100===i?"default":"secondary",children:[l,"/",r]})]}),(0,s.jsx)(b.CardDescription,{children:e.description})]}),(0,s.jsx)(b.CardContent,{children:(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{children:"Progress"}),(0,s.jsxs)("span",{children:[i,"%"]})]}),(0,s.jsx)(w.Progress,{value:i}),o===e.id&&(0,s.jsx)("div",{className:"pt-3 space-y-2",children:e.checks.map((e,t)=>{var l;let r=(null==a||null==(l=a.completed_checks)?void 0:l.includes(t))||!1;return(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[r?(0,s.jsx)(B.CheckCircle,{className:"w-4 h-4 text-green-500"}):(0,s.jsx)(e_.Clock,{className:"w-4 h-4 text-gray-400"}),(0,s.jsx)("span",{className:"text-sm ".concat(r?"text-green-700":"text-gray-600"),children:e})]},t)})})]})})]},e.id)})}),(null==m?void 0:m.issues)&&m.issues.length>0&&(0,s.jsxs)(b.Card,{children:[(0,s.jsxs)(b.CardHeader,{children:[(0,s.jsxs)(b.CardTitle,{className:"flex items-center space-x-2",children:[(0,s.jsx)(d.AlertTriangle,{className:"w-5 h-5 text-red-500"}),(0,s.jsx)("span",{children:"Critical Issues"})]}),(0,s.jsx)(b.CardDescription,{children:"Issues that must be resolved before project activation"})]}),(0,s.jsx)(b.CardContent,{children:(0,s.jsx)("div",{className:"space-y-3",children:m.issues.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-start space-x-3 p-3 border-l-4 border-l-red-500 bg-red-50",children:[(0,s.jsx)(d.AlertTriangle,{className:"w-5 h-5 text-red-500 mt-0.5"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"font-medium text-red-800",children:e.title}),(0,s.jsx)("p",{className:"text-sm text-red-600",children:e.description}),e.action_required&&(0,s.jsxs)("p",{className:"text-sm font-medium text-red-700 mt-1",children:["Action Required: ",e.action_required]})]})]},t))})})]})]}),(0,s.jsx)(C.TabsContent,{value:"checklist",className:"space-y-4",children:(0,s.jsxs)(b.Card,{children:[(0,s.jsxs)(b.CardHeader,{children:[(0,s.jsx)(b.CardTitle,{children:"\x05Project Readiness Checklist"}),(0,s.jsx)(b.CardDescription,{children:"Complete all items below before activating the project"})]}),(0,s.jsx)(b.CardContent,{children:p&&p.length>0?(0,s.jsx)("div",{className:"space-y-4",children:p.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-start space-x-3 p-4 border rounded-lg",children:[(0,s.jsx)("div",{className:"flex-shrink-0 mt-1",children:e.completed?(0,s.jsx)(B.CheckCircle,{className:"w-5 h-5 text-green-500"}):e.required?(0,s.jsx)(H.AlertCircle,{className:"w-5 h-5 text-red-500"}):(0,s.jsx)(e_.Clock,{className:"w-5 h-5 text-gray-400"})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h4",{className:"font-medium ".concat(e.completed?"text-green-700":"text-gray-900"),children:e.title}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[e.required&&(0,s.jsx)(f.Badge,{variant:"destructive",size:"sm",children:"Required"}),(0,s.jsx)(f.Badge,{variant:e.completed?"default":"secondary",size:"sm",children:e.category})]})]}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.description}),e.completed&&e.completed_date&&(0,s.jsxs)("p",{className:"text-xs text-green-600 mt-1",children:["Completed: ",e.completed_date]}),!e.completed&&e.action_required&&(0,s.jsxs)("p",{className:"text-sm font-medium text-orange-600 mt-1",children:["Action: ",e.action_required]})]})]},t))}):(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(eB,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-medium mb-2",children:"No Checklist Available"}),(0,s.jsx)("p",{className:"text-gray-600",children:"The readiness checklist will be generated based on project requirements."})]})})]})}),(0,s.jsx)(C.TabsContent,{value:"activation",className:"space-y-4",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)(b.Card,{children:[(0,s.jsxs)(b.CardHeader,{children:[(0,s.jsx)(b.CardTitle,{children:"Project Status Management"}),(0,s.jsx)(b.CardDescription,{children:"Update project status based on readiness"})]}),(0,s.jsx)(b.CardContent,{children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{children:"Current Status"}),(0,s.jsx)("div",{className:"mt-1",children:(0,s.jsx)(f.Badge,{className:(null==(l=eM.find(e=>e.value===M))?void 0:l.color)||"bg-gray-100 text-gray-800",children:(null==(r=eM.find(e=>e.value===M))?void 0:r.label)||M})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(R.Label,{children:"Change Status"}),(0,s.jsx)("div",{className:"grid grid-cols-1 gap-2",children:eM.map(e=>(0,s.jsx)(N.Button,{variant:M===e.value?"default":"outline",size:"sm",onClick:()=>_(e.value),disabled:g.isPending||M===e.value,className:"justify-start",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[e.icon&&(0,s.jsx)(e.icon,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:e.label})]})},e.value))})]})]})})]}),(0,s.jsxs)(b.Card,{children:[(0,s.jsxs)(b.CardHeader,{children:[(0,s.jsx)(b.CardTitle,{children:"Project Activation"}),(0,s.jsx)(b.CardDescription,{children:"Activate the project when all requirements are met"})]}),(0,s.jsx)(b.CardContent,{children:q>=90?(0,s.jsxs)("form",{onSubmit:y.handleSubmit(T),className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"activation_date",children:"Activation Date"}),(0,s.jsx)(K.Input,{type:"date",...y.register("activation_date",{required:!0})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"responsible_manager",children:"Responsible Manager"}),(0,s.jsx)(K.Input,{placeholder:"Project Manager Name",...y.register("responsible_manager",{required:!0})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(R.Label,{htmlFor:"activation_notes",children:"Activation Notes"}),(0,s.jsx)(O.Textarea,{placeholder:"Special instructions or notes for activation...",...y.register("activation_notes")})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("input",{type:"checkbox",id:"notify_stakeholders",...y.register("notify_stakeholders")}),(0,s.jsx)(R.Label,{htmlFor:"notify_stakeholders",className:"text-sm",children:"Notify all stakeholders"})]}),(0,s.jsx)(N.Button,{type:"submit",className:"w-full",disabled:v.isPending,children:v.isPending?"Activating...":"Activate Project"})]}):(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)(d.AlertTriangle,{className:"mx-auto h-12 w-12 text-orange-400 mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Project Not Ready"}),(0,s.jsxs)("p",{className:"text-gray-600 mb-4",children:["Project must be at least 90% ready for activation. Current readiness: ",q,"%"]}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Complete the missing requirements in the checklist to enable activation."})]})})]})]})})]})]})}}];function eR(e){let{projectId:t}=e,[a,l]=(0,L.useState)(0),{data:r,isLoading:i,error:n}=A(t);if(i)return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)(D.Skeleton,{className:"h-8 w-1/3"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,s.jsx)(D.Skeleton,{className:"h-32"}),(0,s.jsx)(D.Skeleton,{className:"h-32"}),(0,s.jsx)(D.Skeleton,{className:"h-32"})]}),(0,s.jsx)(D.Skeleton,{className:"h-96"})]});if(n||!r)return(0,s.jsx)(b.Card,{children:(0,s.jsx)(b.CardContent,{className:"p-6",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(H.AlertCircle,{className:"mx-auto h-12 w-12 text-red-500 mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Error Loading Project"}),(0,s.jsx)("p",{className:"text-gray-600",children:(null==n?void 0:n.message)||"Failed to load project preparation data"})]})})});let{project:c,potential_revenue:d,preparation_progress:o,steps_summary:x}=r;return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,s.jsx)(b.Card,{children:(0,s.jsx)(b.CardContent,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(B.CheckCircle,{className:"w-5 h-5 text-green-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"Preparation Progress"}),(0,s.jsxs)("p",{className:"text-2xl font-bold",children:[o,"%"]}),(0,s.jsx)(w.Progress,{value:o,className:"mt-2"})]})]})})}),(0,s.jsx)(b.Card,{children:(0,s.jsx)(b.CardContent,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(I.Package,{className:"w-5 h-5 text-blue-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"Total Length"}),(0,s.jsxs)("p",{className:"text-2xl font-bold",children:[(c.total_length_m||0).toLocaleString(),"m"]})]})]})})}),(0,s.jsx)(b.Card,{children:(0,s.jsx)(b.CardContent,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(M.Truck,{className:"w-5 h-5 text-purple-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"Base Rate"}),(0,s.jsxs)("p",{className:"text-2xl font-bold",children:["€",c.base_rate_per_m,"/m"]})]})]})})}),(0,s.jsx)(b.Card,{children:(0,s.jsx)(b.CardContent,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(V,{className:"w-5 h-5 text-orange-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"Potential Revenue"}),(0,s.jsxs)("p",{className:"text-2xl font-bold",children:["€",(d||0).toLocaleString()]})]})]})})})]}),(0,s.jsxs)(b.Card,{children:[(0,s.jsxs)(b.CardHeader,{children:[(0,s.jsx)(b.CardTitle,{children:"Preparation Steps"}),(0,s.jsx)(b.CardDescription,{children:"Complete each step to prepare the project for activation"})]}),(0,s.jsx)(b.CardContent,{children:(0,s.jsx)("div",{className:"grid grid-cols-3 md:grid-cols-9 gap-2",children:eV.map(e=>{let t=e.icon,r=function(e,s){if(!s)return!1;switch(e){case 0:return!0;case 1:return(s.utility_contacts||0)>0;case 2:return(s.cabinets||0)>0;case 3:return(s.facilities||0)>0||(s.housing_units||0)>0;case 4:return(s.crews||0)>0;case 5:return(s.equipment||0)>0;case 6:return(s.materials||0)>0;default:return!1}}(e.id,x),i=a===e.id;return(0,s.jsxs)(N.Button,{variant:i?"default":"outline",size:"sm",className:(0,eI.cn)("flex flex-col items-center p-3 h-auto",r&&"bg-green-50 border-green-200",i&&"ring-2 ring-blue-500"),onClick:()=>l(e.id),children:[(0,s.jsx)(t,{className:(0,eI.cn)("w-5 h-5 mb-1",r?"text-green-600":"text-current")}),(0,s.jsx)("span",{className:"text-xs",children:e.id}),r&&(0,s.jsx)(B.CheckCircle,{className:"w-3 h-3 text-green-600 mt-1"})]},e.id)})})})]}),(0,s.jsxs)(b.Card,{children:[(0,s.jsx)(b.CardHeader,{children:(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(()=>{let e=eV[a].icon;return(0,s.jsx)(e,{className:"w-6 h-6"})})(),(0,s.jsxs)("div",{children:[(0,s.jsxs)(b.CardTitle,{children:["Step ",a,": ",eV[a].title]}),(0,s.jsx)(b.CardDescription,{children:eV[a].description})]})]})}),(0,s.jsx)(b.CardContent,{children:(()=>{let e=eV[a],l=e.component;return console.log("Debug: Active step:",a,"Component:",l,"Step:",e),(0,s.jsx)(eU,{Component:l,projectId:t,stepName:e.title})})()})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)(N.Button,{variant:"outline",onClick:()=>l(Math.max(0,a-1)),disabled:0===a,children:"Previous Step"}),(0,s.jsx)(N.Button,{onClick:()=>l(Math.min(eV.length-1,a+1)),disabled:a===eV.length-1,children:"Next Step"})]})]})}function eO(){var e,k,F;let P=(0,t.useParams)(),q=(0,t.useRouter)(),{canManageProjects:L}=(0,T.usePermissions)(),D=P.id,{data:B,isLoading:H,error:E}=(0,_.useProject)(D),{data:M}=A(D),{data:I,isLoading:U}=(0,_.useProjectStats)(D),{data:V,isLoading:R}=(0,S.useQuery)({queryKey:["project-team",D],queryFn:async()=>{let e=await fetch("/api/projects/".concat(D,"/team"));if(!e.ok)throw Error("Failed to fetch team data");return e.json()},enabled:!!D}),{data:O,isLoading:z}=(0,S.useQuery)({queryKey:["project-documents",D],queryFn:async()=>{let e=await fetch("/api/projects/".concat(D,"/documents"));if(!e.ok)throw Error("Failed to fetch documents data");return e.json()},enabled:!!D});if(H)return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("div",{className:"h-8 w-8 bg-muted animate-pulse rounded"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"h-8 w-64 bg-muted animate-pulse rounded"}),(0,s.jsx)("div",{className:"h-4 w-48 bg-muted animate-pulse rounded"})]})]}),(0,s.jsx)("div",{className:"grid gap-6 md:grid-cols-3",children:[...Array(6)].map((e,t)=>(0,s.jsx)("div",{className:"h-32 bg-muted animate-pulse rounded-lg"},t))})]});if(E||!B)return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsxs)(N.Button,{variant:"ghost",size:"sm",onClick:()=>q.back(),className:"flex items-center space-x-2",children:[(0,s.jsx)(a.ArrowLeft,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:"Back"})]})}),(0,s.jsx)(b.Card,{children:(0,s.jsx)(b.CardContent,{className:"py-8",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(d.AlertTriangle,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,s.jsx)("h3",{className:"mt-2 text-sm font-semibold",children:"Project not found"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"The project you're looking for doesn't exist or you don't have permission to view it."})]})})})]});let Q=(null==I?void 0:I.progress)||{totalLength:B.total_length_m,completedLength:0,progressPercentage:0,workEntries:0,pendingApprovals:0,teamMembers:0,materialsCount:0},K=(null==I?void 0:I.phase)||{currentPhase:1,totalPhases:10,phaseName:"Project Initiation",phaseProgress:0};return(null==I?void 0:I.financial)||(B.total_length_m,B.base_rate_per_m,B.total_length_m,B.base_rate_per_m),(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)(N.Button,{variant:"ghost",size:"sm",onClick:()=>q.back(),className:"flex items-center space-x-2",children:[(0,s.jsx)(a.ArrowLeft,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:"Back"})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:B.name}),(0,s.jsx)(f.Badge,{variant:(e=>{switch(e){case"active":return"default";case"draft":default:return"secondary";case"waiting_invoice":return"outline";case"closed":return"destructive"}})(B.status),children:(e=>{switch(e){case"active":return"Active";case"draft":return"Draft";case"waiting_invoice":return"Waiting Invoice";case"closed":return"Closed";default:return e}})(B.status)})]}),(0,s.jsxs)("p",{className:"text-muted-foreground",children:["Project Details • ",B.total_length_m,"m fiber installation"]})]})]}),L&&(0,s.jsxs)(N.Button,{onClick:()=>q.push("/dashboard/projects/".concat(B.id,"/edit")),children:[(0,s.jsx)(l.Edit,{className:"mr-2 h-4 w-4"}),"Edit Project"]})]}),(0,s.jsxs)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:[(0,s.jsxs)(b.Card,{children:[(0,s.jsxs)(b.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(b.CardTitle,{className:"text-sm font-medium",children:"Project Progress"}),(0,s.jsx)(c.TrendingUp,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsx)(b.CardContent,{children:U?(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"h-8 w-16 bg-muted animate-pulse rounded"}),(0,s.jsx)("div",{className:"h-2 w-full bg-muted animate-pulse rounded"}),(0,s.jsx)("div",{className:"h-3 w-32 bg-muted animate-pulse rounded"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"text-2xl font-bold",children:[Q.progressPercentage,"%"]}),(0,s.jsx)(w.Progress,{value:Q.progressPercentage,className:"mt-2"}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground mt-2",children:[Q.completedLength,"m of ",Q.totalLength,"m completed"]})]})})]}),(0,s.jsxs)(b.Card,{children:[(0,s.jsxs)(b.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(b.CardTitle,{className:"text-sm font-medium",children:"Work Entries"}),(0,s.jsx)(o.Building2,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsx)(b.CardContent,{children:U?(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"h-8 w-12 bg-muted animate-pulse rounded"}),(0,s.jsx)("div",{className:"h-3 w-20 bg-muted animate-pulse rounded"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:Q.workEntries}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:[Q.pendingApprovals," pending approval"]})]})})]}),(0,s.jsxs)(b.Card,{children:[(0,s.jsxs)(b.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(b.CardTitle,{className:"text-sm font-medium",children:"Team Members"}),(0,s.jsx)(n.Users,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsx)(b.CardContent,{children:U?(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"h-8 w-8 bg-muted animate-pulse rounded"}),(0,s.jsx)("div",{className:"h-3 w-24 bg-muted animate-pulse rounded"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:Q.teamMembers}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Active on this project"})]})})]}),(0,s.jsxs)(b.Card,{children:[(0,s.jsxs)(b.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(b.CardTitle,{className:"text-sm font-medium",children:"Current Phase"}),(0,s.jsx)(i.Calendar,{className:"h-4 w-4 text-muted-foreground"})]}),(0,s.jsx)(b.CardContent,{children:U?(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"h-8 w-16 bg-muted animate-pulse rounded"}),(0,s.jsx)("div",{className:"h-3 w-28 bg-muted animate-pulse rounded"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"text-2xl font-bold",children:[K.currentPhase,"/",K.totalPhases]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:K.phaseName})]})})]})]}),(0,s.jsxs)(C.Tabs,{defaultValue:"overview",className:"space-y-4",children:[(0,s.jsxs)(C.TabsList,{children:[(0,s.jsx)(C.TabsTrigger,{value:"overview",children:"Overview"}),(0,s.jsxs)(C.TabsTrigger,{value:"preparation",className:"flex items-center gap-2",children:[(0,s.jsx)(h.Settings,{className:"h-4 w-4"}),"Preparation",M&&(0,s.jsxs)(f.Badge,{variant:"outline",className:"text-xs",children:[M.preparation_progress,"%"]})]}),(0,s.jsx)(C.TabsTrigger,{value:"progress",children:"Progress"}),(0,s.jsx)(C.TabsTrigger,{value:"team",children:"Team"}),(0,s.jsx)(C.TabsTrigger,{value:"documents",children:"Documents"}),(0,s.jsx)(C.TabsTrigger,{value:"financial",children:"Financial"})]}),(0,s.jsx)(C.TabsContent,{value:"overview",className:"space-y-6",children:(0,s.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,s.jsxs)(b.Card,{children:[(0,s.jsxs)(b.CardHeader,{children:[(0,s.jsx)(b.CardTitle,{children:"Project Information"}),(0,s.jsx)(b.CardDescription,{children:"Basic details and specifications"})]}),(0,s.jsxs)(b.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Customer"}),(0,s.jsx)("p",{className:"text-sm",children:B.customer||"—"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"City"}),(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,s.jsx)(r.MapPin,{className:"h-3 w-3 text-muted-foreground"}),(0,s.jsx)("p",{className:"text-sm",children:B.city||"—"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Length"}),(0,s.jsxs)("p",{className:"text-sm font-mono",children:[B.total_length_m," meters"]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Rate per Meter"}),(0,s.jsxs)("p",{className:"text-sm font-mono",children:["€",B.base_rate_per_m]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Project Value"}),(0,s.jsxs)("p",{className:"text-sm font-mono font-semibold",children:["€",(B.total_length_m*B.base_rate_per_m).toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Language"}),(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,s.jsx)(m.Globe,{className:"h-3 w-3 text-muted-foreground"}),(0,s.jsx)("p",{className:"text-sm",children:null==(e=B.language_default)?void 0:e.toUpperCase()})]})]})]}),B.address&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Address"}),(0,s.jsx)("p",{className:"text-sm",children:B.address})]}),B.contact_24h&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"24h Contact"}),(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,s.jsx)(x.Phone,{className:"h-3 w-3 text-muted-foreground"}),(0,s.jsx)("p",{className:"text-sm",children:B.contact_24h})]})]})]})]}),(0,s.jsxs)(b.Card,{children:[(0,s.jsxs)(b.CardHeader,{children:[(0,s.jsx)(b.CardTitle,{children:"Project Timeline"}),(0,s.jsx)(b.CardDescription,{children:"Important dates and milestones"})]}),(0,s.jsxs)(b.CardContent,{className:"space-y-4",children:[B.start_date&&(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(i.Calendar,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsx)("span",{className:"text-sm font-medium",children:"Start Date"})]}),(0,s.jsx)("span",{className:"text-sm",children:new Date(B.start_date).toLocaleDateString("de-DE",{year:"numeric",month:"long",day:"numeric"})})]}),B.end_date_plan&&(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(i.Calendar,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsx)("span",{className:"text-sm font-medium",children:"Planned End"})]}),(0,s.jsx)("span",{className:"text-sm",children:new Date(B.end_date_plan).toLocaleDateString("de-DE",{year:"numeric",month:"long",day:"numeric"})})]}),B.start_date&&B.end_date_plan&&(0,s.jsx)("div",{className:"pt-2 border-t",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm font-medium",children:"Duration"}),(0,s.jsxs)("span",{className:"text-sm",children:[Math.ceil((new Date(B.end_date_plan).getTime()-new Date(B.start_date).getTime())/864e5)," days"]})]})})]})]})]})}),(0,s.jsx)(C.TabsContent,{value:"preparation",className:"space-y-6",children:(0,s.jsx)(eR,{projectId:D})}),(0,s.jsx)(C.TabsContent,{value:"progress",className:"space-y-6",children:(0,s.jsxs)(b.Card,{children:[(0,s.jsxs)(b.CardHeader,{children:[(0,s.jsx)(b.CardTitle,{children:"Project Progress Overview"}),(0,s.jsx)(b.CardDescription,{children:"Track progress across different aspects of the project"})]}),(0,s.jsx)(b.CardContent,{children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)("span",{className:"text-sm font-medium",children:"Overall Progress"}),(0,s.jsxs)("span",{className:"text-sm text-muted-foreground",children:[Q.progressPercentage,"%"]})]}),(0,s.jsx)(w.Progress,{value:Q.progressPercentage})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)("span",{className:"text-sm font-medium",children:"Phase Progress"}),(0,s.jsxs)("span",{className:"text-sm text-muted-foreground",children:[K.phaseProgress,"%"]})]}),(0,s.jsx)(w.Progress,{value:K.phaseProgress}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Phase ",K.currentPhase,": ",K.phaseName]})]})]})})]})}),(0,s.jsx)(C.TabsContent,{value:"team",className:"space-y-6",children:(0,s.jsxs)(b.Card,{children:[(0,s.jsxs)(b.CardHeader,{children:[(0,s.jsx)(b.CardTitle,{children:"Team Assignment"}),(0,s.jsx)(b.CardDescription,{children:"Team members working on this project"})]}),(0,s.jsx)(b.CardContent,{children:R?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("div",{className:"skeleton h-4 w-4 rounded-full"}),(0,s.jsxs)("div",{className:"space-y-2 flex-1",children:[(0,s.jsx)("div",{className:"skeleton h-4 w-full"}),(0,s.jsx)("div",{className:"skeleton h-3 w-3/4"})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("div",{className:"skeleton h-4 w-4 rounded-full"}),(0,s.jsxs)("div",{className:"space-y-2 flex-1",children:[(0,s.jsx)("div",{className:"skeleton h-4 w-full"}),(0,s.jsx)("div",{className:"skeleton h-3 w-3/4"})]})]})]}):(null==V||null==(k=V.crews)?void 0:k.length)>0?(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 p-4 bg-muted/50 rounded-lg",children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:V.summary.total_crews}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Total Crews"})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:V.summary.total_members}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Team Members"})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:V.summary.foreman_count}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Foremen"})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:V.summary.worker_count}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Workers"})]})]}),(0,s.jsx)("div",{className:"space-y-4",children:V.crews.map(e=>(0,s.jsx)(b.Card,{className:"p-4",children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-semibold",children:e.name}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e.member_count," members • Status: ",e.status]})]}),(0,s.jsx)(f.Badge,{variant:"active"===e.status?"default":"secondary",children:e.status})]}),e.foreman&&(0,s.jsx)("div",{className:"border-l-2 border-primary pl-4",children:(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)(y.Shield,{className:"h-4 w-4 text-primary"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"font-medium",children:e.foreman.full_name}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground flex items-center space-x-2",children:[e.foreman.email&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(v.Mail,{className:"h-3 w-3"}),(0,s.jsx)("span",{children:e.foreman.email})]}),e.foreman.phone&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{children:"•"}),(0,s.jsx)(x.Phone,{className:"h-3 w-3"}),(0,s.jsx)("span",{children:e.foreman.phone})]})]}),(0,s.jsx)(f.Badge,{variant:"outline",className:"text-xs mt-1",children:"Foreman"})]})]})}),e.members&&e.members.length>0&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("h5",{className:"text-sm font-medium text-muted-foreground",children:"Team Members"}),(0,s.jsx)("div",{className:"grid gap-2",children:e.members.map(e=>(0,s.jsxs)("div",{className:"flex items-center space-x-3 py-2",children:[(0,s.jsx)(g.User,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("div",{className:"font-medium",children:e.user.full_name}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground flex items-center space-x-2",children:[e.user.email&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(v.Mail,{className:"h-3 w-3"}),(0,s.jsx)("span",{children:e.user.email})]}),e.user.phone&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{children:"•"}),(0,s.jsx)(x.Phone,{className:"h-3 w-3"}),(0,s.jsx)("span",{children:e.user.phone})]})]})]}),(0,s.jsx)(f.Badge,{variant:"outline",className:"text-xs",children:e.role_in_crew})]},e.id))})]})]})},e.id))})]}):(0,s.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,s.jsx)(n.Users,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),(0,s.jsx)("p",{children:"No teams assigned to this project yet."})]})})]})}),(0,s.jsx)(C.TabsContent,{value:"documents",className:"space-y-6",children:(0,s.jsxs)(b.Card,{children:[(0,s.jsxs)(b.CardHeader,{children:[(0,s.jsx)(b.CardTitle,{children:"Project Documents"}),(0,s.jsx)(b.CardDescription,{children:"Files, plans, and documentation related to this project"})]}),(0,s.jsx)(b.CardContent,{children:z?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"skeleton h-20 w-full rounded-lg"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"skeleton h-4 w-full"}),(0,s.jsx)("div",{className:"skeleton h-4 w-3/4"}),(0,s.jsx)("div",{className:"skeleton h-4 w-1/2"})]})]}):(null==O||null==(F=O.documents)?void 0:F.length)>0?(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 p-4 bg-muted/50 rounded-lg",children:O.categories.map(e=>(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"text-2xl font-bold",style:{color:e.color},children:e.count}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:e.name})]},e.id))}),(0,s.jsx)("div",{className:"space-y-4",children:O.documents.map(e=>{var t,a;return(0,s.jsx)(b.Card,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"flex items-start space-x-4 flex-1",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:e.is_image?(0,s.jsx)("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center",children:(0,s.jsx)(p.Eye,{className:"h-6 w-6 text-purple-600"})}):e.is_pdf?(0,s.jsx)("div",{className:"w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center",children:(0,s.jsx)(u.FileText,{className:"h-6 w-6 text-red-600"})}):(0,s.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,s.jsx)(u.FileText,{className:"h-6 w-6 text-blue-600"})})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("h4",{className:"font-semibold truncate",children:e.file_name}),(0,s.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-muted-foreground mt-1",children:[(0,s.jsx)("span",{children:e.size_formatted}),(0,s.jsx)("span",{children:"•"}),(0,s.jsxs)("span",{children:["Uploaded by ",e.uploaded_by_name]}),(0,s.jsx)("span",{children:"•"}),(0,s.jsx)("span",{children:new Date(e.uploaded_at).toLocaleDateString("de-DE")})]}),e.notes&&(0,s.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:e.notes}),(0,s.jsxs)("div",{className:"flex items-center space-x-2 mt-2",children:[(0,s.jsx)(f.Badge,{variant:"outline",className:"text-xs",style:{borderColor:null==(t=O.categories.find(s=>s.id===e.document_type))?void 0:t.color,color:null==(a=O.categories.find(s=>s.id===e.document_type))?void 0:a.color},children:e.document_type}),(0,s.jsx)(f.Badge,{variant:"active"===e.status?"default":"secondary",className:"text-xs",children:e.status})]})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2 ml-4",children:[(0,s.jsx)(N.Button,{variant:"outline",size:"sm",children:(0,s.jsx)(p.Eye,{className:"h-4 w-4"})}),(0,s.jsx)(N.Button,{variant:"outline",size:"sm",children:(0,s.jsx)(j.Download,{className:"h-4 w-4"})})]})]})},e.id)})}),O.pagination&&O.pagination.total>O.pagination.per_page&&(0,s.jsxs)("div",{className:"text-center text-sm text-muted-foreground",children:["Showing ",O.documents.length," of ",O.pagination.total," documents"]})]}):(0,s.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,s.jsx)(u.FileText,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),(0,s.jsx)("p",{children:"No documents uploaded for this project yet."}),(0,s.jsx)(N.Button,{variant:"outline",className:"mt-4",children:"Upload Documents"})]})})]})}),(0,s.jsx)(C.TabsContent,{value:"financial",className:"space-y-6",children:(0,s.jsxs)(b.Card,{children:[(0,s.jsxs)(b.CardHeader,{children:[(0,s.jsx)(b.CardTitle,{children:"Financial Overview"}),(0,s.jsx)(b.CardDescription,{children:"Budget, costs, and financial tracking for this project"})]}),(0,s.jsx)(b.CardContent,{children:(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Project Budget"}),(0,s.jsxs)("p",{className:"text-lg font-mono",children:["€",((null==I?void 0:I.financial.projectBudget)||B.total_length_m*B.base_rate_per_m).toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Spent to Date"}),(0,s.jsxs)("p",{className:"text-lg font-mono",children:["€",((null==I?void 0:I.financial.totalSpent)||0).toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Remaining Budget"}),(0,s.jsxs)("p",{className:"text-lg font-mono",children:["€",((null==I?void 0:I.financial.remainingBudget)||B.total_length_m*B.base_rate_per_m).toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Spent Percentage"}),(0,s.jsxs)("p",{className:"text-lg font-mono",children:[(null==I?void 0:I.financial.spentPercentage)||0,"%"]}),(0,s.jsx)(w.Progress,{value:(null==I?void 0:I.financial.spentPercentage)||0,className:"mt-1"})]})]})})]})})]})]})}}]);