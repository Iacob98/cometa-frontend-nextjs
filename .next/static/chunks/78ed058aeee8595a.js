(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,71689,e=>{"use strict";e.s(["ArrowLeft",()=>r],71689);let r=(0,e.i(75254).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},56909,e=>{"use strict";e.s(["Save",()=>r],56909);let r=(0,e.i(75254).default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},2747,e=>{"use strict";e.s(["Skeleton",()=>a]);var r=e.i(43476),t=e.i(75157);function a(e){let{className:a,...s}=e;return(0,r.jsx)("div",{className:(0,t.cn)("animate-pulse rounded-md bg-muted",a),...s})}},95116,e=>{"use strict";e.s(["Wrench",()=>r],95116);let r=(0,e.i(75254).default)("wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z",key:"1ngwbx"}]])},57428,e=>{"use strict";e.s(["Checkbox",()=>S],57428);var r=e.i(43476),t=e.i(71645),a=e.i(20783),s=e.i(30030),n=e.i(81140),l=e.i(69340),i=e.i(99682),o=e.i(35804),c=e.i(96626),d=e.i(48425),u="Checkbox",[m,p]=(0,s.createContextScope)(u),[h,x]=m(u);function j(e){let{__scopeCheckbox:a,checked:s,children:n,defaultChecked:i,disabled:o,form:c,name:d,onCheckedChange:m,required:p,value:x="on",internal_do_not_use_render:j}=e,[f,v]=(0,l.useControllableState)({prop:s,defaultProp:null!=i&&i,onChange:m,caller:u}),[g,b]=t.useState(null),[y,_]=t.useState(null),F=t.useRef(!1),N=!g||!!c||!!g.closest("form"),C={checked:f,disabled:o,setChecked:v,control:g,setControl:b,name:d,form:c,value:x,hasConsumerStoppedPropagationRef:F,required:p,defaultChecked:!w(i)&&i,isFormControl:N,bubbleInput:y,setBubbleInput:_};return(0,r.jsx)(h,{scope:a,...C,children:"function"==typeof j?j(C):n})}var f="CheckboxTrigger",v=t.forwardRef((e,s)=>{let{__scopeCheckbox:l,onKeyDown:i,onClick:o,...c}=e,{control:u,value:m,disabled:p,checked:h,required:j,setControl:v,setChecked:g,hasConsumerStoppedPropagationRef:b,isFormControl:y,bubbleInput:_}=x(f,l),F=(0,a.useComposedRefs)(s,v),C=t.useRef(h);return t.useEffect(()=>{let e=null==u?void 0:u.form;if(e){let r=()=>g(C.current);return e.addEventListener("reset",r),()=>e.removeEventListener("reset",r)}},[u,g]),(0,r.jsx)(d.Primitive.button,{type:"button",role:"checkbox","aria-checked":w(h)?"mixed":h,"aria-required":j,"data-state":N(h),"data-disabled":p?"":void 0,disabled:p,value:m,...c,ref:F,onKeyDown:(0,n.composeEventHandlers)(i,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,n.composeEventHandlers)(o,e=>{g(e=>!!w(e)||!e),_&&y&&(b.current=e.isPropagationStopped(),b.current||e.stopPropagation())})})});v.displayName=f;var g=t.forwardRef((e,t)=>{let{__scopeCheckbox:a,name:s,checked:n,defaultChecked:l,required:i,disabled:o,value:c,onCheckedChange:d,form:u,...m}=e;return(0,r.jsx)(j,{__scopeCheckbox:a,checked:n,defaultChecked:l,disabled:o,required:i,onCheckedChange:d,name:s,form:u,value:c,internal_do_not_use_render:e=>{let{isFormControl:s}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(v,{...m,ref:t,__scopeCheckbox:a}),s&&(0,r.jsx)(F,{__scopeCheckbox:a})]})}})});g.displayName=u;var b="CheckboxIndicator",y=t.forwardRef((e,t)=>{let{__scopeCheckbox:a,forceMount:s,...n}=e,l=x(b,a);return(0,r.jsx)(c.Presence,{present:s||w(l.checked)||!0===l.checked,children:(0,r.jsx)(d.Primitive.span,{"data-state":N(l.checked),"data-disabled":l.disabled?"":void 0,...n,ref:t,style:{pointerEvents:"none",...e.style}})})});y.displayName=b;var _="CheckboxBubbleInput",F=t.forwardRef((e,s)=>{let{__scopeCheckbox:n,...l}=e,{control:c,hasConsumerStoppedPropagationRef:u,checked:m,defaultChecked:p,required:h,disabled:j,name:f,value:v,form:g,bubbleInput:b,setBubbleInput:y}=x(_,n),F=(0,a.useComposedRefs)(s,y),N=(0,i.usePrevious)(m),C=(0,o.useSize)(c);t.useEffect(()=>{if(!b)return;let e=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set,r=!u.current;if(N!==m&&e){let t=new Event("click",{bubbles:r});b.indeterminate=w(m),e.call(b,!w(m)&&m),b.dispatchEvent(t)}},[b,N,m,u]);let k=t.useRef(!w(m)&&m);return(0,r.jsx)(d.Primitive.input,{type:"checkbox","aria-hidden":!0,defaultChecked:null!=p?p:k.current,required:h,disabled:j,name:f,value:v,form:g,...l,tabIndex:-1,ref:F,style:{...l.style,...C,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});function w(e){return"indeterminate"===e}function N(e){return w(e)?"indeterminate":e?"checked":"unchecked"}F.displayName=_;var C=e.i(43531),k=e.i(75157);let S=t.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(g,{ref:t,className:(0,k.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...s,children:(0,r.jsx)(y,{className:(0,k.cn)("flex items-center justify-center text-current"),children:(0,r.jsx)(C.Check,{className:"h-4 w-4"})})})});S.displayName=g.displayName},31278,e=>{"use strict";e.s(["Loader2",()=>r],31278);let r=(0,e.i(75254).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},72436,e=>{"use strict";e.s(["Separator",()=>o],72436);var r=e.i(43476),t=e.i(71645),a=e.i(48425),s="horizontal",n=["horizontal","vertical"],l=t.forwardRef((e,t)=>{var l;let{decorative:i,orientation:o=s,...c}=e,d=(l=o,n.includes(l))?o:s;return(0,r.jsx)(a.Primitive.div,{"data-orientation":d,...i?{role:"none"}:{"aria-orientation":"vertical"===d?d:void 0,role:"separator"},...c,ref:t})});l.displayName="Separator";var i=e.i(75157);let o=t.forwardRef((e,t)=>{let{className:a,orientation:s="horizontal",decorative:n=!0,...o}=e;return(0,r.jsx)(l,{ref:t,decorative:n,orientation:s,className:(0,i.cn)("shrink-0 bg-border","horizontal"===s?"h-[1px] w-full":"h-full w-[1px]",a),...o})});o.displayName=l.displayName},34265,e=>{"use strict";e.s(["default",()=>N]);var r=e.i(43476),t=e.i(94814),a=e.i(53145),s=e.i(81307),n=e.i(71645),l=e.i(18566),i=e.i(71689),o=e.i(56909),c=e.i(31278),d=e.i(12426),u=e.i(95116),m=e.i(46696),p=e.i(19455),h=e.i(3133),x=e.i(93479),j=e.i(67489),f=e.i(15288),v=e.i(72436),g=e.i(77572),b=e.i(57428),y=e.i(2747);let _=s.z.object({name:s.z.string().min(2,{message:"Equipment name must be at least 2 characters."}).max(100,{message:"Equipment name must not exceed 100 characters."}),type:s.z.enum(["machine","tool","measuring_device"]),inventory_no:s.z.string().optional(),owned:s.z.boolean().default(!0),status:s.z.enum(["available","in_use","maintenance","broken"]).default("available"),purchase_price_eur:s.z.string().optional().transform(e=>e?parseFloat(e):void 0),rental_price_per_day_eur:s.z.string().optional().transform(e=>e?parseFloat(e):void 0),rental_price_per_hour_eur:s.z.string().optional().transform(e=>e?parseFloat(e):void 0),current_location:s.z.string().optional()}),F=[{value:"machine",label:"Machine",icon:(0,r.jsx)(u.Wrench,{className:"h-4 w-4"})},{value:"tool",label:"Tool",icon:(0,r.jsx)(u.Wrench,{className:"h-4 w-4"})},{value:"measuring_device",label:"Measuring Device",icon:(0,r.jsx)(u.Wrench,{className:"h-4 w-4"})}],w=[{value:"available",label:"Available"},{value:"in_use",label:"In Use"},{value:"maintenance",label:"Under Maintenance"},{value:"broken",label:"Broken/Out of Service"}];function N(){let e=(0,l.useRouter)(),s=(0,l.useParams)().id,[N,C]=(0,n.useState)(!0),[k,S]=(0,n.useState)(!1),[q,E]=(0,n.useState)(null),I=(0,a.useForm)({resolver:(0,t.zodResolver)(_),defaultValues:{name:"",type:"tool",inventory_no:"",owned:!0,status:"available",current_location:""}});async function T(r){console.log("ðŸ”§ Submitting equipment update:",r),S(!0);try{let t={name:r.name,type:r.type,inventory_no:r.inventory_no||void 0,owned:r.owned,status:r.status,purchase_price_eur:r.purchase_price_eur,rental_price_per_day_eur:r.rental_price_per_day_eur,rental_price_per_hour_eur:r.rental_price_per_hour_eur,current_location:r.current_location||void 0};console.log("ðŸ”§ Sending equipment data to API:",t);let a=await fetch("/api/equipment/".concat(s),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(console.log("ðŸ”§ Update response status:",a.status),!a.ok){let e=await a.text();console.error("ðŸ”§ Update API error response:",e);let r="Failed to update equipment";try{r=JSON.parse(e).error||r}catch(t){r="Server error (".concat(a.status,"): ").concat(e)}throw Error(r)}let n=await a.json();console.log("ðŸ”§ Equipment updated successfully:",n),m.toast.success("Equipment updated successfully!"),e.push("/dashboard/equipment")}catch(e){console.error("ðŸ”§ Equipment update error:",e),m.toast.error(e instanceof Error?e.message:"Failed to update equipment")}finally{S(!1)}}return((0,n.useEffect)(()=>{!async function(){if(!s){console.error("No equipmentId provided to edit page"),m.toast.error("No equipment ID provided"),e.push("/dashboard/equipment");return}console.log("ðŸ”§ Loading equipment with ID:",s),C(!0);try{var r,t,a,n;let e=await fetch("/api/equipment/".concat(s));if(console.log("ðŸ”§ API response status:",e.status),!e.ok){let r=await e.text();if(console.error("ðŸ”§ API error response:",r),404===e.status)throw Error("Equipment not found");if(500===e.status)throw Error("Server error while loading equipment");throw Error("Failed to load equipment (".concat(e.status,")"))}let l=await e.json();console.log("ðŸ”§ Loaded equipment data:",l),E(l),I.reset({name:l.name||"",type:l.type||"tool",inventory_no:l.inventory_no||"",owned:null==(n=l.owned)||n,status:l.status||"available",purchase_price_eur:(null==(r=l.purchase_price_eur)?void 0:r.toString())||"",rental_price_per_day_eur:(null==(t=l.rental_price_per_day_eur)?void 0:t.toString())||"",rental_price_per_hour_eur:(null==(a=l.rental_price_per_hour_eur)?void 0:a.toString())||"",current_location:l.current_location||""}),console.log("ðŸ”§ Form populated successfully")}catch(t){console.error("ðŸ”§ Failed to load equipment:",t);let r=t instanceof Error?t.message:"Failed to load equipment data";m.toast.error(r),e.push("/dashboard/equipment")}finally{C(!1)}}()},[s,I,e]),N)?(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"flex items-center justify-between",children:(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)(p.Button,{variant:"ghost",size:"sm",onClick:()=>e.back(),className:"flex items-center",children:[(0,r.jsx)(i.ArrowLeft,{className:"h-4 w-4 mr-2"}),"Back"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(y.Skeleton,{className:"h-8 w-64 mb-2"}),(0,r.jsx)(y.Skeleton,{className:"h-4 w-96"})]})]})}),(0,r.jsx)(v.Separator,{}),(0,r.jsxs)("div",{className:"max-w-4xl space-y-6",children:[(0,r.jsx)(y.Skeleton,{className:"h-10 w-full"}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:Array.from({length:6}).map((e,t)=>(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(y.Skeleton,{className:"h-4 w-24"}),(0,r.jsx)(y.Skeleton,{className:"h-10 w-full"})]},t))})]})]}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"flex items-center justify-between",children:(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsxs)(p.Button,{variant:"ghost",size:"sm",onClick:()=>e.back(),className:"flex items-center",children:[(0,r.jsx)(i.ArrowLeft,{className:"h-4 w-4 mr-2"}),"Back"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold tracking-tight",children:"Edit Equipment"}),(0,r.jsxs)("p",{className:"text-muted-foreground",children:["Update information for ",(null==q?void 0:q.name)||"this equipment"]})]})]})}),(0,r.jsx)(v.Separator,{}),(0,r.jsx)("div",{className:"max-w-4xl",children:(0,r.jsx)(h.Form,{...I,children:(0,r.jsxs)("form",{onSubmit:I.handleSubmit(T),className:"space-y-8",children:[(0,r.jsxs)(g.Tabs,{defaultValue:"basic",className:"w-full",children:[(0,r.jsxs)(g.TabsList,{className:"grid w-full grid-cols-2",children:[(0,r.jsx)(g.TabsTrigger,{value:"basic",children:"Basic Information"}),(0,r.jsx)(g.TabsTrigger,{value:"financial",children:"Financial Details"})]}),(0,r.jsx)(g.TabsContent,{value:"basic",className:"space-y-6",children:(0,r.jsxs)(f.Card,{children:[(0,r.jsxs)(f.CardHeader,{children:[(0,r.jsxs)(f.CardTitle,{className:"flex items-center",children:[(0,r.jsx)(u.Wrench,{className:"h-5 w-5 mr-2"}),"Equipment Details"]}),(0,r.jsx)(f.CardDescription,{children:"Update the basic information about the equipment"})]}),(0,r.jsx)(f.CardContent,{className:"space-y-6",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsx)(h.FormField,{control:I.control,name:"name",render:e=>{let{field:t}=e;return(0,r.jsxs)(h.FormItem,{children:[(0,r.jsx)(h.FormLabel,{children:"Equipment Name *"}),(0,r.jsx)(h.FormControl,{children:(0,r.jsx)(x.Input,{placeholder:"e.g. Hydraulic Excavator CAT 320",...t})}),(0,r.jsx)(h.FormDescription,{children:"A descriptive name for the equipment"}),(0,r.jsx)(h.FormMessage,{})]})}}),(0,r.jsx)(h.FormField,{control:I.control,name:"type",render:e=>{let{field:t}=e;return(0,r.jsxs)(h.FormItem,{children:[(0,r.jsx)(h.FormLabel,{children:"Equipment Type *"}),(0,r.jsxs)(j.Select,{onValueChange:t.onChange,value:t.value,children:[(0,r.jsx)(h.FormControl,{children:(0,r.jsx)(j.SelectTrigger,{children:(0,r.jsx)(j.SelectValue,{placeholder:"Select equipment type"})})}),(0,r.jsx)(j.SelectContent,{children:F.map(e=>(0,r.jsx)(j.SelectItem,{value:e.value,children:(0,r.jsxs)("div",{className:"flex items-center",children:[e.icon,(0,r.jsx)("span",{className:"ml-2",children:e.label})]})},e.value))})]}),(0,r.jsx)(h.FormDescription,{children:"Select the type of equipment"}),(0,r.jsx)(h.FormMessage,{})]})}}),(0,r.jsx)(h.FormField,{control:I.control,name:"inventory_no",render:e=>{let{field:t}=e;return(0,r.jsxs)(h.FormItem,{children:[(0,r.jsx)(h.FormLabel,{children:"Inventory Number"}),(0,r.jsx)(h.FormControl,{children:(0,r.jsx)(x.Input,{placeholder:"e.g. EQ-001, TOOL-123",...t})}),(0,r.jsx)(h.FormDescription,{children:"Unique identifier for tracking"}),(0,r.jsx)(h.FormMessage,{})]})}}),(0,r.jsx)(h.FormField,{control:I.control,name:"status",render:e=>{let{field:t}=e;return(0,r.jsxs)(h.FormItem,{children:[(0,r.jsx)(h.FormLabel,{children:"Status"}),(0,r.jsxs)(j.Select,{onValueChange:t.onChange,value:t.value,children:[(0,r.jsx)(h.FormControl,{children:(0,r.jsx)(j.SelectTrigger,{children:(0,r.jsx)(j.SelectValue,{placeholder:"Select status"})})}),(0,r.jsx)(j.SelectContent,{children:w.map(e=>(0,r.jsx)(j.SelectItem,{value:e.value,children:e.label},e.value))})]}),(0,r.jsx)(h.FormDescription,{children:"Current operational status"}),(0,r.jsx)(h.FormMessage,{})]})}}),(0,r.jsx)(h.FormField,{control:I.control,name:"current_location",render:e=>{let{field:t}=e;return(0,r.jsxs)(h.FormItem,{children:[(0,r.jsx)(h.FormLabel,{children:"Current Location"}),(0,r.jsx)(h.FormControl,{children:(0,r.jsx)(x.Input,{placeholder:"e.g. Warehouse A, Site B",...t})}),(0,r.jsx)(h.FormMessage,{})]})}}),(0,r.jsx)(h.FormField,{control:I.control,name:"owned",render:e=>{let{field:t}=e;return(0,r.jsxs)(h.FormItem,{className:"flex flex-row items-start space-x-3 space-y-0",children:[(0,r.jsx)(h.FormControl,{children:(0,r.jsx)(b.Checkbox,{checked:t.value,onCheckedChange:t.onChange})}),(0,r.jsxs)("div",{className:"space-y-1 leading-none",children:[(0,r.jsx)(h.FormLabel,{children:"Company Owned Equipment"}),(0,r.jsx)(h.FormDescription,{children:"Check if this equipment is owned by the company (vs. rented)"})]}),(0,r.jsx)(h.FormMessage,{})]})}})]})})]})}),(0,r.jsx)(g.TabsContent,{value:"financial",className:"space-y-6",children:(0,r.jsxs)(f.Card,{children:[(0,r.jsxs)(f.CardHeader,{children:[(0,r.jsxs)(f.CardTitle,{className:"flex items-center",children:[(0,r.jsx)(d.DollarSign,{className:"h-5 w-5 mr-2"}),"Financial Information"]}),(0,r.jsx)(f.CardDescription,{children:"Update purchase cost and rental rates for the equipment"})]}),(0,r.jsx)(f.CardContent,{className:"space-y-6",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsx)(h.FormField,{control:I.control,name:"purchase_price_eur",render:e=>{let{field:t}=e;return(0,r.jsxs)(h.FormItem,{children:[(0,r.jsx)(h.FormLabel,{children:"Purchase Price (â‚¬)"}),(0,r.jsx)(h.FormControl,{children:(0,r.jsx)(x.Input,{type:"number",step:"0.01",placeholder:"0.00",...t})}),(0,r.jsx)(h.FormDescription,{children:"Original purchase cost in euros"}),(0,r.jsx)(h.FormMessage,{})]})}}),(0,r.jsx)("div",{}),(0,r.jsx)(h.FormField,{control:I.control,name:"rental_price_per_day_eur",render:e=>{let{field:t}=e;return(0,r.jsxs)(h.FormItem,{children:[(0,r.jsx)(h.FormLabel,{children:"Daily Rental Rate (â‚¬)"}),(0,r.jsx)(h.FormControl,{children:(0,r.jsx)(x.Input,{type:"number",step:"0.01",placeholder:"0.00",...t})}),(0,r.jsx)(h.FormDescription,{children:"Rate charged per day when renting to projects"}),(0,r.jsx)(h.FormMessage,{})]})}}),(0,r.jsx)(h.FormField,{control:I.control,name:"rental_price_per_hour_eur",render:e=>{let{field:t}=e;return(0,r.jsxs)(h.FormItem,{children:[(0,r.jsx)(h.FormLabel,{children:"Hourly Rental Rate (â‚¬)"}),(0,r.jsx)(h.FormControl,{children:(0,r.jsx)(x.Input,{type:"number",step:"0.01",placeholder:"0.00",...t})}),(0,r.jsx)(h.FormDescription,{children:"Rate charged per hour when renting to projects"}),(0,r.jsx)(h.FormMessage,{})]})}})]})})]})})]}),(0,r.jsxs)("div",{className:"flex items-center justify-end space-x-4 pt-6",children:[(0,r.jsx)(p.Button,{type:"button",variant:"outline",onClick:()=>e.back(),disabled:k,children:"Cancel"}),(0,r.jsx)(p.Button,{type:"submit",disabled:k,children:k?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.Loader2,{className:"h-4 w-4 mr-2 animate-spin"}),"Updating..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.Save,{className:"h-4 w-4 mr-2"}),"Update Equipment"]})})]})]})})})]})}}]);